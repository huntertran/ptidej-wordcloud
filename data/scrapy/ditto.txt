Eclipse Ditto • open source framework for digital twins in the IoT
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
… where IoT devices and their digital twins get together
Device-as-a-Service
Provide a higher abstraction level in form of an API used to work with individual devices.
State management for digital twins
Differ between reported (last known), desired (target) and current state (live) of devices, including support for synchronization and publishing of state changes.
Organize your set of digital twins
Who's using Eclipse Ditto?
Add your logo as
adopter/user
of Eclipse Ditto to this list.
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
> License
> Report a Vulnerability
eclipse/ditto - Gitter
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
eclipse/ditto - Gitter
eclipse/ditto - Gitter
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
Julian
@JulianFeinauer
Thanks, I’ll try tht
Alexander Wellbrock
@lionax_gitlab
Hey there again, it's been a while! While playing around with the new _metadata field and trying to apply it to our use-cases I may have hit a rather 'wild' idea I'd like to discuss with you in short before actually taking it seriously ;)
We are using Vorto in conjunction with ditto which basically means that we host our model / schema / metadata in a different place than our actual data. This has a rather annoying implication that each and every time we process data in e.g. a frontend or another micro-service and we want to make assumptions about the structure of the data we pull in Models from Vorto. We basically manage two client libraries and have a lot of repetition here. At the clients we can either merge the model and the data to create a unified object or we implement it that way that you always consult the model before actually accessing the data. With the new _metadata concept coming around I had to think about, what if ditto had a concept of prototypes in that I bring my model from outside e.g. from vorto like it is now but I can actually attach model information and metadata to each thing. It's just a bit like prototypes in e.g. JavaScript. I'm currently experimenting, if simply using the _metadata feature is sufficient or rather enough for that idea.
Any thoughts on that?
Thomas Jaeckle
@thjaeckle
hi Alex - we already had the same idea, e.g. storing the
measurementUnit
of a Vorto property as metadata in order to "know" during runtime that e.g. a value is actually a Temperature in Celcius
The datatype would probably also be useful to add as metadata, the min/max constraints could also be ..
So this is totally valid idea
We even thought about that Ditto coud some day translate e.g. a "Celsius" temperature to a "Fahrenheit" temperature - that e.g. the user of the API asks for the "fahrenheit" value of a certain property and Ditto does some internal conversion
GitHub - eclipse/ditto-examples: Ditto Examples
Alexander Wellbrock
@lionax_gitlab
Thomas Jaeckle
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
Alexander Wellbrock
@lionax_gitlab
I'm excited to hear that ;)
Thomas Jaeckle
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
eclipse/ditto - Gitter
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Dashboard [Jenkins]
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
eclipse/ditto - Gitter
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
var isRunAsTest=false; var rootURL="/ditto"; var resURL="/ditto/static/f2c5995a";
crumb.init("Jenkins-Crumb", "ef3e704d152c9239557c9b258e165db598c607eecc3242fd02673aa0753f8738");
var Q=jQuery.noConflict()
Skip to content
Jenkins
createSearchBox("/ditto/search/");
log in
Jenkins
ENABLE AUTO REFRESH
People
Build History
Project Relationship
Check File Fingerprint
Build Queue
No builds in the queue.
refreshPart('buildQueue',"/ditto/ajaxBuildQueue");
Build Executor Status
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
Alexander Wellbrock
@lionax_gitlab
I'm excited to hear that ;)
Thomas Jaeckle
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
a complete thing modify API without affecting specific parts (PATCH) · Issue #288 · eclipse/ditto · GitHub
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
refreshPart('executors',"/ditto/ajaxExecutors");
All
S
W
Name
Last Success
Last Failure
Last Duration
W
Description
%
Test Result: 0 tests failing out of a total of 9,320 tests.
100
Build stability: No recent builds failed.
100
ditto
-ci
2 days 6 hr -
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
eclipse/ditto - Gitter
eclipse/ditto - Gitter
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
eclipse/ditto - Gitter
Thing Metadata • Eclipse Ditto • a digital twin framework
Eclipse Ditto | projects.eclipse.org
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Index of ditto-dev for October 2020
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
eclipse
/
ditto-examples
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
#700
1 mo 15 days -
#658
26 min
W
Description
%
Test Result: 0 tests failing out of a total of 1,296 tests.
100
Build stability: No recent builds failed.
100
ditto
-client
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
Eclipse Ditto version:
development
Google Tag Manager
Skip to main content
Log in
Manage Cookies
projects.eclipse.org
Download
Projects
Working Groups
Members
Community
Marketplace
Events
Planet Eclipse
Newsletter
Videos
Blogs
Yufei Cai
@yufei-cai
@vhdirk
could you provide more information? Ideally a reproducible set up in the Ditto sandbox.
Thomas Jaeckle
@thjaeckle
@JulianFeinauer
just start all of the *Service main classes in Debug mode in IntelliJ
start with the PoliciesService main
after that is up, start the others in any order you want: ThingsService, SearchService, ConciergeService, GatewayService, ConnectivityService
they expect that a MongoDB is running and is reachable on
localhost:27017
Julian
@JulianFeinauer
Thanks, I’ll try tht
Alexander Wellbrock
Thomas Jaeckle
@thjaeckle
@JulianFeinauer
just start all of the *Service main classes in Debug mode in IntelliJ
start with the PoliciesService main
after that is up, start the others in any order you want: ThingsService, SearchService, ConciergeService, GatewayService, ConnectivityService
they expect that a MongoDB is running and is reachable on
localhost:27017
Julian
@JulianFeinauer
Thanks, I’ll try tht
Alexander Wellbrock
@lionax_gitlab
Hey there again, it's been a while! While playing around with the new _metadata field and trying to apply it to our use-cases I may have hit a rather 'wild' idea I'd like to discuss with you in short before actually taking it seriously ;)
Skip to main content
Edit my account
Manage Cookies
Donate
Members
Working Groups
Projects
Community
Marketplace
Events
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
Mailing Lists
Thomas Jaeckle
@thjaeckle
they expect that a MongoDB is running and is reachable on
localhost:27017
Julian
@JulianFeinauer
Thanks, I’ll try tht
Alexander Wellbrock
@lionax_gitlab
Hey there again, it's been a while! While playing around with the new _metadata field and trying to apply it to our use-cases I may have hit a rather 'wild' idea I'd like to discuss with you in short before actually taking it seriously ;)
We are using Vorto in conjunction with ditto which basically means that we host our model / schema / metadata in a different place than our actual data. This has a rather annoying implication that each and every time we process data in e.g. a frontend or another micro-service and we want to make assumptions about the structure of the data we pull in Models from Vorto. We basically manage two client libraries and have a lot of repetition here. At the clients we can either merge the model and the data to create a unified object or we implement it that way that you always consult the model before actually accessing the data. With the new _metadata concept coming around I had to think about, what if ditto had a concept of prototypes in that I bring my model from outside e.g. from vorto like it is now but I can actually attach model information and metadata to each thing. It's just a bit like prototypes in e.g. JavaScript. I'm currently experimenting, if simply using the _metadata feature is sufficient or rather enough for that idea.
Any thoughts on that?
Thomas Jaeckle
@thjaeckle
hi Alex - we already had the same idea, e.g. storing the
measurementUnit
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Watch
16
Star
34
Fork
20
Ditto Examples
EPL-2.0 License
34
stars
20
forks
Star
Watch
Code
Issues
1
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
_
-java
-ci
2 days 5 hr -
#101
16 days -
#96
2 min 29 sec
W
Description
%
Build stability: 4 out of the last 5 builds failed.
20
ditto
-client
-java
-license
-check
2 days 6 hr -
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
Of course. I'll open an issue and describe it in more detail there
_
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
GitHub - eclipse/ditto: Eclipse Ditto Project
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
eclipse/ditto - Gitter
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Julian
@JulianFeinauer
@thjaeckle
do you have a tip for me how you debug into ditto? Run all containers and start one service with different settings? Debug connect into running container? Is there an „easy“ way?
Yufei Cai
@yufei-cai
@vhdirk
could you provide more information? Ideally a reproducible set up in the Ditto sandbox.
Thomas Jaeckle
@thjaeckle
@JulianFeinauer
just start all of the *Service main classes in Debug mode in IntelliJ
start with the PoliciesService main
after that is up, start the others in any order you want: ThingsService, SearchService, ConciergeService, GatewayService, ConnectivityService
they expect that a MongoDB is running and is reachable on
localhost:27017
Julian
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
1.0
1.1
1.2
1.3
Important:
This documentation reflects the latest 'development'. You might want to choose a released version.
Introduction
Overview
Digital twins
Hello world
Release Notes
1.3.0
Participate
Report a Bug
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
@lionax_gitlab
Hey there again, it's been a while! While playing around with the new _metadata field and trying to apply it to our use-cases I may have hit a rather 'wild' idea I'd like to discuss with you in short before actually taking it seriously ;)
We are using Vorto in conjunction with ditto which basically means that we host our model / schema / metadata in a different place than our actual data. This has a rather annoying implication that each and every time we process data in e.g. a frontend or another micro-service and we want to make assumptions about the structure of the data we pull in Models from Vorto. We basically manage two client libraries and have a lot of repetition here. At the clients we can either merge the model and the data to create a unified object or we implement it that way that you always consult the model before actually accessing the data. With the new _metadata concept coming around I had to think about, what if ditto had a concept of prototypes in that I bring my model from outside e.g. from vorto like it is now but I can actually attach model information and metadata to each thing. It's just a bit like prototypes in e.g. JavaScript. I'm currently experimenting, if simply using the _metadata feature is sufficient or rather enough for that idea.
Any thoughts on that?
Thomas Jaeckle
@thjaeckle
hi Alex - we already had the same idea, e.g. storing the
measurementUnit
of a Vorto property as metadata in order to "know" during runtime that e.g. a value is actually a Temperature in Celcius
The datatype would probably also be useful to add as metadata, the min/max constraints could also be ..
So this is totally valid idea
We even thought about that Ditto coud some day translate e.g. a "Celsius" temperature to a "Fahrenheit" temperature - that e.g. the user of the API asks for the "fahrenheit" value of a certain property and Ditto does some internal conversion
Alexander Wellbrock
@lionax_gitlab
I'm excited to hear that ;)
Thomas Jaeckle
@thjaeckle
We are using Vorto in conjunction with ditto which basically means that we host our model / schema / metadata in a different place than our actual data. This has a rather annoying implication that each and every time we process data in e.g. a frontend or another micro-service and we want to make assumptions about the structure of the data we pull in Models from Vorto. We basically manage two client libraries and have a lot of repetition here. At the clients we can either merge the model and the data to create a unified object or we implement it that way that you always consult the model before actually accessing the data. With the new _metadata concept coming around I had to think about, what if ditto had a concept of prototypes in that I bring my model from outside e.g. from vorto like it is now but I can actually attach model information and metadata to each thing. It's just a bit like prototypes in e.g. JavaScript. I'm currently experimenting, if simply using the _metadata feature is sufficient or rather enough for that idea.
Any thoughts on that?
Thomas Jaeckle
@thjaeckle
hi Alex - we already had the same idea, e.g. storing the
measurementUnit
of a Vorto property as metadata in order to "know" during runtime that e.g. a value is actually a Temperature in Celcius
The datatype would probably also be useful to add as metadata, the min/max constraints could also be ..
So this is totally valid idea
We even thought about that Ditto coud some day translate e.g. a "Celsius" temperature to a "Fahrenheit" temperature - that e.g. the user of the API asks for the "fahrenheit" value of a certain property and Ditto does some internal conversion
Alexander Wellbrock
@lionax_gitlab
I'm excited to hear that ;)
Thomas Jaeckle
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
More
Community
Marketplace
Events
Planet Eclipse
Newsletter
of a Vorto property as metadata in order to "know" during runtime that e.g. a value is actually a Temperature in Celcius
The datatype would probably also be useful to add as metadata, the min/max constraints could also be ..
So this is totally valid idea
We even thought about that Ditto coud some day translate e.g. a "Celsius" temperature to a "Fahrenheit" temperature - that e.g. the user of the API asks for the "fahrenheit" value of a certain property and Ditto does some internal conversion
Alexander Wellbrock
@lionax_gitlab
I'm excited to hear that ;)
Thomas Jaeckle
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Pull requests
5
Actions
Projects
0
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Security
Insights
Dismiss
Join GitHub today
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
#13
2 days 6 hr -
#12
1 min 49 sec
W
Description
%
Test Result: 0 tests failing out of a total of 1,296 tests.
100
Build stability: No recent builds failed.
100
ditto
-client
-java
-release
25 days -
1.3.0
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
@JulianFeinauer
Thanks, I’ll try tht
Alexander Wellbrock
@lionax_gitlab
Hey there again, it's been a while! While playing around with the new _metadata field and trying to apply it to our use-cases I may have hit a rather 'wild' idea I'd like to discuss with you in short before actually taking it seriously ;)
We are using Vorto in conjunction with ditto which basically means that we host our model / schema / metadata in a different place than our actual data. This has a rather annoying implication that each and every time we process data in e.g. a frontend or another micro-service and we want to make assumptions about the structure of the data we pull in Models from Vorto. We basically manage two client libraries and have a lot of repetition here. At the clients we can either merge the model and the data to create a unified object or we implement it that way that you always consult the model before actually accessing the data. With the new _metadata concept coming around I had to think about, what if ditto had a concept of prototypes in that I bring my model from outside e.g. from vorto like it is now but I can actually attach model information and metadata to each thing. It's just a bit like prototypes in e.g. JavaScript. I'm currently experimenting, if simply using the _metadata feature is sufficient or rather enough for that idea.
Any thoughts on that?
Thomas Jaeckle
@thjaeckle
hi Alex - we already had the same idea, e.g. storing the
measurementUnit
of a Vorto property as metadata in order to "know" during runtime that e.g. a value is actually a Temperature in Celcius
The datatype would probably also be useful to add as metadata, the min/max constraints could also be ..
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
1.2.1
1.2.0
1.1.5
1.1.3
1.1.2
1.1.1
1.1.0
1.0.0
0.9.0
0.8.0
Milestone releases
1.0.0-M2
1.0.0-M1a
0.9.0-M2
0.9.0-M1
0.8.0-M3
0.8.0-M2
0.8.0-M1
Newcomer Forum
More
Community
Marketplace
Events
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
the http header to set is
put-metadata
as mentioned above in the chat
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Videos
Blogs
Participate
Report a Bug
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
Search
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
eclipse
/
ditto
Watch
36
Star
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
5
branches
0
tags
Go to file
Code
Clone
HTTPS
GitHub CLI
Use Git or checkout with SVN using the web URL.
Work fast with our official CLI.
Learn more
.
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
5 mo 17 days -
#22
9 min 6 sec
W
Description
%
Build stability: No recent builds failed.
100
ditto
-client
-javascript
-ci
1 day 15 hr -
#917
5 mo 16 days -
#897
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
_
Alexander Wellbrock
@lionax_gitlab
Thomas Jaeckle
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
So this is totally valid idea
We even thought about that Ditto coud some day translate e.g. a "Celsius" temperature to a "Fahrenheit" temperature - that e.g. the user of the API asks for the "fahrenheit" value of a certain property and Ditto does some internal conversion
Alexander Wellbrock
@lionax_gitlab
I'm excited to hear that ;)
Thomas Jaeckle
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
0.3.0-M2
0.3.0-M1
0.2.0-M1
0.1.0-M3
0.1.0-M1
Installation
Building Ditto
Running Ditto
Operating Ditto
Basic concepts
Overview
Model entities
Thing
Access Control List (ACL)
Feature
Policy
Namespaces and Names
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
Toggle navigation
Home
Projects
Eclipse IoT
Eclipse Ditto
Eclipse Ditto
Primary tabs
Overview
(active tab)
Downloads
Who's Involved
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Toggle navigation
Breadcrumbs
Home
Contribute
Source code
Index of ditto-dev for October 2020
Index by Thread
Index by Year
[
First Page
] [
Prev Page
][Next Page] [
Last Page
]
October 25, 2020
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
208
Fork
70
Code
Issues
53
Pull requests
2
Actions
Projects
1
Security
Insights
More
Code
Issues
Pull requests
Open with GitHub Desktop
Download ZIP
Launching GitHub Desktop
If nothing happens,
download GitHub Desktop
and try again.
Go back
Launching GitHub Desktop
If nothing happens,
download GitHub Desktop
and try again.
Go back
Launching Xcode
If nothing happens,
download Xcode
and try again.
Go back
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
2 min 57 sec
W
Description
%
Build stability: 3 out of the last 5 builds failed.
40
ditto
-client
-javascript
-release
5 mo 15 days -
#25
5 mo 16 days -
#23
4 min 8 sec
W
Description
%
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Thing Metadata
Errors
Authentication and Authorization
Messages
Signals
Signal types
Command
Command response
Error response
Event
APIs
Connections
Placeholders
Change notifications
RQL expressions
Signal enrichment
Search
Acknowledgements / QoS
Developer Resources
Governance
Contact Us
Eclipse Ditto is a framework for providing the "Digital Twin" pattern for IoT applications in order to interact with IoT devices.
That means that Ditto mirrors physical devices as digital representations in the cloud.
As a web or mobile app developer you can interact with those digital twins as if they were any other web service, that's why Ditto enables a "device as a service" paradigm.
A few of the main features are access control, a search over all twin data and push notifications.
There are various APIs in order to interact with the devices: an HTTP and WebSocket API, additionally the capability to integrate with other systems via AMQP, MQTT and Apache Kafka.
Ditto scales horizontally, so managing millions of twins is what it is designed for.
The benefit when developing IoT applications or solutions is that no own backend must be implemented, the focus can be set on the use case: for example device integration and app or web UI implementation.
Device-as-a-Service
IoT solutions have to interact with a heterogeneous set of device types, device protocols and communication patterns.
To bring back simplicity to IoT developers, Eclipse Ditto exposes a unified resource-based API that can be used to interact with devices, abstracting from the complexity of different device types and how devices are connected. It helps to structure the devices
As devices are equipped with a public API (potentially public on the Internet), it is crucial to define on a device level which individuals are allowed interact with the devices. Ditto ensures that access to the device API is only granted for authorized individuals. Authentication is not scope of Ditto and delegated to existing identity providers.
With this approach your devices are turned into services with a hosted, always accessible and available API.
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
[ditto-dev] Seeking guidance re: Ditto, Hono, and Cloud2edge package
Posted 06:39 by Robinson Montalvo
Mail converted by
MHonArc
Back to the top
Eclipse Foundation
About Us
Contact Us
Donate
Governance
Logo and Artwork
Board of Directors
Legal
Privacy Policy
Terms of Use
Copyright Agent
Eclipse Public License
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
Actions
Projects
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Launching Visual Studio
If nothing happens,
download the GitHub extension for Visual Studio
and try again.
Go back
Latest commit
Git stats
116
commits
Files
Permalink
Failed to load latest commit information.
Type
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
Build stability: All recent builds failed.
0
ditto
-license
-check
5 days 4 hr -
#6
2 days 8 hr -
#21
3 min 45 sec
W
Description
%
Test Result: 0 tests failing out of a total of 9,182 tests.
100
Build stability: No recent builds failed.
100
ditto
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
Architecture
Overview
Services
Policies
Things
Things-Search
Connectivity
Concierge
Gateway
HTTP API
Overview
Concepts
Search
Messages
WebSocket protocol binding
Server sent events
Devices managed by Ditto are usable as easy as any of the other services (like weather, maps, ...) within your application.
State management for Digital Twins
A digital representation of physical devices consists at its heart of the state these devices.
For IoT solutions the following information regarding state is most relevant:
Device and sensor properties like temperature, location, level, fault information, etc.
Configuration properties of sensors and actors like thresholds, intervals, ranges, toggles and limits, etc.
A good representation of this state in a Digital Twin should support different perspectives for these properties:
Reported property values based on the last transmission to the back end
Desired target property value for configuration properties
Live perspective reflecting the properties values at the current point of time
The state management provides access to all three different perspectives and helps in synchronizing between them.
Organize your set of Digital Twins
When interacting with huge amounts of devices, it can get difficult to keep track of which devices and devices types are there and how they are related (e.g. spatially).
It is wise to add meta data like e.g. manufacturer, model information, static geographic location, serial number or software version to devices in order to find them again later.
That meta data as well as the state data is automatically indexed by Ditto which leads to fast search responses provided by the search API, even when there are millions of devices to search in.
When working with sets of devices authorization information is used to determine the visibility of devices to individuals and control who can change device data.
Features at a glance
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
Legal Resources
Useful Links
Report a Bug
Documentation
How to Contribute
Mailing Lists
Forums
Marketplace
Other
IDE and Tools
Community of Projects
Working Groups
Research@Eclipse
Report a Vulnerability
Service Status
Copyright © Eclipse Foundation, Inc. All Rights Reserved.
Back to the top
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
a complete thing modify API without affecting specific parts (PATCH)
#288
Name
Latest commit message
Commit time
azure
grove-ctrl
influxdb
java-client
kata
legal
mqtt-bidirectional
octopus-via-hono
payload-mapping-testing
plc4x
rest-to-websocket
.gitignore
CONTRIBUTING.md
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
-release
25 days -
1.3.0
2 mo 1 day -
1.1.4
1 hr 1 min
W
Description
%
Build stability: No recent builds failed.
100
ditto
-website
-build
-and
-deploy
2 days 5 hr -
#73
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse
/
ditto
Watch
36
Star
208
Fork
70
Eclipse Ditto Project
eclipse.org/ditto/
EPL-2.0 License
208
stars
70
forks
Star
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
_
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
Connectivity API
Overview
Manage connections
AMQP 0.9.1 protocol binding
AMQP 1.0 protocol binding
MQTT 3.1.1 protocol binding
MQTT 5 protocol binding
HTTP 1.1 protocol binding
Kafka 2.x protocol binding
Payload mapping
Header mapping
TLS certificates
Client SDK
Overview
Java
JavaScript
Ditto Protocol
Unified resource-based HTTP JSON API representing devices
Definition of a simple "Digital Twin State Management Protocol" using JSON for command- and events-based interaction with devices
Websocket API based on this protocol in addition to the resource-based HTTP API
Establishing and maintaining connections to AMQP 0.9.1, AMQP 1.0, MQTT and Apache Kafka endpoints
Managing device meta data via APIs
Optionally configure and enforce a schema for device state (via Eclipse Vorto)
Schema evolution support for schema based device state
Accessing and setting different state perspectives
Live
Reported
Desired
Notification about changes of device resources via HTTP Server-sent events (SSE)
Authorization/Access control at device API enforcing that only allowed individuals may read/write
Search HTTP API accepting predicate-based query language
Emit events resulting from state changes of devices which can be used
for building up a "transaction log" (e.g. using Apache Kafka)
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
_
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
_
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
_
Alexander Wellbrock
Open
zubairhamed
opened this issue
Nov 19, 2018
· 11 comments
Open
a complete thing modify API without affecting specific parts (PATCH)
#288
zubairhamed
opened this issue
Nov 19, 2018
· 11 comments
Labels
community-interest
Comments
Copy link
LICENSE
README.md
View code
README.md
Eclipse Ditto :: Examples
This repository contains examples and demonstrations of how to use
Eclipse Ditto
.
Projects
grove control
The grove control project shows the different communication possibilities using Eclipse Ditto on your local machine and a Rasperry Pi with GrovePi+ board as IoT device. This project uses Python for the Raspberry Pi code and jQuery for the Web UI.
Rest to WebSocket demo
This example shows how to combine the REST and WebSocket API of Eclipse Ditto. This is demonstrated using a Frontend that sends REST requests and a Thing that has a WebSocket connection to Ditto and uses it to receive and respond to Messages. This project requires a running Eclipse Ditto instance and a modern web browser.
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
3 mo 19 days -
#53
9 min 40 sec
Icon:
S
M
L
Legend
Atom feed for all
Atom feed for failures
Atom feed for just latest builds
Page generated: Oct 25, 2020 3:24:28 PM EDT
REST API
Jenkins ver. 2.222.4
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
_
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
Watch
Code
Issues
53
Pull requests
2
Actions
Projects
1
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
_
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
_
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
_
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
Overview
Twin/live channel
Specification
Protocol topic
Things group
→ commands/events
Create/Modify
Retrieve
Delete
Acknowledgements
Errors
as source for stream processing (e.g. via Apache Spark Streaming)
for building up additional persistence representations (e.g. into an InfluxDB providing optimized access to the history of a device's state properties)
for transmitting data into data analytic tools (e.g. into an Apache Hadoop HDFS)
Out-of-box integration with Eclipse Hono for communication with devices using standard or custom device protocols
Integrate Ditto in a IoT landscape
Ditto is especially useful in the context of a larger IoT landscape. In this landscape the other important aspects of a IoT solution like device communication or data analytics are covered by distinct components.
The most important integration aspect is the device communication. This is essential for the Digital Twins to really be twins of real-world physical devices.
In addition to provide a custom device communication layer Ditto will provide an out-of-the-box integration with Eclipse Hono to support device communication.
In this scenario Ditto uses Eclipse Hono in order to receive messages (e.g. state changes) from devices and to send messages (e.g. configuration changes) to devices.
Licenses:
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
Quote reply
zubairhamed
commented
Nov 19, 2018
Hi,
is there a way to update multiple parts of a twin/thing without affecting the entire thing using the ditto protocol?
example:
sending an update to path "/" would mean:
a) overwriting parts which may not be desired to be update (e..g the vorto "definition")
b) updating static properties such as attribute
if i want to update say 10 datapoints on a thing, this would mean making 10 calls to the individual features. the updating client needs to know everything about the thing including all the meta information..
solution: maybe: its possible to send an array of commands for path and value instead of singular values?
Or is there anothe way to do so?
Z
Copy link
Contributor
jufickel-b
Octopus via Hono to Ditto
Arduino based example on a ESP8266 board publishing read out sensor values in Ditto Protocol via the MQTT endpoint of
Eclipse Hono
to a digital twin in Ditto:
BME680 sensor
temperature
humidity
barometer
BNO055 sensor
temperature
linear acceleration
angular velocity
gravity
absolute orientation
accelerometer
magnetometer
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
6
branches
29
tags
Go to file
Code
Clone
HTTPS
GitHub CLI
Use Git or checkout with SVN using the web URL.
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
→ search/messages
Search
Messages
Policies group
→ commands/events
Create/Modify
Retrieve
Delete
Bindings
Examples
→ Things examples
Create a Thing
Delete a Thing
Modify a Thing
Retrieve a Thing
Retrieve multiple Things
Modify the Policy ID of a Thing
Eclipse Public License 2.0
Latest Releases:
From July 10th, 2019 to September 30th, 2020
Name
Date
Review
1.3.0
2020-09-30
1.2.1
2020-09-08
1.2.0
2020-08-31
1.1.5
2020-08-25
1.1.3
2020-07-20
1.1.2
2020-07-01
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
Index of ditto-dev for April 2017
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
commented
Nov 19, 2018
•
edited
Hi Zubair,
You can locally update your Features and send them as a whole to .../<thing-id>/features. The same applies to Attributes.
Kind regards
Jürgen
Copy link
Author
zubairhamed
commented
Nov 19, 2018
Woudn't this wipe off any data which in this case don't want to? e.g. "definition"?
This would mean the "local update" would need additional meta information prior to the update, no?
Copy link
Contributor
power voltage
IoT-Device connected directly to Ditto via MQTT - controlled by a custom solution
This example demonstrates how to connect an Arduino based device to Eclipse Ditto and how payload mapping can be utilized to transform its telemetry data into a valid digital twin representation. Furthermore a simple front-end allows manipulating the digital twin and receives twin updates via SSE (Server Sent Events).
Parts of this example
Arduino
How to establish a network connection
How to establish a MQTT connection
How to receive and publish valid JSON data
Front-end
How to use Ditto's HTTP API for
Create policy and things
Create a connection (MQTT)
Send live messages to device
Listen to server sent events
Eclipse Ditto
How to set up Eclipse Ditto with Docker (alternatively use Ditto's Sandbox)
How to apply payload mapping on incoming messages from a connection
Samples for Microsoft Azure users
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Work fast with our official CLI.
Learn more
.
Open with GitHub Desktop
Download ZIP
Launching GitHub Desktop
If nothing happens,
download GitHub Desktop
and try again.
Go back
Launching GitHub Desktop
If nothing happens,
download GitHub Desktop
and try again.
Go back
Launching Xcode
If nothing happens,
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
_
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
Create Attributes
Delete Attributes
Modify Attributes
Retrieve Attributes
Create a single Attribute
Delete a single Attribute
Modify a single Attribute
Retrieve a single Attribute
Create a Definition
Delete a Definition
Modify a Definition
Retrieve a Definition
Create Features
Delete Features
Modify Features
Retrieve Features
Create a single Feature
Delete a single Feature
Index of ditto-dev for April 2020
1.1.1
2020-05-11
1.1.0
2020-04-29
1.0.0
2019-12-12
0.9.0
2019-07-10
Active Member Companies:
Member companies supporting this project over the last three months.
Contribution Activity:
Commits on this project (last 12 months).
Project Links
Website
Documentation
Related Projects
Related Projects:
[ditto-dev] Seeking guidance re: Ditto, Hono, and Cloud2edge package
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
ditto-dev Archive (Date View)
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
Skip to main content
Edit my account
Manage Cookies
Donate
Members
Working Groups
Projects
Community
Marketplace
Events
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
jufickel-b
commented
Nov 19, 2018
•
edited
You are right, PUT overwrites all existing Features. Therefore you should GET them beforehand to have the most recent state before updating them. To avoid lost updates in case of several clients you could harness
ETags
.
👎
1
Copy link
Author
zubairhamed
commented
Nov 19, 2018
•
edited
Samples to leverage Eclipse Ditto capabilities with Microsoft Azure services.
kata
A code kata is a way of learning new things and consolidating what has been learned. The presented katas serve to understand specific features of ditto better.
About
Ditto Examples
Resources
Readme
License
EPL-2.0 License
Releases
No releases published
Packages
0
No packages published
Contributors
14
+ 3 contributors
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
download Xcode
and try again.
Go back
Launching Visual Studio
If nothing happens,
download the GitHub extension for Visual Studio
and try again.
Go back
Latest commit
Git stats
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
Modify a single Feature
Retrieve a single Feature
Create Feature Definition
Delete Feature Definition
Modify Feature Definition
Retrieve Feature Definition
Create Feature Properties
Delete Feature Properties
Modify Feature Properties
Retrieve Feature Properties
Create a single Property
Delete a single Property
Modify a single Property
Retrieve a single Property
Error responses
→ Policies examples
Create a Policy
Delete a Policy
Skip to main content
Edit my account
Manage Cookies
Donate
Members
Working Groups
Projects
Community
Marketplace
Events
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Eclipse IoT
Eclipse Hono
Eclipse Vorto
Eclipse Technology
Eclipse OpenJ9
Project Hierarchy:
Eclipse IoT
Eclipse Ditto
Tags
Technology Types
Internet of Things
Other Tags
twin
iot
Eclipse Foundation
About Us
Contact Us
Skip to main content
Edit my account
Manage Cookies
Donate
Members
Working Groups
Projects
Community
Marketplace
Events
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
Skip to main content
Edit my account
Manage Cookies
Donate
Members
Working Groups
Projects
Community
Marketplace
Events
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
More
Community
Marketplace
Events
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
Hi Juergen,
Thanks for the speedy replies.
Unfortunately doing a GET prior to a PUT all the time is not feasible at all.
If a device uses the Ditto protocol and it needs to update multiple sensor values (be it via Hono or directly to Ditto), doing a GET all the time is not feasible. this would mean the device would additionally need connectivity to IoT Things and apiTokens etc to do this.
If it isn't sending via Ditto and it sends over a few bytes of byte array which needs to be unpacked into multiple bytes, the Ditto Mapping engine doesn't allow doing a GET anyway prior to update. Additionally you can't use this to do multiple update calls either.
Z
Copy link
Contributor
Yannic92
commented
Nov 19, 2018
•
edited
Languages
Java
61.0%
JavaScript
16.3%
C++
6.9%
HTML
6.8%
Vue
4.0%
Python
3.8%
Other
1.2%
© 2020 GitHub, Inc.
6,114
commits
Files
Permalink
Failed to load latest commit information.
Type
Name
Latest commit message
Commit time
.github/
workflows
bom
deployment
documentation
json-cbor
json
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
Modify a Policy
Retrieve a Policy
Modify entries
Retrieve entries
Create a single entry
Delete a single entry
Modify a single entry
Retrieve a single entry
Modify subjects
Retrieve subjects
Create a single subject
Delete a single subject
Modify a single subject
Retrieve a single subject
Modify resources
Retrieve resources
Create a single resource
Delete a single resource
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
More
Community
Marketplace
Events
Planet Eclipse
Donate
Members
Governance
Code of Conduct
Logo and Artwork
Board of Directors
Legal
Privacy Policy
Terms of Use
Copyright Agent
Eclipse Public License
Legal Resources
Useful Links
Report a Bug
Documentation
How to Contribute
Mailing Lists
Forums
Ditto documentation overview • Eclipse Ditto • a digital twin framework
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
More
Community
Marketplace
Events
Planet Eclipse
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
More
Community
Marketplace
Events
Planet Eclipse
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
Hi Zubair,
unfortunately currently we don't support something like a PATCH request that allows to update a thing partially.
You're currently required to do multiple PUT requests (ModifyFeature/ModifyAttribute commands) to the respective Attributes/Features if a GET is not possible.
But I guess you're already aware of this and that's what you meant when you said
"if i want to update say 10 datapoints on a thing, this would mean making 10 calls to the individual features".
I'm sorry that I can't give you a more satisfying answer right now.
Copy link
Contributor
thjaeckle
commented
Nov 20, 2018
Thanks Zubair for reporting.
We already thought about adding such a "PATCH" metaphor - or additionally support sending multiple Ditto commands aggregated in one message (which you also suggested - that would be easier, so we'll also track that in another issue).
We will use this issue for further discussion and tracking the feature.
Our thoughts were that we not only support this for the Ditto Protocol, but also for the HTTP-API.
That way you could do a HTTP PATCH request (e.g. with
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
legal
model
protocol-adapter
services
signals
src
utils
.gitignore
CONTRIBUTING.md
Jenkinsfile_multibranch_pipeline
LICENSE
NOTICE.md
README.md
pom.xml
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Modify a single resource
Retrieve a single resource
Error responses
→ Search examples
Sandbox
Presentations
Glossary
Feedback
Collapse All
|
Expand All
Thing Metadata
A Thing in Ditto is also able to store Metadata information, e.g. about single
feature properties
, complete features and also
attributes
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Marketplace
Other
IDE and Tools
Projects
Working Groups
Research@Eclipse
Report a Vulnerability
Service Status
Copyright © Eclipse Foundation, Inc. All Rights Reserved.
Back to the top
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
Eclipse Ditto version:
development
ditto-dev Archive (Thread View - Most Recent First)
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Newcomer Forum
Search
Toggle navigation
Breadcrumbs
Home
Contribute
Source code
Index of ditto-dev for April 2017
Index by Thread
Index by Year
[
First Page
] [
Prev Page
][
Next Page
] [
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
JsonPatch
) and only modify very selectively.
👍
2
thjaeckle
changed the title
a complete thing modify API without affecting specific parts (via ditto protocol)
a complete thing modify API without affecting specific parts (PATCH)
Nov 20, 2018
thjaeckle
mentioned this issue
Nov 20, 2018
Support combining several DittoProtocol commands in a single aggregating one
#289
Open
Copy link
moebigit
commented
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
View code
README.md
Eclipse Ditto
Eclipse Ditto
Documentation
Find the documentation on the project site:
https://eclipse.org/ditto/
Getting started
In order to start up Ditto, you'll need
a running Docker daemon (at least version 18.06 CE)
Docker Compose installed (at least version 1.22)
Start Ditto
In order to start the latest built Docker images from Docker Hub, simply execute:
Check the logs after starting up:
Open following URL to get started:
http://localhost:8080
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
or other data stored in a digital twin (
thing
).
This metadata can contain additionally information which shall not be treated as part of the twin’s value, however may be useful to provide some context of the twin’s data.
Metadata has not its own API but can only be updated/set while modifying the state of a twin as a side effect.
By default, metadata is not returned at API requests, but must be
asked for explicitly
.
An example is the timestamp when the current value of e.g. a feature property was updated for the last time. Or the metadata information of a feature property may contain information about its type or its semantics (e.g. a unit of measurement).
Setting Metadata
Setting arbitrary
Metadata
is possible by using the
put-metadata
header (e.g. for HTTP requests, set it as HTTP header, for Ditto Protocol requests, put it in the
"headers"
section of the protocol message), see
Newcomer Forum
Search
Toggle navigation
Breadcrumbs
Home
Contribute
Source code
Index of ditto-dev for April 2020
Index by Thread
Index by Year
[
First Page
] [
Prev Page
][
Next Page
1.0
1.1
1.2
1.3
Important:
This documentation reflects the latest 'development'. You might want to choose a released version.
Introduction
Overview
Digital twins
Hello world
Release Notes
1.3.0
1.2.1
1.2.0
1.1.5
1.1.3
1.1.2
Skip to main content
Edit my account
Manage Cookies
Donate
Members
Working Groups
Projects
Community
Marketplace
Events
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Newcomer Forum
Search
Toggle navigation
Breadcrumbs
Home
Contribute
Source code
[
Date Prev
][Date Next][
Thread Prev
][Thread Next][
Date Index
][
Thread Index
]
[
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
Search
Toggle navigation
Breadcrumbs
Home
Contribute
Source code
ditto-dev Archive (Date View)
Index by Thread
Index by Year
[
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Last Page
]
April 08, 2017
Welcome to ditto-dev
Posted 00:05 by portal on behalf of emo
Mail converted by
MHonArc
Back to the top
Eclipse Foundation
About Us
Contact Us
Donate
Governance
Logo and Artwork
Board of Directors
Legal
Privacy Policy
Terms of Use
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
Apr 22, 2019
Hello everybody
I have a similar use case where I would like to send telemetry messages to the hub in ditto format which then updates my thing but only the respective features of my thing.
For optimization I won't send all features with every message - only the ones that have changed, and I also don't want to send individual messages for each property change to keep the number of requests to a minimum.
In my case, either being able to merge my feature structure with the current Twin state would be helpful or being able to provide multiple "path/value"-combinations inside the ditto message.
Copy link
Contributor
thjaeckle
commented
Apr 23, 2019
Sure, still a very valid feature request.
We currently more think about a new verb in the Ditto Protocol (we currently have: create, delete, modify, read):
merge
That - differently than "modify" - would only update the parts which were specified in the payload and leave the other parts of the thing (or feature, property etc.) JSON intact.
At the HTTP API this could be a POST for
merge
instead of a PUT (for modify).
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Or have a look at the
"Hello World"
Build and start Ditto locally
In order to build Ditto, you'll need
JDK 11 >= 11.0.5 and
Apache Maven 3.x installed.
In order to first build Ditto and then start the built Docker images.
1. Build Ditto with Maven
2. Build local Ditto Docker snapshot images
If your infrastructure requires a proxy, its host and port can be set using the
-p
option like for example:
Please note that the given host and port automatically applies for HTTP and HTTPS.
3. Start Ditto with local snapshot images
Check the logs after starting up:
You have now running:
a MongoDB as backing datastore of Ditto (not part of Ditto but started via Docker)
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
here for an overview of the available headers
.
The value of the
put-metadata
is a JSON array containing JSON objects with
"key"
and
"value"
parts:
"key"
: describes the hierarchical position in the Thing where the metadata should be placed
"value"
: is an arbitrary JSON value to set as metadata (could also be a nested JSON object)
Example for setting Metadata
Assume you modify your twin’s lamp color with a call:
You want to specify to set metadata which affects all the changed properties (
"r"
] [
Last Page
]
April 29, 2020
[ditto-dev] Release 1.1.0 of Eclipse Ditto
Posted 05:36 by Jaeckle Thomas (IOC/PAP-TH)
April 08, 2020
[ditto-dev] Eclipse Ditto community call
Posted 06:57 by Jaeckle Thomas (IOC/PAP-TH)
[ditto-dev] Eclipse Ditto community call
Posted 06:57 by Jaeckle Thomas (IOC/PAP-TH)
[ditto-dev] [GERMAN] Webinar about Eclipse Ditto
Posted 05:37 by Julian Feinauer
Mail converted by
MHonArc
Back to the top
Eclipse Foundation
1.1.1
1.1.0
1.0.0
0.9.0
0.8.0
Milestone releases
1.0.0-M2
1.0.0-M1a
0.9.0-M2
0.9.0-M1
0.8.0-M3
0.8.0-M2
0.8.0-M1
0.3.0-M2
0.3.0-M1
0.2.0-M1
0.1.0-M3
0.1.0-M1
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
Newcomer Forum
More
Community
Marketplace
Events
List Home
]
[ditto-dev] Seeking guidance re: Ditto, Hono, and Cloud2edge package
From
: Robinson Montalvo <
rmontalvo@xxxxxxxxxxxxxxxxx
>
Date
: Sun, 25 Oct 2020 06:39:19 -0400
Delivered-to
:
ditto-dev@xxxxxxxxxxx
List-archive
: <
https://www.eclipse.org/mailman/private/ditto-dev
>
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
First Page
] [
Prev Page
][Next Page] [
Last Page
]
2020
October
April
January
2019
December
November
July
May
April
2018
November
Copyright Agent
Eclipse Public License
Legal Resources
Useful Links
Report a Bug
Documentation
How to Contribute
Mailing Lists
Forums
Marketplace
Other
IDE and Tools
Community of Projects
Working Groups
Research@Eclipse
Report a Vulnerability
Service Status
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
That would be easier to use than a JSON Patch or than specifying multiple path/value entries.
What do you think?
Copy link
Contributor
BobClaerhout
commented
Dec 16, 2019
Hi all,
It looks like we are in need of this feature as well. Any updates on this?
Personally I'm in favor for the new verb in the Ditto Protocol and
merge
seems like a perfect one!
Copy link
Ditto microservices:
Policies
Things
Things-Search
Gateway
Connectivity
Concierge
an nginx acting as a reverse proxy performing a simple "basic authentication" listening on port
8080
including some static HTTP + API documentation on
http://localhost:8080
About
Eclipse Ditto Project
eclipse.org/ditto/
Topics
eclipseiot
iot
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
,
"g"
and
"b"
) plus some extra metadata to only set for the
"r"
property.
The content of the
put-metadata
in order to do that would look like this:
The resulting Thing JSON including its
_metadata
would look like this:
Setting Metadata to all affected JSON leaves
A special syntax for the key is
About Us
Contact Us
Donate
Governance
Logo and Artwork
Board of Directors
Legal
Privacy Policy
Terms of Use
Copyright Agent
Eclipse Public License
Legal Resources
Useful Links
Report a Bug
Documentation
Installation
Building Ditto
Running Ditto
Operating Ditto
Basic concepts
Overview
Model entities
Thing
Access Control List (ACL)
Feature
Policy
Namespaces and Names
Thing Metadata
Errors
Authentication and Authorization
Messages
Signals
Actions · eclipse/ditto · GitHub
Planet Eclipse
Newsletter
Videos
Blogs
Participate
Report a Bug
Forums
Mailing Lists
Wiki
IRC
Research
Eclipse IDE
Download
Learn More
Documentation
Getting Started / Support
How to Contribute
IDE and Tools
List-help
: <
mailto:ditto-dev-request@eclipse.org?subject=help
>
List-subscribe
: <
https://www.eclipse.org/mailman/listinfo/ditto-dev
>, <
mailto:ditto-dev-request@eclipse.org?subject=subscribe
>
List-unsubscribe
: <
https://www.eclipse.org/mailman/options/ditto-dev
>, <
mailto:ditto-dev-request@eclipse.org?subject=unsubscribe
>
Dear Ditto community,
I attempted to follow the instructions for installing the Cloud2edge package (@
September
July
May
2017
November
October
April
Mail converted by
MHonArc
Back to the top
Eclipse Foundation
About Us
Contact Us
Donate
Governance
Logo and Artwork
Board of Directors
Legal
Copyright © Eclipse Foundation, Inc. All Rights Reserved.
Back to the top
Contributor
thjaeckle
commented
Dec 16, 2019
The feature definitely will be coming, it's "just" a question about prioritization and resources ;)
So I can't really say when this issue will be done.
Currently I don't see it in Ditto 1.1.0, if you want to start contributing on it, we could definitely support when problems arise :)
On a conceptual level it is quite clear how to add this to Ditto and there should be no major "roadblocks" when implementing.
For the implementation I see 2 options:
either copy all
Modify*
command (maybe also event) classes to their
Merge*
counterpart classes
e.g.:
ModifyThing
->copy->
internet-of-things
digital-twin
Resources
Readme
License
EPL-2.0 License
Releases
29
1.3.0
Latest
Sep 30, 2020
+ 28 releases
Packages
0
No packages published
Contributors
28
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
which means that all affected JSON leaves of the modify operation will get the Metadata key
{key}
with the given value. So if, for example, only the affected JSON leaves should get the timestamp where the changed values were recorded, one would set the
put-metadata
header as shown in the following example:
Reading Metadata information
Metadata of a Thing can be retrieved is by querying a full thing, e.g. via the
HTTP API
, and specifying an (additional)
field selector
_metadata
, e.g.:
?fields=thingId,attributes,_metadata
.
Example for reading Metadata
For example a
GET
request to
How to Contribute
Mailing Lists
Forums
Marketplace
Other
IDE and Tools
Community of Projects
Working Groups
Research@Eclipse
Report a Vulnerability
Service Status
Copyright © Eclipse Foundation, Inc. All Rights Reserved.
Back to the top
Signal types
Command
Command response
Error response
Event
APIs
Connections
Placeholders
Change notifications
RQL expressions
Signal enrichment
Search
Acknowledgements / QoS
Architecture
Overview
Services
Policies
Things
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Newcomer Forum
Search
Toggle navigation
Breadcrumbs
Home
Contribute
Source code
ditto-dev Archive (Thread View - Most Recent First)
Main Index
[
First Page
] [Prev Page][Next Page] [
Last Page
]
[ditto-dev] Seeking guidance re: Ditto, Hono, and Cloud2edge package
,
Robinson Montalvo
https://www.eclipse.org/packages/packages/cloud2edge/installation/
) on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Thank you very much in advance,
Rob
Prev by Date:
[ditto-dev] Release 1.1.0 of Eclipse Ditto
Previous by thread:
[ditto-dev] Release 1.1.0 of Eclipse Ditto
Index(es):
Date
Thread
Privacy Policy
Terms of Use
Copyright Agent
Eclipse Public License
Legal Resources
Useful Links
Report a Bug
Documentation
How to Contribute
Mailing Lists
Forums
Marketplace
Other
IDE and Tools
Community of Projects
Working Groups
Research@Eclipse
Report a Vulnerability
MergeThing
add separate persistence strategies as well in
org.eclipse.ditto.services.things.persistence.actors.strategies.commands.ThingCommandStrategies
add separate concierge enforcements
this would be very many changes towards LoC, duplicated unit tests, etc.
or: make
Modify*
command (maybe also the event) classes aware of whether "replace" or "merge" semantics should be applied
also persistence strategies must make use of that differentiation
concierge enforcement should not be affected
I prefer the second one but am not yet sure if this will work everywhere.
thjaeckle
added this to the
1.2.0
milestone
Apr 30, 2020
Copy link
+ 17 contributors
Languages
Java
99.4%
Scala
0.2%
CSS
0.2%
HTML
0.1%
JavaScript
0.1%
Shell
0.0%
© 2020 GitHub, Inc.
Terms
Privacy
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
will yield the Metadata stored for the given Thing, in the following format:
Tags:
model
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
> License
> Report a Vulnerability
Things-Search
Connectivity
Concierge
Gateway
HTTP API
Overview
Concepts
Search
Messages
WebSocket protocol binding
Server sent events
Connectivity API
Overview
Manage connections
AMQP 0.9.1 protocol binding
AMQP 1.0 protocol binding
MQTT 3.1.1 protocol binding
MQTT 5 protocol binding
The Eclipse Ditto Open Source Project on Open Hub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
[ditto-dev] Release 1.1.0 of Eclipse Ditto
,
Jaeckle Thomas (IOC/PAP-TH)
[ditto-dev] [GERMAN] Webinar about Eclipse Ditto
,
Julian Feinauer
[ditto-dev] Support for MQTT in ditto-client
,
Julian Feinauer
Re: [ditto-dev] Support for MQTT in ditto-client
,
Jaeckle Thomas (INST/ECS1)
<Possible follow-ups>
Re: [ditto-dev] Support for MQTT in ditto-client
,
Julian Feinauer
[ditto-dev] Small Example of a digital twin of a Siemens S7 using PLC4X and Ditto
,
Back to the top
Eclipse Foundation
About Us
Contact Us
Donate
Governance
Logo and Artwork
Board of Directors
Legal
Privacy Policy
Terms of Use
Copyright Agent
Eclipse Public License
Legal Resources
Service Status
Copyright © Eclipse Foundation, Inc. All Rights Reserved.
Back to the top
Contributor
thjaeckle
commented
Apr 30, 2020
•
edited
Currently planned for Ditto 1.4.0
thjaeckle
removed this from the
1.2.0
milestone
Aug 7, 2020
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Maven Central Repository Search
Sorry, your browser does not support JavaScript!
HTTP 1.1 protocol binding
Kafka 2.x protocol binding
Payload mapping
Header mapping
TLS certificates
Client SDK
Overview
Java
JavaScript
Ditto Protocol
Overview
Twin/live channel
Specification
Protocol topic
Things group
→ commands/events
Create/Modify
Retrieve
openhub.net
Black Duck Software, Inc.
Black Duck Open Hub
Follow @
OH
Sign In
Join Now
Projects
People
Organizations
Tools
Blog
Projects
People
Projects
Organizations
Forums
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Julian Feinauer
Re: [ditto-dev] Small Example of a digital twin of a Siemens S7 using PLC4X and Ditto
,
Jaeckle Thomas (INST/ECS1)
Re: [ditto-dev] Small Example of a digital twin of a Siemens S7 using PLC4X and Ditto
,
Julian Feinauer
Re: [ditto-dev] Small Example of a digital twin of a Siemens S7 using PLC4X and Ditto
,
Jaeckle Thomas (INST/ECS1)
Re: [ditto-dev] Small Example of a digital twin of a Siemens S7 using PLC4X and Ditto
,
Julian Feinauer
[ditto-dev] Graduation and release 1.0.0 of Eclipse Ditto
,
Jaeckle Thomas (INST/ECS1)
Useful Links
Report a Bug
Documentation
How to Contribute
Mailing Lists
Forums
Marketplace
Other
IDE and Tools
Community of Projects
Working Groups
Research@Eclipse
Report a Vulnerability
Service Status
Copyright © Eclipse Foundation, Inc. All Rights Reserved.
Back to the top
thjaeckle
added this to the
1.4.0
milestone
Sep 28, 2020
thjaeckle
added the
community-interest
label
Sep 28, 2020
thjaeckle
removed this from the
1.4.0
milestone
Oct 23, 2020
Sign up for free
to join this conversation on GitHub
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Delete
Acknowledgements
Errors
→ search/messages
Search
Messages
Policies group
→ commands/events
Create/Modify
Retrieve
Delete
Bindings
Examples
→ Things examples
Create a Thing
Delete a Thing
Modify a Thing
Retrieve a Thing
Eclipse Ditto
Settings
|
Report Duplicate
1
I Use This!
×
Login Required
Log in to Open Hub
Remember Me
Very High Activity
Analyzed
about 6 hours
ago. based on code collected
about 7 hours
ago.
Project Summary
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
eclipse
/
ditto
Watch
36
Star
[ditto-dev] Eclipse Ditto community call
,
Jaeckle Thomas (INST/ECS1)
<Possible follow-ups>
[ditto-dev] Eclipse Ditto community call
,
Jaeckle Thomas (INST/ECS1)
[ditto-dev] Eclipse Ditto community call
,
Jaeckle Thomas (IOC/PAP-TH)
[ditto-dev] Eclipse Ditto community call
,
Jaeckle Thomas (IOC/PAP-TH)
[ditto-dev] Release announcement of Eclipse Ditto 0.9.0
,
Jaeckle Thomas (INST/ECS1)
[ditto-dev] PMC Approval required for Committer Election for Yannic Klem on Eclipse Ditto
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
community-interest
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
6 participants
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Retrieve multiple Things
Modify the Policy ID of a Thing
Create Attributes
Delete Attributes
Modify Attributes
Retrieve Attributes
Create a single Attribute
Delete a single Attribute
Modify a single Attribute
Retrieve a single Attribute
Create a Definition
Delete a Definition
Modify a Definition
Retrieve a Definition
Create Features
Delete Features
Modify Features
Tags
akka
cloud
digitaltwin
digital-twin
eclipse
eclipseiot
iot
java
mongodb
In a Nutshell, Eclipse Ditto...
...
has had
6,502 commits
made by
49 contributors
representing
208
Fork
70
Code
Issues
53
Pull requests
2
Actions
Projects
1
Security
Insights
More
Code
Issues
Pull requests
,
emo
[ditto-dev] Committer Election for Yannic Klem on Eclipse Ditto has started
,
emo
[ditto-dev] PMC Approval required for Committer Election for Stefan Maute on Eclipse Ditto
,
emo
[ditto-dev] Committer Election for Stefan Maute on Eclipse Ditto has started
,
emo
[ditto-dev] Logos of Ditto users on website
,
Jaeckle Thomas (INST/ECS1)
[ditto-dev] Release announcement of Eclipse Ditto 0.8.0
,
Jaeckle Thomas (INST/ECS1)
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Retrieve Features
Create a single Feature
Delete a single Feature
Modify a single Feature
Retrieve a single Feature
Create Feature Definition
Delete Feature Definition
Modify Feature Definition
Retrieve Feature Definition
Create Feature Properties
Delete Feature Properties
Modify Feature Properties
Retrieve Feature Properties
Create a single Property
Delete a single Property
Modify a single Property
Retrieve a single Property
346,712 lines of code
...
is
mostly written in Java
with
an average number of source code comments
...
has
a codebase with a long source history
maintained by
a very large development team
with
stable Y-O-Y commits
...
took an estimated
93 years of effort
(COCOMO model)
starting with its
Actions
Projects
Security
Insights
Workflows
All workflows
push-dockerhub
build
All workflows
push-dockerhub
build
build
Narrow your search
will be ignored since log searching is not yet available
Create status badge
Create status badge
Branch
[ditto-dev] Release Review for Ditto 0.8.0
,
Jaeckle Thomas (INST/ECS1)
[ditto-dev] CFP Deadline July 16 - All Things IoT @ EclipseCon Europe
,
Roxanne Joncas
[ditto-dev] PMC Approval required for Committer Election for Florian Fendt on Eclipse Ditto
,
emo
[ditto-dev] Committer Election for Florian Fendt on Eclipse Ditto has started
,
emo
[ditto-dev] Eclipse Ditto logo crowdsourcing
,
Jaeckle Thomas (INST/ECS1)
Re: [ditto-dev] Eclipse Ditto logo crowdsourcing
,
Jaeckle Thomas (INST/ECS1)
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Error responses
→ Policies examples
Create a Policy
Delete a Policy
Modify a Policy
Retrieve a Policy
Modify entries
Retrieve entries
Create a single entry
Delete a single entry
Modify a single entry
Retrieve a single entry
Modify subjects
Retrieve subjects
Create a single subject
Delete a single subject
Modify a single subject
Retrieve a single subject
first commit in April, 2017
ending with its
most recent commit 2 days
ago
Quick Reference
Project Links:
Homepage
Community
Documentation
Forums
Issue Trackers
Mailing Lists
Code Locations:
(2 Locations)
Similar Projects:
Managers:
Default branch
Find a branch
Event
Default
check_run
check_suite
create
delete
deployment_status
deployment
fork
gollum
issue_comment
issues
label
milestone
page_build
project_card
Re: [ditto-dev] Eclipse Ditto logo crowdsourcing
,
Glocker Gerald (INST/ECS1)
Welcome to ditto-dev
,
portal on behalf of emo
Mail converted by
MHonArc
Back to the top
Eclipse Foundation
About Us
Contact Us
Donate
Governance
Logo and Artwork
Board of Directors
Legal
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Modify resources
Retrieve resources
Create a single resource
Delete a single resource
Modify a single resource
Retrieve a single resource
Error responses
→ Search examples
Sandbox
Presentations
Glossary
Feedback
Collapse All
|
Expand All
Ditto documentation overview
What is it?
Thomas Jäckle
Licenses
Eclipse Public License 2.0
Permitted
Forbidden
Required
These details are provided for information only. No information here is legal advice and should not be used as such.
All Licenses
Project Security
Vulnerabilities per Version
( last 10 releases )
There are no reported vulnerabilities
Project Vulnerability Report
Security Confidence Index
Poor security track-record
Favorable security track-record
Vulnerability Exposure Index
project_column
project
public
pull_request_review_comment
pull_request_review
pull_request
push
registry_package
release
repository_dispatch
status
watch
workflow_dispatch
workflow_run
schedule
pull_request_target
![build](https://github.com/eclipse/ditto/workflows/build/badge.svg)
Privacy Policy
Terms of Use
Copyright Agent
Eclipse Public License
Legal Resources
Useful Links
Report a Bug
Documentation
How to Contribute
Mailing Lists
Forums
Marketplace
Other
IDE and Tools
Community of Projects
Working Groups
Eclipse Ditto is a technology in the
IoT
implementing a software pattern called “
digital twins
”.
A digital twin is a virtual, cloud based, representation of his real world counterpart (real world “Things”, e.g. devices like sensors, smart heating, connected cars, smart grids, EV charging stations, …).
The technology mirrors potentially millions and billions of digital twins residing in the digital world with physical “
Things
”. This simplifies developing IoT solutions for software developers as they do not need to know how or where exactly the physical “Things” are connected.
With Ditto a thing can just be used as any other web service via its digital twin.
What is it not?
Ditto is not another fully-fledged IoT platform. It does not provide software running on IoT gateways and it does not define or implement an IoT protocol in order to communicate with devices.
Its focus lies on back end scenarios by providing web APIs in order to simplify working with already connected (e.g. via
Eclipse Hono
) devices and “Things” from customer apps or other back end software.
It also does not specify which data or which structure a “Thing” in the IoT has to provide.
When to use it?
Many reported vulnerabilities
Few reported vulnerabilities
About Project Vulnerability Report
Did You Know...
...
65% of companies leverage OSS to speed application development in 2016
...
search
using multiple tags to find exactly what you need
...
55% of companies leverage OSS for production infrastructure
...
data presented on the Open Hub is available through our
API
About Project Security
Code
Lines of Code
Activity
Copy status badge Markdown
703 results
703 results
Event
Filter by event
Status
Filter by status
Branch
Filter by branch
Actor
Filter by actor
Bugfix/amqp publisher mailbox overflow
build
#703:
Pull request
Research@Eclipse
Report a Vulnerability
Service Status
Copyright © Eclipse Foundation, Inc. All Rights Reserved.
Back to the top
TL;DR
Use it in order to get a fully-fledged, authorization aware API (HTTP, WebSocket and other messaging protocols) for interacting with your digital twins and all aspects around them.
Imagine you are building an IoT solution. And let’s assume that you use both hardware (e.g. sensors or actuators) and software (e.g. a mobile or web app) in order to solve your customer’s problem.
In such a scenario you have several places where to implement software:
on or near the hardware, e.g. on an Arduino using
C/C++
or on an Raspberry PI using
Python
,
optionally on a gateway establishing the Internet connectivity (e.g. based on
Eclipse Kura
),
in the mobile or web app using
Java
,
Javascript
,
Swift
Commits per Month
Community
Contributors per Month
Languages
Java
94%
7 Other
6%
30 Day Summary
Sep 25 2020 — Oct 25 2020
211
Commits
12
Contributors
including
3 new contributors
12 Month Summary
#853
synchronize by
yufei-cai
Oct 25, 2020
22m 12s
bosch-io:bugfix/amqp-publisher-mailbox-overflow
bosch-io:bugfix/amqp-publisher-mailbox-overflow
Oct 25, 2020
22m 12s
View #853
View workflow file
Bugfix/amqp publisher mailbox overflow
build
#702:
Pull request
#853
synchronize by
yufei-cai
Hello world • Eclipse Ditto • a digital twin framework
etc.,
in the “back end” fulfilling several responsibilities like
providing an API abstracting from the hardware,
routing requests between hardware and customer apps,
ensuring only authorized access,
persisting last reported state of hardware as cache and for providing the data when hardware is currently not connected,
notifying interested parties (e.g. other back end services) about changes,
…
Ditto focuses on solving the responsibilities a typical “back end” has in such scenarios.
Its goal is to free IoT solutions from the need of implementing and operating a custom back end. Instead by using Eclipse Ditto they can focus on business requirements, on connecting devices to the cloud/back end and on implementing business applications.
Tags:
getting_started
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
Oct 25 2019 — Oct 25 2020
2353
Commits
Up
+ 466 (24%)
from previous 12 months
33
Contributors
Up
+ 13 (65%)
from previous 12 months
Most Recent Contributors
Thomas Jäckle
tobias
Stefan Maute
Yufei Cai
Yannic Klem
Tobias Månsson
Oct 25, 2020
23m 58s
bosch-io:bugfix/amqp-publisher-mailbox-overflow
bosch-io:bugfix/amqp-publisher-mailbox-overflow
Oct 25, 2020
23m 58s
View #853
View workflow file
Bugfix/amqp publisher mailbox overflow
build
#701:
Pull request
#853
synchronize by
jbartelh
Oct 23, 2020
23m 16s
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
Eclipse Ditto version:
development
> License
> Report a Vulnerability
Ratings
1 user rates this project:
5.0
5.0/5.0
Click to add your rating
Review this Project!
Project Summary
News
Settings
Sharing Widgets
Related Projects
Code Data
Languages
Cost Estimates
Security
SCM Data
bosch-io:bugfix/amqp-publisher-mailbox-overflow
bosch-io:bugfix/amqp-publisher-mailbox-overflow
Oct 23, 2020
23m 16s
View #853
View workflow file
Bugfix/amqp publisher mailbox overflow
build
#700:
Pull request
#853
opened by
jbartelh
Oct 23, 2020
17m 58s
bosch-io:bugfix/amqp-publisher-mailbox-overflow
bosch-io:bugfix/amqp-publisher-mailbox-overflow
1.0
1.1
1.2
1.3
Important:
This documentation reflects the latest 'development'. You might want to choose a released version.
Introduction
Overview
Digital twins
Hello world
Release Notes
1.3.0
1.2.1
1.2.0
1.1.5
1.1.3
1.1.2
1.1.1
eclipse/ditto - Gitter
Commits
Contributors
Community Data
Users
Ratings & Reviews
User & Contributor Locations
ABOUT SYNOPSYS
Application Security Testing
Software Security Services
Program Development
Training
ABOUT OPEN HUB
Forums
Terms
Privacy
Open Hub UI Source Code
Contact Us
Oct 23, 2020
17m 58s
View #853
View workflow file
build
build
#699:
by
Yannic92
Oct 23, 2020
25m 9s
master
master
Oct 23, 2020
1.1.0
1.0.0
0.9.0
0.8.0
Milestone releases
1.0.0-M2
1.0.0-M1a
0.9.0-M2
0.9.0-M1
0.8.0-M3
0.8.0-M2
0.8.0-M1
0.3.0-M2
0.3.0-M1
0.2.0-M1
0.1.0-M3
0.1.0-M1
Installation
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
©
2020
Synopsys, Inc.
All Rights Reserved.
This site uses cookies to give you the best possible experience. By using the site, you consent to our use of cookies. For more information, please see our
Privacy Policy
Agree
25m 9s
View workflow file
Declare unique ack labels
build
#698:
Pull request
#851
synchronize by
thjaeckle
Oct 23, 2020
23m 59s
bosch-io:feature/declared-acks
bosch-io:feature/declared-acks
Oct 23, 2020
23m 59s
View #851
View workflow file
Building Ditto
Running Ditto
Operating Ditto
Basic concepts
Overview
Model entities
Thing
Access Control List (ACL)
Feature
Policy
Namespaces and Names
Thing Metadata
Errors
Authentication and Authorization
Messages
Signals
Signal types
Command
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
Declare unique ack labels
build
#697:
Pull request
#851
synchronize by
Yannic92
Oct 23, 2020
25m 34s
bosch-io:feature/declared-acks
bosch-io:feature/declared-acks
Oct 23, 2020
25m 34s
View #851
View workflow file
Declare unique ack labels
Command response
Error response
Event
APIs
Connections
Placeholders
Change notifications
RQL expressions
Signal enrichment
Search
Acknowledgements / QoS
Architecture
Overview
Services
Policies
Things
Things-Search
Connectivity
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
build
#696:
Pull request
#851
synchronize by
Yannic92
Oct 23, 2020
10m 13s
bosch-io:feature/declared-acks
bosch-io:feature/declared-acks
Oct 23, 2020
10m 13s
View #851
View workflow file
Merge pull request #848 from bosch-io/bugfix/844-location-header fixes #844: "location" header was not read when provided by external headers
build
Concierge
Gateway
HTTP API
Overview
Concepts
Search
Messages
WebSocket protocol binding
Server sent events
Connectivity API
Overview
Manage connections
AMQP 0.9.1 protocol binding
AMQP 1.0 protocol binding
MQTT 3.1.1 protocol binding
MQTT 5 protocol binding
HTTP 1.1 protocol binding
Kafka 2.x protocol binding
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
#695:
Commit
edbcd38
pushed by
Yannic92
Oct 23, 2020
22m 35s
master
master
Oct 23, 2020
22m 35s
View workflow file
Declare unique ack labels
build
#694:
Pull request
#851
Payload mapping
Header mapping
TLS certificates
Client SDK
Overview
Java
JavaScript
Ditto Protocol
Overview
Twin/live channel
Specification
Protocol topic
Things group
→ commands/events
Create/Modify
Retrieve
Delete
Acknowledgements
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
synchronize by
Yannic92
Oct 23, 2020
10m 9s
bosch-io:feature/declared-acks
bosch-io:feature/declared-acks
Oct 23, 2020
10m 9s
View #851
View workflow file
Merge pull request #846 from bosch-io/bugfix/timer Fix recording of timer duration above 1s
build
#693:
Commit
687268d
pushed by
Errors
→ search/messages
Search
Messages
Policies group
→ commands/events
Create/Modify
Retrieve
Delete
Bindings
Examples
→ Things examples
Create a Thing
Delete a Thing
Modify a Thing
Retrieve a Thing
Retrieve multiple Things
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
Yannic92
Oct 23, 2020
22m 57s
master
master
Oct 23, 2020
22m 57s
View workflow file
Merge pull request #850 from bosch-io/bugfix/response-required-for-events-and-responses Bugfix/response required for events and responses
build
#692:
Commit
Modify the Policy ID of a Thing
Create Attributes
Delete Attributes
Modify Attributes
Retrieve Attributes
Create a single Attribute
Delete a single Attribute
Modify a single Attribute
Retrieve a single Attribute
Create a Definition
Delete a Definition
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
8fc8f84
pushed by
yufei-cai
Oct 22, 2020
23m 14s
master
master
Oct 22, 2020
23m 14s
View workflow file
fixes #844: "location" header was not read when provided by external headers
build
#691:
Pull request
#848
synchronize by
thjaeckle
Modify a Definition
Retrieve a Definition
Create Features
Delete Features
Modify Features
Retrieve Features
Create a single Feature
Delete a single Feature
Modify a single Feature
Retrieve a single Feature
Create Feature Definition
Delete Feature Definition
Modify Feature Definition
Retrieve Feature Definition
Create Feature Properties
Delete Feature Properties
Modify Feature Properties
Retrieve Feature Properties
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
Oct 22, 2020
23m 28s
bosch-io:bugfix/844-location-header
bosch-io:bugfix/844-location-header
Oct 22, 2020
23m 28s
View #848
View workflow file
Fix recording of timer duration above 1s
build
#690:
Pull request
#846
synchronize by
yufei-cai
Oct 22, 2020
Create a single Property
Delete a single Property
Modify a single Property
Retrieve a single Property
Error responses
→ Policies examples
Create a Policy
Delete a Policy
Modify a Policy
Retrieve a Policy
Modify entries
Retrieve entries
Create a single entry
Delete a single entry
Modify a single entry
Retrieve a single entry
Modify subjects
Retrieve subjects
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
eclipse/ditto - Gitter
22m 26s
bosch-io:bugfix/timer
bosch-io:bugfix/timer
Oct 22, 2020
22m 26s
View #846
View workflow file
Fix recording of timer duration above 1s
build
#689:
Pull request
#846
synchronize by
yufei-cai
Create a single subject
Delete a single subject
Modify a single subject
Retrieve a single subject
Modify resources
Retrieve resources
Create a single resource
Delete a single resource
Modify a single resource
Retrieve a single resource
Error responses
→ Search examples
Sandbox
Presentations
Glossary
Feedback
Collapse All
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
Oct 22, 2020
6m 51s
bosch-io:bugfix/timer
bosch-io:bugfix/timer
Oct 22, 2020
6m 51s
View #846
View workflow file
Merge pull request #849 from bosch-io/feature/oauth-protocol Make protocol of OAuth providers configurable.
build
#688:
Commit
c14a5aa
pushed by
stmaute
Oct 22, 2020
22m 2s
|
Expand All
Hello world
After
starting Ditto
, we have a HTTP and WebSocket API for your
digital twins
at our hands.
Example
Assume we want to create a digital twin for a car. The twin should hold static metadata and dynamic state data. The state data should change as often as its real world counterpart does.
Those static and dynamic types of data are mapped in the Ditto model to “attributes” (for static metadata), “features” (for dynamic state data) and “definition” (to link a model the thing follows, e.g. an
Eclipse Vorto
“information model”). A JSON representation of some metadata and state data could for example look like this:
Background: Ditto only knows about “attributes”, “features” and the “definition”.
Inside “attributes” (the metadata) we can add as much JSON keys as we like with any JSON value we need.
Inside “features” (the state data) we can add as much features as we like - but each feature needs to have a “properties” JSON object. Inside that JSON object we can add as much JSON keys as we like with any JSON value we need.
Inside “definition” we can add one JSON string value.
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
MQTT 3.1.1 protocol binding • Eclipse Ditto • a digital twin framework
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
ditto/ditto-akka-config.conf at master · eclipse/ditto · GitHub
master
master
Oct 22, 2020
22m 2s
View workflow file
Bugfix/response required for events and responses
build
#687:
Pull request
#850
opened by
Yannic92
Oct 22, 2020
23m 1s
bosch-io:bugfix/response-required-for-events-and-responses
bosch-io:bugfix/response-required-for-events-and-responses
Oct 22, 2020
Creating your first Thing
We create a Thing for the example from above by using
cURL
. Basic authentication will use the credentials of a user “ditto”. Those credentials have been created by default in the
nginx
started via “docker”. (See
ditto/deployment/docker/README.md
)
The result is a digital twin in Thing notation. The Thing ID is
org.eclipse.ditto:fancy-car
. An ID must always contain a namespace before the
:
. That way Things are easier to organize.
Querying an existing Thing
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
eclipse/ditto - Gitter
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
Eclipse Ditto version:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
Running Ditto • Eclipse Ditto • a digital twin framework
sheldonTest
@sheldonTest
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
23m 1s
View #850
View workflow file
Make protocol of OAuth providers configurable.
build
#686:
Pull request
#849
opened by
yufei-cai
Oct 21, 2020
23m 49s
bosch-io:feature/oauth-protocol
bosch-io:feature/oauth-protocol
Oct 21, 2020
By creating the digital twin as a Thing with the specified JSON format, Ditto implicitly provides an API for our Thing.
For Things we know the ID of, we can simply query them by their ID:
Querying one specific state value
The created API for our Thing also provides HTTP endpoints for each attribute and feature property.
That way we can for example just retrieve the
cur_speed
of our fancy car:
Updating one specific state value
We can just as easy use the HTTP API to update one attribute or feature property, e.g. update the
cur_speed
to
77
:
Searching for all Things
When we lost the overview which Things we have already created, we can use the
eclipse/ditto - Gitter
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
eclipse/ditto - Gitter
Building Ditto • Eclipse Ditto • a digital twin framework
development
1.0
1.1
1.2
1.3
Important:
This documentation reflects the latest 'development'. You might want to choose a released version.
Introduction
Overview
Digital twins
Hello world
Release Notes
1.3.0
1.2.1
1.2.0
1.1.5
1.1.3
1.1.2
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
eclipse/ditto - Gitter
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
Eclipse Ditto version:
development
1.0
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
eclipse/ditto - Gitter
23m 49s
View #849
View workflow file
fixes #844: "location" header was not read when provided by external headers
build
#685:
Pull request
#848
opened by
thjaeckle
Oct 21, 2020
22m 52s
bosch-io:bugfix/844-location-header
bosch-io:bugfix/844-location-header
Oct 21, 2020
22m 52s
View #848
eclipse/ditto - Gitter
search
HTTP endpoint, e.g. searching all Things with the same
manufacturer
named
"ACME"
:
Tags:
getting_started
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
> License
> Report a Vulnerability
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
eclipse/ditto - Gitter
Policy • Eclipse Ditto • a digital twin framework
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
Eclipse Ditto version:
development
1.0
1.1.1
1.1.0
1.0.0
0.9.0
0.8.0
Milestone releases
1.0.0-M2
1.0.0-M1a
0.9.0-M2
0.9.0-M1
0.8.0-M3
0.8.0-M2
0.8.0-M1
0.3.0-M2
0.3.0-M1
0.2.0-M1
0.1.0-M3
0.1.0-M1
eclipse/ditto - Gitter
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
eclipse/ditto - Gitter
Payload mapping in connectivity service • Eclipse Ditto • a digital twin framework
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
1.1
1.2
1.3
Important:
This documentation reflects the latest 'development'. You might want to choose a released version.
Introduction
Overview
Digital twins
Hello world
Release Notes
1.3.0
1.2.1
1.2.0
1.1.5
1.1.3
1.1.2
1.1.1
1.1.0
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
View workflow file
Merge pull request #847 from bosch-io/bugfix/header-reset Test header resetting in Ack.Agg.Actor and fix it.
build
#684:
Commit
8bdf2b7
pushed by
thjaeckle
Oct 21, 2020
20m 58s
master
master
Oct 21, 2020
20m 58s
View workflow file
Test header resetting in Ack.Agg.Actor and fix it.
build
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
eclipse/ditto - Gitter
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
eclipse/ditto - Gitter
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
Eclipse Ditto version:
development
eclipse/ditto - Gitter
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
[epic] Distinguish between reported and desired state in twins · Issue #696 · eclipse/ditto · GitHub
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
1.1
1.2
1.3
Important:
This documentation reflects the latest 'development'. You might want to choose a released version.
Introduction
Overview
Digital twins
Hello world
Release Notes
1.3.0
1.2.1
1.2.0
1.1.5
1.1.3
1.1.2
1.1.1
1.1.0
Installation
Building Ditto
Running Ditto
Operating Ditto
Basic concepts
Overview
Model entities
Thing
Access Control List (ACL)
Feature
Policy
Namespaces and Names
Thing Metadata
Errors
Authentication and Authorization
Messages
Signals
Signal types
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
{ "@context": "http://schema.org", "@type": "Organization", "url": "https://eclipse.org/ditto/", "logo": "https://eclipse.org/ditto/images/ditto.svg" }
Toggle navigation
Blog
Documentation
HTTP API
Sandbox
GitHub
GitHub examples
Links
Eclipse Ditto Project
Forum
Jenkins
Mailing list archives
Gitter.im chat
Eclipse Ditto version:
development
1.0
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
1.0.0
0.9.0
0.8.0
Milestone releases
1.0.0-M2
1.0.0-M1a
0.9.0-M2
0.9.0-M1
0.8.0-M3
0.8.0-M2
0.8.0-M1
0.3.0-M2
0.3.0-M1
0.2.0-M1
0.1.0-M3
0.1.0-M1
Installation
Building Ditto
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
#683:
Pull request
#847
opened by
Yannic92
Oct 21, 2020
23m 46s
bosch-io:bugfix/header-reset
bosch-io:bugfix/header-reset
Oct 21, 2020
23m 46s
View #847
View workflow file
updated slide with todays GH stars
build
#682:
Commit
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
eclipse/ditto - Gitter
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
OIDC integration should support arbitrary claims for authorization subjects · Issue #512 · eclipse/ditto · GitHub
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
1.0
1.1
1.2
1.3
Important:
This documentation reflects the latest 'development'. You might want to choose a released version.
Introduction
Overview
Digital twins
Hello world
Release Notes
1.3.0
1.2.1
1.2.0
1.1.5
1.1.3
1.1.2
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
1.0.0
0.9.0
0.8.0
Milestone releases
1.0.0-M2
1.0.0-M1a
0.9.0-M2
0.9.0-M1
0.8.0-M3
0.8.0-M2
0.8.0-M1
0.3.0-M2
0.3.0-M1
0.2.0-M1
0.1.0-M3
0.1.0-M1
Command
Command response
Error response
Event
APIs
Connections
Placeholders
Change notifications
RQL expressions
Signal enrichment
Search
Acknowledgements / QoS
Architecture
Overview
Services
Policies
Things
Michael van Niekerk
@mvniekerk
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
1.1
1.2
1.3
Important:
This documentation reflects the latest 'development'. You might want to choose a released version.
Introduction
Overview
Digital twins
Hello world
Release Notes
1.3.0
1.2.1
1.2.0
1.1.5
1.1.3
1.1.2
1.1.1
1.1.0
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
Running Ditto
Operating Ditto
Basic concepts
Overview
Model entities
Thing
Access Control List (ACL)
Feature
Policy
Namespaces and Names
Thing Metadata
Errors
Authentication and Authorization
Messages
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Sign up
eclipse
/
ditto
Watch
36
Star
208
Fork
70
Code
Issues
53
Pull requests
2
Actions
Projects
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
f954ed2
pushed by
thjaeckle
Oct 19, 2020
21m 12s
master
master
Oct 19, 2020
21m 12s
View workflow file
Fix recording of timer duration above 1s
build
#681:
Pull request
#846
opened by
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
Where communities thrive
Join over
1.5M+ people
Join over
100K+ communities
Free
without limits
Create
your own community
Explore more communities
eclipse/ditto
Eclipse Ditto - Digital Twins for Eclipse IoT
People
Repo info
Activity
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Activity
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
_
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
1.1.1
1.1.0
1.0.0
0.9.0
0.8.0
Milestone releases
1.0.0-M2
1.0.0-M1a
0.9.0-M2
0.9.0-M1
0.8.0-M3
0.8.0-M2
0.8.0-M1
0.3.0-M2
0.3.0-M1
0.2.0-M1
0.1.0-M3
0.1.0-M1
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Installation
Building Ditto
Running Ditto
Operating Ditto
Basic concepts
Overview
Model entities
Thing
Access Control List (ACL)
Feature
Policy
Namespaces and Names
Thing Metadata
Errors
Authentication and Authorization
Messages
Signals
Things-Search
Connectivity
Concierge
Gateway
HTTP API
Overview
Concepts
Search
Messages
WebSocket protocol binding
Server sent events
Connectivity API
Overview
Manage connections
AMQP 0.9.1 protocol binding
AMQP 1.0 protocol binding
MQTT 3.1.1 protocol binding
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
_
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
1.0.0
0.9.0
0.8.0
Milestone releases
1.0.0-M2
1.0.0-M1a
0.9.0-M2
0.9.0-M1
0.8.0-M3
0.8.0-M2
0.8.0-M1
0.3.0-M2
0.3.0-M1
0.2.0-M1
0.1.0-M3
0.1.0-M1
Installation
Building Ditto
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
Signals
Signal types
Command
Command response
Error response
Event
APIs
Connections
Placeholders
Change notifications
RQL expressions
Signal enrichment
Search
Acknowledgements / QoS
Architecture
Overview
Services
Policies
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
1
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yufei-cai
Oct 18, 2020
22m 32s
bosch-io:bugfix/timer
bosch-io:bugfix/timer
Oct 18, 2020
22m 32s
View #846
View workflow file
Merge pull request #843 from bosch-io/doc/sso-doc added some documentation about SSO with OpenID connect in the browser
build
#680:
Commit
afb0338
pushed by
thjaeckle
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Thomas Jaeckle
@thjaeckle
hi Alex - we already had the same idea, e.g. storing the
measurementUnit
of a Vorto property as metadata in order to "know" during runtime that e.g. a value is actually a Temperature in Celcius
The datatype would probably also be useful to add as metadata, the min/max constraints could also be ..
So this is totally valid idea
We even thought about that Ditto coud some day translate e.g. a "Celsius" temperature to a "Fahrenheit" temperature - that e.g. the user of the API asks for the "fahrenheit" value of a certain property and Ditto does some internal conversion
Alexander Wellbrock
@lionax_gitlab
I'm excited to hear that ;)
Thomas Jaeckle
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
Alexander Wellbrock
@lionax_gitlab
Hey there again, it's been a while! While playing around with the new _metadata field and trying to apply it to our use-cases I may have hit a rather 'wild' idea I'd like to discuss with you in short before actually taking it seriously ;)
We are using Vorto in conjunction with ditto which basically means that we host our model / schema / metadata in a different place than our actual data. This has a rather annoying implication that each and every time we process data in e.g. a frontend or another micro-service and we want to make assumptions about the structure of the data we pull in Models from Vorto. We basically manage two client libraries and have a lot of repetition here. At the clients we can either merge the model and the data to create a unified object or we implement it that way that you always consult the model before actually accessing the data. With the new _metadata concept coming around I had to think about, what if ditto had a concept of prototypes in that I bring my model from outside e.g. from vorto like it is now but I can actually attach model information and metadata to each thing. It's just a bit like prototypes in e.g. JavaScript. I'm currently experimenting, if simply using the _metadata feature is sufficient or rather enough for that idea.
Any thoughts on that?
Thomas Jaeckle
@thjaeckle
hi Alex - we already had the same idea, e.g. storing the
measurementUnit
of a Vorto property as metadata in order to "know" during runtime that e.g. a value is actually a Temperature in Celcius
The datatype would probably also be useful to add as metadata, the min/max constraints could also be ..
So this is totally valid idea
We even thought about that Ditto coud some day translate e.g. a "Celsius" temperature to a "Fahrenheit" temperature - that e.g. the user of the API asks for the "fahrenheit" value of a certain property and Ditto does some internal conversion
Alexander Wellbrock
@lionax_gitlab
I'm excited to hear that ;)
Thomas Jaeckle
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Installation
Building Ditto
Running Ditto
Operating Ditto
Basic concepts
Overview
Model entities
Thing
Access Control List (ACL)
Feature
Policy
Namespaces and Names
Thing Metadata
Errors
Authentication and Authorization
Messages
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
Signal types
Command
Command response
Error response
Event
APIs
Connections
Placeholders
Change notifications
RQL expressions
Signal enrichment
Search
Acknowledgements / QoS
Architecture
Overview
Services
Policies
Things
MQTT 5 protocol binding
HTTP 1.1 protocol binding
Kafka 2.x protocol binding
Payload mapping
Header mapping
TLS certificates
Client SDK
Overview
Java
JavaScript
Ditto Protocol
Overview
Twin/live channel
Specification
Protocol topic
Things group
→ commands/events
Create/Modify
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Running Ditto
Operating Ditto
Basic concepts
Overview
Model entities
Thing
Access Control List (ACL)
Feature
Policy
Namespaces and Names
Thing Metadata
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
Things
Things-Search
Connectivity
Concierge
Gateway
HTTP API
Overview
Concepts
Search
Messages
WebSocket protocol binding
Server sent events
Connectivity API
Overview
Manage connections
AMQP 0.9.1 protocol binding
AMQP 1.0 protocol binding
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
_
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
_
Thomas Jaeckle
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
ditto
/
services
/
utils
/
config
/
src
/
main
/
resources
/
ditto-akka-config.conf
Go to file
Go to file
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
Oct 16, 2020
24m 7s
master
master
Oct 16, 2020
24m 7s
View workflow file
added some documentation about SSO with OpenID connect in the browser
build
#679:
Pull request
#843
opened by
thjaeckle
Oct 15, 2020
23m 8s
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
:clap:
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
the http header to set is
put-metadata
as mentioned above in the chat
Julian
@JulianFeinauer
@lionax_gitlab
I am working on the documentation
Thomas Jaeckle
@thjaeckle
didn't expect that feature to have so much fans so quickly ..
Julian
@JulianFeinauer
My first PR is such a success (well, its not really my first and in fact, it wasnt my code when you were finished BUT nonetheless) :D
Thomas Jaeckle
@thjaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
Signals
Signal types
Command
Command response
Error response
Event
APIs
Connections
Placeholders
Change notifications
RQL expressions
Signal enrichment
Search
Acknowledgements / QoS
Architecture
Overview
Services
Policies
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
eclipse
/
ditto
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
Things-Search
Connectivity
Concierge
Gateway
HTTP API
Overview
Concepts
Search
Messages
WebSocket protocol binding
Server sent events
Connectivity API
Retrieve
Delete
Acknowledgements
Errors
→ search/messages
Search
Messages
Policies group
→ commands/events
Create/Modify
Retrieve
Delete
Bindings
Examples
→ Things examples
Create a Thing
Delete a Thing
Modify a Thing
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
Errors
Authentication and Authorization
Messages
Signals
Signal types
Command
Command response
Error response
Event
APIs
Connections
Placeholders
Change notifications
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
_
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
MQTT 3.1.1 protocol binding
MQTT 5 protocol binding
HTTP 1.1 protocol binding
Kafka 2.x protocol binding
Payload mapping
Header mapping
TLS certificates
Client SDK
Overview
Java
JavaScript
Ditto Protocol
Overview
Twin/live channel
Specification
Protocol topic
Things group
→ commands/events
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
_
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
_
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
261 lines (216 sloc)
8.55 KB
Raw
Blame
akka {
loggers = ["akka.event.slf4j.Slf4jLogger"]
loglevel = "DEBUG"
logging-filter = "akka.event.slf4j.Slf4jLoggingFilter"
# for log messages during the actor system is starting up and shutting down:
stdout-loglevel = "INFO"
log-config-on-start = off
# jdk.jfr is not available in Open J9
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
bosch-io:doc/sso-doc
bosch-io:doc/sso-doc
Oct 15, 2020
23m 8s
View #843
View workflow file
Previous
Next
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
:clap:
Alexander Wellbrock
@lionax_gitlab
:tada:
Michael van Niekerk
@mvniekerk
Hello Ditto people -
I've made a Vorto thing definition on the Vorto marketplace and exported it using the Ditto exporter.
Now I've got a zip file with a bunch of .json files. Is there documentation to show how I import these?
Thanks in advance.
Thomas Jaeckle
@thjaeckle
hi
@mvniekerk
Ditto can't do anything yet with those generated JSON schema files - you can use them yourself in order to e.g. check for a valid Ditto thing feature structure with a JSON Schema library of your choice
Or you could use the schemas to generate example payload, e.g. with
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
eclipse
/
ditto
Watch
36
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
Things
Things-Search
Connectivity
Concierge
Gateway
HTTP API
Overview
Concepts
Search
Messages
WebSocket protocol binding
Server sent events
Connectivity API
Overview
Manage connections
AMQP 0.9.1 protocol binding
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
Watch
36
Star
208
Fork
70
Code
Issues
53
Pull requests
2
Actions
Projects
1
Security
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
Overview
Manage connections
AMQP 0.9.1 protocol binding
AMQP 1.0 protocol binding
MQTT 3.1.1 protocol binding
MQTT 5 protocol binding
HTTP 1.1 protocol binding
Kafka 2.x protocol binding
Payload mapping
Header mapping
TLS certificates
Client SDK
Overview
Java
JavaScript
Ditto Protocol
Overview
Retrieve a Thing
Retrieve multiple Things
Modify the Policy ID of a Thing
Create Attributes
Delete Attributes
Modify Attributes
Retrieve Attributes
Create a single Attribute
Delete a single Attribute
Modify a single Attribute
Retrieve a single Attribute
Create a Definition
Delete a Definition
Modify a Definition
Retrieve a Definition
Create Features
Delete Features
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
RQL expressions
Signal enrichment
Search
Acknowledgements / QoS
Architecture
Overview
Services
Policies
Things
Things-Search
Connectivity
Concierge
Gateway
HTTP API
Overview
Concepts
Search
Messages
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
_
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
_
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
Create/Modify
Retrieve
Delete
Acknowledgements
Errors
→ search/messages
Search
Messages
Policies group
→ commands/events
Create/Modify
Retrieve
Delete
Bindings
Examples
→ Things examples
Create a Thing
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
java-flight-recorder.enabled = false
io.dns {
resolver = "inet-address"
inet-address {
# To set the time to cache name resolutions
# Possible values:
# default: sun.net.InetAddressCachePolicy.get() and getNegative()
# forever: cache forever
# never: no caching
# n [time unit]: positive timeout with unit, for example "30 s"
positive-ttl = never
negative-ttl = never
}
}
discovery {
# pick the discovery method you'd like to use:
method = akka-dns
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
https://json-schema-faker.js.org
Maybe Ditto will validate the structure of the managed Thing JSON itself with those JSON schemas, but not for now ..
Michael van Niekerk
@mvniekerk
Thanks
@thjaeckle
.
Sorry about the noob questions, I'm trying to grok what's going on here.
The resulting "create a new Thing" json file has in its json on
features.speed.definition: ["vorto.private.agriio.pivot:Speed:0.1.0"]
.
Now - I take it I must first create a Thing, import all of these schemas in, before I can actually POST the "create a new Thing" json file as exported by Vorto?
Thomas Jaeckle
@thjaeckle
no, I don't think so .. you don't have to import the schemas - Ditto doesn't do anything with them
and as far as I remember, the "definition" parts are also part of the "create a new Thing" json file created by the Vorto generator
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
Star
208
Fork
70
Code
Issues
53
Pull requests
2
Actions
Projects
1
Security
Insights
More
Code
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
AMQP 1.0 protocol binding
MQTT 3.1.1 protocol binding
MQTT 5 protocol binding
HTTP 1.1 protocol binding
Kafka 2.x protocol binding
Payload mapping
Header mapping
TLS certificates
Client SDK
Overview
Java
JavaScript
Ditto Protocol
Overview
Twin/live channel
Specification
Protocol topic
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
_
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
Insights
More
Code
Issues
Pull requests
Actions
Projects
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
Twin/live channel
Specification
Protocol topic
Things group
→ commands/events
Create/Modify
Retrieve
Delete
Acknowledgements
Errors
→ search/messages
Search
Messages
Policies group
→ commands/events
Create/Modify
Retrieve
Modify Features
Retrieve Features
Create a single Feature
Delete a single Feature
Modify a single Feature
Retrieve a single Feature
Create Feature Definition
Delete Feature Definition
Modify Feature Definition
Retrieve Feature Definition
Create Feature Properties
Delete Feature Properties
Modify Feature Properties
Retrieve Feature Properties
Create a single Property
Delete a single Property
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
WebSocket protocol binding
Server sent events
Connectivity API
Overview
Manage connections
AMQP 0.9.1 protocol binding
AMQP 1.0 protocol binding
MQTT 3.1.1 protocol binding
MQTT 5 protocol binding
HTTP 1.1 protocol binding
Kafka 2.x protocol binding
Payload mapping
Header mapping
TLS certificates
Client SDK
Overview
Java
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
_
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
_
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
_
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
_
Thomas Jaeckle
@thjaeckle
Delete a Thing
Modify a Thing
Retrieve a Thing
Retrieve multiple Things
Modify the Policy ID of a Thing
Create Attributes
Delete Attributes
Modify Attributes
Retrieve Attributes
Create a single Attribute
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
kubernetes-api {
pod-label-selector = "actorSystemName=%s"
}
# DNS based service discovery in docker swarm (without DNS ttl caching)
docker-swarm-dns {
class = org.eclipse.ditto.services.base.DockerSwarmServiceDiscovery
}
}
coordinated-shutdown.exit-jvm=on
management {
http {
bind-hostname = "0.0.0.0"
}
health-checks.readiness-checks {
# when this is empty, the cluster-membership check is disabled for readiness:
# cluster-membership = ""
}
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
_
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Michael van Niekerk
@mvniekerk
Right. Thought it was like a class definition vs class instance type of vibe
Thank you
Thomas Jaeckle
@thjaeckle
kind of - however not yet enforced and the "definition"
may
just contain the reference to a Vorto model .. could be something else in here as well as long as the type/validation stuff is not enforced ;)
Michael van Niekerk
@mvniekerk
I think the big crux of the story is that these are then not inheritable, copy-able or verifiable on the Ditto side but only "suggestions" as to how the payload looks like, for use on client side. Thanks again
@thjaeckle
.
Alexander Wellbrock
@lionax_gitlab
Is it currently possible to configure metadata to be sent along with change events? Similar to the possibility to configure more fields like the definition to be send along change events
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
_
Stefan Maute
@stmaute
Hi
Issues
Pull requests
Actions
Projects
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
_
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
Things group
→ commands/events
Create/Modify
Retrieve
Delete
Acknowledgements
Errors
→ search/messages
Search
Messages
Policies group
→ commands/events
Create/Modify
Retrieve
Delete
Bindings
Examples
→ Things examples
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
[epic] Distinguish between reported and desired state in twins
#696
Open
thjaeckle
opened this issue
Jun 18, 2020
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
_
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Delete
Bindings
Examples
→ Things examples
Create a Thing
Delete a Thing
Modify a Thing
Retrieve a Thing
Retrieve multiple Things
Modify the Policy ID of a Thing
Create Attributes
Delete Attributes
Modify Attributes
Retrieve Attributes
Create a single Attribute
Delete a single Attribute
Modify a single Attribute
Retrieve a single Attribute
Modify a single Property
Retrieve a single Property
Error responses
→ Policies examples
Create a Policy
Delete a Policy
Modify a Policy
Retrieve a Policy
Modify entries
Retrieve entries
Create a single entry
Delete a single entry
Modify a single entry
Retrieve a single entry
Modify subjects
Retrieve subjects
Create a single subject
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
_
oscarfh
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
_
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
JavaScript
Ditto Protocol
Overview
Twin/live channel
Specification
Protocol topic
Things group
→ commands/events
Create/Modify
Retrieve
Delete
Acknowledgements
Errors
→ search/messages
Search
Messages
Policies group
→ commands/events
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
_
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
Delete a single Attribute
Modify a single Attribute
Retrieve a single Attribute
Create a Definition
Delete a Definition
Modify a Definition
Retrieve a Definition
Create Features
Delete Features
Modify Features
Retrieve Features
Create a single Feature
Delete a single Feature
Modify a single Feature
Retrieve a single Feature
Create Feature Definition
Delete Feature Definition
cluster.bootstrap {
new-cluster-enabled = on
contact-point-discovery {
service-name = "ditto-cluster"
discovery-method = akka-dns
}
}
}
actor {
provider = "akka.cluster.ClusterActorRefProvider"
enable-additional-serialization-bindings = on
# this is only intended for testing.
serialize-messages = off
serialize-creators = off
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Feature/785 documentation metadata by JulianFeinauer · Pull Request #806 · eclipse/ditto · GitHub
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
eclipse/ditto#806
Alexander Wellbrock
Thomas Jaeckle
@thjaeckle
yes, should work the same way
Alexander Wellbrock
@lionax_gitlab
Was something changed in the way ditto messages through the http API are processed - I'm observing that json responses through the messaging API are now escaped. Is this something introduced since 1.2.x?
Thomas Jaeckle
@thjaeckle
we did some changes there but would not expect it to look different
this might be a bug .. could you be more specific what you are doing and what the results are?
Alexander Wellbrock
@lionax_gitlab
Of course. I'll open an issue and describe it in more detail there
Julian
@JulianFeinauer
@lionax_gitlab
I just opened a PR for the documentation of the metadata feature in Ditto. As you are „new“ to the discussion I would appreciate your feedback:
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
OIDC integration should support arbitrary claims for authorization subjects
#512
Open
jokraehe
opened this issue
Oct 7, 2019
· 18 comments
Open
OIDC integration should support arbitrary claims for authorization subjects
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
_
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
_
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
_
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
Create a Thing
Delete a Thing
Modify a Thing
Retrieve a Thing
Retrieve multiple Things
Modify the Policy ID of a Thing
Create Attributes
Delete Attributes
Modify Attributes
Retrieve Attributes
Create a single Attribute
Delete a single Attribute
Modify a single Attribute
Retrieve a single Attribute
Create a Definition
Delete a Definition
Modify a Definition
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
_
mangexl
@mangexl
@geglock
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
· 2 comments
Open
[epic] Distinguish between reported and desired state in twins
#696
thjaeckle
opened this issue
Jun 18, 2020
· 2 comments
Projects
reported/desired
Comments
Copy link
Quote reply
Contributor
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
Create a Definition
Delete a Definition
Modify a Definition
Retrieve a Definition
Create Features
Delete Features
Modify Features
Retrieve Features
Create a single Feature
Delete a single Feature
Modify a single Feature
Retrieve a single Feature
Create Feature Definition
Delete Feature Definition
Modify Feature Definition
Retrieve Feature Definition
Create Feature Properties
Delete Feature Properties
Delete a single subject
Modify a single subject
Retrieve a single subject
Modify resources
Retrieve resources
Create a single resource
Delete a single resource
Modify a single resource
Retrieve a single resource
Error responses
→ Search examples
Sandbox
Presentations
Glossary
Feedback
Collapse All
|
Expand All
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
Create/Modify
Retrieve
Delete
Bindings
Examples
→ Things examples
Create a Thing
Delete a Thing
Modify a Thing
Retrieve a Thing
Retrieve multiple Things
Modify the Policy ID of a Thing
Create Attributes
Delete Attributes
Modify Attributes
Retrieve Attributes
Create a single Attribute
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
Modify Feature Definition
Retrieve Feature Definition
Create Feature Properties
Delete Feature Properties
Modify Feature Properties
Retrieve Feature Properties
Create a single Property
Delete a single Property
Modify a single Property
Retrieve a single Property
Error responses
→ Policies examples
Create a Policy
Delete a Policy
Modify a Policy
Retrieve a Policy
Modify entries
Retrieve entries
debug {
lifecycle = on
}
serializers {
json = "org.eclipse.ditto.services.utils.cluster.JsonJsonifiableSerializer"
cbor = "org.eclipse.ditto.services.utils.cluster.CborJsonifiableSerializer"
}
# Ditto custom settings:
serializers-json {
# The number of bytes per direct buffer in the pool used to read or write messages during JSON serialization
# The maximal number of direct buffers kept in the direct buffer pool for reuse
direct-buffer-pool-limit = 128
}
serialization-bindings {
#"java.io.Serializable" = none # must not be set in order to get akka.cluster.sharding.ShardRegion$GetShardRegionStats$ serialized
# Serialize Jsonifiable events with custom JSON serializer:
"org.eclipse.ditto.model.base.json.Jsonifiable" = cbor
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
_
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
_
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
_
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
_
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
eclipse/ditto#806
_
Alexander Wellbrock
@lionax_gitlab
I'd like to ask everyone around how you cope with the schema less data storage in ditto. I had some interesting discussion with a few backend developers working with graph databases or graphQL APIs and proper schema-based / type-safe databases (their opinion on mongodb is rather meh - at least if not for super high scalability) and I was wondering how others here handle schemas and validation of their data stored in ditto. We use Vorto currently to store our models and have a rather loose schema. It's quite nice for prototyping to just push stuff to ditto and I know that storing data without the hassle of a schema attached has it's own benefits in terms of performance. Since there is no comparable ditto alternative around using type-safety and graphQL interfaces (none that I know of), I'd like to know what you all think about these topics
Julian
@JulianFeinauer
@lionax_gitlab
thats an interesting discussion that I also reason a lot about (thinking about W3Cs Web of Things standard as alternative to Vorto as well as the Asset Administration Shell as data model). Especially in our „history“ setup where we push all updates also to a timeseries database we usually have to have some minimal shema (at least know the type of scalars). I personally think it would be neat to have some kind of model definition one could do for a feature which also includes some kind of validation if used
Alexander Wellbrock
@lionax_gitlab
We are also adding some meta-information on the history types to our vorto models and use that to bridge the data stream into our timeseries db. Right now we evaluate the usage of metadata fields for the necessary information. Since you should be able to configure metadata to be sent along update events this would enhance developer experience as well as performance on the wire regarding our bridging service for example
Alexander Wellbrock
@lionax_gitlab
@thjaeckle
how do you handle Timeseries and Alerting in your paid offerings? Do you use IoTDB, InfluxDB or something like postgres? How do you manage access to those data stores and how do you interface them? Do you use ditto there too or something else / custom? I'd also like to know how you do alerting ;) Do you go through ditto for that?
Thomas Jaeckle
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
#512
jokraehe
opened this issue
Oct 7, 2019
· 18 comments
Labels
community-interest
Comments
Copy link
Quote reply
Contributor
jokraehe
commented
Oct 7, 2019
•
edited by thjaeckle
The current implementation reads the "sub" claim only to create authorization subjects from a JSON web token. We should provide configuration options to support any claims.
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
Retrieve a Definition
Create Features
Delete Features
Modify Features
Retrieve Features
Create a single Feature
Delete a single Feature
Modify a single Feature
Retrieve a single Feature
Create Feature Definition
Delete Feature Definition
Modify Feature Definition
Retrieve Feature Definition
Create Feature Properties
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
thjaeckle
commented
Jun 18, 2020
•
edited
Problem statement
A feature which was long on the roadmap of Eclipse Ditto (see also former GH issue
#125
where previous discussions were done) is the ability to distinguish between reported and desired twin state.
reported
twin state can be seen as data/state coming from the actual device (the current "truth") whereas the
desiredProperties
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
Modify Feature Properties
Retrieve Feature Properties
Create a single Property
Delete a single Property
Modify a single Property
Retrieve a single Property
Error responses
→ Policies examples
Create a Policy
Delete a Policy
Modify a Policy
Retrieve a Policy
Modify entries
Retrieve entries
Create a single entry
Delete a single entry
Modify a single entry
MQTT 3.1.1 protocol binding
Consume messages from MQTT brokers via
sources
and send messages to MQTT brokers via
targets
.
Content-type
When MQTT messages are sent in
Ditto Protocol
, the payload should be
UTF-8
encoded strings.
If messages, which are not in Ditto Protocol, should be processed, a
payload mapping
must be configured for the connection in order to transform the messages.
MQTT 3.1.1 properties
MQTT 3.1.1 messages have no application headers. Transmission-relevant properties are set in the
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
Delete a single Attribute
Modify a single Attribute
Retrieve a single Attribute
Create a Definition
Delete a Definition
Modify a Definition
Retrieve a Definition
Create Features
Delete Features
Modify Features
Retrieve Features
Create a single Feature
Delete a single Feature
Modify a single Feature
Retrieve a single Feature
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
Create a single entry
Delete a single entry
Modify a single entry
Retrieve a single entry
Modify subjects
Retrieve subjects
Create a single subject
Delete a single subject
Modify a single subject
Retrieve a single subject
Modify resources
Retrieve resources
Create a single resource
Delete a single resource
Modify a single resource
Retrieve a single resource
Error responses
→ Search examples
"org.eclipse.ditto.model.base.exceptions.DittoRuntimeException" = cbor
}
default-dispatcher {
fork-join-executor {
parallelism-min = 4
parallelism-factor = 3.0
parallelism-max = 32
}
}
}
extensions = [
"akka.cluster.pubsub.DistributedPubSub"
]
remote {
log-remote-lifecycle-events = on
netty.tcp {
# InetAddress.getLocalHost.getHostAddress is used if empty
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Thomas Jaeckle
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
@thjaeckle
@lionax_gitlab
we have a commercial service for that (timeseries, alerting, dashboarding, ...): Bosch IoT Insights
this does its own access management, the historical data is not yet accessed via Ditto
Thomas Jaeckle
@thjaeckle
for all the metadata lovers, the documentation of the current featureset around metadata is now available:
https://www.eclipse.org/ditto/basic-metadata.html
with the upcoming Ditto 1.3.0 also a bug is fixed that during creation of a thing the metadata was not applied
Ditto 1.3.0 will probably be released next week
demetz
@demetz
@thjaeckle
is the patch-feature (
eclipse/ditto#288
) still on the roadmap?
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Implementation suggestion (see below for discussion how we got there) for the configuration "syntax":
jokraehe
mentioned this issue
Oct 7, 2019
Multi-tenancy with OpenID Connect JWT claims
#509
Open
w4tsn
mentioned this issue
Oct 9, 2019
OpenID Connect: make used claim for a policies subject configurable
#507
Closed
Copy link
Contributor
w4tsn
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
Delete Feature Properties
Modify Feature Properties
Retrieve Feature Properties
Create a single Property
Delete a single Property
Modify a single Property
Retrieve a single Property
Error responses
→ Policies examples
Create a Policy
Delete a Policy
Modify a Policy
Retrieve a Policy
Modify entries
Retrieve entries
Create a single entry
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
state is something an application in the backend or a mobile app would set as the new requested target state for a property.
Example
For example, take a room thermostat:
the actual device reports that the measured-temperature (reported) is 20°
the currently configured target-temperature (reported) is also 20°
the user feels chilly, so via a mobile app the (desired) target-temperature is set to 22°
the actual device receives this desired target-temperature as change notification and sets its
reported
target-temperature also to 22
when this change was done and
reported = desired
for the target-temperature, the desired target-temperature is removed from the twin
the measured-temperature in this moment is still 20, and the device will now start heating up the room until the measured-temperature reaches the (reported) target-temperature
now if the device was offline during the desired target-temperature was configured, upon reconnection it can ask its twin "give me a delta for the desired state to apply" and can apply those missed changes
Sequence diagram
The following sequence diagram shall illustrate the interaction pattern:
Show sequencediagram.org source of sequence diagram
Benefits
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
Retrieve a single entry
Modify subjects
Retrieve subjects
Create a single subject
Delete a single subject
Modify a single subject
Retrieve a single subject
Modify resources
Retrieve resources
Create a single resource
Delete a single resource
Modify a single resource
Retrieve a single resource
Error responses
→ Search examples
Sandbox
Presentations
Glossary
"headers"
field as a part of
Ditto protocol messages
in the payload.
This property is supported:
correlation-id
: For correlating request messages and events. Twin events have the correlation IDs of
Twin commands
that produced them.
Specific connection configuration
The common configuration for connections in
Connections > Sources
and
Connections > Targets
applies here as well.
Following are some specifics for MQTT connections:
Source format
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
Create Feature Definition
Delete Feature Definition
Modify Feature Definition
Retrieve Feature Definition
Create Feature Properties
Delete Feature Properties
Modify Feature Properties
Retrieve Feature Properties
Create a single Property
Delete a single Property
Modify a single Property
Retrieve a single Property
Error responses
→ Policies examples
Create a Policy
Delete a Policy
Modify a Policy
Retrieve a Policy
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
Sandbox
Presentations
Glossary
Feedback
Collapse All
|
Expand All
Running Ditto
Start Ditto
In order to start Ditto, you’ll need:
a running Docker daemon (at least version 18.06 CE),
Docker Compose installed (at least version 1.22),
the built Docker images of Ditto
either by building them as described in
Building Ditto
,
or by using the pre-built
hostname = ""
port = 2551
# maximum-frame-size = 128000b # this is the default
maximum-frame-size = 256000b # 256 KiB
# send-buffer-size = 256000b # this is the default
send-buffer-size = 320000b # 320 KiB
# receive-buffer-size = 256000b # this is the default
receive-buffer-size = 320000b # 320 KiB
}
artery {
enabled = on
# useful default for Ditto: "tcp" - as requires less memory, CPU, etc. than "aeron-udp"
# (which is also more complicated to configure correctly):
transport = tcp
canonical {
# "<getHostAddress>" InetAddress.getLocalHost.getHostAddress
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
eclipse/ditto#288
) still on the roadmap?
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
Thomas Jaeckle
@thjaeckle
@demetz
yes, is on our agenda for Ditto 1.4.0 (hopefully coming end of the year)
mangexl
@mangexl
Hello, I have a question about how you handle desired/actual state. I see there is an open issue
eclipse/ditto#696
discussing this. But how do you handle it today? Do you only update devices through the live channel, and let the twin represent the actual state. Or do you accept that the twin can contain both desired and actual state?
Gerald Glocker
@geglock
@mangexl
in the current Ditto version you can use the first option (live channel) only - but with the future desired/reported support (
#696
), the twin will contain both states: the current/reported as well as the desired one. Of course, you could also do this distinction already now by using an own separation within the state properties - but this is manual effort.
mangexl
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
commented
Apr 27, 2020
Is there any advance in this topic?
thjaeckle
added the
community-interest
label
Apr 27, 2020
Copy link
Contributor
thjaeckle
commented
Apr 27, 2020
No, we don't have that on our short term agenda currently.
Copy link
Contributor
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Delete a single entry
Modify a single entry
Retrieve a single entry
Modify subjects
Retrieve subjects
Create a single subject
Delete a single subject
Modify a single subject
Retrieve a single subject
Modify resources
Retrieve resources
Create a single resource
Delete a single resource
Modify a single resource
Retrieve a single resource
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
Currently, Eclipse Ditto foresees
features
of a
thing
(aka the digital twin) to contain data/state from real devices in the
properties
of the features.
It is however not defined if those properties are reported or desired state. Up to now this had to be defined by the application developer modeling the data
to store in Ditto.
By defining in Ditto what is
reported
and what
desired
property state, Ditto can provide several benefits for application developers:
at any time (e.g. when a device is not connected) the reported and desired properties are clearly distinguishable in the twin
devices which are offline during changing
desired
properties can retrieve all desired state of a digital twin, e.g. on (re-)connection of the device
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Feedback
Collapse All
|
Expand All
Building Ditto
Building with Apache Maven
In order to build Ditto with Maven, you’ll need:
JDK 11 >= 1.0.5,
Apache Maven 3.x installed,
a running Docker daemon (at least version 18.06 CE).
Building with Docker
In order to build Ditto with Docker, you’ll need a running Docker daemon (at least version 18.06 CE).
If you do not have the appropriate Maven and JDK version available, you can also use a Maven Docker image as build environment.
Tags:
getting_started
installation
For an MQTT connection:
Source
"addresses"
are MQTT topics to subscribe to. Wildcards
+
and
#
are allowed.
"authorizationContext"
may
not
contain placeholders
as MQTT 3.1.1 has no application headers.
The optional field
"qos"
sets the maximum Quality of Service to request when subscribing for messages. Its value can be
0
for at-most-once delivery,
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
Modify entries
Retrieve entries
Create a single entry
Delete a single entry
Modify a single entry
Retrieve a single entry
Modify subjects
Retrieve subjects
Create a single subject
Delete a single subject
Modify a single subject
Retrieve a single subject
Modify resources
Retrieve resources
Create a single resource
Delete a single resource
Modify a single resource
Retrieve a single resource
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Ditto images on Docker Hub
.
Check the logs after starting up:
You have now running:
a MongoDB as backing datastore of Ditto (not part of Ditto but started via Docker),
Ditto microservices:
Policies,
Things,
Thing-Search,
Gateway,
an instance of nginx acting as a reverse proxy performing a simple “basic authentication” listening on port
8080
including some static HTTP + API documentation on
http://localhost:8080
.
Stop Ditto
This command stops the Ditto stack without removing the data from MongoDB database.
After executing this command, Ditto can be started again:
# "<getHostName>" InetAddress.getLocalHost.getHostName
hostname = "<getHostAddress>" # external (logical) hostname
port = 2551 # external (logical) port
}
bind {
hostname = "" # internal (bind) hostname -> "" means use the same as the canonical one
port = "" # internal (bind) port
}
advanced {
# Maximum serialized message size, including header data. # default: 256 KiB
maximum-frame-size = 256 KiB
# Direct byte buffers are reused in a pool with this maximum size.
buffer-pool-size = 128
# Maximum serialized message size for the large messages, including header data. # default: 2 MiB
maximum-large-frame-size = 256 KiB
# Direct byte buffers for the large messages are reused in a pool with this maximum size.
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
eclipse
/
ditto
Watch
36
Star
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
@mangexl
@geglock
Thanks for the info!
oscarfh
@oscarfh
Hello,
I am new to ditto and I have some gaps in my understanding.
There is no way to express which messages the thing listens to, right? That should be done in an external system (i.e. Vorto)
I cannot express anything related to type safety. If required, I should have a custom layer between the client and Ditto, that would checkout the values being sent by the client and compare with some definition (Vorto information model?) and reject requests if the type does not match. Correct?
Same as above for plausibility checks, right?
Julian
@JulianFeinauer
@oscarfh
you can do that with custom mappers. This is basically a js script that gets your (custom) payload and can do validation before inserting it
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
JulianFeinauer
commented
May 14, 2020
Just to get the issue clear. Is the aim to get arbitrary claims as the authorization subject or should the claims be used otherwise, also?
Copy link
Contributor
ffendt
commented
May 15, 2020
I think the idea behind this was to provide configuration on how (multiple) authorization subjects would be generated from the claims of a JWT. So basically a mini-DSL for generating the subjects.
So just a small example to clarify what I think this means:
For a token
and a configuration for the issuer
[sub]+[...scp][-@client_id]
(where
'...' -> 'each array value'
and
'-' -> 'optional'
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Error responses
→ Search examples
Sandbox
Presentations
Glossary
Feedback
Collapse All
|
Expand All
Policy
A Policy enables developers to configure fine-grained access control for Things and other entities in an easy way.
Note:
The policy concept is only supported for Ditto
HTTP API version 2
.
Find the HTTP API reference at
Policies resources
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
delta changes can be calculated by Ditto in order to get a list of changes to be done for an out-of-sync-device to reach its configured desired state
the
definition
(the information about the contained properties and their types) of a feature applies for both, reported and desired state
automatic cleanup/deletion of desired state by Ditto when reported state eventually reaches the desired state
policies may be applied based on reported/desired, so e.g. a device may be prohibited to change the
desired
state whereas an end user may be prohibited from changing the
reported
state
search capabilities based on the desired state, e.g. finding all twins where the desired state is not yet met
automatic delta calculation and publishing to the device upon device connection
maintaining order (modification timestamp) of desired/reported changes in order to not apply a desired change when a change done to the actual device was done at a later point in time
This GitHub issue shall act as the overall "epic" for all issues regarding the "desired" feature addition.
EPIC issues
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
> License
> Report a Vulnerability
1
for at-least-once delivery and
2
for exactly-once delivery. The default value is
2
(exactly-once). Support of any Quality of Service depends on the external MQTT broker;
AWS IoT
for example does not acknowledge subscriptions with
qos=2
.
Note: This example assumes that there is a valid user named
ditto:inbound-auth-subject
in Ditto. If you want to use a user for the basic auth (from the
HTTP API
) use the prefix
nginx:
, e.g.
nginx:ditto
. See
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
Error responses
→ Search examples
Sandbox
Presentations
Glossary
Feedback
Collapse All
|
Expand All
Payload mapping in connectivity service
TL;DR
The payload mapping feature in Ditto’s connectivity APIs can be used to transform arbitrary payload consumed via the different supported protocols to
Ditto Protocol
messages and vice versa.
Motivation
Eclipse Ditto is about providing access to IoT devices via the
digital twin
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Destroy Ditto stack
For removing the stack and clearing the MongoDB completely, execute:
Tags:
getting_started
installation
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
> License
> Report a Vulnerability
large-buffer-pool-size = 32
# Size of the send queue for outgoing messages. Messages will be dropped if
# the queue becomes full.
outbound-message-queue-size = 3072
# Size of the send queue for outgoing control messages, such as system messages.
outbound-control-queue-size = 3072
# Size of the send queue for outgoing large messages. Messages will be dropped if
# the queue becomes full.
outbound-large-message-queue-size = 256
# Level of CPU time used, on a scale between 1 and 10, during backoff/idle.
# The tradeoff is that to have low latency more CPU time must be used to be
# able to react quickly on incoming messages or send as fast as possible after
# backoff backpressure.
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
208
Fork
70
Code
Issues
53
Pull requests
2
Actions
Projects
1
Security
Insights
More
Code
Issues
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
See here
https://www.eclipse.org/ditto/connectivity-mapping.html#javascript-mapper
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
Thomas Jaeckle
@thjaeckle
@oscarfh
regarding point 1: you can use policies for that (in order to define which "messages" are "granted" to be "WRITTEN"/send and which ones to be "READ"/received) for which authenticated subjects (e.g. users)
for the other points: yes, you could use the connection payload mapping, but that is not available for HTTP and WebSocket APIs
for those APIs the idea is still to use Vorto generated JsonSchemas to apply type safety/validation against models - hopefully we'll look into this again once Vorto released its first stable version 1.0.0
oscarfh
@oscarfh
Thanks
@JulianFeinauer
and
@thjaeckle
for the information. I will take a further look into it.
A small question about Policies: I want to use the openID token integration to allow a group of users to access something (just like in the example in
https://www.eclipse.org/ditto/basic-policy.html#example
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
), Ditto would generate a list of auth subjects:
👍
2
Copy link
Contributor
w4tsn
commented
May 15, 2020
@JulianFeinauer
@ffendt
Just to get the issue clear. Is the aim to get arbitrary claims as the authorization subject or should the claims be used otherwise, also?
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
.
Authorization concept
A specific policy provides someone (called subject), permission to read and/or write a given resource.
Tip:
The write permission at the policy root resource (i.e.
policy:/
) allows to manage the policy itself.
Find an
example
at the end of the page.
Please note, that in most cases it makes sense to grant read permission in addition to a write permission, because
write does not imply read.
Who can be addressed?
A Subject ID must conform to one of the following rules:
The ID of a User defined in the nginx reverse proxy prefixed with
nginx
.
Different JWT providers with their JWT “iss” fields - the currently supported are listed in the table below.
OpenID Connect compliant providers - supported providers are listed at
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
Phase 1
#697
: Enhance model and APIs with "desiredProperties" for Features
#700
: Support wildcard in "fields" selectors in order to receive all "desired" properties of all features of a thing
#698
: Delete value of a "desired" feature property once the actual "property" was set to the same value
#701
: Convenient creation of parent objects for modify commands with nested JSON paths
Phase 1+x
#708
: Support for using wildcard in place of feature name in policies
#702
: Search for things/features with pending "desired" properties
#704
: Provide information about desired property changes which could not be applied
#706
: Don't apply desired property if "applied" property was changed by device more recently
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Basic Authentication
for more information.
Source header mapping
MQTT 3.1.1 does not support headers in its protocol, however Ditto extracts the following headers from each consumed message:
mqtt.topic
: contains the MQTT topic on which a message was received
mqtt.qos
: contains the MQTT QoS value of a received message
mqtt.retain
: contains the MQTT retain flag of a received message
These headers may be used in a source header mapping, e.g.:
Source acknowledgement handling
For MQTT 3.1.1 sources, when configuring
acknowledgement requests
, consumed messages from the MQTT 3.1.1 broker are treated in the following way:
For Ditto acknowledgements with successful
status
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
pattern. In order to provide structured APIs for different heterogeneous devices Ditto defines a lightweight JSON based
model
.
A
Thing
might look like in the following example:
Devices in the IoT, may they be brownfield devices or newly produced devices, will probably not send their data to the cloud in the structure and
protocol
Ditto requires.
They should not need to be aware of something like Ditto running in the cloud mirroring them as digital twins.
So for example device payload could look like this:
In case of constrained devices or IoT protocols, even binary payload might be common.
Builtin mappers
The following message mappers are included in the Ditto codebase:
Mapper Alias
Description
Inbound
Outbound
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
# Level 1 strongly prefer low CPU consumption over low latency.
# Level 10 strongly prefer low latency over low CPU consumption.
idle-cpu-level = 1 # default: 5
}
}
watch-failure-detector.threshold = 12 # default 10
}
cluster {
# Disable legacy metrics in akka-cluster.
metrics.enabled = off
# enable weakly up feature to allow members to join even if some members are unreachable
allow-weakly-up-members = on
# required for akka-management-cluster-bootstrap (to be more robust):
shutdown-after-unsuccessful-join-seed-nodes = 60s
sharding {
state-store-mode = ddata
use-dispatcher = "sharding-dispatcher"
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Pull requests
Actions
Projects
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
. But I also read
OpenID Connect compliant providers - supported providers are listed at OpenID Connect - Certified OpenID Provider Servers and Services The sub claim and configured provider name are used in the form <provider>:<sub-claim>.
, which seems somehow contradicting.
Is the group support something only supported by the nginx integration?
oscarfh
@oscarfh
Just found
eclipse/ditto#512
, which is exactly what we need. thanks!
sheldonTest
@sheldonTest
Hello all. After executing the building process then running the docker-compose up -d command I am now getting the following error: ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
Pulling policies (docker.io/eclipse/ditto-policies:0-SNAPSHOT)...
ERROR: manifest for eclipse/ditto-policies:0-SNAPSHOT not found: manifest unknown: manifest unknown
How should I fix or proceed?
Stefan Maute
@stmaute
Thomas Jaeckle
@thjaeckle
the
[WARN] No publish flow registered
come directly from the HiveMQ MQTT client - I'm not sure what those mean, never seen those before
in order to analyze, it would be best to activate DEBUG logging and look at the logs for a "roundtrip" - maybe we can spot something strange there
robmontalvojr
@robmontalvojr
I attempted to follow the instructions for installing the Cloud2edge package (@
https://www.eclipse.org/packages/packages/cloud2edge/installation/)
on a minikube cluster.
Unfortunately, I ran into an issue while attempting said installation...
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
In my understanding the main goal is to support e.g. roles and group claims in subjects such that I may add a OIDC role or group to a policy entry instead of a user id. This would already be much more flexible and allow access management being made from e.g. keycloak instead of ditto policies directly. With this I could write policy entries reflecting roles and add these roles to users to give them more capabilites.
Apart from that your idea
@ffendt
sounds interesting. Could you elaborate a bit more about the use-case that this could enable? I don't have a good feeling about what possibilities this would open up ;)
👍
1
Copy link
Contributor
JulianFeinauer
commented
Oct 15, 2020
This is an interesting topic and I see two different tasks in it. I agree with
@ffendt
in the sense that in some systems it may be preferable to use e.g. the email instead of the subject e.g. for consistency with other systems.
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
It seems that while the targets are working finde the sources cause some problem right now. It seems that I'm also only sometimes able to get a working creation command executed in ditto if it's received by ditto via mqtt-source.
I'm not using any header mapping right now. The app just sets the header object in the response payload before handing it over to mqtt->ditto-source
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
OpenID Connect - Certified OpenID Provider Servers and Services
The
sub
claim and configured provider name are used in the form
<provider>:<sub-claim>
.
Prefix
Type
Description
google
jwt
A
JWT
issued by Google
Which Resources can be controlled?
A Policy can contain access control definitions for several resources:
Policy:
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
#703
: Automatically publish remaining desired state upon device connection
#705
: Emit a special event once a single and/or all "desired" properties were cleared
#699
: Provide a command + APIs in order to calculate+retrieve deltas of desired vs. properties
Please feel free to start discussions about the overall concept in this issue and regarding the more specific topics in the linked issues.
👍
1
This was referenced
Jun 18, 2020
Enhance model and APIs with "desiredProperties" for Features
#697
Open
Distinguish between "desired" and "twin" Feature properties
#125
Closed
Delete value of a "desired" feature property once the actual "property" was set to the same value
:
Acknowledges the received MQTT 3.1.1 message
For Ditto acknowledgements with mixed successful/failed
status
:
If some of the aggregated
acknowledgements
require redelivery (e.g. based on a timeout):
based on the
specificConfig
reconnectForDelivery
either
closes and reconnects the MQTT connection in order to receive unACKed QoS 1/2 messages again
or simply acknowledges the received MQTT 3.1.1 message
If none of the aggregated
acknowledgements
require redelivery:
acknowledges the received MQTT 3.1.1 message as redelivery does not make sense
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Alexander Wellbrock
@lionax_gitlab
The connectivity service logs a lot of [WARN] No publish flow registered for MqttStatefulPublish... Might that be related?
Sign in to start talking
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Thomas Jaeckle
@thjaeckle
aah, yes - sorry, I mixed that up as well
it should still work that way you configured it
did you maybe configure an explicit header mapping in the target or in the source which now doesn't contain a mapping of the "correlation-id" header?
Thomas Jaeckle
@thjaeckle
the added header mapping to MQTT 3 could maybe cause a problem with discarding the correlation-id at some point
some "fake headers" may now be used in a headerMapping for MQTT 3, see:
https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html#source-header-mapping
but to be honest, we don't have many MQTT 3 connections in our productive systems, as we have mainly Hono as device connectivity layer, so there could be bugs
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Ditto
Assumes that inbound/outbound messages are already in
Ditto Protocol
(JSON) format.
✓
✓
JavaScript
Converts arbitrary messages from and to the
Ditto Protocol
format using
custom
JavaScript code executed by Ditto.
✓
✓
Normalized
I issued the following command:
$ helm install -n $NS --wait --timeout 10m $RELEASE eclipse-iot/cloud2edge
And, after a few minutes, I got this:
Error: rpc error: code = Unavailable desc = transport is closing
Any recommendations with regards to how I should troubleshoot this?
Better yet, any ideas why this is happening?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
}
}
}
sharding-dispatcher {
# Dispatcher is the name of the event-based dispatcher
type = Dispatcher
# What kind of ExecutionService to use
executor = "fork-join-executor"
# Configuration for the fork join pool
fork-join-executor {
# Min number of threads to cap factor-based parallelism number to
parallelism-min = 4
# Parallelism (threads) ... ceil(available processors * factor)
parallelism-factor = 3.0
# Max number of threads to cap factor-based parallelism number to
parallelism-max = 32
}
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Feature/785 documentation metadata
#806
Merged
thjaeckle
merged 6 commits into
eclipse
:
master
from
JulianFeinauer
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Julian
@JulianFeinauer
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
Hi
@sheldonTest
. After the build process has finished you need to build the docker images with the following script ./ditto/services/build-images.sh. Then you can run the docker-compose up -d.
sheldonTest
@sheldonTest
@stmaute
thank you i will try this. I'm not sure if I skipped this step or I missed it in the helloworld example. Is there a link with this instruction?
Stefan Maute
@stmaute
@sheldonTest
No problem. Here is the link to our documentation:
https://www.eclipse.org/ditto/installation-building.html
Thomas Jaeckle
@thjaeckle
@sheldonTest
are you sure that you want/need to build Ditto - or do you just want to try out the helloworld example?
in that case you don't need to build Ditto, just use the official Docker images and go ahead starting it, e.g. with docker compose:
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
On the other hand I really lik
@w4tsn
idea of moving roles or groups in a policy.
Probably the most generic and probably "simple" way of achieving that would be to have some kind of "filters" which could be added to policies based on metadata that the user could have. So besides the prefix and subject as it is right now we could add a key-value map to the user with attribues. And from oauth we could do a generic mapping e.g. of groups and roles in there so that a filter on "METADATA["role_admin"] != null" (we could use arbitrary engine and syntax here, js, JEXL, ...) would allow all users with oatuh role admin.
Copy link
Contributor
Yannic92
commented
Oct 15, 2020
I'm not sure what the benefit of having METADATA is vs sticking to the already existing mechanism of multiple auth subjects.
If I understood
@ffendt
correctly you could do the same thing by using the subjects.
and a configuration for the issuer [sub]+[...scp][-@client_id] (where '...' -> 'each array value' and '-' -> 'optional'), Ditto would generate a list of auth subjects:
[
"ffendt+user@ditto-users",
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
Someone who was granted write permission at the policy root resource (i.e.
policy:/
) is allowed to manage the policy itself.
Thing:
The resource can be defined as fine-grained as necessary for the respective use case: e.g.
thing:/
as top-level resource or on sub-resources such as
thing:/features
. At runtime, the permissions are propagated down to all Thing sub-entities.
In case you grant read permission on top-level and revoke it at a sub-entity, the subject can read the upper part only.
In case you omit a subject at top-level but grant permission at a sub-entity, the subject can access the lower part only (and the Thing ID).
Policy
The Policy resource (addressable as
policy:/
) defines the access control for the Policy itself.
Tip:
Please make sure to define at least one user (for which you have the credentials) with top-level
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
#698
Open
Provide a command + APIs in order to calculate+retrieve deltas of desired vs. properties
#699
Open
Support wildcard in "fields" selectors in order to receive all "desired" properties of all features of a thing
#700
Open
Convenient creation of parent objects for modify commands with nested JSON paths
#701
Open
thjaeckle
added this to
concept phase
in
reported/desired
Jun 18, 2020
This was referenced
Target format
For an MQTT connection, the target address is the MQTT topic to publish events and messages to. The target address may contain placeholders; see
placeholders
section for more information.
Further,
"topics"
is a list of strings, each list entry representing a subscription of
Ditto protocol topics
.
Outbound messages are published to the configured target address if one of the subjects in
"authorizationContext"
has READ permission on the thing, which is associated with a message.
The additional field
"qos"
sets the Quality of Service with which messages are published. Its value can be
0
for at-most-once delivery,
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Transforms the payload of events to a normalized view.
✓
ConnectionStatus
This mapper handles messages containing
creation-time
and
ttd
headers by updating a feature of the targeted thing with
definition
ConnectionStatus
.
✓
RawMessage
For outgoing message commands and responses, this mapper extracts the payload for publishing directly into the channel. For incoming messages, this mapper wraps them in a configured message command or response envelope.
✓
✓
ImplicitThingCreation
# Throughput defines the maximum number of messages to be
# processed per actor before the thread jumps to the next actor.
# Set to 1 for as fair as possible.
throughput = 5 # default is 5
}
akka.contrib.persistence.mongodb.mongo {
driver = "akka.contrib.persistence.mongodb.ScalaDriverPersistenceExtension"
# Write concerns are one of: ErrorsIgnored, Unacknowledged, Acknowledged, Journaled, ReplicaAcknowledged
journal-write-concern = "Acknowledged" # By default was: "Journaled"
journal-wtimeout = 10000
journal-fsync = false
snaps-write-concern = "Acknowledged" # By default was: "Journaled"
snaps-wtimeout = 5000
snaps-fsync = false
realtime-enable-persistence = false
metrics-builder {
:
feature/785-documentation-metadata
Sep 23, 2020
Merged
Feature/785 documentation metadata
#806
thjaeckle
merged 6 commits into
eclipse
:
master
from
JulianFeinauer
:
feature/785-documentation-metadata
Sep 23, 2020
Conversation
30
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
AFAIR as I remember it is not
Its harcoded in Ditto to use https, I think
65 replies
mangexl
@mangexl
@thjaeckle
Thanks! I am trying to find which/how to provide the adress to use for the service discovery in ditto. If i have an address for example ditto-test.com that shall be used for discovery, do you know how I could provide it?
Thomas Jaeckle
@thjaeckle
@mangexl
that should be controllable via this configuration section:
https://github.com/eclipse/ditto/blob/master/services/utils/config/src/main/resources/ditto-akka-config.conf#L62
by default,
ditto-cluster
is used as DNS name to use for discovery .. also have a look at the Akka reference configuration for the details on those options:
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
https://www.eclipse.org/ditto/installation-running.html
Or in a Kubernetes cluster:
https://github.com/eclipse/ditto/tree/master/deployment/kubernetes
Or using the Helm chart:
https://github.com/eclipse/ditto/tree/master/deployment/helm
mangexl
@mangexl
Hello, I am looking at setting up a ditto cluster using akka-dns service discovery (running AWS/ECS). Do you know if this is possible with current implementation? I see that default discovery method is akka-dns in ditto-akka-config.conf. But I do not find any maven dependency for akka-discovery-dns.
Thomas Jaeckle
@thjaeckle
@mangexl
for using
akka-dns
, no additional dependency is required and this is the default, yes
see the Akka doc:
https://doc.akka.io/docs/akka/current/discovery/index.html#discovery-method-dns
so that should be possible on AWS/ECS
"ffendt+user",
"ffendt+admin@ditto-users",
"ffendt+admin"
]
If I got this idea right, it allows to configure any structure of the subject that will be generated. This means you could for example configure [-sub+][scp] which would then generate the following list of subjects:
This way you also have a subject which reflects only the role (admin and user) taken from the scp.
Did I miss something of your approach
@JulianFeinauer
?
Copy link
Contributor
JulianFeinauer
commented
Oct 15, 2020
@Yannic92
thanks for the response. Then I missunderstood
@ffendt
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
I just noticed that I did not mention, that the replyTarget is set in my mqtt-source configuration, not the target configuration
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
did you previously define a separate "source" for the replies?
Alexander Wellbrock
@lionax_gitlab
Currently there is a mqtt target where ditto writes the request from the HTTP client. The app then writes it's response to another topic where ditto has a mqtt-source configured for. The app uses the same ditto mqtt-source for answering messages as well as sending commands / signals / messages itself
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
read
and
write
permissions on the Policy, otherwise you won’t be able to access/change it.
Resource
Addressed data, description
policy:/
The Policy itself (top-level)
Applies to the Policy and all of its sub-resources.
policy:/policyId
The Policy’s ID.
However, such a reference is
not recommended
because write is not supported anyway, and read on the ID only, does not provide any benefit.
policy:/entries
Applies to all entries of the Policy.
policy:/entries/X
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Thomas Jaeckle
@thjaeckle
the "replyTarget" in a connection's target defines on which address responses are consumed for outgoing messages Ditto sends (in this case published to a MQTT topic)
previously that was purely defined by the "reply-to" header (which should also be the default for the "replyTarget" "address", isn't it?)
the "replyTarget" lets you additionally defined header mappings and expected response types (e.g. in order to only receive "errors", but no successful "responses") for consumed responses (and is therefore similar to a "source", defined in the "target" but only for responses)
so does you HTTP live message request define a "reply-to" header? if not, the "replyTarget.address" may also be filled with a static reply address where the MQTT device sends its replies to
did you previously define a separate "source" for the replies?
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
Jun 19, 2020
Search for things/features with pending "desired" properties
#702
Open
Automatically publish remaining desired state upon device connection
#703
Open
Provide information about desired property changes which could not be applied
#704
Open
Emit a special event once a single and/or all "desired" properties were cleared
#705
Open
thjaeckle
changed the title
Distinguish between reported and desired state in twins
[epic] Distinguish between reported and desired state in twins
Jun 19, 2020
1
for at-least-once delivery and
2
for exactly-once delivery. Support of any Quality of Service depends on the external MQTT broker. The default value is
0
(at-most-once).
Target header mapping
As MQTT 3.1.1 does not support headers in its protocol, a
header mapping
is not possible to configure here.
Target acknowledgement handling
For MQTT 3.1.1 targets, when configuring
automatically issued acknowledgement labels
, requested acknowledgements are produced in the following way:
Once the MQTT 3.1.1 client signals that the message was acknowledged by the MQTT 3.1.1 broker, the following information is mapped to the automatically created
acknowledgement
:
This mapper handles messages for which a Thing should be created automatically based on a defined template
✓
Ditto mapper
This is the default
Ditto Protocol
mapper. If you do not specify any payload mapping this mapper is used to map inbound and outbound messages. The mapper requires has no mandatory options, so its alias can be directly used as a mapper reference.
It assumes that received messages are in
Ditto Protocol JSON
and emits outgoing messages also in that format.
JavaScript mapper
This mapper may be used whenever any inbound messages are not yet in
Ditto Protocol
. By using the built in
JavaScript mapping engine
(based on Rhino) custom defined JavaScript scripts can be executed which are responsible for creating
Ditto Protocol JSON
message from arbitrary consumed payload.
class = "org.eclipse.ditto.services.utils.metrics.mongo.MongoMetricsBuilder"
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Commits
6
Checks
1
Files changed
Conversation
Copy link
Quote reply
Contributor
JulianFeinauer
commented
Sep 16, 2020
This PR adds Documentation for the current implementation of the Metadata Feature and the necessary adjustment to the Swagger docs.
Issue
#785
add documentation for the Ditto metadata feature (
#680
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Alexander Wellbrock
@lionax_gitlab
Did something change with the mqtt / connectivity system regarding responses for ditto live messages? I'm using a HTTP client to issue a live message which is then forwarded via mqtt to some application doing stuff and returning a response via mqtt back to ditto. To get request and response correlated I used to have a correlation-id header with the response using the id from the request. That used to work a while ago but now doesn't. I've verified that ditto writes the message to mqtt broker, the broker transmits it to the app and the app sends a response with correlation-id header. Then nothing except for a timeout at the HTTP client...
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
https://github.com/akka/akka-management/blob/master/cluster-bootstrap/src/main/resources/reference.conf#L30
to use
ditto-test.com
as DNS address I would overwrite the
effective-name
.. that one should be the "total" overwrite for DNS discovery
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Patrick Sernetz
@patrickse
Is it possible to use ditto with keycloak without using https. I am creating a rather simple environment for a little workshop. The workshop will be onsite and cloud-less so no chance to use proper certificates and I really would like to skip the part of installing self-signed certs to the different machines.
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
additionally, there is another possibility for ECS as well:
https://doc.akka.io/docs/akka-management/current/discovery/aws.html#discovery-method-aws-api-ecs-discovery
for that however we would need another depedency:
com.lightbend.akka.discovery:akka-discovery-aws-api_2.13
or
com.lightbend.akka.discovery:akka-discovery-aws-api-async_2.13
Sign in to start talking
window.webpackPublicPath = '//cdn02.gitter.im/_s/edbef577a/js/';
a bit, I guess. I though he wants to genreate only ONE "subject string". But if we generate multiple ones I agree, then its better than my suggestion and easier :)
Sorry for the confusion!
Copy link
Contributor
w4tsn
commented
Oct 15, 2020
•
edited
It took me a moment to fully understand the described approach of
@ffendt
and I think it's a solid approach!
So one of the next steps then is to propose a actual DSL for this then? Some ideas / implementation notes:
As additional note about the nature of claims: they are auth provider dependent and since they are JSON could have any type such as
array, string, boolean, long, int, (nested) object
. Therefore the DSL has to support something like JSON pointer syntax and the value has to be parsed accordingly. E.g. keycloak supports to put a list of attribute values into something like
.
If the value of a claim is a list we can assume to use all it's contents for the auth subjects. No need to specify it explicitly with
Applies to all subjects and resources of the specific entry X.
policy:/entries/X/subjects
Applies to all subjects of the specific entry X.
policy:/entries/X/subjects/Y
Applies to subject Y of the specific entry X.
policy:/entries/X/resources
Applies to all resources of the specific entry X.
policy:/entries/X/resources/Y
Applies to resource Y of the specific entry X.
The
Things example at the end of the page
also defines access control on the policy resource.
Thing
The Thing resource (addressable as
thing:/
) defines the access control for Things.
The access control definitions defined in a Policy’s Thing resource will be applied to all Things referencing this Policy.
Note:
Copy link
Contributor
jufickel-b
commented
Jun 19, 2020
At least one corner case came to my mind: what happens if a property with a desired state gets deleted or renamed?
Deletion, probably, is no problem because the desired state gets deleted as well.
However when a property is renamed will its desired property renamed, too? If so, how does Ditto maintain the association of the former name to the new name for received state changes?
Copy link
Contributor
Author
thjaeckle
commented
Jun 19, 2020
At least one corner case came to my mind: what happens if a property with a desired state gets deleted or renamed?
I think that this is a cornercase which can only happen during development - once the model/structure of a feature is defined by a fixed "definition", there is no renaming of properties.
When updating the major version of a definition (according to semantic versioning this would be the only way to rename a field), there would have to be a migration done anyways, so that migration must migrate properties as well as desired fields the same way.
Acknowledgement.status:
will be
200
, if the message was successfully ACKed by the MQTT 3.1.1 broker or when the target has QoS 0
will be
503
, if the MQTT 3.1.1 broker ran into an error before an acknowledgement message was received
Acknowledgement.value:
will be missing, for status
200
will contain more information, in case that an error
status
was set
Specific Configuration
The MQTT 3.1.1 binding offers additional
specific configurations
to apply for the used MQTT client.
Overall example JSON of the MQTT
The same is possible for outbound messages in order to transform
Ditto Protocol JSON
messages (e.g. events or responses) to arbitrary other formats.
Configuration options
incomingScript
(required): the mapping script for incoming messages
outgoingScript
(required): the mapping script for outgoing messages
loadBytebufferJS
(optional, default:
"false"
): whether to load ByteBufferJS library
loadLongJS
(optional, default:
"false"
): whether to load LongJS library
Normalized mapper
This mapper transforms
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
).
…
Loading status checks…
5548ffa
JulianFeinauer
force-pushed
the
JulianFeinauer:feature/785-documentation-metadata
branch from
2f9cef5
to
5548ffa
Sep 16, 2020
Copy link
Quote reply
Contributor
w4tsn
[...scp]
because it's not useful to specify a certain list entry (the order could be unreliable). We could of course use this to enforce or loosen the claim parsing: allowing a claim to be either string or array or the other way around reject the JWT / claim if it doesn't match the configured type.
Copy link
Contributor
thjaeckle
commented
Oct 15, 2020
If the value of a claim is a list we can assume to use all it's contents for the auth subjects. No need to specify it explicitly with
[...scp]
because it's not useful to specify a certain list entry (the order could be unreliable).
I agree on that.
Regarding the DSL: yes, that one would have to be defined. I just searched if there already is a standard/library for defining such things, but I didn't find any.
We could of course use a "Json transformation" library like e.g.
Jolt
, but it's really crazy what that library and its JSON based DSL can do (also crazy difficult to learn).
So I guess defining our own DSL and parser would be the best option.
In case you want to re-use a policy for various things, please make sure to name the Policy ID differently than the Thing ID.
Resource
Addressed data, description
thing:/
The Thing itself (top-level).
Applies to the Thing and all of its sub-resources.
thing:/thingId
The Thing’s ID.
Not recommended, because write is not supported anyway and read on the ID only does not provide any benefit.
thing:/policyId
Applies to the Policy ID of the Thing, which implicitly defines its access control.
Please double-check write permissions on this resource.
thing:/attributes
Applies to all attributes of the Thing.
thing:/attributes/X
Applies to the specific attribute X and its sub-paths.
This was referenced
Jun 22, 2020
Don't apply desired property if "applied" property was changed by device more recently
#706
Open
Support for using wildcard in place of feature name in policies
#708
Open
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
"specificConfig"
:
clientId
Overwrites the default MQTT client id.
Default: not set - the ID of the Ditto
connection
is used as MQTT client ID.
reconnectForRedelivery
Configures that the MQTT connection re-connects whenever a consumed message (via a connection source) with QoS 1 (“at least once”) or 2 (“exactly once”) is processed but cannot be
acknowledged
successfully.
That causes that the MQTT broker will re-publish the message once the connection reconnected.
If configured to
false
, the MQTT message is simply acknowledged (
PUBACK
or
PUBREC
created
and
modified
events (other type of messages are dropped) to a normalized view. Events are mapped to a nested sparse JSON.
would result in the following normalized JSON representation:
The
_context
field contains the original message content excluding the
value
.
Configuration options
fields
(optional, default: all fields): comma separated list of fields that are contained in the result (see also chapter about
field selectors
)
ConnectionStatus mapper
This mapper transforms the information from the
ttd
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
commented
Sep 16, 2020
The
json-schema v2
needs to be changed too
w4tsn
suggested changes
Sep 16, 2020
View changes
Copy link
Quote reply
Contributor
w4tsn
left a comment
Added some questions and suggestions.
Copy link
Contributor
thjaeckle
commented
Oct 15, 2020
The DSL would be part of the
openid-connect-issuers
configuration in "gateway.conf" (and could be specified/overwritten via environment variable or system property).
I guess it would make sense to "break" the config format in order to e.g. define for a issuer - so change from plain string to object in the config.
In order to start simple, I would suggest:
to configure a list of JsonPointers (in
[...]
braces) combined with optional "static" characters in between
if any of the used JsonPointers of one entry can't be resolved/found in the JWT, that complete entry is not added
each added
[<pointer>]
X may be a nested path such as tire/pressure.
Find a
Things example at the end of the page.
Feature
Resource
Addressed data, description
thing:/features
Applies to all Features of the Thing.
thing:/features/X
Applies to the Feature with ID X and all its sub-paths.
thing:/features/X/properties
Applies to all properties of the Feature X.
thing:/features/X/properties/Y
Applies to the property with path Y (and its sub-paths) of the Feature with ID X.
Y may be a nested path such as tire/pressure.
Find a
Things example at the end of the page.
reported/desired
In preparation
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
2 participants
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
,
PUBREL
).
Default:
true
Handle with care:
when set to
true
, incoming QoS 0 messages are lost during the reconnection phase
when set to
true
and there is also an MQTT target configured to publish messages, the messages to be published during the reconnection phase are lost
to fix that, configure
"separatePublisherClient"
also to
true
in order to publish via another MQTT connection
when set to
and
creation-time
message headers (see Eclipse Hono
device notifications
) into a ModifyFeature command that complies with the
org.eclipse.ditto:ConnectionStatus
.
The connectivity state of the device is then represented in a Feature.
It is mostly used in conjunction with another mapper that transforms the payload e.g.:
"payloadMapping": [ "Ditto" , "connectionStatus" ]
Example of a resulting
ConnectionStatus
feature:
Configuration options
thingId
(required): The ID of the Thing that is updated with the connectivity state. It can either be a fixed value or a header placeholder (e.g.
).
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
documentation/src/main/resources/pages/ditto/basic-metadata.md
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/pages/ditto/basic-metadata.md
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/pages/ditto/basic-metadata.md
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/pages/ditto/protocol-specification.md
Outdated
Show resolved
Hide resolved
JulianFeinauer
may be of type string or type array of strings
for type string a single auth subject is extracted
for type array of strings multiple auth subjects are extracted
Example config:
Example token:
Example extracted auth subjects (to be used in policy "subjects"):
WDYT? Could this be a simple start already solving 80% of the use cases?
👍
2
❤️
1
Copy link
Contributor
JulianFeinauer
commented
Oct 15, 2020
This looks very good
Message
The Message resource (addressable as
message:/
) defines the access control for Messages.
The access control definitions defined in a Policy’s Message resource will be applied to all Messages sent to or from Things referencing this Policy.
For sending messages to a Thing or its Features write permission is required
For receiving messages from a Thing or its Features read permission is required.
Such permissions can be defined at resources of different granularity.
Resource
Addressed data, description
message:/
All messages (top-level)
Applies to all messages sent to or from Things referencing this Policy and all messages sent to or from features of these Things.
message:/inbox
Applies to all messages sent to a specific Thing (or multiple things referencing this Policy)
message:/inbox/messages/X
Applies to all messages on message-subject X, sent to the Things referencing this Policy
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
false
, MQTT messages with QoS 1 and 2 could get lost (e.g. during downtime or connection issues)
cleanSession
Configure the MQTT client’s
cleanSession
flag.
Default: the negation of
"reconnectForRedelivery"
separatePublisherClient
Configures whether to create a separate physical client and connection to the MQTT broker for publishing messages, or not. By default (configured true), a single Ditto connection would open 2 MQTT connections/sessions: one for subscribing and one for publishing. If configured to
false
, the same MQTT connection/session is used both: for subscribing to messages, and for publishing messages.
Default:
true
publisherId
Configures a specific MQTT client ID for the case that
"separatePublisherClient"
featureId
(optional, default:
ConnectionStatus
): The ID of the Feature that is updated. It can either be a fixed value or resolved from a message header (e.g.
).
RawMessage mapper
This mapper relates the payload in the
"value"
field of message commands and message responses to the payload of AMQP, MQTT and Kafka messages and the body of HTTP requests. The encoding of the payload is chosen according to the configured content type. The subject, direction, thing ID and feature ID of the envelope for incoming message commands and responses need to be configured.
Messages with the Ditto protocol content type
application/vnd.eclipse.ditto+json
or signals that are not message commands or responses are mapped by the
Ditto mapper
instead.
added
2
commits
Sep 17, 2020
Improved example on basic-metadata Documentation page according to Al…
…
Loading status checks…
39edb6d
Added _metadata tag to thing_v2.json. Thanks to Alex for the pointer!
…
@thjaeckle
. Woudl at least solve 100% of my use cases (use email and probably use roles / groups).
👍
Copy link
Contributor
w4tsn
commented
Oct 15, 2020
•
edited
@thjaeckle
I'd like a shorter config option. Just throwing in some ideas:
message:/outbox
Applies to all messages sent from the Things referencing this Policy
message:/outbox/messages/X
Applies to all messages on message-subject X, sent from the Things referencing this Policy
message:/features
Messages for all Features
Applies to all messages sent to or from all Features of Things referencing this Policy
message:/features/Y
Applies to all messages sent to or from Feature Y of the Things referencing this Policy
message:/features/Y/inbox
Applies to all messages sent to Feature Y of the Things referencing this Policy
message:/features/Y/inbox/messages/X
Applies to all messages on message-subject X sent to Feature Y of the Things referencing this Policy
message:/features/Y/outbox
Applies to all messages sent from Feature Y of the Things referencing this Policy
message:/features/Y/outbox/messages/X
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
is enabled.
Default:
if client ID is configured,
clientId
+
"p"
if no client ID is configured,
connectionId
+
"p"
reconnectForRedeliveryDelay
Configures how long to wait before reconnecting a consumer client for redelivery when
"reconnectForRedelivery"
and
separatePublisherClient
are both enabled. The minimum value is
1s
.
For example, the mapper maps between the feature message command response
and an AMQP, MQTT 5, Kafka message with payload or an HTTP request with body of 6 bytes
and headers
The headers are lost for connection protocols without application headers such as MQTT 3.
Configuration options
Example configuration:
outgoingContentType
(optional): The fallback content-type for outgoing message commands and responses without the content-type header. Default to
text/plain; charset=UTF-8
.
incomingMessageHeaders
(optional): A JSON object containing the following headers needed to construct a message command or response envelope containing the incoming message as payload in the field
"value"
. Placeholder expressions reading from the protocol headers of incoming messages may be used.
content-type
(optional): The content type with which to encode the incoming message as payload. Default to
. If resolved to the Ditto protocol content type
application/vnd.eclipse.ditto+json
Loading status checks…
3cee214
thjaeckle
added this to the
1.2.2
milestone
Sep 17, 2020
Fixes in Header and basic-metadata according to Feedback from Thomas.
…
Loading status checks…
2eb901f
thjaeckle
requested changes
Sep 17, 2020
View changes
Copy link
Quote reply
My favorit being simply
auth-subjects
since that's what we are looking for to extract from the JWT. This actually gives me another idea: would it be interesting to allow fixed subjects in this list such that one could bind policy entries directly to auth-providers? Not sure how useful this is but we e.g. have a strict realm-per-customer infrastructure where it could potentially become a use-case to give "basic permissions" to everything coming from one provider.
Copy link
Contributor
thjaeckle
commented
Oct 15, 2020
Yes,
auth-subjects
is totally fine here
👍
I think fixed subjects would "automatically" be supported if you don't use the
[...]
notation inside an entry.
That could really proof useful as some kind of "all users" group for all users which could successfully authenticate with a specific issuer.
Copy link
Applies to all messages on message-subject X sent from Feature Y of the Things referencing this Policy
Tip:
The resources
message:/inbox
and
message:/outbox
do not address feature-related messages. For providing access to feature-related messages, you have to either grant top-level permission (
message:/
) or grant permission to the resource
message:/features
(or the required sub-resources).
The
Things example at the end of the page
Accept
Reject
Save preferences
Default:
2s
Establishing a connection to an MQTT 3.1.1 endpoint
Ditto’s
Connectivity service
is responsible for creating new and managing existing connections.
This can be done dynamically at runtime without the need to restart any microservice using a
Ditto DevOps command
.
Example:
Connection configuration to create a new MQTT connection:
Client-certificate authentication
Ditto supports certificate-based authentication for MQTT connections. Consult
Certificates for Transport Layer Security
for how to set it up.
Here is an example MQTT connection, which checks the broker certificate and authenticates by a client certificate.
, then the entire payload is interpreted as a Ditto protocol message instead.
status
(optional): Include for message responses. Exclude for message commands. Default to
.
subject
(mandatory for MQTT 3): Subject of the message. Default to
. Mapping will fail if not resolvable.
ditto-message-direction
(optional): The message direction. Default to
TO
, which corresponds to
inbox
in message commands and responses.
ditto-message-thing-id
(mandatory for MQTT 3): ID of the thing to send the message command or response to. Default to
. Mapping will fail if not resolvable.
Contributor
thjaeckle
left a comment
Some change requests.
And what is still missing: adding the new
basic-metadata.html
page to the navigation. Currently, it won't show up in the page navigation at all.
documentation/src/main/resources/jsonschema/thing_v2.json
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/openapi/ditto-api-2.yml
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/openapi/ditto-api-2.yml
Outdated
Contributor
Author
jokraehe
commented
Oct 20, 2020
I like your approach
@thjaeckle
, but I have a little issue with the placeholder syntax. I would prefer braces style that we use in connectivity configuration. Maybe even with a type declaration (string/array).
Copy link
Contributor
thjaeckle
commented
Oct 20, 2020
@jokraehe
that syntax is also good for me
👍
However I don't think the ":string" or ":array" is of much help here - as potentially all claims could be either string or array and we must be able to handle either string or array.
also defines access control on messages.
Grant and Revoke some Permission
Change
Permission
Description
grant
READ
All subjects named in the section are granted
read
permission on the resources specified in the path, and all nested paths, except they are revoked at a deeper level, or another policy entry (label).
grant
WRITE
All subjects named in the section are granted
write
permission on the resources specified in the path, and all nested paths, except they are revoked at a deeper level, or another policy entry (label).
revoke
Tags:
protocol
connectivity
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
> License
> Report a Vulnerability
ditto-message-feature-id
(optional): Include to send the message or message response to a feature of the thing. Exclude to send it to the thing itself. Default to
.
ImplicitThingCreation Mapper
This mapper implicitly creates a new thing for an incoming message.
The created thing contains the values defined in the template, configured in the
mappingDefinitions
options
.
Configuration options
thing
(required): The values of the thing that is created implicitly. It can either contain fixed values or header placeholders (e.g.
).
Example of a template defined in
options
:
Example connection with multiple mappers
Show resolved
Hide resolved
documentation/src/main/resources/openapi/ditto-api-2.yml
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/pages/ditto/basic-metadata.md
Outdated
Show resolved
Hide resolved
5 hidden conversations
Load more…
documentation/src/main/resources/pages/ditto/basic-metadata.md
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/pages/ditto/basic-metadata.md
Another proposal, use "json" or "claim" as prefix:
Copy link
Contributor
Author
jokraehe
commented
Oct 20, 2020
I had that exact same thought on the prefix
👍
The type would make the config more like a contract to which the provider has to conform. I assume one provider would always return e.g. the "scope" claim as array. But you are right, it isn't of much help here and the convention to allow string or array for any claim is also fine by me.
👍
1
Copy link
Contributor
thjaeckle
commented
Oct 21, 2020
READ
All subjects named in the section are
prohibited to read
on the resources specified in the path, and all nested paths, except they are granted again such permission at a deeper level, or another policy entry (label).
revoke
WRITE
All subjects named in the section are
prohibited to write
on the resources specified in the path, and all nested paths, except they are granted again such permission at a deeper level, or another policy entry (label).
Tools for editing a Policy
The Policy can be edited with a text editor of your choice. Just make sure it is in valid JSON representation, and that at least one valid subject is granted write permission at the root resources.
Tip:
The easiest way to create a Policy is to copy the model schema provided at the
interactive HTTP API documentation
and adapt it to your needs.
In case of fine-grained access on Things, keep an eye on your actual Thing structure to make sure that all paths will be granted or revoked the permissions your use case is supposed to support.
Example
The following example connection defines a
ConnectionStatus
mapping with the ID
status
and references it in a source.
Messages received via this source will be mapped by the
Ditto
mapping and the
ConnectionStatus
mapping.
The
Ditto
mapping requires no options to be configured, so you can directly use its alias
Ditto
.
Note:
Starting aliases with an uppercase character and IDs with a lowercase character is encouraged to avoid confusion but this is not enforced.
Example connection with mapping conditions
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/pages/ditto/basic-metadata.md
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/pages/ditto/protocol-specification.md
Outdated
Show resolved
Hide resolved
documentation/src/main/resources/pages/ditto/protocol-specification.md
Outdated
Show resolved
Hide resolved
thjaeckle
I think we reached an agreement on the format (I updated the summary accordingly).
I still don't know when the Ditto team will get the chance to work on this, so I suggest, if this is time-critical for someone, to provide a PullRequest.
Implementation hints:
the config interface
OAuthConfig
would need to be enhanced to contain the new
issuer
and
auth-subjects
config entries
look at
DefaultOAuthConfig
which loads the issuers from the config file
create new
Placeholder
implementation for
ClaimPlaceholder extends Placeholder<JsonObject>
(with
Given you need to support the following scenario:
Owner: The Thing
my.namespace:thing-0123
is owned by a user. Thus, she needs full access and admin rights for the complete Thing. In our example her ID is
ditto
Observer of changes at featureX and featureY:
Another application needs to be informed on each change at those features. In our example its ID is
observer-client
.
There is a group of users who are allowed to read both features. In our example the group ID is
some-users
.
Privacy: The value of the “city” property at “featureY” is confidential and needs to be “hidden” from the group of users.
Example Thing with link to a Policy ID
Your Policy then might look like the following:
Example Policy
The correct Policy JSON object notation would be as shown in the following code block.
The Policy can be found:
The following example connection defines
incomingConditions
and
outgoingConditions
for the ConnectionStatus mapping engine.
Optional incomingConditions are validated before the mapping of inbound messages.
Optional outgoingConditions are validated before the mapping of outbound messages.
Conditional Mapping can be achieved by using
. When multiple incoming or outgoing conditions are set for one
mappingEngine
, all have to equal true for the mapping to be executed.
JavaScript mapping engine
Ditto utilizes the
Rhino
JavaScript engine for Java for evaluating the JavaScript to apply for mapping payloads.
Using Rhino instead of Nashorn, the newer JavaScript engine shipped with Java, has the benefit that sandboxing can be applied in a better way.
Sandboxing of different payload scripts is required as Ditto is intended to be run as cloud service where multiple connections to different endpoints are managed for different tenants at the same time. This requires the isolation of each single script to avoid interference with other scripts and to protect the JVM executing the script against harmful code execution.
added the
documentation
label
Sep 18, 2020
Apply suggestions from code review
…
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
Loading status checks…
5a43e75
thjaeckle
removed this from the
claim:
prefix) which extracts arbitrary claims from a passen in JWT JsonObject
add a new facctory method to
PlaceholderFactory
enhance
JwtAuthenticationProvider
which creates an
AuthenticationResult
based on a passed in
JsonWebToken
to make use of the
new configured
auth-subjects
patterns
in combination with the new introduced
ClaimPlaceholder
in order to resolve claims from placeholders
pass in the
Via GET request at
/api/2/policies/<policyId>
, and
Via GET request at
At any Thing itself in its JSON representation. It is however not included by default, but can be retrieved by specifying the
/api/2/things/<thingId>?fields=_policy
query parameter.
Tip:
As soon as a sophisticated policy is described, you will only need to add a further
subject
entry to have for example a new group of users equally empowered as the initial one.
Tags:
model
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
Constraints
http://mozilla.github.io/rhino/compat/engines.html
.
Ditto currently includes Rhino version
1.7.11
and has the
VERSION_ES6
flag enabled.
Sandboxing
For sandboxing/security reasons following restrictions apply:
access to Java packages and classes is not possible
1.2.2
milestone
Sep 21, 2020
#785
: last polishing of "Metadata" documentation
…
Loading status checks…
dde119a
thjaeckle
approved these changes
Sep 21, 2020
View changes
Copy link
Quote reply
Contributor
thjaeckle
commented
OAuthConfig
which the
JwtAuthenticationFactory
holds when creating new
JwtAuthenticationProvider
instances
👍
1
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
community-interest
Projects
> License
> Report a Vulnerability
using
exit
,
quit
,
print
, etc. is not possible
file access is not possible
doing remote calls (e.g. to foreign web-servers) is not possible
programming an endless-loop will terminate the script
programming a recursion will terminate the script
the file size of the script is limited
no foreign JS libraries can be loaded (unless they fit in the file size limit and are included into the mapping script)
Helper libraries
In order to work more conveniently with binary payloads, the following libraries may be loaded for payload transformations:
bytebuffer.js
a ByteBuffer implementation using ArrayBuffers
Sep 21, 2020
@JulianFeinauer
could you have a look on the changes I made? Are they ok for you?
I really want to get the docs merged - it's not good to have no docs for the metadata feature for such a long time ;)
thjaeckle
added this to the
1.3.0
milestone
Sep 21, 2020
Copy link
Quote reply
Contributor
Author
JulianFeinauer
commented
Sep 22, 2020
THanks for your support here, all changes are fine for me
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
6 participants
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
long.js
for representing a 64-bit two’s-complement integer value
Ditto
scope:
Mapping incoming messages
Ditto Protocol
or an array of such JavaScript objects. That’s where the helper method
Ditto.buildDittoProtocolMsg
is useful: it explicitly defines which parameters are required for the Ditto Protocol message.
Mapping outgoing messages
Outgoing Ditto Protocol messages (e.g.
responses
or
events
👍
Hide details
View details
thjaeckle
merged commit
5737707
into
eclipse
:
master
Sep 23, 2020
2 checks passed
2 checks passed
build
Details
eclipsefdn/eca
The author(s) of the pull request is covered by necessary legal agreements in order to proceed!
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
headers
,
textPayload
,
bytePayload
and
contentType
. That’s where the helper method
Ditto.buildExternalMsg
is useful: it explicitly defines which parameters are required for the external message.
JavaScript payload types
Both, text payloads and byte payloads may be mapped.
Text payloads
Working with text payloads is as easy as it gets in JavaScript. For example, for the content-type
application/json
structured data may be processed like this:
Details
thjaeckle
mentioned this pull request
Sep 23, 2020
Provide documentation for _metadata feature
#785
Closed
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
w4tsn
thjaeckle
Assignees
No one assigned
Labels
documentation
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Byte payloads
Working with byte payloads is also possible but does require a little bit of knowledge about JavaScipt’s
ArrayBuffer
TypedArrays
and
DataView
.
What you get in the mapping scripts is a
bytePayload
of type
ArrayBuffer
which lets you work on the bytes in different ways:
Typed Arrays
A TypedArray [is] a view into an ArrayBuffer where every item has the same size and type.
source
With TypedArrays you can simply wrap the
bytePayload
ArrayBuffer
Projects
None yet
Milestone
1.3.0
Linked issues
Successfully merging this pull request may close these issues.
None yet
3 participants
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
and work on all the items e.g. as unsigned 8-bit integers:
DataViews
The DataView [is] another view into an ArrayBuffer, but one which allows items of different size and type in the ArrayBuffer.
source
DataViews also allow to
set
bytes to an underlying ArrayBuffer conveniently.
ByteBuffer.js
Alternatively, Ditto’s JavaScript transformation may be loaded with the
above mentioned
libraries, e.g. “bytebuffer.js”.
With
ByteBuffer
, the content of an
ArrayBuffer
can be accessed in a buffered way:
Check the
ByteBuffer API documentation
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
to find out what is possible with that helper.
JavaScript Examples
Text payload example
Let’s assume your device sends telemetry data via
Eclipse Hono’s
MQTT adapter into the cloud. And that an example payload of your device is:
We want to map a single message of this device containing updates for all 3 values to a Thing in the following structure:
Therefore, we define following
incoming
When your device now sends its payload via the MQTT adapter of Eclipse Hono:
Your digital twin is updated by applying the specified script and extracting the relevant values from the passed
textPayload
.
Bytes payload example
For this example, let’s assume your device sends telemetry data via
Eclipse Hono’s
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
HTTP adapter into the cloud. An example payload of your device - displayed as hexadecimal - is:
Let us now also assume that
the first 2 bytes
09 EF
represent
the temperature as 16bit signed integer (thus, may also be negative)
this is not a float in oder to save space (as float needs at least 32 bit)
the second 2 bytes
03 F7
represent the pressure as 16bit signed integer
the last byte
2A
represents the humidity as 8bit unsigned integer of our device.
We want to map a single message of this device containing updates for all 3 values to a Thing in the following structure:
Therefore, we define following
incoming
When your device now sends its payload via the HTTP adapter of Eclipse Hono:
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Your digital twin is updated by applying the specified script and extracting the relevant values from the passed
bytePayload
.
Custom Java based implementation
Beside the JavaScript based mapping - which can be configured/changed at runtime without the need of restarting the connectivity service - there is also the possibility to implement a custom Java based mapper.
The interface to be implemented is
org.eclipse.ditto.services.connectivity.mapping.MessageMapper
(
find the source here
) with the following signature to implement (this is only for experts, the sources contain JavaDoc):
After instantiation of the custom
MessageMapper
, the
configure
method is called with all the
options
which were provided to the mapper in the
configured connection
. Use them in order to pass in configurations, thresholds, etc.
Then, simply implement both of the
map
methods:
List<Adaptable> map(ExternalMessage message)
maps from an incoming external message to
an empty list of
Adaptable
s if the incoming message should be dropped
a list of one or many
Ditto Protocol
Adaptable
s
List<ExternalMessage> map(Adaptable adaptable)
maps from an outgoing
Ditto Protocol
Adaptable
to
an empty list of
ExternalMessage
s if the outgoing message should be dropped
a list of one or many external messages
In order to use this custom Java based mapper implementation, the following steps are required:
the implementing Class must be annotated with
@PayloadMapper(alias="customMapper")
and define at least one alias
if the custom mapper requires mandatory options then specify
@PayloadMapper(alias="customMapper", requiresMandatoryConfiguration=true)
the Class needs obviously to be on the classpath of the
connectivity
microservice in order to be loaded
when creating a new connection you have to specify the alias of your mapper as the
mappingEngine
in the connection’s
mappingDefinitions
and reference the ID of your mapper in a source or a target
Tip:
If your mapper does not require any options (
requiresMandatoryConfiguration=false
), you can directly reference the alias in a source or a target without first defining it inside
mappingDefinitions
.
Tags:
connectivity
©2020 Eclipse Ditto. Site last generated: Oct 23, 2020
> Privacy Policy
> Terms of Use
> Copyright Agent
> Legal
> License
> Report a Vulnerability
