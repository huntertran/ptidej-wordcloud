Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
GitHub - moquette-io/moquette: Java MQTT lightweight broker
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Java MQTT lightweight broker
moquette-io.github.io/moquette/
View license
1.7k
stars
666
forks
Star
Watch
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
8
branches
14
tags
Go to file
Code
Clone
HTTPS
GitHub CLI
Use Git or checkout with SVN using the web URL.
Work fast with our official CLI.
Learn more
.
Open with GitHub Desktop
Download ZIP
Launching GitHub Desktop
If nothing happens,
download GitHub Desktop
and try again.
Go back
Launching GitHub Desktop
If nothing happens,
download GitHub Desktop
and try again.
Go back
Launching Xcode
If nothing happens,
download Xcode
and try again.
Go back
Launching Visual Studio
If nothing happens,
download the GitHub extension for Visual Studio
and try again.
Go back
Latest commit
PHameete
and
Pieter Hameete
Reduce log level for log messages caused by client side input mistakes (
…
7b9db6e
Oct 9, 2020
Reduce log level for log messages caused by client side input mistakes (
7b9db6e
Git stats
1,276
commits
Files
Permalink
Failed to load latest commit information.
Type
Name
Latest commit message
Commit time
.github
Added GitHub Issue template
Oct 20, 2017
broker
Reduce log level for log messages caused by client side input mistakes (
Oct 9, 2020
distribution
remove unnecessary quotes (
#478
)
May 21, 2019
embedding_moquette
Moved packages from old io.moquette.server to new io.moquette.broker
Nov 11, 2018
gradle
Removed perf module to be move in separate project, and disabled leak…
Nov 11, 2018
tools_scripts
Bumped dev cycle 0.13
Mar 17, 2019
.editorconfig
switch to gradle
Aug 24, 2017
.gitignore
enable the usage of Netty OpenSSL provider implementation
Jun 22, 2018
.travis.yml
Updated travis ci config to openjdk12
Jul 21, 2019
ChangeLog.txt
Added implementation of retained store in H2
Nov 28, 2018
README.md
Minor, changed header (
#536
)
Oct 1, 2020
about.html
Update about.html
Apr 16, 2018
build.gradle
Bumped dev cycle 0.13
Mar 17, 2019
checkstyle-suppressions.xml
checkstyle: resource folders excluded form check
Feb 1, 2017
checkstyle.xml
Fixed checkStyle and ErrorProne warns
Apr 26, 2018
gradlew
Build tools update.
Mar 12, 2018
gradlew.bat
Build tools update.
Mar 12, 2018
license-eplv10-aslv20.html
Added copyright and license notice to every source file, added about.…
Jun 11, 2014
license.txt
Added Apache 2.0 license
Oct 4, 2013
settings.gradle
Added QueueRepository implemented in memory and on H2
Nov 22, 2018
View code
README.md
Moquette Project
Documentation reference guide
Guide on how to use and configure Moquette
Google Group
Google Group to participate in development discussions.
Moquette aims to be a MQTT compliant broker. The broker supports QoS 0, QoS 1 and QoS 2.
Its designed to be evented, uses Netty for the protocol encoding and decoding part.
Embeddable
Freedomotic
is an home automation framework and uses Moquette embedded to interface with MQTT by a specific
plugin
.
Moquette is also used into
Atomize Spin
a software solution for the logistic field.
Part of moquette are used into the
Vertx MQTT module
, into
MQTT spy
and into
WSO2 Messge broker
.
Try the demo instance
Point your browser to
cloud instance
, request an account then use it from your MQTT clients.
1 minute set up
Start play with it, download the self distribution tar from
BinTray
, the un untar and start the broker listening on
1883
port and enjoy!
Or if you are on Windows shell
Embedding in other projects
To embed Moquette in another maven project is sufficient to include a repository and declare the dependency:
Include dependency in your project:
Build from sources
After a git clone of the repository, cd into the cloned sources and:
./gradlew clean moquette-distribution:distMoquetteTar
or
./gradlew clean moquette-distribution:distMoquetteZip
.
In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
If you like Moquette you can support us by donating.
About
Java MQTT lightweight broker
moquette-io.github.io/moquette/
Topics
broker
Security Overview · moquette-io/moquette · GitHub
Join GitHub · GitHub
mqtt
java
moquette
Resources
Readme
License
View license
Releases
14
Release v.012.1
Latest
Mar 3, 2019
+ 13 releases
Packages
0
No packages published
Contributors
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Projects · moquette-io/moquette · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Join GitHub · GitHub
36
+ 25 contributors
Languages
Java
79.6%
Groovy
14.0%
HTML
5.3%
Other
1.1%
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
moquette/license.txt at master · moquette-io/moquette · GitHub
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
Actions · moquette-io/moquette · GitHub
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Jump to
↵
No suggested jump to results
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
File Finder · GitHub
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
63
Pull requests
11
Actions
Projects
0
Wiki
Security
0
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Username
Email address
Password
Make sure it's
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
No suggested jump to results
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Join GitHub · GitHub
→
Education
→
In this organization
All GitHub
↵
Jump to
↵
No suggested jump to results
In this organization
All GitHub
↵
Jump to
↵
In this organization
All GitHub
↵
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Security
Insights
Overview
Security policy
Security advisories
0
Overview
Security policy
Security advisories
0
Security overview
Security policy
Suggest how users should report security vulnerabilities for this repository
Suggest a security policy
Security advisories
View security advisories for this repository
View security advisories
Projects · moquette-io · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
moquette · GitHub Topics · GitHub
Packages · Moquette · GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Email address
Password
Make sure it's
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Moquette Broker
Moquette
Documentation
Mailing list
Moquette MQTT broker
JVM lightweight MQTT broker for the Internet of Things. Simply embeddable in your IoT projects
Learn more
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Reduce log level for log messages caused by client side input mistake… · moquette-io/moquette@7b9db6e · GitHub
Jump to
↵
Sign in
Sign up
Moquette
Moquette is lightweight MQTT Java broker
Italy
http://moquette.io
Repositories
Packages
People
Projects
Dismiss
Grow your team on GitHub
GitHub is home to over 50 million developers working together. Join them to grow your own development teams, manage permissions, and collaborate on projects.
Sign up
Type:
Join GitHub · GitHub
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
Join GitHub · GitHub
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
moquette/.editorconfig at master · moquette-io/moquette · GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Reduce log level for log messages caused by client side input mistakes by PHameete · Pull Request #537 · moquette-io/moquette · GitHub
Join GitHub · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Follow on twitter
@moquetteproject
.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
All
Select type
All
Sources
Forks
Archived
Mirrors
Language:
All
Select language
All
Java
Repositories
moquette
Java MQTT lightweight broker
java
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Release Release v.012.1 · moquette-io/moquette · GitHub
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Milestones - moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Actions
Projects
Wiki
Security
Insights
Organize your issues with project boards
Did you know you can manage projects in the same place you keep your code? Set up a project board on GitHub to streamline and automate your workflow.
Learn More
Sort tasks
Add issues and pull requests to your board and prioritize them alongside note cards containing ideas or task lists.
Plan your project
Sort tasks into columns by status. You can label columns with status indicators like "To Do", "In Progress", and "Done".
Automate your workflow
Set up triggering events to save time on project management—we’ll move tasks into the right columns for you.
Track progress
Keep track of everything happening in your project and see exactly what’s changed since the last time you looked.
Share status
Each card has a unique URL, making it easy to share and discuss individual tasks with your team.
switch to gradle · moquette-io/moquette@e8b105f · GitHub
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Pull requests · moquette-io/moquette · GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
↵
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Join GitHub · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
mqtt
broker
moquette
Java
666
1,656
63
11
Updated
Oct 9, 2020
netty-mqtt5-codec
Netty codec implementation for MQTT3 and MQTT5
Java
Apache-2.0
8
17
1
0
Updated
Labels · moquette-io/moquette · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Skip to content
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this topic
All GitHub
↵
Jump to
↵
No suggested jump to results
In this topic
All GitHub
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
Wrap up
After you wrap up your work, close your project board to remove it from your active projects list. On to the next project!
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
license.txt
Go to file
Go to file
T
Go to line
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
at least 15 characters
OR
at least 8 characters
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Dec 1, 2018
Top languages
Loading…
Most used topics
Loading…
People
This organization has no public members. You must be a member to see who’s a part of this organization.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
↵
Join GitHub · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
MQTT durable subscription exception · Issue #455 · moquette-io/moquette · GitHub
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Actions
Projects
Wiki
Security
Insights
Automate your workflow from idea to production
GitHub Actions makes it easy to automate all your software workflows, now with world-class CI/CD. Build, test, and deploy your code right from GitHub.
Learn More
Linux, macOS, Windows, ARM, and containers
Hosted runners for every major OS make it easy to build and test all your projects. Run directly on a VM or inside a container. Use your own VMs, in the cloud or on-prem, with self-hosted runners.
Matrix builds
Save time with matrix workflows that simultaneously test across multiple operating systems and versions of your runtime.
Any language
GitHub Actions supports Node.js, Python, Java, Ruby, PHP, Go, Rust, .NET, and more. Build, test, and deploy applications in your language of choice.
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
↵
Jump to
↵
In this topic
All GitHub
↵
Jump to
↵
Sign in
Sign up
Explore
Topics
Trending
Collections
Events
GitHub Sponsors
Get email updates
No suggested jump to results
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
L
Copy path
Cannot retrieve contributors at this time
205 lines (170 sloc)
11.3 KB
Raw
Blame
Copyright 2012-2013 (c) Andrea Selva
Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/
TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
1. Definitions.
"License" shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
moquette
/
No matching files found.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
Security
Team
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Packages · Moquette · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Packages · Moquette · GitHub
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Packages · Moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
at least 15 characters
OR
at least 8 characters
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Packages · Moquette · GitHub
Issues · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
Moquette
Repositories
Packages
People
Projects
Moquette doesn’t have any public projects.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Live logs
See your workflow run in realtime with color and emoji. It’s one click to copy a link that highlights a specific line number to share a CI/CD failure.
Built-in secret store
Automate your software development practices with workflow files embracing the Git flow by codifying it in your repository.
Multi-container testing
Test your web service and its DB in your workflow by simply adding some
docker-compose
to your workflow file.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
#
moquette
Star
Here are 2 public repositories matching this topic...
moquette-io
/
moquette
Star
1.7k
Code
Issues
Pull requests
Projects
Type:
All
Select type
All
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
All
Select visibility
All
Private
Public
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
"Licensor" shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.
"Legal Entity" shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
control with that entity. For the purposes of this definition,
"control" means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.
"You" (or "Your") shall mean an individual or Legal Entity
exercising permissions granted by this License.
"Source" form shall mean the preferred form for making modifications,
including but not limited to software source code, documentation
source, and configuration files.
"Object" form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
Professional Services
Learning Lab
Certifications
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Packages · Moquette · GitHub
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
Security
Team
Packages · Moquette · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
moquette/.editorconfig at e8b105fa90a032cda9794511e0c1db1b932987e6 · moquette-io/moquette · GitHub
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Java MQTT lightweight broker
java
mqtt
broker
moquette
Updated
Oct 9, 2020
Java
dnobel
/
mqtt-load-balancer
Star
4
Code
Issues
Pull requests
MQTT Load Balancer with HAProxy
Sort by:
Most downloads
Select sort view
Most downloads
Least downloads
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Save preferences
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
not limited to compiled object code, generated documentation,
and conversions to other media types.
"Work" shall mean the work of authorship, whether in Source or
Object form, made available under the License, as indicated by a
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).
"Derivative Works" shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.
"Contribution" shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
or by an individual or Legal Entity authorized to submit on behalf of
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
at least 15 characters
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Reduce log level for log messages caused by client side input mistakes (
Loading branch information
PHameete
and
Pieter Hameete
committed
Oct 9, 2020
Verified
This commit was created on GitHub.com and signed with a
switch to gradle · moquette-io/moquette@e8b105f · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Join GitHub · GitHub
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
Professional Services
Learning Lab
Certifications
Issues · moquette-io/moquette · GitHub
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
.editorconfig
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
docker
mqtt
haproxy
moquette
Updated
Sep 3, 2017
Improve this page
Add a description, image, and links to the
moquette
topic page so that developers can more easily learn about it.
Curate this topic
Add this topic to your repo
To associate your repository with the
moquette
topic, visit your repo's landing page and select "manage topics."
Learn more
Product
Features
Releases · moquette-io/moquette · GitHub
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
the copyright owner. For the purposes of this definition, "submitted"
means any form of electronic, verbal, or written communication sent
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
designated in writing by the copyright owner as "Not a Contribution."
"Contributor" shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
subsequently incorporated within the Work.
2. Grant of Copyright License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
Work and such Derivative Works in Source or Object form.
Reject
Save preferences
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
moquette/pom.xml at 7c4f902dbd20e398f734501426cdd2ec22df6d2c · moquette-io/moquette · GitHub
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
8ba0b4d
commit
7b9db6eafd6b2beaf59184b91493360b16c5e97f
Unified
Split
Showing
1 changed file
with
5 additions
and
5 deletions
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
moquette/build.gradle at e8b105fa90a032cda9794511e0c1db1b932987e6 · moquette-io/moquette · GitHub
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
switch to gradle · moquette-io/moquette@e8b105f · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Merge pull request #350 from AndreasMager/test_setup_improvement · moquette-io/moquette@7c4f902 · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
Insights
Releases
Tags
Latest release
v0.12.1
26e43c5
Compare
Choose a tag to compare
Search for a tag
Release v.012.1
Latest release
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
16 lines (13 sloc)
299 Bytes
Raw
Blame
#
EditorConfig is awesome: http://EditorConfig.org
#
top-most EditorConfig file
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Actions
Projects
Wiki
Security
Insights
Labels
Milestones
5 Open
0 Closed
Sort
Sort
Recently updated
Furthest due date
Closest due date
Least complete
Most complete
Alphabetically
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Reduce log level for log messages caused by client side input mistakes
#537
Merged
andsel
merged 1 commit into
moquette-io
:
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
Professional Services
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
switch to gradle
Loading branch information
Andreas Mager
3. Grant of Patent License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.
4. Redistribution. You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
Actions
Projects
Wiki
Security
Insights
Labels
7
Milestones
5
Labels
7
Milestones
5
New pull request
New
11 Open
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
Type:
NuGet
Select type
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
.
+5
−5
broker/src/main/java/io/moquette/broker/MQTTConnection.java
10
broker/src/main/java/io/moquette/broker/MQTTConnection.java
Show comments
View file
Edit file
Delete file
@@ -140,13 +140,13 @@ void processConnect(MqttConnectMessage msg) {
final
boolean
cleanSession
=
msg
.
variableHeader()
moquette/README.md at e8b105fa90a032cda9794511e0c1db1b932987e6 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
Type:
Docker
Release Release v.012 · moquette-io/moquette · GitHub
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
Type:
Maven
Insights
Labels
Milestones
No labels!
There aren’t any labels for this repository quite yet.
7
labels
Sort
Sort
Alphabetically
Reverse alphabetically
Most issues
Fewest issues
bug
bug
5 open issues and pull requests
duplicate
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
v0.12.1
26e43c5
Compare
Choose a tag to compare
Search for a tag
andsel
released this
Mar 3, 2019
·
14 commits
to master since this release
Bugfix release for bad push of queue messages
Assets
2
Source code
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
↵
No suggested jump to results
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
Accept
Reject
Save preferences
root
=
true
#
Unix-style newlines with a newline ending every file
[
*
]
end_of_line
=
lf
insert_final_newline
=
true
charset
=
utf-8
indent_style
Reverse alphabetically
Most issues
Least issues
0.13
No due date
Last updated
6 months ago
60%
complete
2
open
3
closed
0.12.1
No due date
Last updated
over 1 year ago
100%
complete
master
from
unknown repository
Oct 9, 2020
Merged
Reduce log level for log messages caused by client side input mistakes
#537
andsel
merged 1 commit into
moquette-io
:
master
from
unknown repository
Oct 9, 2020
Conversation
5
Commits
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
authored and
AndreasMager
committed
Aug 24, 2017
1 parent
7c4f902
commit
e8b105fa90a032cda9794511e0c1db1b932987e6
Unified
Split
Showing
31 changed files
with
699 additions
and
1,316 deletions
.
+3
modifications, and in Source or Object form, provided that You
meet the following conditions:
(a) You must give any other recipients of the Work or
Derivative Works a copy of this License; and
(b) You must cause any modified files to carry prominent notices
stating that You changed the files; and
(c) You must retain, in the Source form of any Derivative Works
that You distribute, all copyright, patent, trademark, and
attribution notices from the Source form of the Work,
excluding those notices that do not pertain to any part of
the Derivative Works; and
(d) If the Work includes a "NOTICE" text file as part of its
distribution, then any Derivative Works that You distribute must
include a readable copy of the attribution notices contained
within such NOTICE file, excluding those notices that do not
pertain to any part of the Derivative Works, in at least one
of the following places: within a NOTICE text file distributed
149 Closed
11 Open
149 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Reviews
All
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
All
Select visibility
All
Private
Public
Sort by:
Most downloads
Select sort view
Most downloads
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
.
isCleanSession();
if
(clientId
==
null
||
clientId
.
length()
==
0
) {
if
(
!
brokerConfig
.
isAllowZeroByteClientId()) {
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Release second_try_with_osgi_giveup · moquette-io/moquette · GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Release Release v0.11 · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Select type
All
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
All
Select visibility
All
Private
Public
Sort by:
Most downloads
Select sort view
Most downloads
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
There aren’t any packages here
Bumped release 0.12 · moquette-io/moquette@3080050 · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
Select type
All
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
All
Select visibility
All
Private
Public
Sort by:
Most downloads
Select sort view
duplicate
feature req
feature req
5 open issues and pull requests
help wanted
help wanted
invalid
invalid
1 open issue or pull request
question
question
1 open issue or pull request
wontfix
wontfix
© 2020 GitHub, Inc.
Terms
Privacy
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
People
Projects
Type:
RubyGems
Select type
All
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
All
Select visibility
All
Private
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
=
space
indent_size
=
4
max_line_length
=
120
[
*
.gradle
]
indent_size
=
2
Copy lines
Copy permalink
0
open
6
closed
0.11
No due date
Last updated
over 1 year ago
100%
complete
0
open
1
closed
0.12
No due date
Last updated
almost 2 years ago
1
Checks
0
Files changed
Conversation
Copy link
Quote reply
Contributor
PHameete
commented
Oct 6, 2020
I've lowered the log level for some logging that follows client side mistakes, such as a wrong MQTT version, not sending a client ID, or using incorrect credentials. When hosting a Moquette broker that is publicly available - so you don't have control over what clients are sending - the current log levels cause frequent error/warn logging which in turn can trigger alarms in monitoring solutions.
Closes
#463
Reduce log level for log messages caused by client side input mistakes
Loading status checks…
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
−0
.editorconfig
+3
−1
.gitignore
+10
−0
.travis.yml
+3
−2
README.md
+51
−0
broker/build.gradle
+0
−282
broker/pom.xml
as part of the Derivative Works; within the Source form or
documentation, if provided along with the Derivative Works; or,
within a display generated by the Derivative Works, if and
wherever such third-party notices normally appear. The contents
of the NOTICE file are for informational purposes only and
do not modify the License. You may add Your own attribution
notices within Derivative Works that You distribute, alongside
or as an addendum to the NOTICE text from the Work, provided
that such additional attribution notices cannot be construed
as modifying the License.
You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
for any such Derivative Works as a whole, provided Your use,
reproduction, and distribution of the Work otherwise complies with
the conditions stated in this License.
Filter by reviews
No reviews
Review required
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
Least downloads
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Release before_sofia2 · moquette-io/moquette · GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
LOG
.
warn
(
"
"
, username, channel);
LOG
.
info
(
"
"
, username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
Release Release v0.10 · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
MQTT SSL not working · Issue #499 · moquette-io/moquette · GitHub
Least downloads
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
Merge pull request #345 from AndreasMager/gradle · moquette-io/moquette@c367100 · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
With GitHub Packages you can safely publish and consume packages.
Learn more
about GitHub Packages
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Most downloads
Least downloads
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
There aren’t any packages here
With GitHub Packages you can safely publish and consume packages.
Learn more
about GitHub Packages
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Public
Sort by:
Most downloads
Select sort view
Most downloads
Least downloads
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
MQTT durable subscription exception
#455
Open
OleksandrBerezianskyi
opened this issue
Mar 8, 2019
· 1 comment
Open
MQTT durable subscription exception
#455
OleksandrBerezianskyi
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
100%
complete
0
open
4
closed
0.9
No due date
Last updated
over 2 years ago
33%
complete
2
open
1
closed
© 2020 GitHub, Inc.
Terms
299cb9c
PHameete
mentioned this pull request
Oct 6, 2020
Authenticator rejection results in MQTTMessageLogger error
#463
Closed
Copy link
Quote reply
Collaborator
andsel
commented
Oct 9, 2020
I don't think it's a good idea in general, since if you have a problem with a client and broker the first thing you do is to check for WARN logs on the broker side.
If you need to remove from appearing in such environment, do you think is more useful to raise up the log limit for the MQTTConnection logger in
log4j.properties
?
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
+89
−0
build.gradle
+63
−0
distribution/build.gradle
+0
−80
distribution/pom.xml
+0
−57
distribution/src/main/assembly/assembly.xml
5. Submission of Contributions. Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.
6. Trademarks. This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
origin of the Work and reproducing the content of the NOTICE file.
7. Disclaimer of Warranty. Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
👎
😄
🎉
😕
❤️
🚀
👀
Fix java 11+ build and tests
#533 opened
Aug 14, 2020
by
hylkevds
1
Fixes #529, #505: NPE caused by matching on a TNode
#532 opened
Aug 13, 2020
by
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
;
}
if
(
!
cleanSession) {
LOG
.
warn
(
"
"
,
LOG
.
info
(
"
"
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Release v0.8.1 · moquette-io/moquette · GitHub
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
Make sure it's
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
e8b105fa90
moquette
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
opened this issue
Mar 8, 2019
· 1 comment
Assignees
Labels
bug
Milestone
0.13
Comments
Copy link
Quote reply
OleksandrBerezianskyi
commented
Mar 8, 2019
Expected behavior
After reconnect of the same client with clean_session = false and subscribing to the same topic with QoS = 1 all missed messages should appear
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Copy link
Quote reply
Contributor
Author
PHameete
commented
Oct 9, 2020
•
edited
Hi
@andsel
thanks for looking at this.
I don't agree. Because I think you assume the client is operated by the same party as the broker, and therefore this party can see the broker logs.
Increasing the log level above ERROR is also not an option because then I will receive no ERROR logs at all, but some of them are relevant to me as a broker hoster becasue there could actually be something wrong on the broker side such as a bug or misconfiguration.
If you are hosting an MQTT broker and many different parties connect to your broker they can not see the broker logs (because it is hosted by - in this example - me) as the logs are not publicly available.
Accept
Reject
Save preferences
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
+5
−0
embedding_moquette/build.gradle
+0
−37
embedding_moquette/pom.xml
+9
−0
gradle/java.gradle
+19
−0
gradle/lint.gradle
+62
−0
gradle/test.gradle
BIN
gradle/wrapper/gradle-wrapper.jar
Contributor provides its Contributions) on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.
8. Limitation of Liability. In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
negligent acts) or agreed to in writing, shall any Contributor be
hylkevds
1
Bugfix/stop broker interceptor
#530 opened
May 26, 2020
by
Northram511
one get
#520 opened
Mar 4, 2020
by
luoliangtiger
fixed throw NullPointerException when new connection
#519 opened
Mar 2, 2020
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Releases · moquette-io/moquette · GitHub
Release last_with_maven · moquette-io/moquette · GitHub
Accept
Reject
Save preferences
,
username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
@@ -229,17 +229,17 @@ private boolean login(MqttConnectMessage msg, final String clientId) {
if
(msg
.
variableHeader()
.
hasPassword()) {
pwd
=
Release 0.9 · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Bumped release 0.8.1 · moquette-io/moquette@5e680b6 · GitHub
Security
Insights
Permalink
Browse files
Loading status checks…
switch to gradle
Loading branch information
Andreas Mager
authored and
AndreasMager
committed
Aug 24, 2017
1 parent
7c4f902
commit
e8b105fa90a032cda9794511e0c1db1b932987e6
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Bumped release 0.10 · moquette-io/moquette@0480260 · GitHub
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
. We'll occasionally send you account-related emails.
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
/
.editorconfig
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
16 lines (13 sloc)
299 Bytes
Raw
Blame
#
EditorConfig is awesome: http://EditorConfig.org
#
top-most EditorConfig file
root
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Sign in
to your account
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Actual behavior
Exception is thrown while trying to resend unacked message:
Steps to reproduce
Run moquette broker
Publish messages every second to any topic, e.g. "/test-topic"
Run subscriber with client = "client123", clean_session = false and subscribe to topic "/test-topic" with QoS = 1
Kill subscriber
Rerun subscriber
Retry 4.-5. until you get an exception
Minimal yet complete reproducer code (or URL to code) or complete log file
Client using python 3.7
Moquette MQTT version
moquette-broker-0.12.1.jar
JVM version (e.g.
java -version
)
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Logging authentication failures as error is then not useful for the clients because they can not see them, and it is not useful for the broker hoster as it causes a lot of noise in the logs and the broker host can not control what the clients are doing.
Copy link
Quote reply
Collaborator
andsel
commented
Oct 9, 2020
I understand you concerns, sounds reasonable
Hide details
View details
andsel
merged commit
7b9db6e
into
moquette-io
:
master
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Be notified of new releases
Create your free GitHub account today to subscribe to this repository for new releases and build software alongside 50 million developers.
Sign up
+6
−0
gradle/wrapper/gradle-wrapper.properties
+164
−0
gradlew
+90
−0
gradlew.bat
+23
−0
h2_storage/build.gradle
+0
−129
h2_storage/pom.xml
+23
−0
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.
9. Accepting Warranty or Additional Liability. While redistributing
the Work or Derivative Works thereof, You may choose to offer,
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.
by
luoliangtiger
Authentication changes
#507 opened
Oct 11, 2019
by
ndchandar
2
Java 11 compatibility
#498 opened
Aug 17, 2019
by
qbast
Clean test storage on exit to prevent assert in next test
#497 opened
Aug 16, 2019
by
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7c4f902dbd
moquette
/
broker
/
pom.xml
Go to file
Go to file
T
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
else
if
(
!
brokerConfig
.
Issues · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Unified
Split
Showing
31 changed files
with
699 additions
and
1,316 deletions
.
+3
−0
.editorconfig
+3
−1
.gitignore
+10
−0
Bumped version 0.9 · moquette-io/moquette@4162aae · GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
e8b105fa90
moquette
/
broker
/
build.gradle
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Bumped dev cycle for 0.10 · moquette-io/moquette@a7b8c07 · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
switch to gradle
Loading branch information
Andreas Mager
authored and
AndreasMager
committed
Aug 24, 2017
1 parent
7c4f902
Help
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Merge pull request
#350
from AndreasMager/test_setup_improvement
Loading branch information
andsel
committed
Aug 24, 2017
7
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Accept
Reject
Save preferences
=
true
#
Unix-style newlines with a newline ending every file
[
*
]
end_of_line
=
lf
insert_final_newline
=
true
charset
=
utf-8
indent_style
=
space
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
OS version (e.g.
uname -a
)
andsel
pinned this issue
Mar 9, 2019
andsel
self-assigned this
Mar 17, 2019
andsel
added the
bug
label
Mar 17, 2019
andsel
added this to the
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Oct 9, 2020
1 check failed
1 check failed
continuous-integration/travis-ci/pr
The Travis CI build could not complete due to an error
Details
Copy link
Quote reply
Collaborator
andsel
commented
Oct 9, 2020
@PHameete
thanks for contribution!
Copy link
Quote reply
Contributor
Author
Releases
Tags
Apr 11, 2020
v0.13
…
Apr 11, 2020
3b83f47
zip
tar.gz
Latest release
v0.12.1
26e43c5
Compare
Choose a tag to compare
Search for a tag
Release v.012.1
Latest release
mapdb_storage/build.gradle
+0
−129
mapdb_storage/pom.xml
+1
−1
osgi_test/README.md
+22
−0
osgi_test/build.gradle
+0
−183
osgi_test/pom.xml
+28
−38
osgi_test/src/test/java/io/moquette/test/osgi/MoquetteOsgiTest.java
+9
END OF TERMS AND CONDITIONS
APPENDIX: How to apply the Apache License to your work.
To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets "[]"
replaced with your own identifying information. (Don't include
the brackets!) The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
file or class name and description of purpose be included on the
same "printed page" as the copyright notice for easier
identification within third-party archives.
Copyright [yyyy] [name of copyright owner]
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
qbast
fix trie match bug and bytesMetrics bug
#479 opened
Jun 2, 2019
by
ilylia
4
Make the number of Netty worker threads number configurable
#468 opened
Apr 8, 2019
by
komamitsu
1
Fix a bug Session#resendInflightNotAcked() fails due to handling a freed ByteBuf
#464 opened
Go to line
L
Copy path
Cannot retrieve contributors at this time
282 lines (249 sloc)
9.27 KB
Raw
Blame
<
project
xmlns
=
"
http://maven.apache.org/POM/4.0.0
"
xmlns
:
xsi
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
isAllowAnonymous()) {
LOG
.
error
(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
LOG
.
info
(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
e8b105fa90
moquette
/
README.md
Go to file
Go to file
T
Go to line
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Issues · moquette-io/moquette · GitHub
Issues · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
.travis.yml
+3
−2
README.md
+51
−0
broker/build.gradle
+0
−282
broker/pom.xml
+89
−0
build.gradle
+63
−0
distribution/build.gradle
+0
−80
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
51 lines (40 sloc)
2.27 KB
Raw
Blame
description
=
'
Moquette - broker
'
apply
plugin
:
'
osgi
'
apply
plugin
:
'
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Security
Insights
Releases
Tags
v0.12
3080050
Compare
Choose a tag to compare
Search for a tag
Release v.012
v0.12
3080050
Compare
Choose a tag to compare
Search for a tag
andsel
released this
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
commit
e8b105fa90a032cda9794511e0c1db1b932987e6
Unified
Split
Showing
31 changed files
with
699 additions
and
1,316 deletions
.
+3
−0
.editorconfig
+3
−1
.gitignore
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
2 parents
dbd1310
+
4d59a54
commit
7c4f902dbd20e398f734501426cdd2ec22df6d2c
Unified
Split
Showing
9 changed files
with
175 additions
and
20 deletions
.
+1
−1
.gitignore
+28
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
indent_size
=
4
max_line_length
=
120
[
*
.gradle
]
indent_size
=
2
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Mqtt websocket http
#538 opened
Oct 22, 2020
by
strautins
1
Embedding example throws java.lang.UnsupportedOperationException: direct buffer
0.13
milestone
Mar 17, 2019
Copy link
Collaborator
andsel
commented
Mar 17, 2019
@OleksandrBerezianskyi
you missed the publisher client part. I mean the error here relates to the fact that
PubRelMarker
can't be cast to
PublishedMessage
due to a timeout of a message in flight from broker to client. The PubRelMarker is a placeholder class that reppresents the PUBREL message from broker to a subscriber that want to receive messages at QoS2. Please, could you share a complete log file from bootstrap of the broker till the crash moquette.log and messages.logs? It could help a lot to understand/ reproduce, thanks
Sign up for free
PHameete
commented
Oct 9, 2020
Thank you!
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
v0.12.1
26e43c5
Compare
Choose a tag to compare
Search for a tag
andsel
released this
Mar 3, 2019
·
14 commits
to master since this release
Bugfix release for bad push of queue messages
Assets
2
Source code
(zip)
Source code
(tar.gz)
−0
perf/build.gradle
+0
−142
perf/pom.xml
+0
−235
pom.xml
+16
−0
settings.gradle
3
.editorconfig
Show comments
View file
Edit file
Delete file
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
Mar 31, 2019
by
komamitsu
4
ProTip!
Follow long discussions with
comments:>50
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
=
"
http://www.w3.org/2001/XMLSchema-instance
"
xsi
:
schemaLocation
=
"
http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd
"
>
<
modelVersion
>4.0.0</
modelVersion
>
<
parent
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
return
false
;
}
final
String
login
=
msg
.
payload()
.
userName();
if
(
!
authenticator
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
L
Copy path
Cannot retrieve contributors at this time
70 lines (54 sloc)
2.43 KB
Raw
Blame
What is Moquette?
[Documentation reference guide] (
http://andsel.github.io/moquette/
) Guide on how to use and configure Moquette
[Google Group] (
https://groups.google.com/forum/#!forum/moquette-mqtt
) Google Group to participate in development discussions. Moquette aims to be a MQTT compliant broker. The broker supports QoS 0, QoS 1 and QoS 2.
Its designed to be evented, uses Netty for the protocol encoding and decoding part.
Embeddable
[Freedomotic] (
Wiki
Security
Insights
Releases
Tags
second_try_with_osgi_giveup
c367100
Compare
Choose a tag to compare
Search for a tag
second_try_with_osgi_giveup
second_try_with_osgi_giveup
c367100
Compare
Choose a tag to compare
Search for a tag
andsel
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Updated readme for version 0.11 · moquette-io/moquette@0bf35a7 · GitHub
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Add Ping Request handling to the interceptors · Issue #481 · moquette-io/moquette · GitHub
distribution/pom.xml
+0
−57
distribution/src/main/assembly/assembly.xml
+5
−0
embedding_moquette/build.gradle
+0
−37
embedding_moquette/pom.xml
+9
−0
gradle/java.gradle
+19
−0
gradle/lint.gradle
+62
−0
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Wiki
Security
Insights
Releases
Tags
v0.11
0bf35a7
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
Compare
Choose a tag to compare
Search for a tag
Release v0.11
maven
'
dependencies
{
compile
group
:
'
io.netty
'
,
name
:
'
netty-common
'
,
version
: nettyVersion
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
Dec 1, 2018
·
28 commits
to master since this release
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Rewritten completly the broker to introduce the concept of MqttConnection
Dropped suppoert for MapDB and keeped only H2 MvStore for persistence
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Security
Insights
Permalink
Browse files
Loading status checks…
Bumped release 0.12
Loading branch information
andsel
committed
Dec 1, 2018
1 parent
2138513
commit
3080050c4dc32b92aedde1de490da7621d8b1f4b
Unified
Split
Showing
5 changed files
+10
−0
.travis.yml
+3
−2
README.md
+51
−0
broker/build.gradle
+0
−282
broker/pom.xml
+89
−0
build.gradle
+63
−0
distribution/build.gradle
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
−0
broker/pom.xml
+11
−0
broker/src/test/java/io/moquette/server/ServerIntegrationSSLClientAuthTest.java
+12
−0
broker/src/test/java/io/moquette/server/ServerIntegrationSSLTest.java
+18
−11
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
+5
−0
osgi_test/README.md
+31
−0
osgi_test/pom.xml
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
#534 opened
Sep 16, 2020
by
micw
New configuration parameter : setting the HandshakeTimeout on SslHandler
#531 opened
Jul 23, 2020
by
dsoulayrol
NullPointerException in CTrie.evaluate
#529 opened
May 13, 2020
by
hylkevds
1
3
Publish javadoc & sources of 0.13
#528 opened
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
andsel
Labels
bug
Projects
None yet
Milestone
0.13
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
2 participants
© 2020 GitHub, Inc.
Terms
Privacy
None yet
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
Authenticator rejection results in MQTTMessageLogger error
2 participants
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
v0.12
3080050
Compare
Choose a tag to compare
Search for a tag
Release v.012
v0.12
3080050
Compare
Choose a tag to compare
Search for a tag
andsel
released this
@@ -11,3 +11,6 @@ charset = utf-8
indent_style
=
space
indent_size
=
4
max_line_length
=
120
[
*
.gradle
]
indent_size
=
2
4
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
>
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
Security
Insights
Releases
Tags
before_sofia2
a7b8c07
Compare
Choose a tag to compare
Search for a tag
before_sofia2
before_sofia2
a7b8c07
Compare
Choose a tag to compare
Search for a tag
andsel
tagged this
Jan 18, 2017
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
.
checkValid(clientId, login, pwd)) {
LOG
.
error
(
"
"
, clientId, login);
LOG
.
info
(
"
"
, clientId, login);
return
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Projects
Wiki
Security
Insights
Releases
Tags
v0.10
0480260
Compare
Choose a tag to compare
Search for a tag
Release v0.10
v0.10
0480260
Compare
Choose a tag to compare
Search for a tag
http://www.freedomotic.com/
) Is an home automation framework, uses Moquette embedded to interface with MQTT world. Moquette is also used into [Atomize Spin] (
http://atomizesoftware.com/spin
) a software solution for the logistic field. Part of moquette are used into the [Vertx MQTT module] (
https://github.com/giovibal/vertx-mqtt-broker-mod
), into
MQTT spy
and into [WSO2 Messge broker] (
http://techexplosives-pamod.blogspot.it/2014/05/mqtt-transport-architecture-wso2-mb-3x.html
).
Try the demo instance
Point your MQTT client to
broker.moquette.io
1 minute set up
Start play with it, download the self distribution tar from
BinTray
, the un untar and start the broker listening on 1883 port and enjoy!
Or if you are on Windows shell
tagged this
Aug 26, 2017
·
113 commits
to master since this tag
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Subscription storage · Issue #482 · moquette-io/moquette · GitHub
Error processing protocol message: PUBACK · Issue #483 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
gradle/test.gradle
BIN
gradle/wrapper/gradle-wrapper.jar
+6
−0
gradle/wrapper/gradle-wrapper.properties
+164
−0
gradlew
+90
−0
gradlew.bat
+23
−0
h2_storage/build.gradle
+0
−129
h2_storage/pom.xml
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
v0.11
0bf35a7
Compare
Choose a tag to compare
Search for a tag
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
andsel
released this
Jun 10, 2018
·
80 commits
to master since this release
compile
group
:
'
io.netty
'
,
name
:
'
netty-buffer
'
,
version
: nettyVersion
compile
group
:
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
with
6 additions
and
6 deletions
.
+1
−1
broker/src/main/java/io/moquette/broker/Server.java
+2
−2
build.gradle
+1
−1
distribution/src/main/scripts/moquette.bat
+1
−1
distribution/src/main/scripts/moquette.sh
+0
−80
distribution/pom.xml
+0
−57
distribution/src/main/assembly/assembly.xml
+5
−0
embedding_moquette/build.gradle
+0
−37
embedding_moquette/pom.xml
+9
−0
gradle/java.gradle
+19
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
+57
−8
osgi_test/src/test/java/io/moquette/test/osgi/MoquetteOsgiTest.java
+12
−0
osgi_test/src/test/resources/log4j.properties
2
.gitignore
Show comments
View file
Edit file
Delete file
@@ -18,7 +18,7 @@ broker/runner
/
perf
/
target
🎉
😕
❤️
🚀
👀
MQTT durable subscription exception
bug
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
0.13
1
ProTip!
no:milestone
will show everything without a milestone.
© 2020 GitHub, Inc.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
May 13, 2020
by
hylkevds
Buffering settings to reduce latency
#527 opened
May 8, 2020
by
impliedx
1
Broker does not reject connections with clientId longer than 23 characters for MQTT v3.1
#522 opened
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Dec 1, 2018
·
28 commits
to master since this release
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Rewritten completly the broker to introduce the concept of MqttConnection
Dropped suppoert for MapDB and keeped only H2 MvStore for persistence
Assets
2
Source code
(zip)
Source code
(tar.gz)
v0.11
.gitignore
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,5 @@
/
build
*
/
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
version
>0.11-SNAPSHOT</
version
>
</
parent
>
<
artifactId
>moquette-broker</
artifactId
>
<
packaging
>jar</
packaging
>
<
·
377 commits
to master since this tag
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
false
;
}
NettyUtils
.
userName(channel, login);
}
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error
(
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
andsel
released this
Jun 30, 2017
·
136 commits
to master since this release
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Embedding in other projects
To embed Moquette in another maven project is sufficient to include a repository and declare the dependency:
Include dependency in your project:
Build from sources
After a git clone of the repository, cd into the cloned sources and:
./gradlew clean distribution:distMoquetteTar
or
./gradlew clean distribution:distMoquetteZip
. In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
+23
−0
mapdb_storage/build.gradle
+0
−129
mapdb_storage/pom.xml
+1
−1
osgi_test/README.md
+22
−0
osgi_test/build.gradle
+0
−183
osgi_test/pom.xml
+28
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
'
io.netty
'
,
name
:
'
netty-transport
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
MQTT SSL not working
#499
Open
francesco98
opened this issue
Aug 20, 2019
· 1 comment
Open
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Releases
Tags
v0.8.1
5e680b6
Compare
Choose a tag to compare
Search for a tag
Loading status checks…
Merge pull request
#345
from AndreasMager/gradle
Loading branch information
andsel
committed
Aug 24, 2017
2 parents
7c4f902
+
e8b105f
commit
c367100e6b34908a8cf9b644013133e94abdc4d8
Unified
Split
Showing
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
2
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -57,7 +57,7 @@
public
static
void
main
(
String
[]
−0
gradle/lint.gradle
+62
−0
gradle/test.gradle
BIN
gradle/wrapper/gradle-wrapper.jar
+6
−0
gradle/wrapper/gradle-wrapper.properties
+164
−0
gradlew
+90
−0
gradlew.bat
+23
/
/
mapdb_storage
/
target
/
*
~
*
log
*
*
.
log
*
.DS_Store
.settings
/
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Mar 31, 2020
by
mjacoby
queue is full
#521 opened
Mar 28, 2020
by
arifainchtein
java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes
#518 opened
Feb 27, 2020
by
carlsberg-stack
BUG - null Session in subscribe procedure
#517 opened
Feb 14, 2020
by
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
0bf35a7
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
Compare
Choose a tag to compare
Search for a tag
Release v0.11
v0.11
0bf35a7
Compare
Choose a tag to compare
Search for a tag
build
/
/
target
/
/
parser
/
target
/
/
benchmarking
/
target
/
@@ -31,7 +33,6 @@ broker/runner
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Save preferences
name
>Moquette - broker</
name
>
<
properties
>
<
project
.build.sourceEncoding>UTF-8</
project
.build.sourceEncoding>
<
bintray
.package>io.moquette.moquette-broker</
bintray
.package>
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Actions
Projects
Wiki
Security
Insights
Dismiss
Be notified of new releases
Create your free GitHub account today to subscribe to this repository for new releases and build software alongside 50 million developers.
Sign up
Releases
Tags
Jan 17, 2016
v0.8
…
Jan 17, 2016
a44d6b0
zip
tar.gz
Pull requests
Actions
Projects
Wiki
Security
Insights
Releases
Tags
last_with_maven
7c4f902
Compare
Choose a tag to compare
Search for a tag
last_with_maven
last_with_maven
7c4f902
Compare
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
LOG
.
info
(
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
return
false
;
}
return
true
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Security
Insights
Releases
Tags
v0.9
4162aae
Compare
Choose a tag to compare
Search for a tag
0.9
v0.9
4162aae
Compare
Choose a tag to compare
Search for a tag
andsel
released this
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Bumped release 0.8.1
Loading branch information
andsel
committed
Feb 3, 2016
1 parent
5c7e2b3
commit
5e680b64655acdd2296bde7c963e302b6032f76c
Unified
Split
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
−38
osgi_test/src/test/java/io/moquette/test/osgi/MoquetteOsgiTest.java
+9
−0
perf/build.gradle
+0
−142
perf/pom.xml
+0
−235
pom.xml
+16
−0
settings.gradle
3
.editorconfig
Show comments
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
,
name
:
'
netty-handler
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
Permalink
Browse files
Loading status checks…
Bumped release 0.10
Loading branch information
andsel
committed
Jun 27, 2017
1 parent
ae9c6c7
commit
0480260a567a4e5317acb441b7d35988df4a687f
Unified
Split
Showing
11 changed files
MQTT SSL not working
#499
francesco98
opened this issue
Aug 20, 2019
· 1 comment
Comments
Copy link
Quote reply
francesco98
commented
Aug 20, 2019
Hi guys,
I am having some problems with the configuration of
MQTT throw SSL
, below description and useful code.
Description
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
v0.8.1
v0.8.1
5e680b6
Compare
Choose a tag to compare
Search for a tag
andsel
tagged this
Feb 3, 2016
·
538 commits
to master since this tag
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
31 changed files
with
699 additions
and
1,316 deletions
.
+3
−0
.editorconfig
+3
−1
.gitignore
+10
−0
.travis.yml
+3
−2
README.md
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
args
)
throws
IOException
{
final
Server
server
=
new
Server
();
server
.
startServer();
System
.
out
−0
h2_storage/build.gradle
+0
−129
h2_storage/pom.xml
+23
−0
mapdb_storage/build.gradle
+0
−129
mapdb_storage/pom.xml
.project
28
broker/pom.xml
Show comments
View file
Edit file
Delete file
@@ -100,6 +100,12 @@
<
version
>5.1.0</
version
>
</
dependency
>
<
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
BigGitWorld
Question: disconnecting a client when authentication details removed
#516 opened
Jan 23, 2020
by
MattyyttaM
Bridging to a cloud broker [Microsoft Azure -- IOT Hub] ?
#513 opened
Jan 17, 2020
by
carlsberg-stack
5
Moquette shows topics, but subscribers won't receive anything - Subscription missing?
#510 opened
Dec 18, 2019
by
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
andsel
released this
Jun 10, 2018
·
80 commits
to master since this release
Assets
2
Source code
(zip)
.mtj.tmp
/
#
Package Files #
*
.jar
*
.war
*
.ear
@@ -43,3 +44,4 @@ broker/nb-configuration.xml
broker
/
nbactions-Server.xml
maven-metadata.xml
/
</
properties
>
<
dependencies
>
<!--
<dependency>
-->
<!--
-->
<!--
<artifactId>moquette-mapdb-storage</artifactId>
-->
<!--
-->
<!--
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Sep 29, 2015
last_with_ringbuffer
…
Sep 29, 2015
b716927
zip
tar.gz
Jul 8, 2015
0.7
…
Jul 8, 2015
f0a8346
zip
tar.gz
Apr 6, 2015
last_osgi
Choose a tag to compare
Search for a tag
andsel
tagged this
Aug 24, 2017
·
115 commits
to master since this tag
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
Terms
;
Toggle all file notes
0 comments on commit
7b9db6e
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
Jan 11, 2017
·
378 commits
to master since this release
Move the protocol processing to concurrent FSM.
Fixes for tests
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Showing
8 changed files
with
8 additions
and
8 deletions
.
+1
−1
broker/pom.xml
+1
−1
broker/src/main/java/io/moquette/server/Server.java
+1
−1
distribution/pom.xml
+1
−1
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
View file
Edit file
Delete file
@@ -11,3 +11,6 @@ charset = utf-8
indent_style
=
space
indent_size
=
4
max_line_length
=
120
[
*
.gradle
]
Browse files
Loading status checks…
Bumped version 0.9
Loading branch information
andsel
committed
Jan 11, 2017
1 parent
ac8a11f
commit
4162aae3a0a4e697e49983858afacb2fe1f60af5
Unified
Split
Showing
10 changed files
with
10 additions
and
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
'
netty-codec
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-codec-http
'
with
14 additions
and
14 deletions
.
+3
−3
README.md
+1
−1
broker/pom.xml
+1
−1
broker/src/main/java/io/moquette/server/Server.java
+1
−1
distribution/pom.xml
I am trying to include moquette in my Java Project using SSL (8883), but somethings is wrong. Before checking SSL connection, I have configured standard connection throw 1883 port and tested with Paho Java Client, therefore this work correctly! Instead, SSL seems not listening to 8883 port and every connection is refused. The command
"netstat -aon | grep 8883"
return 0 lines, instead
"netstat -aon | grep 1883"
return 1 line. Moreover, the new method added
getSslPort()
return always 0.
This is my config/moquette.conf
This is the code to start server
Could you help me? Thank you!
Copy link
Rick-Farstreet
commented
Nov 9, 2019
Hi franscesco98,
I think that the problem that you're having is due to the fact that your jks file might not be found. In my own code I give the whole path from the /src folder
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Bumped dev cycle for 0.10
Loading branch information
andsel
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
+51
−0
broker/build.gradle
+0
−282
broker/pom.xml
+89
.
println(
"
Server started, version 0.12
-SNAPSHOT
"
);
+1
−1
osgi_test/README.md
+22
−0
osgi_test/build.gradle
+0
−183
osgi_test/pom.xml
+28
−38
osgi_test/src/test/java/io/moquette/test/osgi/MoquetteOsgiTest.java
+9
−0
perf/build.gradle
+0
dependency
>
<
groupId
>com.librato.metrics</
groupId
>
<
artifactId
>librato-java</
artifactId
>
<
version
>2.1.0</
version
>
</
dependency
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
beniroquai
1
Will it be compatible with Graalvm in the future?
#509 opened
Dec 12, 2019
by
coolbeevip
Moquette & 2-way SSL authentication
#508 opened
Nov 25, 2019
by
lukaszsoszynski
BrokerInterceptor thread pool never closing on serverStop
#506 opened
Oct 9, 2019
by
bobrowskim
Save preferences
Source code
(tar.gz)
Aug 26, 2017
second_try_with_osgi_giveup
…
Aug 26, 2017
c367100
zip
tar.gz
Aug 24, 2017
last_with_maven
.gradle
/
10
.travis.yml
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,13 @@
language
:
java
jdk
:
-
oraclejdk8
before_cache
</dependency>
-->
<
dependency
>
<
groupId
>org.slf4j</
groupId
>
<
artifactId
>slf4j-api</
artifactId
>
<
version
>1.7.5</
Save preferences
…
Apr 6, 2015
d850262
zip
tar.gz
Previous
Next
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
embedding_moquette/pom.xml
+1
−1
netty_parser/pom.xml
+1
−1
parser_commons/pom.xml
+1
−1
pom.xml
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
2
broker/pom.xml
Show comments
View file
Edit file
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
indent_size
=
2
4
.gitignore
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,5 @@
/
build
*
/
build
/
/
10 deletions
.
+1
−1
README.md
+1
−1
broker/pom.xml
+1
−1
broker/src/main/java/io/moquette/server/Server.java
+1
−1
distribution/pom.xml
+1
−1
embedding_moquette/pom.xml
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-codec-mqtt
'
,
version
: nettyVersion
compile
+1
−1
embedding_moquette/pom.xml
+1
−1
h2_storage/pom.xml
+1
−1
mapdb_storage/pom.xml
+1
−1
osgi_test/pom.xml
+1
−1
perf/pom.xml
+1
−1
(jks_path src\main\java\com\mycompany\myproject\mqtt\broker\config\serverkeystore.jks).
without this path my code did not work for me eather.
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
committed
Jan 11, 2017
1 parent
4162aae
commit
a7b8c07d1aa683236ef827b0d3d4141ec96e33ec
Unified
Split
Showing
11 changed files
with
13 additions
and
10 deletions
.
+3
−0
ChangeLog.txt
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
−0
build.gradle
+63
−0
distribution/build.gradle
+0
−80
distribution/pom.xml
+0
−57
distribution/src/main/assembly/assembly.xml
+5
−0
embedding_moquette/build.gradle
+0
−37
embedding_moquette/pom.xml
System
.
out
.
println(
"
Server started, version 0.12
"
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
−142
perf/pom.xml
+0
−235
pom.xml
+16
−0
settings.gradle
3
.editorconfig
Show comments
View file
Edit file
Delete file
@@ -11,3 +11,6 @@ charset = utf-8
indent_style
>
<
dependency
>
<
groupId
>com.bugsnag</
groupId
>
<
artifactId
>bugsnag</
artifactId
>
@@ -176,6 +182,13 @@
<
scope
>test</
Subscription breaks during performance test
#505 opened
Oct 4, 2019
by
JinseonyLee
1
Connection dropped when publishing message with payload greater 8KB.
#503 opened
Aug 30, 2019
by
r-t-s
MQTT SSL not working
#499 opened
Aug 20, 2019
by
francesco98
…
Aug 24, 2017
7c4f902
zip
tar.gz
v0.10
0480260
Compare
Choose a tag to compare
Search for a tag
Release v0.10
v0.10
0480260
Compare
Choose a tag to compare
Search for a tag
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache
:
directories
:
-
$HOME/.gradle/caches/
-
$HOME/.gradle/wrapper/
script
:
-
./gradlew install test
version
>
</
dependency
>
<
dependency
>
<
groupId
>io.netty</
groupId
>
<
artifactId
>netty-common</
artifactId
>
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Security
Insights
Permalink
Browse files
Loading status checks…
Updated readme for version 0.11
Loading branch information
andsel
committed
May 17, 2018
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
Delete file
@@ -6,7 +6,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
target
/
/
parser
/
target
/
/
benchmarking
/
target
/
@@ -31,7 +33,6 @@ broker/runner
.mtj.tmp
/
#
Package Files #
+1
−1
netty_parser/pom.xml
+1
−1
osgi_test/pom.xml
+1
−1
perf/pom.xml
+1
−1
pom.xml
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
2
README.md
Show comments
group
:
'
io.netty
'
,
name
:
'
netty-transport-native-epoll
'
,
version
: nettyVersion,
classifier
:
'
linux-x86_64
'
pom.xml
+2
−2
tools_scripts/integration/brokerEmbeddedTest.groovy
6
README.md
Show comments
View file
Edit file
Delete file
@@ -20,10 +20,10 @@ and into [WSO2 Messge broker] (http://techexplosives-pamod.blogspot.it/2014/05/m
Point your MQTT client to
_broker.moquette.io_
##
1 minute set up
Start play with it, download the self distribution tar from [
None yet
2 participants
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
+1
−1
README.md
+1
−1
broker/pom.xml
+1
−1
broker/src/main/java/io/moquette/server/Server.java
+1
−1
distribution/pom.xml
+1
−1
embedding_moquette/pom.xml
+1
−1
netty_parser/pom.xml
+1
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
+9
−0
gradle/java.gradle
+19
−0
gradle/lint.gradle
+62
−0
gradle/test.gradle
BIN
gradle/wrapper/gradle-wrapper.jar
+6
−0
gradle/wrapper/gradle-wrapper.properties
+164
−0
gradlew
+90
Thread
(server
::
stopServer));
}
4
build.gradle
Show comments
View file
Edit file
Delete file
@@ -3,7 +3,7 @@ allprojects {
apply
plugin
:
'
=
space
indent_style
=
space
indent_size
=
4
indent_size
=
4
max_line_length
=
120
max_line_length
=
120
[
scope
>
</
dependency
>
<
dependency
>
<
groupId
>org.awaitility</
groupId
>
<
artifactId
>awaitility</
artifactId
1
license is missing in artifact
#492 opened
Jul 30, 2019
by
ascheman
How one port supports both unidirectional and two-way certificate authentication for TLS
#491 opened
Jul 30, 2019
by
cnneillee
Plans to support MQTT 5?
#490 opened
Jul 23, 2019
by
mpe85
6
andsel
released this
Jun 30, 2017
·
136 commits
to master since this release
Assets
2
Source code
(zip)
Source code
(tar.gz)
Jan 18, 2017
before_sofia2
…
Jan 18, 2017
a7b8c07
zip
5
README.md
Show comments
View file
Edit file
Delete file
@@ -64,6 +64,7 @@ Include dependency in your project:
##
Build from sources
After a git clone of the repository, cd into the cloned sources and:
`mvn clean package`
.
In distribution/target directory will be produced the selfcontained tar for the broker with all dependencies and a running script.
After a git clone of the repository, cd into the cloned sources and:
`./gradlew clean distribution:distMoquetteTar`
or
<
version
>
</
version
>
</
dependency
>
<
dependency
>
<
groupId
>io.netty</
groupId
>
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more
Accept
Reject
Save preferences
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
Sign in
to your account
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
1 parent
08d3e8d
commit
0bf35a7b8da7267c726aa2148fd631da4fa07173
Unified
Split
Showing
1 changed file
with
3 additions
and
3 deletions
.
+3
−3
README.md
6
README.md
version
>0.
9-SNAPSHOT
</
version
>
<
version
>0.
8.1
</
version
>
</
parent
>
<
artifactId
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Add Ping Request handling to the interceptors
#481
Open
djbr-david
opened this issue
Jun 5, 2019
· 6 comments
Open
*
.jar
*
.war
*
.ear
@@ -43,3 +44,4 @@ broker/nb-configuration.xml
broker
/
nbactions-Server.xml
maven-metadata.xml
/
.gradle
/
10
.travis.yml
Show comments
View file
View file
Edit file
Delete file
@@ -55,7 +55,7 @@ Include dependency in your project:
<dependency>
<groupId>io.moquette</groupId>
<artifactId>moquette-broker</artifactId>
<version>0.
8.1
</version>
<version>0.
9
</version>
</dependency>
```
2
broker/pom.xml
//
compile
group
:
'
io.dropwizard.metrics
'
,
name
:
'
metrics-core
'
,
version
:
'
BinTray
](https://bintray.com/artifact/download/andsel/generic/distribution-0.
8
-bundle-tar.tar.gz) ,
Start play with it, download the self distribution tar from [
BinTray
](https://bintray.com/artifact/download/andsel/generic/distribution-0.
10
-bundle-tar.tar.gz) ,
the un untar and start the broker listening on 1883 port and enjoy!
```
tar zxf distribution-0.
8
-bundle-tar.tar.gz
tar zxf distribution-0.
10
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
−1
osgi_test/pom.xml
+1
−1
perf/pom.xml
+1
−1
pom.xml
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
3
ChangeLog.txt
Show comments
View file
Edit file
−0
gradlew.bat
+23
−0
h2_storage/build.gradle
+0
−129
h2_storage/pom.xml
+23
−0
mapdb_storage/build.gradle
+0
−129
mapdb_storage/pom.xml
+1
−1
osgi_test/README.md
+22
maven-publish
'
group
=
'
io.moquette
'
version
=
'
0.12
-SNAPSHOT
'
version
=
'
0.12
'
*
.gradle
]
indent_size
=
2
4
.gitignore
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,5 @@
/
build
*
/
build
>
<
version
>3.0.0</
version
>
<
scope
>test</
scope
>
</
dependency
>
<
Error processing protocol message: PUBACK
#483 opened
Jun 13, 2019
by
Demitrius
Subscription storage
#482 opened
Jun 12, 2019
by
BigGitWorld
Add Ping Request handling to the interceptors
#481 opened
Jun 5, 2019
by
djbr-david
6
tar.gz
v0.9
4162aae
Compare
Choose a tag to compare
Search for a tag
0.9
v0.9
4162aae
Compare
Choose a tag to compare
Search for a tag
andsel
released this
Jan 11, 2017
·
378 commits
to master since this release
`./gradlew clean distribution:distMoquetteZip`
.
In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
51
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,51 @@
description
=
'
Moquette - broker
'
apply
<
artifactId
>netty-buffer</
artifactId
>
<
version
>
</
version
>
</
dependency
>
<
dependency
>
<
👎
😄
🎉
😕
❤️
🚀
👀
MQTT SSL not working
#499 opened
Aug 20, 2019
by
francesco98
1
ProTip!
Find all open issues with in progress development work with
linked:pr
.
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Subscription storage
#482
Open
BigGitWorld
opened this issue
Jun 12, 2019
· 0 comments
Open
Subscription storage
#482
BigGitWorld
opened this issue
Jun 12, 2019
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Error processing protocol message: PUBACK
#483
Open
Demitrius
opened this issue
Jun 13, 2019
· 0 comments
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
Show comments
View file
Edit file
Delete file
@@ -25,11 +25,11 @@ Point your MQTT client to _broker.moquette.io_
##
1 minute set up
Start play with it, download the self distribution tar from [
BinTray
](https://bintray.com/artifact/download/andsel/generic/distribution-0.
10-bundle-tar
.tar
.gz
) ,
Start play with it, download the self distribution tar from [
BinTray
](https://bintray.com/artifact/download/andsel/generic/
moquette-
>moquette-broker</
artifactId
>
2
broker/src/main/java/io/moquette/server/Server.java
Show comments
View file
Edit file
Delete file
@@ -53,7 +53,7 @@
public
static
void
main
(
String
[]
args
Add Ping Request handling to the interceptors
#481
djbr-david
opened this issue
Jun 5, 2019
· 6 comments
Comments
Copy link
Quote reply
djbr-david
commented
Jun 5, 2019
•
edited
Expected behavior
Ping Request messages should be notified using the Interceptor interface. This is useful for monitoring client status.
Actual behavior
Currently Ping Requests are handled without any notification
Steps to reproduce
Edit file
Delete file
@@ -1,3 +1,13 @@
language
:
java
jdk
:
-
oraclejdk8
before_cache
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
3.2.2
'
compile
group
:
'
io.dropwizard.metrics
'
,
name
:
'
metrics-jvm
'
,
version
:
'
3.2.2
-bundle-tar.tar.gz
cd bin
./moquette.sh
```
@@ -58,7 +58,7 @@ Include dependency in your project:
<dependency>
<groupId>io.moquette</groupId>
<artifactId>moquette-broker</artifactId>
<version>0.10
-SNAPSHOT
</version>
<version>0.10</version>
</dependency>
```
2
broker/pom.xml
Show comments
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Delete file
@@ -1,3 +1,6 @@
Version 0.10:
Version 0.9:
Moved canRead check to topic from publish phase to subscribe (#144)
Added javadoc and src jars creations for JCenter/Maven central
2
README.md
Show comments
View file
Edit file
Delete file
@@ -55,7 +55,7 @@ Include dependency in your project:
<dependency>
<groupId>io.moquette</groupId>
<artifactId>moquette-broker</artifactId>
<version>0.
−0
osgi_test/build.gradle
+0
−183
osgi_test/pom.xml
+28
−38
osgi_test/src/test/java/io/moquette/test/osgi/MoquetteOsgiTest.java
+9
−0
perf/build.gradle
+0
−142
perf/pom.xml
+0
−235
pom.xml
}
buildscript
{
@@ -92,7 +92,7 @@ subprojects {
from components
.
java
groupId
"
$p
roject
.
group
"
artifactId
"
${
project.name
}
/
/
target
/
/
target
/
/
parser
/
target
/
/
parser
/
target
/
/
benchmarking
dependency
>
<
groupId
>com.h2database</
groupId
>
<
artifactId
>h2</
artifactId
>
@@ -241,6 +254,21 @@
</
goals
>
</
execution
Previous
1
2
3
Next
Previous
Next
ProTip!
Type
g
i
on any issue or pull request to go back to the issue listing page.
© 2020 GitHub, Inc.
Terms
Privacy
Move the protocol processing to concurrent FSM.
Fixes for tests
Assets
2
Source code
(zip)
Source code
(tar.gz)
Feb 3, 2016
v0.8.1
…
plugin
:
'
osgi
'
apply
plugin
:
'
maven
'
dependencies
{
compile
group
:
'
groupId
>io.netty</
groupId
>
<
artifactId
>netty-transport</
artifactId
>
<
version
>
</
version
>
</
dependency
>
<
Issues · moquette-io/moquette · GitHub
Issues · moquette-io/moquette · GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
· 0 comments
Comments
Copy link
Quote reply
BigGitWorld
commented
Jun 12, 2019
Where is moquette saving list of subscriptions?
I want to keep list of subscriptions when the moquette server is restarted.
Moquette MQTT version
Latest version
JVM version (e.g.
java -version
)
java 1.8
OS version (e.g.
uname -a
)
Open
Error processing protocol message: PUBACK
#483
Demitrius
opened this issue
Jun 13, 2019
· 0 comments
Comments
Copy link
Quote reply
Demitrius
commented
Jun 13, 2019
Expected behavior
Moquette works without exceptions when receive many (1000 for example) messages
Actual behavior
Many exceptions when client (javascript Paho) send 1000 messages in loop.
Some first (300-400 messages) was processed normal, but then exceptions.
👍
👎
😄
🎉
😕
❤️
🚀
👀
Potential Bug in NextPacketID
bug
#237 opened
Nov 29, 2016
by
peacecoder
processConnectionLost miss to remove the subscriptions of the client
question
#236 opened
🚀
👀
Significant (>90%) message loss under heavy load
#480 opened
Jun 5, 2019
by
flonix8
2
NullPointerException.I think is a bug
#473 opened
Apr 22, 2019
by
liuhanjim
3
How to forcefully disconnect the client from the broker?
#469 opened
Apr 8, 2019
distribution-0.
11
.tar) ,
the un untar and start the broker listening on
`1883`
port and enjoy!
```
tar zxf distribution-0.
10-bundle-tar
.tar
.gz
tar zxf
moquette-
distribution-0.
11
.tar
cd bin
./moquette.sh
)
throws
IOException
{
final
Server
server
=
new
Server
();
server
.
startServer();
System
.
out
Feature request
Minimal yet complete reproducer code (or URL to code) or complete log file
N/A
Moquette MQTT version
0.12.1
JVM version (e.g.
java -version
)
Any
OS version (e.g.
uname -a
)
:
directories
:
-
$HOME/.gradle/caches/
-
$HOME/.gradle/wrapper/
script
:
-
./gradlew install test
>
<
version
>0.9
-SNAPSHOT
</
version
>
<
version
>0.9</
version
>
'
compile
group
:
'
com.librato.metrics
'
,
name
:
'
metrics-librato
'
,
version
:
'
5.1.0
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
9
</version>
<version>0.
10-SNAPSHOT
</version>
</dependency>
```
2
broker/pom.xml
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
<
relativePath
>../</
+16
−0
settings.gradle
3
.editorconfig
Show comments
View file
Edit file
Delete file
@@ -11,3 +11,6 @@ charset = utf-8
indent_style
=
space
indent_size
=
"
version
'
0.12
-SNAPSHOT
'
version
'
0.12
'
}
}
}
2
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
/
target
/
/
benchmarking
/
target
/
@@ -31,7 +33,6 @@ broker/runner
.mtj.tmp
/
.mtj.tmp
/
#
Package Files #
#
Package Files #
*
.jar
>
</
executions
>
<
configuration
>
<
instructions
>
<
Export-Package
>
io.moquette.persistence,
io.moquette.server.config,
io.moquette.spi,
io.moquette.spi.impl.subscriptions,
</
Export-Package
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Feb 3, 2016
5e680b6
zip
tar.gz
Previous
Next
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
io.netty
'
,
name
:
'
netty-common
'
,
version
: nettyVersion
compile
group
:
'
dependency
>
<
groupId
>io.netty</
groupId
>
<
artifactId
>netty-handler</
artifactId
>
<
version
>
</
version
>
</
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Linux Ubuntu 16.04
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Steps to reproduce
Run Moquette.
Run javacript code in browser (Paho lib required)
Part of code:
Minimal yet complete reproducer code (or URL to code) or complete log file
Log with exception attached
mqtt-log.log
Moquette MQTT version
version 0.13-SNAPSHOT
JVM version (e.g.
java -version
)
openjdk version "11.0.3" 2019-04-16 LTS
OpenJDK Runtime Environment 18.9 (build 11.0.3+7-LTS)
OpenJDK 64-Bit Server VM 18.9 (build 11.0.3+7-LTS, mixed mode, sharing)
OS version (e.g.
uname -a
)
Nov 18, 2016
by
shuzhongling
1
republishing messages fails....
bug
#234 opened
Nov 17, 2016
by
windbender
7
checkHeaderAvailability don't check max remaininglength
#217 opened
Oct 12, 2016
by
beyondfengyu
1
when protocol processor is inited with ssl port the word "disabled" is used to indicate the server name
by
giri110890
9
Netty Leak Detection.
#467 opened
Apr 4, 2019
by
kopens
1
failed to allocate 16777216 byte(s) of direct memory
#466 opened
Apr 4, 2019
by
FengXMGeek
3
Deploy -javadoc and -source jars
#465 opened
```
@@ -66,7 +66,7 @@ Include dependency in your project:
<dependency>
<groupId>io.moquette</groupId>
<artifactId>moquette-broker</artifactId>
<version>0.
10
</version>
<version>0.
11
</version>
</dependency>
```
Toggle all file notes
0 comments on commit
0bf35a7
Please
How one port supports both unidirectional and two-way certificate authentication for TLS · Issue #491 · moquette-io/moquette · GitHub
.
println(
"
Server started, version 0.
9-SNAPSHOT
"
);
System
.
out
.
println(
"
Server started, version 0.
8.1
"
);
//
Any
Copy link
Collaborator
andsel
commented
Jun 7, 2019
Hi, why ping requests should be notified with interceptors, which is the use case for an application that embed Moquette to know each ping from every connected client? Il mer 5 giu 2019, 13:23 David Brooks <notifications@github.com> ha scritto:
…
Expected behavior Ping Request messages should be notified using the Interceptor interface Actual behavior Currently Ping Requests are handled without any notification Steps to reproduce Feature request Minimal yet complete reproducer code (or URL to code) or complete log file N/A Moquette MQTT version 0.12.1 JVM version (e.g. java -version) Any OS version (e.g. uname -a) Any — You are receiving this because you are subscribed to this thread. Reply to this email directly, view it on GitHub <
#481
?email_source=notifications&email_token=AAH5RUNUSONGCDO5AHH4MTDPY6O4JA5CNFSM4HTVVFCKYY3PNVWWK3TUL52HS4DFUVEXG43VMWVGG33NNVSW45C7NFSM4GXX2EOQ>, or mute the thread <
https://github.com/notifications/unsubscribe-auth/AAH5RUPXSIN4F4QXRY66WUTPY6O4JANCNFSM4HTVVFCA
> .
Copy link
Author
djbr-david
commented
5
README.md
Show comments
View file
Edit file
Delete file
@@ -64,6 +64,7 @@ Include dependency in your project:
##
Build from sources
After a git clone of the repository, cd into the cloned sources and:
`mvn clean package`
.
</
parent
>
<
artifactId
>moquette-broker</
artifactId
>
2
broker/src/main/java/io/moquette/server/Server.java
Show comments
View file
Edit file
Delete file
@@ -68,7 +68,7 @@
public
static
license is missing in artifact · Issue #492 · moquette-io/moquette · GitHub
'
compile
group
:
'
com.librato.metrics
'
,
name
:
'
librato-java
'
,
version
:
'
2.1.0
<
version
>0.10
-SNAPSHOT
</
version
>
<
version
>0.10</
version
>
</
parent
>
<
artifactId
>moquette-broker</
artifactId
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.
9
</
4
max_line_length
=
120
[
*
.gradle
]
indent_size
=
2
4
.gitignore
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,5 @@
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.12
-SNAPSHOT
"
echo
*
.war
*
.war
*
.ear
*
.ear
@@ -43,3 +44,4 @@ broker/nb-configuration.xml
broker
/
nbactions-Server.xml
broker
/
nbactions-Server.xml
maven-metadata.xml
>
<
Embed-Dependency
>
com.bugsnag;bugsnag,
com.librato.metrics;metrics-librato,
com.librato.metrics;librato-java,
</
Embed-Dependency
>
</
instructions
>
</
configuration
>
</
plugin
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
io.netty
'
,
name
:
'
netty-buffer
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
dependency
>
<
dependency
>
<
groupId
>io.netty</
groupId
>
<
artifactId
>netty-codec</
artifactId
>
<
version
>
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Connection dropped when publishing message with payload greater 8KB. · Issue #503 · moquette-io/moquette · GitHub
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Linux dev.cwt.local 4.1.12-124.26.10.el7uek.x86_64
#2
SMP Fri Apr 19 18:00:11 PDT 2019 x86_64 x86_64 x86_64 GNU/Linux
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
#209 opened
Sep 15, 2016
by
windbender
Intermittent concurrentModificationExceptions
bug
#208 opened
Sep 14, 2016
by
kjayashankar
1
Server API to get subscriptions information
feature req
#207 opened
Sep 14, 2016
by
teranisi
3
Apr 1, 2019
by
joker1
distribute
#458 opened
Mar 18, 2019
by
dqqzj
7
MQTT durable subscription exception
bug
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
0.13
1
InterceptAcknowledgedMessage.StoredMessage is inaccessible
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
() {
@Override
2
distribution/pom.xml
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
Jun 7, 2019
Hi. The use case is purely from an Application Support view. Operationally these messages don’t do anything, but support teams like to see this sort of thing as confirmation that the client is still connected, still sending data and isn’t in some zombie state. In our app we have a status page for the broker showing the latest messages received and knowing pingreq is still happening is a useful feature for the support team
Copy link
Collaborator
andsel
commented
Jun 8, 2019
Hi
@djbr-david
I understand you requirements, we could have 2 solutions, in my opinion:
make the interceptors aware of the ping from client, but in a configurable manner, with a configuration property to switch on startup.
notify only when a client is not anymore alive which means connection closed or failed ping
In distribution/target directory will be produced the selfcontained tar for the broker with all dependencies and a running script.
After a git clone of the repository, cd into the cloned sources and:
`./gradlew clean distribution:distMoquetteTar`
or
`./gradlew clean distribution:distMoquetteZip`
.
In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
51
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,51 @@
description
=
'
void
main
(
String
[]
args
)
throws
IOException
{
final
Server
server
=
new
Server
();
server
.
Plans to support MQTT 5? · Issue #490 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
'
compile
group
:
'
com.bugsnag
'
,
name
:
'
bugsnag
'
,
version
:
'
[3.0,4.0)
>
2
broker/src/main/java/io/moquette/server/Server.java
Show comments
View file
Edit file
Delete file
@@ -74,7 +74,7 @@
public
static
void
main
(
String
[]
args
)
throws
version
>
<
version
>0.
10-SNAPSHOT
</
version
>
</
parent
>
<
artifactId
>moquette-broker</
artifactId
>
2
/
build
*
/
build
/
/
target
/
/
parser
/
target
/
"
version: 0.12
"
set
"
CURRENT_DIR
=
%cd%
"
if
maven-metadata.xml
/
.gradle
/
10
.travis.yml
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,13 @@
>
</
plugins
>
</
build
>
11
broker/src/test/java/io/moquette/server/ServerIntegrationSSLClientAuthTest.java
Show comments
View file
Edit file
Delete file
@@ -40,6 +40,7 @@
import
org.eclipse.paho.client.mqttv3.MqttException
;
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
name
:
'
netty-transport
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
</
version
>
</
dependency
>
<
dependency
>
<
groupId
>io.netty</
groupId
>
<
artifactId
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Repeating receiving non clear session messages.
bug
#197 opened
Aug 11, 2016
by
stayclean
1
Authentication interface should return Optional< Principal>
feature req
#176 opened
May 6, 2016
by
windbender
2
Allow for multiple server side clients to share a topic with queue behavior...
feature req
#158 opened
#444 opened
Jan 14, 2019
by
austinw-fineart
0.13
3
getSubscriptions() always return an Empty list
#438 opened
Nov 19, 2018
by
abdollahpour
Publish Failed Acknowledgment
#433 opened
Oct 22, 2018
by
BigGitWorld
Abnormal disconnection of the connection will result in InterceptHandler.onConnectionLost() called twice
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
<!--
<relativePath>../pom.xml</relativePath>
-->
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.
9-SNAPSHOT
</
Subscription breaks during performance test · Issue #505 · moquette-io/moquette · GitHub
Personally i prefer the second one, because the broker doesn't flood too much notification to the interceptors.
Would you like to provide an PR with this? In case remember to cover it with unit tests
Copy link
Author
djbr-david
commented
Jul 1, 2019
Hi - apologies for not replying earlier, I didn't see your second message until just now. I'll take a look at adding both options to the project to provide the most flexibility.
Copy link
Author
djbr-david
commented
Jul 2, 2019
Thinking of option 2 again, isn't that already covered by the use of the onDisconnect and onConnectionLost interceptors?
Copy link
Moquette - broker
'
apply
plugin
:
'
osgi
'
apply
plugin
:
'
maven
'
dependencies
{
compile
startServer();
System
.
out
.
println(
"
Server started, version 0.9
-SNAPSHOT
"
);
System
.
out
.
println(
"
Server started, version 0.9
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
'
compile
group
:
'
commons-codec
'
,
name
:
'
commons-codec
'
,
version
:
'
1.10
'
IOException
{
final
Server
server
=
new
Server
();
server
.
startServer();
System
.
out
.
println(
"
broker/src/main/java/io/moquette/server/Server.java
Show comments
View file
Edit file
Delete file
@@ -68,7 +68,7 @@
public
static
void
main
(
String
[]
args
)
throws
IOException
{
/
benchmarking
/
target
/
@@ -31,7 +33,6 @@ broker/runner
.mtj.tmp
/
#
Package Files #
*
.jar
*
.war
*
.ear
@@ -43,3 +44,4 @@ broker/nb-configuration.xml
broker
not
"
%MOQUETTE_HOME%
"
==
"
"
goto
gotHome
2
distribution/src/main/scripts/moquette.sh
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
language
:
java
language
:
java
jdk
:
jdk
:
-
oraclejdk8
-
oraclejdk8
before_cache
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
import
org.eclipse.paho.client.mqttv3.persist.MqttDefaultFilePersistence
;
import
org.junit.After
;
import
org.junit.AfterClass
;
import
org.junit.Before
;
import
org.junit.BeforeClass
;
import
org.junit.Test
;
@@ -113,11 +114,21 @@
,
name
:
'
netty-handler
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
>netty-codec-http</
artifactId
>
<
version
>
</
version
>
</
dependency
>
<
dependency
>
<
groupId
>io.netty</
groupId
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Issues · moquette-io/moquette · GitHub
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Issues · moquette-io/moquette · GitHub
Mar 4, 2016
by
redboy1972
4
Avoid OutOfMemory error
feature req
#141 opened
Jan 17, 2016
by
andsel
0.9
3
[FR]Moquette clusters
feature req
#131 opened
Dec 11, 2015
by
pabloa
#430 opened
Sep 20, 2018
by
CoderBigL
ConcurrentModificationException while stress testing
invalid
#427 opened
Aug 9, 2018
by
rakechan
2
In BytesMetrics wroteBytes always return 0
#425 opened
Jul 27, 2018
by
mjpatelsls
1
Memory grows infinitely when Qos set 2
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
version
>
<
version
>0.
8.1
</
version
>
</
parent
>
<
artifactId
>distribution</
artifactId
>
2
embedding_moquette/pom.xml
Show comments
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
BrokerInterceptor thread pool never closing on serverStop · Issue #506 · moquette-io/moquette · GitHub
Collaborator
andsel
commented
Jul 2, 2019
Yes, you are right! good catch
…
On Tue, Jul 2, 2019 at 4:58 PM David Brooks ***@***.***> wrote: Thinking of option 2 again, isn't that already covered by the use of the onDisconnect and onConnectionLost interceptors? — You are receiving this because you commented. Reply to this email directly, view it on GitHub <
#481
?email_source=notifications&email_token=AAH5RULVP6SLZ3GDQVXXBT3P5NUINA5CNFSM4HTVVFCKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGODZBR3QI#issuecomment-507715009>, or mute the thread <
https://github.com/notifications/unsubscribe-auth/AAH5RULH77JBO23CXOPAHULP5NUINANCNFSM4HTVVFCA
group
:
'
io.netty
'
,
name
:
'
netty-common
'
,
version
: nettyVersion
compile
group
:
'
io.netty
"
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
() {
@Override
2
distribution/pom.xml
Show comments
View file
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
//
compile group: 'org.hdrhistogram', name: 'HdrHistogram', version:'2.1.4'
compile
group
:
'
com.hazelcast
'
,
name
:
'
hazelcast
'
,
version
:
'
Server started, version 0.10
-SNAPSHOT
"
);
System
.
out
.
println(
"
Server started, version 0.10
"
);
//
final
Server
server
=
new
Server
();
server
.
startServer();
System
.
out
.
println(
"
Server started, version 0.
/
nbactions-Server.xml
maven-metadata.xml
/
.gradle
/
10
.travis.yml
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,13 @@
language
:
java
jdk
| |
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.12
-SNAPSHOT
"
echo
"
version: 0.12
"
cd
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache
:
directories
:
-
$HOME/.gradle/caches/
-
$HOME/.gradle/wrapper/
script
:
-
./gradlew install test
IMqttClient
m_client;
MessageCollector
m_callback;
static
String
backup;
@BeforeClass
public
static
void
:
'
netty-codec
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
>
<
artifactId
>netty-codec-mqtt</
artifactId
>
<
version
>
</
version
>
</
dependency
>
<
dependency
>
<
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
0.9
19
Retained message with QoS 0
#125 opened
Nov 11, 2015
by
env3d
5
Previous
1
2
3
Next
Previous
Next
ProTip!
Find all open issues with in progress development work with
#423 opened
Jul 10, 2018
by
zhengyangyong
3
The server throws an exception when the message is received
#406 opened
Jun 4, 2018
by
ma-yadong
3
client can't reconnect to the broker once exception happened inner processSubscribe()
#388 opened
Feb 6, 2018
by
fjcyue
6
Will Message lost if client reconnect before server clear the old connection
Issues · moquette-io/moquette · GitHub
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
Fix a bug Session#resendInflightNotAcked() fails due to handling a freed ByteBuf by komamitsu · Pull Request #464 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
> .
djbr-david
pushed a commit to djbr-david/moquette that referenced this issue
Jul 2, 2019
Issue
moquette-io#481
- Moquette. Add Ping Request handling to the in…
…
eb2b64e
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
'
,
name
:
'
netty-buffer
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
Edit file
Delete file
@@ -6,7 +6,7 @@
<!--
<relativePath>../pom.xml</relativePath>
-->
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
3.5.4
'
testCompile
group
:
'
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
'
,
version
:
'
1.12
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
(server
::
stopServer));
}
2
distribution/pom.xml
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
9
"
);
System
.
out
.
println(
"
Server started, version 0.
10-SNAPSHOT
"
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
:
-
oraclejdk8
before_cache
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache
:
directories
:
-
$HOME/.gradle/caches/
-
$HOME/.gradle/wrapper/
script
:
"
$(
dirname
"
$0
"
)
"
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
@GrabResolver
(
name
5
README.md
Show comments
View file
Edit file
Delete file
@@ -64,6 +64,7 @@ Include dependency in your project:
##
Build from sources
##
Build from sources
After a git clone of the repository, cd into the cloned sources and:
`mvn clean package`
.
After a git clone of the repository, cd into the cloned sources and:
`./gradlew clean distribution:distMoquetteTar`
beforeTests
() {
String
tmpDir
=
System
.
getProperty(
"
java.io.tmpdir
"
);
s_dataStore
=
new
MqttDefaultFilePersistence
(tmpDir);
backup
=
'
netty-codec-http
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-codec-mqtt
'
groupId
>io.netty</
groupId
>
<
artifactId
>netty-transport-native-epoll</
artifactId
>
<
version
>
</
version
>
<
classifier
>linux-x86_64</
classifier
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
moquette/.gitignore at e8b105fa90a032cda9794511e0c1db1b932987e6 · moquette-io/moquette · GitHub
Issues · moquette-io/moquette · GitHub
Issues · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
linked:pr
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
#366 opened
Oct 22, 2017
by
fjcyue
1
1
cannot make a distinction between bad user and not authorized when connect
#359 opened
Sep 5, 2017
by
rongwei84n
2
Netty Leak Detection
#356 opened
Aug 31, 2017
by
somejavadev
1
Issues · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
<
version
>0.
9-SNAPSHOT
</
version
>
<
version
>0.
8.1
</
version
>
</
parent
>
<
artifactId
moquette/.travis.yml at e8b105fa90a032cda9794511e0c1db1b932987e6 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
2 participants
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
'
netty-transport
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-handler
'
,
>0.9
-SNAPSHOT
</
version
>
<
version
>0.9</
version
>
</
parent
>
<
artifactId
>distribution</
artifactId
>
2
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
'
testCompile
group
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
<!--
<relativePath>../pom.xml</relativePath>
-->
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.10
-SNAPSHOT
</
.
addShutdownHook(
new
Thread
() {
@Override
2
distribution/pom.xml
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
<!--
<relativePath>../pom.xml</relativePath>
-->
<
-
./gradlew install test
5
README.md
Show comments
View file
Edit file
Delete file
@@ -64,6 +64,7 @@ Include dependency in your project:
##
Build from sources
After a git clone of the repository, cd into the cloned sources and:
`mvn clean package`
.
In distribution/target directory will be produced the selfcontained tar for the broker with all dependencies and a running script.
After a git clone of the repository, cd into the cloned sources and:
`./gradlew clean distribution:distMoquetteTar`
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
'
io.moquette
'
or
In distribution/target directory will be produced the selfcontained tar for the broker with all dependencies and a running script.
`./gradlew clean distribution:distMoquetteZip`
.
In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
51
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,51 @@
description
=
'
System
.
getProperty(
"
moquette.path
"
);
}
@AfterClass
public
static
void
afterTests
() {
if
(backup
==
null
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-transport-native-epoll
'
,
version
: nettyVersion,
>
<!--
-->
</
dependency
>
<
dependency
>
<
groupId
>io.dropwizard.metrics</
groupId
>
<
artifactId
>metrics-core</
artifactId
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Authorizator based on client Certificate information
#328 opened
Jun 15, 2017
by
edenmob
1
Message size >64kB is not handled via Websocket connection.
#319 opened
May 25, 2017
by
raipratheek
1
if unchecked exception is throw while running processSubscription then remove() will never be called
#316 opened
May 19, 2017
by
windbender
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Release v0.13 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
>moquette-embedded-test</
artifactId
>
2
netty_parser/pom.xml
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Make the number of Netty worker threads number configurable by komamitsu · Pull Request #468 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-codec
'
,
version
: nettyVersion
compile
group
embedding_moquette/pom.xml
Show comments
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
'
1.0.2
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
version
>
<
version
>0.10</
version
>
</
parent
>
<
artifactId
>distribution</
artifactId
>
2
embedding_moquette/pom.xml
Show comments
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.
9
</
version
>
<
version
or
`./gradlew clean distribution:distMoquetteZip`
.
In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
51
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,51 @@
description
=
'
Moquette - broker
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.12
-SNAPSHOT
'
)
@Grab
(
group
=
'
Moquette - broker
'
apply
plugin
:
'
osgi
'
apply
plugin
:
'
maven
'
dependencies
{
compile
group
)
System
.
clearProperty(
"
moquette.path
"
);
else
System
.
setProperty(
"
moquette.path
"
, backup);
}
classifier
:
'
linux-x86_64
'
//
compile
group
:
'
io.dropwizard.metrics
'
,
name
:
'
metrics-core
'
>
<
version
>3.2.2</
version
>
</
dependency
>
<
dependency
>
<
groupId
>io.dropwizard.metrics</
groupId
>
<
artifactId
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
java.lang.ClassCastException: io.netty.handler.codec.http.HttpObjectAggregator$AggregatedFullHttpRequest cannot be cast to io.moquette.parser.proto.messages.AbstractMessage
#290 opened
Mar 23, 2017
by
leesangboo
7
Exception: java.lang.NoClassDefFoundError: org/mapdb/DBMaker
#248 opened
Jan 5, 2017
by
ThomasSchemmer
3
Previous
1
2
3
Next
Pull requests · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Moquette & 2-way SSL authentication · Issue #508 · moquette-io/moquette · GitHub
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Bumped release 0.13 (#523) · moquette-io/moquette@3b83f47 · GitHub
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
How one port supports both unidirectional and two-way certificate authentication for TLS
#491
Open
cnneillee
opened this issue
Jul 30, 2019
· 0 comments
Open
How one port supports both unidirectional and two-way certificate authentication for TLS
#491
cnneillee
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.
9-SNAPSHOT
</
version
>
<
version
>0.
8.1
</
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
:
'
io.netty
'
,
name
:
'
netty-codec-http
'
,
version
: nettyVersion
compile
group
:
'
io.netty
<
groupId
>io.moquette</
groupId
>
<
version
>0.9
-SNAPSHOT
</
version
>
<
version
>0.9</
version
>
</
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
license is missing in artifact
#492
Open
ascheman
9.2.0.M1
'
testCompile
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>0.
10-SNAPSHOT
</
version
>
</
parent
>
<
artifactId
>distribution</
artifactId
>
2
embedding_moquette/pom.xml
Show comments
apply
plugin
:
'
osgi
'
apply
plugin
:
'
maven
'
dependencies
{
compile
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.12
'
)
import
io.moquette.server.Server
:
'
io.netty
'
,
name
:
'
netty-common
'
,
version
: nettyVersion
compile
group
:
'
protected
void
startServer
()
throws
IOException
{
12
broker/src/test/java/io/moquette/server/ServerIntegrationSSLTest.java
Show comments
View file
Edit file
Delete file
@@ -41,6 +41,7 @@
import
org.eclipse.paho.client.mqttv3.persist.MemoryPersistence
;
import
,
version
:
'
3.2.2
'
compile
group
:
'
io.dropwizard.metrics
'
,
name
:
'
metrics-jvm
>metrics-jvm</
artifactId
>
<
version
>3.2.2</
version
>
</
dependency
>
<
dependency
>
<
groupId
>com.librato.metrics</
groupId
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Connection dropped when publishing message with payload greater 8KB.
#503
Open
r-t-s
opened this issue
Aug 30, 2019
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Previous
Next
ProTip!
What’s not been updated in a month:
updated:<2020-09-22
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Will it be compatible with Graalvm in the future? · Issue #509 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
opened this issue
Jul 30, 2019
· 0 comments
Comments
Copy link
Quote reply
cnneillee
commented
Jul 30, 2019
Hello
I have a question
How one port supports both unidirectional and two-way certificate authentication for TLS？
thank you!
Sign up for free
to join this conversation on GitHub
. Already have an account?
version
>
</
parent
>
<
artifactId
>moquette-netty-parser</
artifactId
>
2
parser_commons/pom.xml
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
'
,
name
:
'
netty-codec-mqtt
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
parent
>
<
artifactId
>moquette-embedded-test</
artifactId
>
2
netty_parser/pom.xml
Show comments
View file
Edit file
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
opened this issue
Jul 30, 2019
· 0 comments
Open
license is missing in artifact
#492
ascheman
opened this issue
Jul 30, 2019
· 0 comments
Comments
:
'
1.4.191
'
}
task
createPom
() {
.
writeTo(
"
build/pom.xml
"
)
}
jar
{
manifest {
>io.moquette</
groupId
>
<
version
>0.10
-SNAPSHOT
</
version
>
<
version
>0.10</
version
>
</
parent
>
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
group
:
'
io.netty
'
,
name
:
'
netty-common
'
,
version
: nettyVersion
compile
group
:
'
io.netty
Toggle all file notes
0 comments on commit
3080050
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
io.netty
'
,
name
:
'
netty-buffer
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
org.eclipse.paho.client.mqttv3.persist.MqttDefaultFilePersistence
;
import
org.junit.After
;
import
org.junit.AfterClass
;
import
org.junit.Before
;
import
org.junit.BeforeClass
;
import
org.junit.Test
;
@@ -60,10 +61,21 @@
IMqttClient
'
,
version
:
'
3.2.2
'
compile
group
:
'
com.librato.metrics
'
,
name
:
'
>
<
artifactId
>metrics-librato</
artifactId
>
<
version
>5.1.0</
version
>
</
dependency
>
<
dependency
>
<
groupId
❤️
🚀
👀
Error processing protocol message: PUBACK
#483 opened
Jun 13, 2019
by
Demitrius
ProTip!
What’s not been updated in a month:
updated:<2020-09-22
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
🎉
😕
❤️
🚀
👀
Add Ping Request handling to the interceptors
#481 opened
Jun 5, 2019
by
djbr-david
6
ProTip!
Updated in the last three days:
updated:>2020-10-19
.
© 2020 GitHub, Inc.
Terms
· 0 comments
Open
Connection dropped when publishing message with payload greater 8KB.
#503
r-t-s
opened this issue
Aug 30, 2019
· 0 comments
Comments
Copy link
Quote reply
r-t-s
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.
9-SNAPSHOT
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Subscription breaks during performance test
#505
Open
JinseonyLee
opened this issue
Oct 4, 2019
· 1 comment
Open
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
:
'
netty-transport-native-epoll
'
,
version
: nettyVersion,
classifier
:
'
linux-x86_64
'
//
compile
group
:
'
io.dropwizard.metrics
Delete file
@@ -6,7 +6,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
Plans to support MQTT 5?
#490
Open
mpe85
opened this issue
Jul 23, 2019
· 6 comments
Open
Plans to support MQTT 5?
#490
mpe85
opened this issue
Jul 23, 2019
· 6 comments
Comments
Copy link
Quote reply
mpe85
Copy link
Quote reply
ascheman
commented
Jul 30, 2019
Please add the license file to the released artifact.
This makes usage of the broker much easier when using license checkers like WhiteSource.
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
instruction
'
Bundle-Description
'
,
'
Moquette lightweight MQTT Broker
'
instruction
'
Bundle-License
'
,
'
http://www.apache.org/licenses/LICENSE-2.0.txt, http://www.eclipse.org/org/documents/epl-v10.php
'
instruction
'
<
artifactId
>moquette-embedded-test</
artifactId
>
2
h2_storage/pom.xml
Show comments
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
version
>0.
9
</
version
>
<
version
>0.
10-SNAPSHOT
</
version
>
</
parent
>
<
artifactId
'
,
name
:
'
netty-buffer
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
name
:
'
netty-transport
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-handler
m_client;
MessageCollector
m_callback;
static
String
backup;
@BeforeClass
public
static
void
beforeTests
() {
String
tmpDir
=
System
.
metrics-librato
'
,
version
:
'
5.1.0
'
compile
group
:
'
com.librato.metrics
'
,
name
:
>com.librato.metrics</
groupId
>
<
artifactId
>librato-java</
artifactId
>
<
version
>2.1.0</
version
>
</
dependency
>
<
dependency
>
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
commented
Aug 30, 2019
Expected behavior
Connection Disconnected when publishing a JSON string 9000 characters long. Works for 8000 characters. Works on mosquito.
Actual behavior
Steps to reproduce
Minimal yet complete reproducer code (or URL to code) or complete log file
Moquette MQTT version
0.12.1 and 0.12
error.log
JVM version (e.g.
java -version
)
java version "1.8.0_172"
Java(TM) SE Runtime Environment (build 1.8.0_172-b11)
OS version (e.g.
uname -a
)
Windows 10
1
Labels
7
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
5
Labels
7
Milestones
5
New issue
Have a question about this project?
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
Moquette shows topics, but subscribers won't receive anything - Subscription missing? · Issue #510 · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
</
version
>
<
version
>0.
8.1
</
version
>
</
parent
>
<
artifactId
>moquette-parser-commons</
artifactId
>
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Subscription breaks during performance test
#505
JinseonyLee
opened this issue
Oct 4, 2019
· 1 comment
Comments
Copy link
Quote reply
JinseonyLee
commented
Oct 4, 2019
•
edited
Hi,
I tested mqtt server with moquette 0.12.1 version with H2.
I sent 1 message/per sec with 2 ~ 3000 clients.
Already on GitHub?
Sign in
to your account
Jump to bottom
BrokerInterceptor thread pool never closing on serverStop
#506
Open
bobrowskim
opened this issue
Oct 9, 2019
· 0 comments
Open
BrokerInterceptor thread pool never closing on serverStop
#506
bobrowskim
opened this issue
Oct 9, 2019
· 0 comments
'
,
name
:
'
metrics-core
'
,
version
:
'
3.2.2
'
compile
group
:
'
io.dropwizard.metrics
<
version
>0.9
-SNAPSHOT
</
version
>
<
version
>0.9</
version
>
</
parent
>
<
artifactId
commented
Jul 23, 2019
Are there any plans to support the latest specification version 5?
Copy link
Collaborator
andsel
commented
Jul 23, 2019
Yes I'm working on it, in my spare time. Andrea
…
On Tue, Jul 23, 2019 at 8:57 AM mpe85 ***@***.***> wrote: Are there any plans to support the latest specification version 5? — You are receiving this because you are subscribed to this thread. Reply to this email directly, view it on GitHub <
#490
?email_source=notifications&email_token=AAH5RULSU5MYI3ASVS4FETTQA2TWFA5CNFSM4IGAUTOKYY3PNVWWK3TUL52HS4DFUVEXG43VMWVGG33NNVSW45C7NFSM4HA2ZNLQ>, or mute the thread <
https://github.com/notifications/unsubscribe-auth/AAH5RULZOSLBDZAXBJOW673QA2TWFANCNFSM4IGAUTOA
> .
👍
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Import-Package
'
,
'
!com.codahale.metrics*, !com.bugsnag*, !com.librato.metrics*, *
'
}
into (
"
META-INF/maven/io.moquette/
${
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
>moquette-embedded-test</
artifactId
>
2
netty_parser/pom.xml
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
<
name
:
'
netty-transport
'
,
version
: nettyVersion
compile
group
:
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
getProperty(
"
java.io.tmpdir
"
);
s_dataStore
=
new
MqttDefaultFilePersistence
(tmpDir);
backup
'
librato-java
'
,
version
:
'
2.1.0
'
compile
group
<
groupId
>com.bugsnag</
groupId
>
<
artifactId
>bugsnag</
artifactId
>
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
e8b105fa90
moquette
/
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Reject
Save preferences
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
2
pom.xml
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
<
artifactId
>moquette-parent</
artifactId
>
<
packaging
>pom</
packaging
>
<
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
e8b105fa90
moquette
/
.travis.yml
Go to file
Go to file
T
Go to line
L
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Fix a bug Session#resendInflightNotAcked() fails due to handling a freed ByteBuf
#464
Open
komamitsu
wants to merge
2
commits into
moquette-io
When I first started testing, then It was done properly.
But, when all clients are disconnected and restarted testing, It can't use internalPublish methods.
It is the error log below.
I checked the subscription tree trace log.
When the exception occured, the subscription suddenly changed from CNode to TNode.
I added log to check Node type and token value in CTrie.java
Is there any way to solve this situation?
Copy link
Author
JinseonyLee
commented
Dec 10, 2019
I found a solution.
In performance test, it is processed in Tnode format in CTrie.java's recursiveMatch methods.
NullPointerException is not thrown if the source is changed as follows:
It just changes the order of processing.
Before
Comments
Copy link
Quote reply
bobrowskim
commented
Oct 9, 2019
•
edited
Expected behavior
When using moquette-io as embedded broker in application when invoking method
stopServer
from class
Server
it would be expected that all related threads are closing.
Actual behavior
Invoking
stopServer
from class
'
,
name
:
'
metrics-jvm
'
,
version
:
'
3.2.2
'
compile
group
:
'
com.librato.metrics
>moquette-netty-parser</
artifactId
>
2
osgi_test/pom.xml
Show comments
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
1
🎉
1
Copy link
Author
mpe85
commented
Jul 23, 2019
Thats great to hear :-)
Thanks for the quick answer.
Copy link
Collaborator
andsel
commented
Jul 23, 2019
Your're welcome, but the implementation will take time;-) Andrea
…
On Tue, Jul 23, 2019 at 9:06 AM mpe85 ***@***.***> wrote: Thats great to hear :-) Thanks for the quick answer. — You are receiving this because you commented. Reply to this email directly, view it on GitHub <
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
project.name
}
"
){
from
"
build/pom.xml
"
}
}
jar
.
dependsOn createPom
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
version
>0.10
-SNAPSHOT
</
version
>
<
version
>0.10</
version
>
</
parent
>
<
artifactId
>moquette-h2-storage</
artifactId
>
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.
9
'
io.netty
'
,
name
:
'
netty-handler
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
Learn more
Accept
Reject
Save preferences
name
:
'
netty-codec
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-codec-http
=
System
.
getProperty(
"
moquette.path
"
);
}
@AfterClass
public
static
void
afterTests
() {
if
(backup
==
:
'
com.bugsnag
'
,
name
:
'
bugsnag
'
,
version
:
'
[3.0,4.0)
'
compile
group
:
<
version
>[3.0,4.0)</
version
>
</
dependency
>
<
dependency
>
<
groupId
>commons-codec</
groupId
>
<
artifactId
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
.gitignore
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
47 lines (42 sloc)
716 Bytes
Raw
Blame
/
build
*
/
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Releases
Tags
v0.13
3b83f47
Compare
Choose a tag to compare
Search for a tag
v0.13
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Learn more
Accept
Reject
Save preferences
version
>0.
9-SNAPSHOT
</
version
>
<
version
>0.
8.1
</
version
>
<
name
>Moquette MQTT parent</
name
Copy path
Cannot retrieve contributors at this time
13 lines (12 sloc)
276 Bytes
Raw
Blame
language
:
java
jdk
:
-
oraclejdk8
before_cache
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
:
master
base:
master
from
komamitsu
:
wrong-netty-buf-ref-cnt
Open
Fix a bug Session#resendInflightNotAcked() fails due to handling a freed ByteBuf
#464
komamitsu
wants to merge
2
commits into
moquette-io
:
master
TO-BE
hylkevds
mentioned this issue
May 25, 2020
NullPointerException in CTrie.evaluate
#529
Open
hylkevds
added a commit to hylkevds/moquette that referenced this issue
Aug 13, 2020
Fixes
moquette-io#529
,
moquette-io#505
: NPE caused by matching on a T…
…
Server
does not call to stop
BrokerInterceptor
thus the threads pool it created is never shutdown and some thread is kept in awaiting state. This leads to application hang running.
Steps to reproduce
Start
Server
Connect client to server, publish and subscribe to some topics
Stop server
Server.stopServer
Thread pool created by
BrokerInterceptor
is still in waiting state
Application never stops.
Minimal yet complete reproducer code (or URL to code) or complete log file
Here is sample code
Run class
'
,
name
:
'
metrics-librato
'
,
version
:
'
5.1.0
'
compile
group
:
'
com.librato.metrics
'
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.9
-SNAPSHOT
</
version
>
<
version
>0.9</
#490
?email_source=notifications&email_token=AAH5RUIY2SGOD3RP6TA2XALQA2UWTA5CNFSM4IGAUTOKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOD2SELWI#issuecomment-514082265>, or mute the thread <
https://github.com/notifications/unsubscribe-auth/AAH5RUK5SNWNBPUWJOMKXLTQA2UWTANCNFSM4IGAUTOA
> .
Copy link
MuhammadMattiullah
commented
Sep 20, 2019
Hello Andsel, is it supporting mqtt v5 ?
Copy link
Collaborator
andsel
commented
Sep 20, 2019
Hi Muhammad not at the moment, it's still work in progress. Andrea
…
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
2
mapdb_storage/pom.xml
Show comments
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
</
version
>
<
version
>0.
10-SNAPSHOT
</
version
>
</
parent
>
<
artifactId
>moquette-netty-parser</
artifactId
>
2
,
name
:
'
netty-codec
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-codec-mqtt
'
,
null
)
System
.
clearProperty(
"
moquette.path
"
);
else
System
.
setProperty(
"
moquette.path
"
, backup);
}
'
commons-codec
'
,
name
:
'
commons-codec
'
,
version
:
'
1.10
'
//
compile group: 'org.hdrhistogram', name: 'HdrHistogram', version:'2.1.4'
compile
>commons-codec</
artifactId
>
<
version
>1.10</
version
>
</
dependency
>
<!--
<dependency>
-->
<!--
<groupId>org.hdrhistogram</groupId>
-->
<!--
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
license is missing in artifact
build
/
/
target
/
/
parser
/
target
/
/
benchmarking
/
target
/
.idea
/
*
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Plans to support MQTT 5?
#490 opened
Actions
Projects
Wiki
Security
Insights
Labels
7
Milestones
5
Labels
7
Milestones
5
New pull request
New
Clear current search query, filters, and sorts
0 Open
0 Closed
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
v0.13
3b83f47
Compare
Choose a tag to compare
Search for a tag
andsel
tagged this
Apr 11, 2020
·
2 commits
to master since this tag
Assets
2
Source code
(zip)
Source code
(tar.gz)
© 2020 GitHub, Inc.
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Bumped release 0.13 (
#523
)
Loading branch information
andsel
committed
Apr 11, 2020
Verified
>
<
url
>https://github.com/andsel/moquette/</
url
>
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
@GrabResolver
(
name
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache
:
directories
:
-
$HOME/.gradle/caches/
-
$HOME/.gradle/wrapper/
script
:
-
./gradlew install test
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
Already on GitHub?
Sign in
to your account
Jump to bottom
Make the number of Netty worker threads number configurable
#468
Open
komamitsu
wants to merge
1
commit into
moquette-io
:
master
base:
from
komamitsu
:
wrong-netty-buf-ref-cnt
Conversation
4
Commits
2
Checks
0
Files changed
Conversation
Copy link
Quote reply
Contributor
komamitsu
9c1c2ff
hylkevds
added a commit to hylkevds/moquette that referenced this issue
Aug 13, 2020
Fixes
moquette-io#529
,
moquette-io#505
: NPE caused by matching on a T…
…
72a21ef
hylkevds
mentioned this issue
Aug 13, 2020
Fixes #529, #505: NPE caused by matching on a TNode
#532
Open
NotClosingApplication
.
Moquette MQTT version
Tested on version:
0.12.1
JVM version (e.g.
java -version
)
Tested with:
1.8_162
,
11.0.1
and
13
OS version (e.g.
uname -a
)
Windows 10
,
name
:
'
librato-java
'
,
version
:
'
2.1.0
'
compile
group
:
'
com.bugsnag
'
version
>
</
parent
>
<
artifactId
>moquette-osgi-test</
artifactId
>
2
perf/pom.xml
Show comments
View file
Edit file
Delete file
On Fri, Sep 20, 2019 at 1:48 PM Muhammad Mattiullah < ***@***.***> wrote: Hello Andsel, is it supporting mqtt v5 ? — You are receiving this because you commented. Reply to this email directly, view it on GitHub <
#490
?email_source=notifications&email_token=AAH5RUKESDF2GDSBPBPJWF3QKS2BZA5CNFSM4IGAUTOKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOD7GOCYI#issuecomment-533520737>, or mute the thread <
https://github.com/notifications/unsubscribe-auth/AAH5RUKZIRJYE5KAAFJKX23QKS2BZANCNFSM4IGAUTOA
> .
👍
1
🎉
1
Copy link
MuhammadMattiullah
commented
Sep 20, 2019
Thanks for the quick response.
Regards
Sign up for free
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
groupId
>io.moquette</
groupId
>
<
version
>0.10
-SNAPSHOT
</
version
>
<
version
>0.10</
version
>
</
parent
osgi_test/pom.xml
Show comments
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
netty-codec-http
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-codec-mqtt
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-transport-native-epoll
'
,
version
: nettyVersion,
classifier
protected
void
startServer
()
throws
IOException
{
29
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
Show comments
View file
Edit file
Delete file
@@ -27,8 +27,11 @@
import
org.junit.Test
;
import
org.slf4j.Logger
group
:
'
com.hazelcast
'
,
name
:
'
hazelcast
'
,
version
:
'
3.5.4
'
testCompile
<artifactId>HdrHistogram</artifactId>
-->
<!--
<version>2.1.4</version>
-->
<!--
</dependency>
-->
<
dependency
>
<
groupId
>com.hazelcast</
groupId
>
<
artifactId
>hazelcast</
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
#492 opened
Jul 30, 2019
by
ascheman
ProTip!
Type
g
i
on any issue or pull request to go back to the issue listing page.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
.iml
broker
/
target
/
client
/
target
/
parser_commons
/
target
/
netty_parser
/
target
/
netty_parser
/
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Jul 23, 2019
by
mpe85
6
ProTip!
What’s not been updated in a month:
updated:<2020-09-22
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
0 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Reviews
Filter by reviews
No reviews
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Moquette & 2-way SSL authentication
#508
Open
lukaszsoszynski
opened this issue
Nov 25, 2019
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
6ee0137
commit
3b83f4772a1e51a805931ff70809ce9c29fbb36f
Unified
Split
Showing
7 changed files
with
15 additions
and
11 deletions
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
'
io.moquette
'
,
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
master
from
treasure-data
:
netty-threads-num
Open
Make the number of Netty worker threads number configurable
#468
komamitsu
wants to merge
1
commit into
moquette-io
:
master
from
treasure-data
:
commented
Mar 31, 2019
I ran into this exception when Moquette was running with QoS1 under heavy load.
It looks like Session#resendInflightNotAcked() was triggered, but it dealt with a ByteBuf already freed. After this exception, the channel didn't work at all and I think this is a critical bug.
I reproduced this bug as
ServerLowlevelMessagesIntegrationTests#testResendNotAckedPublishes
and I tried fixing it somehow by retaining the duplicated buffer. It works so far.
komamitsu
added
2
commits
Mar 28, 2019
Add a test to reproduce the issue
00443e0
Fix a bug Session#resendInflightNotAcked() fails
…
Loading status checks…
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
and
OSx 10.11.6
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
,
name
:
'
bugsnag
'
,
version
:
'
[3.0,4.0)
'
compile
group
:
'
commons-codec
@@ -6,7 +6,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
3 participants
© 2020 GitHub, Inc.
Terms
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
>
<
artifactId
>moquette-mapdb-storage</
artifactId
>
2
osgi_test/pom.xml
Show comments
View file
Edit file
Delete file
@@ -5,7 +5,7 @@
<
relativePath
>../</
relativePath
>
groupId
>
<
version
>0.
9
</
version
>
<
version
>0.
10-SNAPSHOT
</
version
>
</
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-transport-native-epoll
'
,
version
: nettyVersion,
classifier
:
'
linux-x86_64
'
//
compile
group
:
'
io.dropwizard.metrics
'
,
name
:
'
metrics-core
'
;
import
org.slf4j.LoggerFactory
;
import
org.awaitility.Awaitility
;
import
java.io.IOException
;
import
java.nio.charset.StandardCharsets
;
import
java.util.Properties
;
import
group
:
'
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
'
,
version
:
'
1.12
'
testCompile
artifactId
>
<
version
>3.5.4</
version
>
</
dependency
>
<!--
Test dependencies
-->
<
dependency
>
<
groupId
>junit</
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
target
/
parser_commons
/
target
/
distribution
/
target
/
broker
/
moquette.log
broker
/
runner
/
bundle
/
😄
🎉
😕
❤️
🚀
👀
BrokerInterceptor thread pool never closing on serverStop
#506 opened
Oct 9, 2019
by
bobrowskim
ProTip!
no:milestone
will show everything without a milestone.
© 2020 GitHub, Inc.
Terms
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Subscription breaks during performance test
#505 opened
Oct 4, 2019
by
JinseonyLee
1
ProTip!
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
Review required
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Connection dropped when publishing message with payload greater 8KB.
#503 opened
Aug 30, 2019
by
r-t-s
ProTip!
no:milestone
will show everything without a milestone.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
· 0 comments
Open
Moquette & 2-way SSL authentication
#508
lukaszsoszynski
opened this issue
Nov 25, 2019
· 0 comments
Comments
Copy link
Quote reply
lukaszsoszynski
commented
Nov 25, 2019
I have just question: Does Moquette support 2-way SSL authentication? I found in documentation section "SSL Configuration" (
https://moquette-io.github.io/moquette/documentation.html#_ssl_configuration
) but if I understand example correctly there is covered only "1-way" SSL authentication and client certificate is not verified by server.
👀
How one port supports both unidirectional and two-way certificate authentication for TLS
#491 opened
Jul 30, 2019
by
cnneillee
ProTip!
no:milestone
will show everything without a milestone.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Will it be compatible with Graalvm in the future?
#509
Open
coolbeevip
opened this issue
Dec 12, 2019
· 0 comments
Open
Will it be compatible with Graalvm in the future?
#509
.
+4
−0
ChangeLog.txt
+3
−3
README.md
+1
−1
broker/src/main/java/io/moquette/broker/Server.java
+2
−2
build.gradle
+2
−2
distribution/src/main/scripts/moquette.bat
module
=
'
moquette-broker
'
,
version
=
'
0.
9-SNAPSHOT
'
)
@Grab
(
group
=
'
io.moquette
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
netty-threads-num
Conversation
1
Commits
1
Checks
0
Files changed
Conversation
Copy link
Quote reply
Contributor
komamitsu
commented
Apr 8, 2019
I noticed Moquette users can't configure the number of Netty worker threads in current Moquette. Increasing Netty worker threads number is important in our use case that handles a lot of MQTT requests.
6dee138
Copy link
Quote reply
Collaborator
andsel
commented
Apr 2, 2019
I have to reason about this more carefully, because this could potentially open to memory leakeage
🎉
1
🚀
1
Copy link
Quote reply
Contributor
Author
komamitsu
commented
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
'
,
name
:
'
commons-codec
'
,
version
:
'
1.10
'
//
compile group: 'org.hdrhistogram', name: 'HdrHistogram', version:'2.1.4'
compile
group
:
'
version
>0.9
-SNAPSHOT
</
version
>
<
version
>0.9</
version
>
</
parent
>
<
artifactId
>moquette-performance</
artifactId
>
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.10
-SNAPSHOT
</
version
>
<
parent
>
<
artifactId
>moquette-osgi-test</
artifactId
>
2
perf/pom.xml
Show comments
View file
Edit file
Delete file
@@ -6,7 +6,7 @@
<
relativePath
>../</
:
'
linux-x86_64
'
//
compile
group
:
'
io.dropwizard.metrics
'
,
name
,
version
:
'
3.2.2
'
compile
group
:
'
io.dropwizard.metrics
'
,
name
:
'
metrics-jvm
'
java.util.concurrent.TimeUnit
;
import static
io.netty.handler.codec.mqtt.MqttConnectReturnCode.*
;
import static
org.junit.Assert.*
;
@@ -81,10 +84,10 @@ public void elapseKeepAliveTime() throws InterruptedException {
*/
m_client
.
sendMessage(connectMessage);
//
wait
2
times the keepAlive
Thread
group
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.0.2
'
testCompile
groupId
>
<
artifactId
>junit</
artifactId
>
<
version
>4.8.2</
version
>
<
scope
>test</
scope
>
</
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
target
/
/
bundle
/
runner
/
/
osgi_test
/
target
/
/
perf
/
target
/
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
What’s not been updated in a month:
updated:<2020-09-22
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
😕
❤️
🚀
👀
No results matched your search.
You could search
all of GitHub
or try an
advanced search
.
ProTip!
Filter pull requests by the default branch with
base:master
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
coolbeevip
opened this issue
Dec 12, 2019
· 0 comments
Comments
Copy link
Quote reply
coolbeevip
commented
Dec 12, 2019
Expected behavior
Actual behavior
Steps to reproduce
Minimal yet complete reproducer code (or URL to code) or complete log file
Moquette MQTT version
JVM version (e.g.
java -version
)
+2
−2
distribution/src/main/scripts/moquette.sh
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
4
ChangeLog.txt
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,7 @@
Version 0.13:
Fixed issue #454 to avoid 1 second pause in flushing
Updated Travis build to JDK 12
Version 0.12:
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.
8.1
'
)
import
io.moquette.server.Server
Toggle all file notes
0 comments on commit
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
This PR makes it configurable.
Add BrokerConstants.NETTY_WORKER_THREADS
Loading status checks…
48ccd40
komamitsu
force-pushed
the
treasure-data:netty-threads-num
branch from
c520b9f
to
48ccd40
Apr 8, 2019
Copy link
Quote reply
Collaborator
andsel
Apr 3, 2019
Yeah. If you have any concern of memory leak, feel free to give me feedbacks. Thanks.
IMO, this issue occurs 100% when a subscriber takes time and potential memory leak may be better than it.
I think you can easily reproduce this issue by running
testResendNotAckedPublishes()
introduced by this pull request with commenting out the fix.
Copy link
Quote reply
githawks
commented
Sep 24, 2019
hey brother, me too
Copy link
Quote reply
githawks
commented
Sep 24, 2019
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
com.hazelcast
'
,
name
:
'
hazelcast
'
,
version
:
'
3.5.4
'
testCompile
group
:
'
org.fusesource.mqtt-client
'
2
pom.xml
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
<
artifactId
>moquette-parent</
artifactId
>
<
packaging
>pom</
packaging
>
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
version
>0.10</
version
>
</
parent
>
<
artifactId
>moquette-osgi-test</
artifactId
>
2
perf/pom.xml
Show comments
View file
Edit file
Delete file
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
version
>0.
9
</
version
>
:
'
metrics-core
'
,
version
:
'
3.2.2
'
compile
group
:
'
io.dropwizard.metrics
'
,
name
:
'
,
version
:
'
3.2.2
'
compile
group
:
'
com.librato.metrics
'
,
name
:
.
sleep(keepAlive
*
2
*
1000
);
assertTrue
(m_client
.
isConnectionLost
()
);
//
wait
3
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
dependency
>
<
dependency
>
<
groupId
>org.slf4j</
groupId
>
<
artifactId
>slf4j-log4j12</
artifactId
>
<
version
>1.7.5</
version
Accept
Reject
Save preferences
/
mapdb_storage
/
target
/
*
~
*
.log
*
.DS_Store
.settings
/
.project
.classpath
*
.swp
*
.class
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
Issues · moquette-io/moquette · GitHub
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Issues · moquette-io/moquette · GitHub
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Moquette shows topics, but subscribers won't receive anything - Subscription missing?
#510
Open
beniroquai
opened this issue
Dec 18, 2019
· 1 comment
Open
OS version (e.g.
uname -a
)
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
Fixed issue #415
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
6
README.md
Show comments
View file
Edit file
Delete file
@@ -25,11 +25,11 @@ Point your browser to [cloud instance](http://broker.moquette.io), request an ac
##
1 minute set up
Start play with it, download the self distribution tar from [
BinTray
](https://bintray.com/artifact/download/andsel/generic/moquette-0.
12.1
.tar.gz) ,
Start play with it, download the self distribution tar from [
5e680b6
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
commented
Apr 8, 2019
This is not necessary. Netty used asunch IO an Moquette is essentially IO bound so adding thread only adds threads that do IO waiting. The broker starts and Co figure the number of threads equals to the number of cores - 1, let this configurable to put for example 1000 threads it's a no sense, just adds weight to the scheduler and stole memory for each thread's stack. Il lun 8 apr 2019, 07:24 Mitsunori Komatsu <notifications@github.com> ha scritto:
…
I noticed Moquette users can't configure the number of Netty worker threads in current Moquette. Increasing Netty worker threads number is important in our use case that handles a lot of MQTT requests. This PR makes it configurable. ------------------------------ You can view, comment on, or merge this pull request online at:
#468
Commit Summary - Add BrokerConstants.NETTY_WORKER_THREADS File Changes - *M* broker/src/main/java/io/moquette/BrokerConstants.java <
https://github.com/moquette-io/moquette/pull/468/files#diff-0
> (1) - *M* broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java <
https://github.com/moquette-io/moquette/pull/468/files#diff-1
> (13) Patch Links: -
https://github.com/moquette-io/moquette/pull/468.patch
-
https://github.com/moquette-io/moquette/pull/468.diff
— You are receiving this because you are subscribed to this thread. Reply to this email directly, view it on GitHub <
just four sensor, the problem
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
None yet
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
,
name
:
'
mqtt-client
'
,
version
:
'
1.12
'
testCompile
group
:
'
org.eclipse.paho
'
<
version
>0.9
-SNAPSHOT
</
version
>
<
version
>0.9</
version
>
<
name
>Moquette MQTT</
name
>
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
@@ -6,7 +6,7 @@
<
relativePath
>../</
relativePath
>
<
artifactId
>moquette-parent</
artifactId
>
<
groupId
>io.moquette</
groupId
>
<
<
version
>0.
10-SNAPSHOT
</
version
>
</
parent
>
<
artifactId
>moquette-performance</
artifactId
>
2
pom.xml
Show comments
metrics-jvm
'
,
version
:
'
3.2.2
'
compile
group
:
'
com.librato.metrics
'
,
name
:
'
'
metrics-librato
'
,
version
:
'
5.1.0
'
compile
group
:
'
com.librato.metrics
'
,
name
:
times the keepAlive
Awaitility
.
await()
.atMost(
3
*
keepAlive,
TimeUnit
.
SECONDS
)
.until
(m_client
::
isConnectionLost);
}
private
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
1.4.191
'
}
>
<
scope
>test</
scope
>
</
dependency
>
<!--
needs extra dependencies: objenesis & hamcrest
-->
<
dependency
>
<
groupId
>org.mockito</
#
Mobile Tools for Java (J2ME)
.mtj.tmp
/
#
Package Files #
*
.war
*
.ear
#
virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml
hs_err_pid
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Issues · moquette-io/moquette · GitHub
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Pull requests · moquette-io/moquette · GitHub
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Reject
Save preferences
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Clean test storage on exit to prevent assert in next test by qbast · Pull Request #497 · moquette-io/moquette · GitHub
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Moquette shows topics, but subscribers won't receive anything - Subscription missing?
#510
beniroquai
opened this issue
Dec 18, 2019
· 1 comment
Comments
Copy link
Quote reply
beniroquai
commented
Dec 18, 2019
Expected behavior
Clients should receive topics
Actual behavior
Clients - subscribed to topic - don'T receive anything.
Steps to reproduce
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
BinTray
](https://bintray.com/artifact/download/andsel/generic/moquette-0.
13
.tar.gz) ,
the un untar and start the broker listening on
`1883`
port and enjoy!
```
tar xvf moquette-distribution-0.
12.1
.tar.gz
tar xvf moquette-distribution-0.
13
.tar.gz
cd bin
./moquette.sh
```
@@ -66,7 +66,7 @@ Include dependency in your project:
<dependency>
Bridging to a cloud broker [Microsoft Azure -- IOT Hub] ? · Issue #513 · moquette-io/moquette · GitHub
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
#468
>, or mute the thread <
https://github.com/notifications/unsubscribe-auth/AA_Y0dOkYC03U8T_1P3ARPjffNKz8uxPks5vetKKgaJpZM4chUpc
> .
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
3 participants
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.0.2
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
<
description
>Moquette lightweight MQTT Broker</
description
>
<
inceptionYear
>2011</
inceptionYear
>
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
@GrabResolver
version
>0.10
-SNAPSHOT
</
version
>
<
version
>0.10</
version
>
</
parent
>
<
artifactId
>moquette-performance</
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
<
artifactId
>moquette-parent</
artifactId
>
<
packaging
>pom</
packaging
>
<
version
>0.
9
</
metrics-librato
'
,
version
:
'
5.1.0
'
compile
group
:
'
com.librato.metrics
'
,
name
:
'
'
librato-java
'
,
version
:
'
2.1.0
'
compile
group
:
'
com.bugsnag
'
,
name
:
'
static
MqttConnectMessage
createConnectMessage
(
String
clientID
,
int
keepAlive
) {
@@ -109,14 +112,18 @@ public void testWillMessageIsWiredOnClientKeepAliveExpiry() throws Exception {
m_client
.
clientId(
"
FAKECLNT
"
task
createPom
() {
.
writeTo(
"
build/pom.xml
"
)
}
jar
{
manifest {
instruction
'
Bundle-Description
'
,
groupId
>
<
artifactId
>mockito-core</
artifactId
>
<
version
>1.9.0</
version
>
<
scope
>test</
scope
>
</
dependency
*
broker
/
*
moquette_store.
*
embedding_moquette
/
target
/
broker
/
nb-configuration.xml
broker
/
nbactions-Server.xml
maven-metadata.xml
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
fix trie match bug and bytesMetrics bug by ilylia · Pull Request #479 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
See below
Minimal yet complete reproducer code (or URL to code) or complete log file
Moquette MQTT version
latest
JVM version (e.g.
java -version
)
1.8
OS version (e.g.
uname -a
)
Android
Hey,
thanks for putting this great work online! I was wondering if someone ever tried to create a broker + cleint on the same (Android) device. My app has a moquette broker app which connects just fine and receives commands sent from a second cellphone. The brokers' debug output is reflecting the topic, but the second device (ESP32) is not receiving anything - even though it's subscribed to this topic. Do you have any idea?
The debug-output is this one:
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
<groupId>io.moquette</groupId>
<artifactId>moquette-broker</artifactId>
<version>0.
12.1
</version>
<version>0.
13
</version>
</dependency>
```
2
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
No milestone
Linked issues
Successfully merging this pull request may close these issues.
None yet
2 participants
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
com.h2database
'
,
(
name
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
artifactId
>
2
pom.xml
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
<
artifactId
>moquette-parent</
artifactId
>
<
packaging
>pom</
version
>
<
version
>0.
10-SNAPSHOT
</
version
>
<
name
>Moquette MQTT</
name
>
<
description
>Moquette lightweight MQTT Broker</
librato-java
'
,
version
:
'
2.1.0
'
compile
group
:
'
com.bugsnag
'
,
name
:
bugsnag
'
,
version
:
'
[3.0,4.0)
'
compile
group
:
'
commons-codec
'
,
name
:
'
commons-codec
)
.
connect(willTestamentTopic, willTestamentMsg);
long
connectTime
=
System
.
currentTimeMillis();
//
but after the 2 KEEP ALIVE timeout expires it gets fired,
//
NB it's 1,5 * KEEP_ALIVE so 3 secs and some millis to propagate the message
org.eclipse.paho.client.mqttv3
.
MqttMessage
msg
=
m_messageCollector
'
Moquette lightweight MQTT Broker
'
instruction
'
Bundle-License
'
,
'
http://www.apache.org/licenses/LICENSE-2.0.txt, http://www.eclipse.org/org/documents/epl-v10.php
'
instruction
'
Import-Package
'
,
'
!com.codahale.metrics*, !com.bugsnag*, !com.librato.metrics*, *
>
<
dependency
>
<
groupId
>org.fusesource.mqtt-client</
groupId
>
<
artifactId
>mqtt-client</
artifactId
>
<
version
>1.12</
version
/
.gradle
/
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Sign in to GitHub · GitHub
Skip to content
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Java 11 compatibility by qbast · Pull Request #498 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Any idea? Both devices are visible, but it seems, that the ESP32 is not subscribing to anything,, am I right?
Cheers and thanks for putting this up! :)
Copy link
Author
beniroquai
commented
Jan 2, 2020
The problem is
here
. The "join" method is not implemented for some reason. I changed
this.topic = String.join("/", strTokens);
to
this.topic = "/"+strTokens;
This worked for me.
Sign up for free
to join this conversation on GitHub
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
@@ -55,7 +55,7 @@
public
static
void
main
(
String
[]
args
)
throws
IOException
{
final
Server
server
=
new
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
name
:
'
h2
'
,
version
:
'
1.4.191
'
}
task
createPom
() {
.
writeTo(
"
build/pom.xml
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.9
-SNAPSHOT
'
)
@Grab
packaging
>
<
version
>0.10
-SNAPSHOT
</
version
>
<
version
>0.10</
version
>
<
name
>Moquette MQTT</
name
description
>
<
inceptionYear
>2011</
inceptionYear
>
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
@GrabResolver
(
name
'
bugsnag
'
,
version
:
'
[3.0,4.0)
'
compile
group
:
'
commons-codec
'
,
name
'
,
version
:
'
1.10
'
//
compile group: 'org.hdrhistogram', name: 'HdrHistogram', version:'2.1.4'
compile
group
:
'
com.hazelcast
'
,
name
:
'
.
waitMessage(
5
);
assertNotNull(
"
the will message should be fired after keep alive!
"
, msg);
//
the will message hasn't to be received before the elapsing of Keep Alive timeout
assertTrue(
System
.
currentTimeMillis()
-
connectTime
>
'
}
into (
"
META-INF/maven/io.moquette/
${
project.name
}
"
){
from
"
build/pom.xml
"
}
}
>
<
scope
>test</
scope
>
</
dependency
>
<
dependency
>
<
groupId
>org.eclipse.paho</
groupId
>
<
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
Reduce log level for log messages caused by client side input mistakes by PHameete · Pull Request #537 · moquette-io/moquette · GitHub
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Reduce log level for log messages caused by client side input mistakes by PHameete · Pull Request #537 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Authenticator rejection results in MQTTMessageLogger error · Issue #463 · moquette-io/moquette · GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Server
();
server
.
startServer();
System
.
out
.
println(
"
Server started, version 0.13
-SNAPSHOT
"
);
System
.
out
.
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
)
}
jar
{
manifest {
instruction
'
Bundle-Description
'
,
'
Moquette lightweight MQTT Broker
'
instruction
'
Bundle-License
(
group
=
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.9
'
>
<
description
>Moquette lightweight MQTT Broker</
description
>
<
inceptionYear
>2011</
inceptionYear
>
4
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
'
io.moquette
'
:
'
commons-codec
'
,
version
:
'
1.10
'
//
compile group: 'org.hdrhistogram', name: 'HdrHistogram', version:'2.1.4'
compile
group
:
'
com.hazelcast
'
hazelcast
'
,
version
:
'
3.5.4
'
testCompile
group
:
'
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
3000
);
Awaitility
.
await()
.atMost(
7
,
TimeUnit
.
SECONDS
)
.untilAsserted(()
-
>
{
//
but after the 2 KEEP ALIVE timeout expires it gets fired,
jar
.
dependsOn createPom
282
broker/pom.xml
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
artifactId
>org.eclipse.paho.client.mqttv3</
artifactId
>
<
version
>1.0.2</
version
>
<
scope
>test</
scope
>
</
dependency
>
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Skip to content
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
println(
"
Server started, version 0.13
"
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
(server
::
stopServer));
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
'
,
'
http://www.apache.org/licenses/LICENSE-2.0.txt, http://www.eclipse.org/org/documents/epl-v10.php
'
instruction
'
Import-Package
'
,
'
!com.codahale.metrics*, !com.bugsnag*, !com.librato.metrics*, *
'
)
import
io.moquette.server.Server
Toggle all file notes
0 comments on commit
4162aae
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
@@ -1,5 +1,5 @@
@GrabResolver
(
name
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
,
module
=
'
moquette-broker
'
,
version
=
'
0.
9
'
)
@Grab
(
group
=
,
name
:
'
hazelcast
'
,
version
:
'
3.5.4
'
testCompile
group
:
'
org.fusesource.mqtt-client
'
,
'
,
version
:
'
1.12
'
testCompile
group
:
'
org.eclipse.paho
'
,
name
:
'
//
NB it's 1,5 * KEEP_ALIVE so 3 secs and some millis to propagate the message
org.eclipse.paho.client.mqttv3
.
MqttMessage
msg
=
m_messageCollector
.
getMessageImmediate();
assertNotNull(
"
the will message should be fired after keep alive!
"
, msg);
//
e8b105f
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
<
dependency
>
<
groupId
>org.eclipse.jetty.websocket</
groupId
>
<
artifactId
>websocket-client</
artifactId
>
<
version
>9.2.0.M1</
version
Learn more
Accept
Reject
Save preferences
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
Pull requests · moquette-io/moquette · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Question: disconnecting a client when authentication details removed · Issue #516 · moquette-io/moquette · GitHub
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
}
4
build.gradle
Show comments
View file
Edit file
Delete file
@@ -3,7 +3,7 @@ allprojects {
apply
plugin
:
'
maven-publish
'
group
=
'
io.moquette
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
}
into (
"
META-INF/maven/io.moquette/
${
project.name
}
"
){
from
"
build/pom.xml
"
}
}
jar
.
dependsOn createPom
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
=
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.10
-SNAPSHOT
'
)
@Grab
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.
10-SNAPSHOT
'
)
import
io.moquette.server.Server
name
:
'
mqtt-client
'
,
version
:
'
1.12
'
testCompile
group
:
'
org.eclipse.paho
'
,
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.0.2
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
the will message hasn't to be received before the elapsing of Keep Alive timeout
assertTrue(
System
.
currentTimeMillis()
-
connectTime
>
3000
);
assertEquals(willTestamentMsg,
new
String
(msg
.
getPayload(),
StandardCharsets
.
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
>
<
scope
>test</
scope
>
</
dependency
>
<
dependency
>
<
groupId
>org.assertj</
groupId
>
<
artifactId
>assertj-core</
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Pull requests
Actions
Projects
Wiki
Security
Insights
Labels
7
Milestones
5
Labels
7
Milestones
5
New pull request
New
Clear current search query, filters, and sorts
2 Open
Pull requests · moquette-io/moquette · GitHub
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
BUG - null Session in subscribe procedure · Issue #517 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes · Issue #518 · moquette-io/moquette · GitHub
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Moquette 0.12.1 versions release · moquette-io/moquette@26e43c5 · GitHub
'
version
=
'
0.13
-SNAPSHOT
'
version
=
'
0.13
'
}
buildscript
{
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
282
broker/pom.xml
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
e8b105f
Please
sign in
to comment.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
(
group
=
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.10
'
)
Toggle all file notes
0 comments on commit
a7b8c07
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.0.2
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
com.h2database
'
,
name
:
'
h2
UTF_8
));
});
assertEquals(willTestamentMsg,
new
String
(msg
.
getPayload()));
m_willSubscriber
.
disconnect();
}
5
osgi_test/README.md
Show comments
View file
Edit file
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
artifactId
>
<!--
use 2.6.0 for Java 7 projects
-->
<
version
>2.6.0</
version
>
<
scope
>test</
scope
>
</
dependency
>
<
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
1 Closed
2 Open
1 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Reviews
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Clean test storage on exit to prevent assert in next test
#497
Open
qbast
wants to merge
1
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Issues · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
@@ -92,7 +92,7 @@ subprojects {
from components
.
java
groupId
"
$p
roject
.
group
"
artifactId
"
${
project.name
}
"
version
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Bridging to a cloud broker [Microsoft Azure -- IOT Hub] ?
#513
Open
carlsberg-stack
opened this issue
Jan 17, 2020
· 5 comments
Open
Bridging to a cloud broker [Microsoft Azure -- IOT Hub] ?
#513
carlsberg-stack
opened this issue
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Save preferences
import
io.moquette.server.Server
@@ -13,4 +13,4 @@ props.setProperty('password_file', '../broker/config/password_file.conf')
println
"
starting proprs
$p
rops
"
server
.
startServer(props)
println
"
Stopping broker..
"
server
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
com.h2database
'
,
name
'
,
version
:
'
1.4.191
'
}
task
createPom
() {
.
writeTo(
"
build/pom.xml
"
)
Delete file
@@ -0,0 +1,5 @@
#
Development
to run the osgi tests use:
mvn clean && mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V && mvn -B test -pl osgi_test
31
osgi_test/pom.xml
Show comments
View file
Edit file
Delete file
@@ -22,6 +22,37 @@
<
groupId
>io.moquette</
groupId
dependency
>
<
groupId
>org.awaitility</
groupId
>
<
artifactId
>awaitility</
artifactId
>
<
version
>3.0.0</
version
>
<
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Issues · moquette-io/moquette · GitHub
Travis CI - Test and Deploy Your Code with Confidence
Hey there!
Looks like you have JavaScript disabled.
The Travis CI webclient needs JavaScript to work properly.
Please enable JavaScript to get the best Travis CI experience.
Thank you!
Filter by reviews
No reviews
Review required
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
Pull requests · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
commit into
moquette-io
:
master
base:
master
from
augnetuk
:
it-file-fix
Open
Clean test storage on exit to prevent assert in next test
#497
qbast
wants to merge
1
commit into
Issues · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
moquette/MQTTConnection.java at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
fix trie match bug and bytesMetrics bug
#479
Open
ilylia
wants to merge
1
commit into
moquette-io
:
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
'
0.13
-SNAPSHOT
'
version
'
0.13
'
}
}
}
4
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
Delete file
Jan 17, 2020
· 5 comments
Comments
Copy link
Quote reply
carlsberg-stack
commented
Jan 17, 2020
No description provided.
Copy link
Collaborator
andsel
commented
Jan 17, 2020
Please file a request with more details, "bridging to a cloud broker" is not so clear to understand what you mean
Copy link
Author
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
.
stopServer()
server
.
stopServer()
Toggle all file notes
0 comments on commit
0480260
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
:
'
h2
'
,
version
:
'
1.4.191
'
}
task
createPom
() {
.
writeTo(
"
build/pom.xml
}
jar
{
manifest {
instruction
'
Bundle-Description
'
,
'
Moquette lightweight MQTT Broker
'
instruction
'
Bundle-License
'
,
'
>
<
artifactId
>moquette-broker</
artifactId
>
<
version
>
</
version
>
</
dependency
>
<
dependency
>
scope
>test</
scope
>
</
dependency
>
<
dependency
>
<
groupId
>com.h2database</
groupId
>
<
artifactId
>h2</
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
Wiki
Security
Insights
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
👎
😄
🎉
😕
❤️
🚀
👀
Make the number of Netty worker threads number configurable
#468 opened
Apr 8, 2019
by
komamitsu
1
Fix a bug Session#resendInflightNotAcked() fails due to handling a freed ByteBuf
#464 opened
Mar 31, 2019
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
👀
Moquette shows topics, but subscribers won't receive anything - Subscription missing?
#510 opened
Dec 18, 2019
by
beniroquai
1
ProTip!
Type
g
p
on any issue or pull request to go back to the pull request listing page.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Java 11 compatibility
#498
Open
qbast
wants to merge
2
commits into
moquette-io
moquette-io
:
master
from
augnetuk
:
it-file-fix
Conversation
0
Commits
1
Checks
0
Files changed
Conversation
Copy link
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
fixed throw NullPointerException when new connection by luoliangtiger · Pull Request #519 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Actions
Projects
Wiki
Security
Insights
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
master
base:
master
from
ilylia
:
master
Open
fix trie match bug and bytesMetrics bug
#479
ilylia
wants to merge
1
commit into
moquette-io
:
master
from
ilylia
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
😄
🎉
😕
❤️
🚀
👀
Moquette & 2-way SSL authentication
#508 opened
Nov 25, 2019
by
lukaszsoszynski
ProTip!
Exclude everything labeled
bug
with
-label:bug
.
© 2020 GitHub, Inc.
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
@@ -1,6 +1,6 @@
@
ECHO
OFF
rem
#
rem
# Copyright (c) 2012-
2015
Andrea Selva
rem
# Copyright (c) 2012-
2020
Andrea Selva
rem
#
echo
"
carlsberg-stack
commented
Jan 17, 2020
Please file a request with more details, "bridging to a cloud broker" is not so clear to understand what you mean
I am sorry. So i am able to run broker in my android device. I am using for azure iot for remote access. I want to bridge between my android broker and azure iot.
Copy link
Collaborator
andsel
commented
Jan 17, 2020
You have to write some code to bridge it. Moquette exposes a set of Interceptor callback interfaces, you can implement the one you are interested in (for example a forwarder to Azure using some Azure HTTP endpoint or whatever protocol Azure use) and register in you embedded application.
…
On Fri, Jan 17, 2020 at 10:24 AM Amit Jaiswal ***@***.***> wrote: Please file a request with more details, "bridging to a cloud broker" is not so clear to understand what you mean I am sorry. So i am able to run broker in my android device. I am using for azure iot for remote access. I want to bridge between my android broker and azure iot. — You are receiving this because you commented. Reply to this email directly, view it on GitHub <
#513
?email_source=notifications&email_token=AAH5RUKNMO4ZMQSG3XPDDNLQ6F2OHA5CNFSM4KIDNQKKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEJHB7WQ#issuecomment-575545306>, or unsubscribe <
https://github.com/notifications/unsubscribe-auth/AAH5RUMNBGPURCWKGD2UKLTQ6F2OHANCNFSM4KIDNQKA
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Reject
Save preferences
"
)
}
jar
{
manifest {
instruction
'
Bundle-Description
'
,
'
Moquette lightweight MQTT Broker
'
instruction
'
http://www.apache.org/licenses/LICENSE-2.0.txt, http://www.eclipse.org/org/documents/epl-v10.php
'
instruction
'
Import-Package
'
,
'
!com.codahale.metrics*, !com.bugsnag*, !com.librato.metrics*, *
'
}
into (
"
META-INF/maven/io.moquette/
${
project.name
}
"
){
<
groupId
>io.moquette</
groupId
>
<
artifactId
>moquette-h2-storage</
artifactId
>
<
version
>
</
version
>
</
dependency
>
artifactId
>
<
version
>1.4.191</
version
>
<
scope
>test</
scope
>
</
dependency
>
</
dependencies
>
<
🎉
😕
❤️
🚀
👀
Will it be compatible with Graalvm in the future?
#509 opened
Dec 12, 2019
by
coolbeevip
ProTip!
Type
g
i
on any issue or pull request to go back to the issue listing page.
© 2020 GitHub, Inc.
Terms
Reduce log level for log messages caused by client side input mistakes
#537
Merged
andsel
merged 1 commit into
moquette-io
:
master
from
unknown repository
Oct 9, 2020
+5
−5
Conversation
5
Commits
1
Checks
0
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
by
komamitsu
4
ProTip!
Find all pull requests that aren't related to any open issues with
-linked:issue
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Packages · Moquette · GitHub
Authentication changes by ndchandar · Pull Request #507 · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
:
master
base:
master
from
augnetuk
:
new-gradle
Open
Java 11 compatibility
#498
qbast
wants to merge
2
commits into
Quote reply
qbast
commented
Aug 16, 2019
Running
./gradlew build
on linux causes following test failure:
io.moquette.integration.ServerIntegrationPahoCanPublishOnReadBlockedTopicTest > shouldNotInternalPublishOnReadBlockedSubscriptionTopic PASSED
io.moquette.integration.ServerIntegrationSSLClientAuthTest > checkClientAuthentication FAILED
java.lang.AssertionError: The DB storagefile /home/kuba/moquette/broker/build/moquette_store.h2 already exists
at org.junit.Assert.fail(Assert.java:91)
at org.junit.Assert.assertTrue(Assert.java:43)
at org.junit.Assert.assertFalse(Assert.java:68)
at io.moquette.integration.ServerIntegrationSSLClientAuthTest.setUp(ServerIntegrationSSLClientAuthTest.java:154)
This is caused by ServerIntegrationPahoCanPublishOnReadBlockedTopicTest not deleting H2 file in tearDown
Clean test storage on exit to prevent assert in next test
Loading status checks…
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Reduce log level for log messages caused by client side input mistakes
#537
Merged
andsel
merged 1 commit into
moquette-io
:
master
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
:
master
Conversation
4
Commits
1
Checks
0
Files changed
Conversation
Copy link
Quote reply
ilylia
commented
Jun 2, 2019
fix trie match bug when topic contains root;
fix bytesMetrics wroteBytes always 0;
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Sign in
to your account
Jump to bottom
Authenticator rejection results in MQTTMessageLogger error
#463
Closed
PHameete
opened this issue
Mar 29, 2019
· 3 comments
Closed
Authenticator rejection results in MQTTMessageLogger error
#463
PHameete
opened this issue
Mar 29, 2019
· 3 comments
Comments
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
"
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.13
-SNAPSHOT
> .
👍
1
Copy link
Author
carlsberg-stack
commented
Jan 17, 2020
You have to write some code to bridge it. Moquette exposes a set of Interceptor callback interfaces, you can implement the one you are interested in (for example a forwarder to Azure using some Azure HTTP endpoint or whatever protocol Azure use) and register in you embedded application.
…
On Fri, Jan 17, 2020 at 10:24 AM Amit Jaiswal
@
.***> wrote: Please file a request with more details, "bridging to a cloud broker" is not so clear to understand what you mean I am sorry. So i am able to run broker in my android device. I am using for azure iot for remote access. I want to bridge between my android broker and azure iot. — You are receiving this because you commented. Reply to this email directly, view it on GitHub <
#513
?email_source=notifications&email_token=AAH5RUKNMO4ZMQSG3XPDDNLQ6F2OHA5CNFSM4KIDNQKKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEJHB7WQ#issuecomment-575545306>, or unsubscribe
https://github.com/notifications/unsubscribe-auth/AAH5RUMNBGPURCWKGD2UKLTQ6F2OHANCNFSM4KIDNQKA
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Bundle-License
'
,
'
http://www.apache.org/licenses/LICENSE-2.0.txt, http://www.eclipse.org/org/documents/epl-v10.php
'
instruction
'
Import-Package
'
,
'
!com.codahale.metrics*, !com.bugsnag*, !com.librato.metrics*, *
'
}
into (
"
META-INF/maven/io.moquette/
${
from
"
build/pom.xml
"
}
}
jar
.
dependsOn createPom
282
broker/pom.xml
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
<
dependency
>
<
groupId
>io.moquette</
groupId
>
<
artifactId
>moquette-mapdb-storage</
artifactId
>
<
version
>
</
version
build
>
<
plugins
>
<
plugin
>
<
groupId
>org.apache.maven.plugins</
groupId
>
<
artifactId
>maven-surefire-plugin</
artifactId
>
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Files changed
1
Reduce log level for log messages caused by client side input mistakes
299cb9c
Select commit
299cb9c
Reduce log level for log messages caused by client side input mistakes
Oct 6, 2020
Merged
Reduce log level for log messages caused by client side input mistakes
#537
Reduce log level for log messages caused by client side input mistakes
299cb9c
Select commit
299cb9c
Reduce log level for log messages caused by client side input mistakes
Oct 6, 2020
Workflow runs completed with no jobs
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
moquette-io
:
master
from
augnetuk
:
new-gradle
Conversation
0
Commits
2
Checks
0
Files changed
Conversation
Copy link
Quote reply
1671fd2
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
None yet
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
Sign in to GitHub · GitHub
Skip to content
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Labels
7
Milestones
5
Labels
7
Milestones
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
from
unknown repository
Oct 9, 2020
+5
−5
Conversation
5
Commits
1
Checks
0
Files changed
1
Merged
Reduce log level for log messages caused by client side input mistakes
#537
Changes from
all commits
fix startup shell can not run outside bin;
Copy link
Quote reply
Collaborator
andsel
commented
Jun 3, 2019
Sorry
@ilylia
but this PR miss an important part, at least one test that manifest the problem you are trying to solve.
fix trie match bug when topic contains root, with test case;
…
Loading status checks…
74d92f9
ilylia
force-pushed
the
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Copy link
Quote reply
Contributor
PHameete
commented
Mar 29, 2019
•
edited
Expected behavior
Rejection of authentication should not result in errors.
Actual behavior
Rejection of authentication results in an error in the MQTTMessageLogger and a failed
massage
;-)
Steps to reproduce
Start a Moquette broker that requires authentication
Connect with an MQTT Client using username/password (I used the paho Java client)
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
"
echo
"
version: 0.13
"
set
"
CURRENT_DIR
=
%cd%
"
if
not
"
%MOQUETTE_HOME%
"
==
"
.
Thanks
carlsberg-stack
closed this
Jan 17, 2020
Copy link
Author
carlsberg-stack
commented
Jan 20, 2020
You have to write some code to bridge it. Moquette exposes a set of Interceptor callback interfaces, you can implement the one you are interested in (for example a forwarder to Azure using some Azure HTTP endpoint or whatever protocol Azure use) and register in you embedded application.
…
On Fri, Jan 17, 2020 at 10:24 AM Amit Jaiswal
@
.***> wrote: Please file a request with more details, "bridging to a cloud broker" is not so clear to understand what you mean I am sorry. So i am able to run broker in my android device. I am using for azure iot for remote access. I want to bridge between my android broker and azure iot. — You are receiving this because you commented. Reply to this email directly, view it on GitHub <
#513
?email_source=notifications&email_token=AAH5RUKNMO4ZMQSG3XPDDNLQ6F2OHA5CNFSM4KIDNQKKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEJHB7WQ#issuecomment-575545306>, or unsubscribe
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
project.name
}
"
){
from
"
build/pom.xml
"
}
}
jar
.
dependsOn createPom
282
broker/pom.xml
Show comments
View file
Edit file
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
e8b105f
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
>
</
dependency
>
<
dependency
>
<
groupId
>javax.servlet</
groupId
>
<
artifactId
>javax.servlet-api</
artifactId
>
<
configuration
>
<
systemPropertyVariables
>
<
io
.netty.leakDetectionLevel>PARANOID</
io
.netty.leakDetectionLevel>
</
systemPropertyVariables
>
<
includes
>
<
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Insights
Labels
7
Milestones
5
Labels
7
Milestones
5
New pull request
New
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
qbast
commented
Aug 17, 2019
Gradle 4.6 does not work with Java 11.
Update Gradle to newest version (5.6) along with errorprone and spotbugs in order to make moquette buildable with JDK 11. Compatibility with Java 8 is retained.
qbast
added
2
commits
Aug 16, 2019
Clean test storage on exit to prevent assert in next test
Loading status checks…
1671fd2
Upgrade to newest gradle
Loading status checks…
cbcbea7
hylkevds
1 participant
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
5
New pull request
New
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
Commits
Show all changes
1 commit
Select commit
299cb9c
Reduce log level for log messages caused by client side input mistakes
Oct 6, 2020
File filter...
Filter file types
.java
(1)
All 1 file type selected
Filter viewed files
Hide viewed files
Clear filters
Jump to…
Jump to file
Failed to load files.
ilylia:master
branch from
1bad339
to
74d92f9
Jun 20, 2019
Copy link
Quote reply
Author
ilylia
commented
Jun 20, 2019
Hi
@andsel
, there is a test case for the trie match bug in the new pr, please check.
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Question: disconnecting a client when authentication details removed
#516
Open
MattyyttaM
opened this issue
Jan 23, 2020
· 0 comments
Open
Question: disconnecting a client when authentication details removed
#516
MattyyttaM
opened this issue
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Error occurs on the CONNECT -> CONNACK sequence
Minimal yet complete reproducer code (or URL to code) or complete log file
I cant provide the code unfortunately. Reproducing should be simple though. If needed I can build a standalone example, but it will take me an hour or two. Here you can find a full log file:
https://pastebin.com/x9tNYVE0
Moquette MQTT version
0.12.1
JVM version (e.g.
java -version
)
Java 8 1.8.0_201
OS version (e.g.
uname -a
)
Windows 10
Copy link
Contributor
Author
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Moquette 0.12.1 versions release
Loading branch information
andsel
committed
Feb 24, 2019
1 parent
b827ad4
commit
26e43c519ee69c00e0608796b6b8fafa03dbe999
Unified
"
goto
gotHome
4
distribution/src/main/scripts/moquette.sh
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,6 @@
#!
/bin/sh
#
#
Copyright (c) 2012-
2015
https://github.com/notifications/unsubscribe-auth/AAH5RUMNBGPURCWKGD2UKLTQ6F2OHANCNFSM4KIDNQKA
.
Using Interceptor we can only send data to remote. What about to receive messages from remote? I have seen some blogs but there is no configuration here [https://aws.amazon.com/blogs/iot/how-to-bridge-mosquitto-mqtt-broker-to-aws-iot/]
carlsberg-stack
reopened this
Jan 20, 2020
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
c367100
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
<
version
>3.1.0</
version
>
</
dependency
>
<
dependency
>
<
groupId
>org.slf4j</
groupId
>
<
artifactId
>slf4j-api</
artifactId
include
>**/*Test.java</
include
>
</
includes
>
</
configuration
>
</
plugin
>
<!--
Generate the test-jar
-->
<
plugin
>
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Save preferences
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Reviews
Filter by reviews
No reviews
Review required
Approved review
Changes requested
Assignee
mentioned this pull request
May 15, 2020
NullPointerException in CTrie.evaluate
#529
Open
hylkevds
mentioned this pull request
Aug 14, 2020
Fix java 11+ build and tests
#533
Open
Sign up for free
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
BUG - null Session in subscribe procedure
#517
Open
BigGitWorld
opened this issue
Feb 14, 2020
· 0 comments
Open
queue is full · Issue #521 · moquette-io/moquette · GitHub
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Filter by project
Milestones
Filter by milestone
Reviews
Filter by reviews
No reviews
Review required
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
Retry
Always
Unified
Split
Just for now
Hide whitespace changes
Apply and reload
10
broker/src/main/java/io/moquette/broker/MQTTConnection.java
Show comments
View file
Edit file
Delete file
Open in desktop
@@ -140,13 +140,13 @@ void processConnect(MqttConnectMessage msg) {
final
boolean
cleanSession
andsel
reviewed
Jun 20, 2019
View changes
broker/src/main/java/io/moquette/broker/subscriptions/CTrie.java
Show resolved
Hide resolved
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
andsel
Assignees
No one assigned
Labels
None yet
Projects
Jan 23, 2020
· 0 comments
Comments
Copy link
Quote reply
MattyyttaM
commented
Jan 23, 2020
Is there a way I can disconnect a client(s) that have connected to a certain user/password combination?
I'm trying to dynamically create/remove users whilst the broke is running. If a client has already connected with a given user/password combination and I then remove it, I want to client to be told to disconnect, if this is doable.
Moquette MQTT version
0.12.1
👍
1
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
PHameete
commented
Jan 21, 2020
Hi
@andsel
I no longer see the java IOException. But is is possible to lower the log level for invalid credentials to INFO?
I could change it, if you are accepting pull requests?
Copy link
Collaborator
andsel
commented
Jan 21, 2020
Hi Pieter, feel free to propose a PR I'll be happy to review it
…
On Tue, Jan 21, 2020 at 1:57 PM Pieter Hameete ***@***.***> wrote: Hi
@andsel
<
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes
#518
Open
carlsberg-stack
opened this issue
Feb 27, 2020
· 0 comments
Open
Split
Showing
5 changed files
with
6 additions
and
6 deletions
.
+1
−1
broker/src/main/java/io/moquette/broker/Server.java
+2
−2
build.gradle
+1
−1
distribution/src/main/scripts/moquette.bat
+1
−1
Andrea Selva
#
Copyright (c) 2012-
2020
Andrea Selva
#
echo
"
"
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
"
echo
"
|_|
"
echo
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
2 participants
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
>
<
version
>1.7.5</
version
>
<
scope
>test</
scope
>
</
dependency
>
<
dependency
>
<
<
groupId
>org.apache.maven.plugins</
groupId
>
<
artifactId
>maven-jar-plugin</
artifactId
>
<
version
>3.0.2</
version
>
<
executions
>
<
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
We've detected that JavaScript is disabled in your browser. Would you like to proceed to legacy Twitter?
Yes
Something went wrong, but don’t fret — let’s give it another shot.
document.cookie = decodeURIComponent("gt=1319308132447813632; Max-Age=10800; Domain=.twitter.com; Path=/; Secure");
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
Security
Insights
Labels
7
Milestones
5
Labels
7
Milestones
5
New pull request
New
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
None yet
1 participant
Add this suggestion to a batch that can be applied as a single commit.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
BUG - null Session in subscribe procedure
#517
BigGitWorld
opened this issue
Feb 14, 2020
· 0 comments
Comments
Copy link
Quote reply
BigGitWorld
commented
Feb 14, 2020
•
edited
Expected behavior
Suppose a mqtt client with a specific CLIENT-ID is connected to the server.
Now another mqtt client with the same CLIENT-ID wants to connect to the server.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
fix trie match bug and bytesMetrics bug
#479 opened
Jun 2, 2019
by
ilylia
4
ProTip!
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
=
msg
.
variableHeader()
.
isCleanSession();
if
(clientId
==
null
||
clientId
.
length()
==
0
) {
if
None yet
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
None yet
2 participants
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
https://github.com/andsel
> I no longer see the java IOException. But is is possible to lower the log level for invalid credentials to INFO? I could change it, if you are accepting pull requests? — You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <
#463
?email_source=notifications&email_token=AAH5RUNVC47NGTXBTSKCGC3Q63WKRA5CNFSM4HCIJCHKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEJPULJY#issuecomment-576669095>, or unsubscribe <
https://github.com/notifications/unsubscribe-auth/AAH5RUIN7NK4IQAZBZ4UCNDQ63WKRANCNFSM4HCIJCHA
> .
PHameete
mentioned this issue
Oct 6, 2020
Reduce log level for log messages caused by client side input mistakes
#537
Merged
Copy link
Contributor
Author
PHameete
commented
java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes
#518
carlsberg-stack
opened this issue
Feb 27, 2020
· 0 comments
Comments
Copy link
Quote reply
carlsberg-stack
commented
Feb 27, 2020
•
edited
Server Log
2020-02-28 13:03:11.970 20418-20876/ I/System.out: 117068 [nioEventLoopGroup-5-1] DEBUG io.moquette.broker.AutoFlushHandler - Initializing autoflush handler on channel [id: 0x82488a46, L:/172.16.1.196:1883 - R:/172.16.1.196:38308] Cid: null
2020-02-28 13:03:12.309 20418-20876/ I/System.out: 117404 [nioEventLoopGroup-5-1] INFO io.moquette.broker.metrics.MQTTMessageLogger - C->B CONNECT
distribution/src/main/scripts/moquette.sh
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
2
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -55,7 +55,7 @@
public
static
void
main
(
"
"
echo
"
version: 0.
.13-SNAPSHOT
"
echo
"
version: 0.
13
"
cd
"
$(
dirname
"
$0
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
groupId
>org.slf4j</
groupId
>
<
artifactId
>slf4j-log4j12</
artifactId
>
<
version
>1.7.5</
version
>
<
scope
>test</
execution
>
<
goals
>
<
goal
>test-jar</
goal
>
</
goals
>
</
execution
>
</
executions
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Packages
People
Projects
Type:
All
Select type
All
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
Private
Select visibility
All
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Clear current search query, filters, and sorts
2 Open
0 Closed
2 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
🚀
👀
Authentication changes
#507 opened
Oct 11, 2019
by
ndchandar
2
ProTip!
Add
no:assignee
to see everything that’s not assigned.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Learn more
Accept
Reject
Save preferences
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
I expect:
At first, the server disconnects the old client.
And then, the new client can connect to the server.
In implementation:
I expect the new client's thread waits for completing the old client disconnection and then do its task.
Actual behavior
In Actual case, I observed that :
processConnect()
will be called for the new client and because this CLIENT-ID exists in the sessions (due to the old client), So nothing is added to the sessions.
And concurrently the server disconnects the old client and remove it's session from
sessionRegistry
.
And Now when the new client wants to subscribe to a topic (after successfully connection),
in the
PostOffice#subscribeClientToTopics()
Reduce log level for log messages caused by client side input mistake… · moquette-io/moquette@7b9db6e · GitHub
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Add
no:assignee
to see everything that’s not assigned.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
moquette
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
broker
/
MQTTConnection.java
/
Jump to
(
!
brokerConfig
.
isAllowZeroByteClientId()) {
LOG
.
warn
(
"
"
, username, channel);
LOG
.
info
(
"
"
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Oct 6, 2020
HI
@andsel
sorry this took a while. But i've opened a PR for this:
#537
This lowers the log level for some error/warn logging caused by client mistakes to info.
andsel
closed this in
#537
Oct 9, 2020
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
2020-02-28 13:03:12.316 20418-20876/ I/System.out: 117412 [nioEventLoopGroup-5-1] DEBUG io.moquette.broker.MQTTConnection - Received MQTT message, type: CONNECT, channel: [id: 0x82488a46, L:/172.16.1.196:1883 - R:/172.16.1.196:38308]
2020-02-28 13:03:12.431 20418-20876/ I/System.out: 117431 [nioEventLoopGroup-5-1] ERROR io.moquette.broker.NewNettyMQTTHandler - Error processing protocol message: CONNECT
2020-02-28 13:03:12.431 20418-20876/ I/System.out: java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes (declaration of 'org.apache.commons.codec.binary.Hex' appears in /system/framework/org.apache.http.legacy.boot.jar)
2020-02-28 13:03:12.432 20418-20876/ I/System.out: at org.apache.commons.codec.digest.DigestUtils.sha256Hex(DigestUtils.java:500)
2020-02-28 13:03:12.432 20418-20876/ I/System.out: at io.moquette.broker.security.ResourceAuthenticator.checkValid(ResourceAuthenticator.java:124)
2020-02-28 13:03:12.432 20418-20876/ I/System.out: at io.moquette.broker.MQTTConnection.login(MQTTConnection.java:235)
2020-02-28 13:03:12.432 20418-20876/ I/System.out: at io.moquette.broker.MQTTConnection.processConnect(MQTTConnection.java:160)
2020-02-28 13:03:12.432 20418-20876/ I/System.out: at io.moquette.broker.MQTTConnection.handleMessage(MQTTConnection.java:67)
2020-02-28 13:03:12.433 20418-20876/ I/System.out: at io.moquette.broker.NewNettyMQTTHandler.channelRead(NewNettyMQTTHandler.java:58)
2020-02-28 13:03:12.433 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
2020-02-28 13:03:12.433 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
2020-02-28 13:03:12.433 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
2020-02-28 13:03:12.433 20418-20876/ I/System.out: at io.moquette.broker.metrics.MQTTMessageLogger.channelRead(MQTTMessageLogger.java:46)
2020-02-28 13:03:12.434 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
String
[]
args
)
throws
IOException
{
final
Server
server
=
new
Server
();
server
.
startServer();
System
"
)
"
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
@GrabResolver
(
name
=
'
moquette-bintray
'
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
scope
>
</
dependency
>
65
osgi_test/src/test/java/io/moquette/test/osgi/MoquetteOsgiTest.java
Show comments
View file
Edit file
Delete file
@@ -18,15 +18,18 @@
import static
org.junit.Assert.*
;
import static
org.ops4j.pax.exam.CoreOptions.*
>
</
plugin
>
<!--
Includes to generate OSGi headers
-->
<
plugin
>
<
artifactId
>maven-jar-plugin</
artifactId
>
<
configuration
>
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
3 Open
15 Closed
3 Open
15 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Private
Public
Sort by:
Most downloads
Select sort view
Most downloads
Least downloads
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Reviews
Filter by reviews
No reviews
Review required
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
the below line results is a NULL:
And therefore the below line will results in a NPE:
Steps to reproduce
Minimal yet complete reproducer code (or URL to code) or complete log file
Moquette MQTT version
Latest version (0.12.1)
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Fixes #529, #505: NPE caused by matching on a TNode by hylkevds · Pull Request #532 · moquette-io/moquette · GitHub
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
fixed throw NullPointerException when new connection
#519
Open
Code definitions
MQTTConnection
Class
handleMessage
Method
processPubComp
Method
processPubRec
Method
pubrel
Method
, username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
}
if
(
!
cleanSession) {
LOG
.
warn
(
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
Reduce log level for log messages caused by client side input mistakes
2 participants
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
2020-02-28 13:03:12.434 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
2020-02-28 13:03:12.434 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
2020-02-28 13:03:12.434 20418-20876/ I/System.out: at io.moquette.broker.metrics.MessageMetricsHandler.channelRead(MessageMetricsHandler.java:50)
2020-02-28 13:03:12.434 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
2020-02-28 13:03:12.435 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
2020-02-28 13:03:12.435 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
2020-02-28 13:03:12.435 20418-20876/ I/System.out: at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
2020-02-28 13:03:12.436 20418-20876/ I/System.out: at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
2020-02-28 13:03:12.436 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
2020-02-28 13:03:12.436 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
2020-02-28 13:03:12.436 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
2020-02-28 13:03:12.437 20418-20876/ I/System.out: at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
2020-02-28 13:03:12.437 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
2020-02-28 13:03:12.437 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
.
out
.
println(
"
Server started, version 0.12.1
-SNAPSHOT
"
);
System
.
out
.
println(
"
Server started, version 0.12.1
"
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
'
io.moquette
'
,
module
=
'
moquette-broker
;
import
java.util.Arrays
;
import
java.util.LinkedList
;
import
java.util.List
;
import
org.junit.Test
;
import
org.junit.runner.RunWith
;
import
<
archive
>
<
manifestFile
>
/META-INF/MANIFEST.MF</
manifestFile
>
</
archive
>
</
configuration
>
<
executions
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Authentication changes
#507
Open
ndchandar
👎
😄
🎉
😕
❤️
🚀
👀
Java 11 compatibility
#498 opened
Aug 17, 2019
by
qbast
Clean test storage on exit to prevent assert in next test
#497 opened
Aug 16, 2019
by
qbast
ProTip!
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Clear current search query, filters, and sorts
2 Open
0 Closed
2 Open
0 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Question: disconnecting a client when authentication details removed
#516 opened
Jan 23, 2020
by
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
luoliangtiger
wants to merge
1
commit into
moquette-io
:
master
base:
master
from
luoliangtiger
:
master
Open
fixed throw NullPointerException when new connection
#519
luoliangtiger
wants to merge
processPubAck
Method
processConnect
Method
setupInflightResender
Method
initializeKeepAliveTimeout
Method
setIdleTime
Method
isNotProtocolVersion
Method
abortConnection
Method
connAck
Method
login
"
"
,
LOG
.
info
(
"
"
,
username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
@@ -229,17 +229,17 @@ private boolean login(MqttConnectMessage msg, final String clientId) {
if
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Reject
Save preferences
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
2020-02-28 13:03:12.437 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
2020-02-28 13:03:12.437 20418-20876/ I/System.out: at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
2020-02-28 13:03:12.438 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
2020-02-28 13:03:12.438 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
2020-02-28 13:03:12.438 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
2020-02-28 13:03:12.438 20418-20876/ I/System.out: at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
2020-02-28 13:03:12.439 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
2020-02-28 13:03:12.439 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
2020-02-28 13:03:12.439 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
2020-02-28 13:03:12.439 20418-20876/ I/System.out: at io.moquette.broker.metrics.BytesMetricsHandler.channelRead(BytesMetricsHandler.java:51)
2020-02-28 13:03:12.439 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
2020-02-28 13:03:12.439 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
2020-02-28 13:03:12.440 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
2020-02-28 13:03:12.440 20418-20876/ I/System.out: at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1414)
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
(server
::
stopServer));
}
4
build.gradle
Show comments
View file
'
,
version
=
'
0.13
-SNAPSHOT
'
)
@Grab
(
group
=
'
io.moquette
'
,
module
=
org.ops4j.pax.exam.Configuration
;
import
org.ops4j.pax.exam.Option
;
import
org.ops4j.pax.exam.junit.PaxExam
;
import
org.osgi.framework.Bundle
;
import
org.osgi.framework.BundleContext
;
import
org.slf4j.Logger
;
>
<
execution
>
<
goals
>
<
goal
>test-jar</
goal
>
</
goals
>
</
execution
>
👎
😄
🎉
😕
❤️
🚀
👀
BUG - null Session in subscribe procedure
#517 opened
Feb 14, 2020
by
BigGitWorld
Subscription storage
#482 opened
Jun 12, 2019
by
BigGitWorld
Publish Failed Acknowledgment
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
wants to merge
1
commit into
moquette-io
:
master
base:
master
from
ndchandar
:
master
Open
Authentication changes
#507
ndchandar
wants to merge
1
Add
no:assignee
to see everything that’s not assigned.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
Accept
Reject
Save preferences
Save preferences
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
MattyyttaM
ProTip!
Type
g
p
on any issue or pull request to go back to the pull request listing page.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
Packages · Moquette · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
1
commit into
moquette-io
:
master
from
luoliangtiger
:
master
Conversation
0
Commits
1
Checks
0
Files changed
Conversation
Copy link
Method
handleConnectionLost
Method
sendConnAck
Method
isConnected
Method
dropConnection
Method
processDisconnect
Method
processSubscribe
Method
(msg
.
variableHeader()
.
hasPassword()) {
pwd
=
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
2020-02-28 13:03:12.440 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
2020-02-28 13:03:12.440 20418-20876/ I/System.out: at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
2020-02-28 13:03:12.440 20418-20876/ I/System.out: at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:945)
2020-02-28 13:03:12.441 20418-20876/ I/System.out: at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:146)
2020-02-28 13:03:12.441 20418-20876/ I/System.out: at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
2020-02-28 13:03:12.441 20418-20876/ I/System.out: at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
2020-02-28 13:03:12.441 20418-20876/ I/System.out: at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
2020-02-28 13:03:12.442 20418-20876/ I/System.out: at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
2020-02-28 13:03:12.442 20418-20876/ I/System.out: at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:886)
2020-02-28 13:03:12.442 20418-20876/ I/System.out: at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
2020-02-28 13:03:12.442 20418-20876/ I/System.out: at java.lang.Thread.run(Thread.java:764)
2020-02-28 13:03:12.450 20418-20876/ I/System.out: 117548 [nioEventLoopGroup-5-1] INFO io.moquette.broker.NewNettyMQTTHandler - Closed client channel due to exception in processing
// Paho Client Log
2020-02-28 13:03:12.469 20418-20418/ W/System.err: Connection lost (32109) - java.io.EOFException
2020-02-28 13:03:12.469 20418-20418/ W/System.err: at org.eclipse.paho.client.mqttv3.internal.CommsReceiver.run(CommsReceiver.java:190)
Edit file
Delete file
@@ -3,7 +3,7 @@ allprojects {
apply
plugin
:
'
maven-publish
'
group
=
'
io.moquette
'
version
=
'
0.12.1
'
moquette-broker
'
,
version
=
'
0.13
'
)
import
io.moquette.server.Server
Toggle all file notes
0 comments on commit
3b83f47
Please
sign in
import
org.slf4j.LoggerFactory
;
import
javax.inject.Inject
;
/**
@@ -35,6 +38,9 @@
*/
@RunWith
(
PaxExam
.
class)
public
class
MoquetteOsgiTest
{
</
executions
>
</
plugin
>
<
plugin
>
<
groupId
>org.apache.felix</
groupId
>
<
artifactId
>maven-bundle-plugin</
artifactId
>
#433 opened
Oct 22, 2018
by
BigGitWorld
ProTip!
Adding
no:label
will show everything without a label.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
commit into
moquette-io
:
master
from
ndchandar
:
master
Conversation
2
Commits
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
😄
🎉
😕
❤️
🚀
👀
java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes
#518 opened
Feb 27, 2020
by
carlsberg-stack
Bridging to a cloud broker [Microsoft Azure -- IOT Hub] ?
#513 opened
Jan 17, 2020
by
carlsberg-stack
5
ProTip!
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Join GitHub · GitHub
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Quote reply
luoliangtiger
commented
Mar 2, 2020
java.lang.NullPointerException
at java.util.concurrent.ConcurrentHashMap.get(ConcurrentHashMap.java:936)
at io.moquette.broker.SessionRegistry.retrieve(SessionRegistry.java:233)
at io.moquette.broker.PostOffice.flushInFlight(PostOffice.java:313)
at io.moquette.broker.MQTTConnection.readCompleted(MQTTConnection.java:507)
at io.moquette.broker.NewNettyMQTTHandler.channelReadComplete(NewNettyMQTTHandler.java:76)
fixed throw NullPointerException when new connection
…
Loading status checks…
2cadef6
Sign up for free
to join this conversation on GitHub
sendSubAckMessage
Method
processUnsubscribe
Method
sendUnsubAckMessage
Method
processPublish
Method
sendPublishReceived
Method
processPubRel
Method
sendPublish
Method
sendIfWritableElseDrop
Method
writabilityChanged
Method
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error
(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
LOG
.
info
2020-02-28 13:03:12.470 20418-20418/ W/System.err: at java.lang.Thread.run(Thread.java:764)
2020-02-28 13:03:12.471 20418-20418/ W/System.err: Caused by: java.io.EOFException
2020-02-28 13:03:12.471 20418-20418/ W/System.err: at java.io.DataInputStream.readByte(DataInputStream.java:270)
2020-02-28 13:03:12.472 20418-20418/ W/System.err: at org.eclipse.paho.client.mqttv3.internal.wire.MqttInputStream.readMqttWireMessage(MqttInputStream.java:92)
2020-02-28 13:03:12.472 20418-20418/ W/System.err: at org.eclipse.paho.client.mqttv3.internal.CommsReceiver.run(CommsReceiver.java:137)
2020-02-28 13:03:12.472 20418-20418/ W/System.err: ... 1 more
carlsberg-stack
changed the title
Connecting Using username and password throw error? Working fine without authentication
java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes
Feb 28, 2020
Sign up for free
to join this conversation on GitHub
-SNAPSHOT
'
version
=
'
0.12.1
'
}
buildscript
{
@@ -92,7 +92,7 @@ subprojects {
from components
.
java
groupId
"
$p
roject
.
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
MoquetteOsgiTest
.
class);
@Inject
private
BundleContext
bundleContext;
@@ -43,7 +49,42 @@
return
<
executions
>
<
execution
>
<
id
>bundle-manifest</
id
>
<
phase
>process-classes</
phase
>
<
goals
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
1
Checks
0
Files changed
Conversation
Copy link
Quote reply
ndchandar
commented
Oct 11, 2019
IAuthenticator.checkValid
should return
CompletableFuture<Boolean>
Notes
I can add more tests based on review/feedback
Once the PR is approved, i can work similar changes for
IAuthorizatorPolicy
Authentication Changes: IAuthenticator.checkValid should return `Comp…
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Adding
no:label
will show everything without a label.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Save preferences
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
queue is full
#521
Open
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
. Already have an account?
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
None yet
1 participant
Add this suggestion to a batch that can be applied as a single commit.
sendPubAck
Method
sendPubCompMessage
Method
getClientId
Method
getUsername
Method
sendPublishRetainedQos0
Method
sendPublishRetainedWithPacketId
Method
retainedPublish
Method
retainedPublishWithMessageId
Method
sendPublishNotRetainedQos0
(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
return
false
;
}
final
String
login
=
msg
.
payload()
.
userName();
if
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
group
"
artifactId
"
${
project.name
}
"
version
'
0.12.1
-SNAPSHOT
'
version
'
0.12.1
'
}
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
options(
junitBundles(),
mavenBundle(
"
io.moquette
"
,
"
moquette-broker
"
)
mavenBundle(
"
com.google.guava
"
,
"
guava
>
<
goal
>manifest</
goal
>
</
goals
>
</
execution
>
</
executions
>
<
configuration
>
<
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
…
Loading status checks…
5d23808
ndchandar
force-pushed
the
ndchandar:master
branch from
3fe6e9b
to
5d23808
Oct 11, 2019
Copy link
Quote reply
Author
ndchandar
commented
Oct 14, 2019
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Reduce log level for log messages caused by client side input mistakes (
Loading branch information
PHameete
and
Pieter Hameete
committed
Oct 9, 2020
Verified
arifainchtein
opened this issue
Mar 28, 2020
· 0 comments
Open
queue is full
#521
arifainchtein
opened this issue
Mar 28, 2020
· 0 comments
Comments
Copy link
Quote reply
arifainchtein
commented
Mar 28, 2020
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
↵
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Method
notRetainedPublish
Method
notRetainedPublishWithMessageId
Method
resendNotAckedPublishes
Method
nextPacketId
Method
toString
Method
remoteAddress
Method
readCompleted
Method
Code navigation index up-to-date
Go to file
Go to file
(
!
authenticator
.
checkValid(clientId, login, pwd)) {
LOG
.
error
(
"
"
, clientId, login);
LOG
.
info
(
"
"
, clientId, login);
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
}
}
2
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
"
echo
"
|_|
"
echo
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
)
.
versionAsInProject(),
//
mavenBundle("com.google.code.findbugs", "jsr305").versionAsInProject(),
mavenBundle(
"
com.fasterxml.jackson.core
"
,
"
jackson-core
"
)
.
versionAsInProject()
instructions
>
<
Export-Package
>
io.moquette.persistence,
io.moquette.server.config,
io.moquette.spi,
io.moquette.spi.impl.subscriptions,
</
Export-Package
>
<
Embed-Dependency
>
com.bugsnag;bugsnag,
com.librato.metrics;metrics-librato,
Save preferences
@andsel
Pinging for review. The Travis build failures seems independent of this PR.
Copy link
Quote reply
Collaborator
andsel
commented
Oct 18, 2019
Hi Dinesh, I'm slow on review, to find some time to work on this. But don't worry. Thanks for start contributing Andrea
…
On Mon, Oct 14, 2019 at 10:13 PM Dinesh Narayanan ***@***.***> wrote:
@andsel
<
https://github.com/andsel
> Pinging for review. The Travis build failures seems independent of this PR. — You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
8ba0b4d
commit
7b9db6eafd6b2beaf59184b91493360b16c5e97f
Unified
Split
Showing
1 changed file
with
5 additions
and
5 deletions
.
Hello,
I am using version 0.11 and I am getting this error. Any suggestions as to why its happening and how do i prevent it from happening?
Thanks
7013256 [nioEventLoopGroup-3-1] INFO ProtocolProcessor - Processing PUBLISH message. CId=ZhinuHeartPublisher, topic=OrganismStatus, messageId=9663, qos=AT_LEAST_ONCE 97013256 [nioEventLoopGroup-3-1] INFO MessagesPublisher - Sending publish message to subscribers. ClientId=ZhinuHeartPublisher, topic=OrganismStatus, messageId=9663 97013256 [nioEventLoopGroup-3-1] INFO PersistentQueueMessageSender - Sending PUBLISH message. MessageId=20314, CId=web_63, topic=OrganismStatus 97013256 [nioEventLoopGroup-3-1] INFO ConnectionDescriptorStore - Sending PUBLISH message CId=<web_63>, messageId=20314 97013256 [nioEventLoopGroup-3-1] ERROR NettyMQTTHandler - Exception was caught while processing MQTT message, null java.lang.IllegalStateException: Queue full at java.util.AbstractQueue.add(AbstractQueue.java:98) at java.util.concurrent.ArrayBlockingQueue.add(ArrayBlockingQueue.java:312) at io.moquette.spi.DurableSession.enqueue(DurableSession.java:207) at io.moquette.spi.impl.MessagesPublisher.publish2Subscribers(MessagesPublisher.java:107) at io.moquette.spi.impl.MessagesPublisher.publish2Subscribers(MessagesPublisher.java:71) at io.moquette.spi.impl.Qos1PublishHandler.receivedPublishQos1(Qos1PublishHandler.java:70) at io.moquette.spi.impl.ProtocolProcessor.processPublish(ProtocolProcessor.java:470) at io.moquette.server.netty.NettyMQTTHandler.channelRead(NettyMQTTHandler.java:56) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) at io.moquette.server.netty.metrics.MQTTMessageLogger.channelRead(MQTTMessageLogger.java:44) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) at io.moquette.server.netty.metrics.MessageMetricsHandler.channelRead(MessageMetricsHandler.java:48) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310) at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) at io.moquette.server.netty.metrics.BytesMetricsHandler.channelRead(BytesMetricsHandler.java:49) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:287) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1334) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:926) at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:134) at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:644) at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579) at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496) at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138) at java.lang.Thread.run(Thread.java:748)
Sign up for free
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
Type:
Container
Select type
All
Mqtt websocket http · Issue #538 · moquette-io/moquette · GitHub
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
508 lines (447 sloc)
21.6 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
return
false
;
}
NettyUtils
.
userName(channel, login);
}
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error
(
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
"
"
echo
"
version: 0.12.1
-SNAPSHOT
"
echo
"
version: 0.12.1
"
set
"
CURRENT_DIR
=
%cd%
"
if
not
.
start(),
mavenBundle(
"
com.fasterxml.jackson.core
"
,
"
jackson-databind
"
)
.
versionAsInProject(),
mavenBundle(
"
com.fasterxml.jackson.core
"
,
"
com.librato.metrics;librato-java,
</
Embed-Dependency
>
</
instructions
>
</
configuration
>
</
plugin
>
</
plugins
>
</
build
>
#507
?email_source=notifications&email_token=AAH5RUMKVVW235LHQGNGVBTQOTHGTA5CNFSM4I77QJ6KYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEBGKWGA#issuecomment-541895448>, or unsubscribe <
https://github.com/notifications/unsubscribe-auth/AAH5RULZ24VAP5P3ITL7GHLQOTHGTANCNFSM4I77QJ6A
> .
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Save preferences
+5
−5
broker/src/main/java/io/moquette/broker/MQTTConnection.java
10
broker/src/main/java/io/moquette/broker/MQTTConnection.java
Show comments
View file
Edit file
Delete file
@@ -140,13 +140,13 @@ void processConnect(MqttConnectMessage msg) {
final
boolean
cleanSession
=
msg
.
variableHeader()
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
at least 15 characters
OR
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
All
Select visibility
All
Private
Public
Sort by:
Most downloads
Select sort view
Most downloads
Least downloads
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Fixes #529, #505: NPE caused by matching on a TNode
#532
Open
hylkevds
wants to merge
1
commit into
moquette-io
:
master
base:
master
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthenticator
;
import
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
LOG
.
info
(
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
return
false
;
}
return
true
;
Toggle all file notes
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
%MOQUETTE_HOME%
"
==
"
"
goto
gotHome
2
distribution/src/main/scripts/moquette.sh
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
jackson-annotations
"
)
.
versionAsInProject(),
//
mavenBundle("com.librato.metrics", "librato-java").versionAsInProject(),
//
mavenBundle("com.librato.metrics", "metrics-librato").versionAsInProject(),
mavenBundle(
"
io.dropwizard.metrics
"
,
"
metrics-core
"
)
<
distributionManagement
>
<
repository
>
<
id
>bintray</
id
>
<
url
>https://api.bintray.com/maven/
/
</
url
>
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
None yet
2 participants
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
.
isCleanSession();
final
boolean
cleanSession
=
msg
.
variableHeader()
.
isCleanSession();
if
(clientId
==
null
||
clientId
.
length()
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
Issues · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
from
hylkevds
:
fix_529_npe_in_ctrie
Open
Fixes #529, #505: NPE caused by matching on a TNode
#532
hylkevds
wants to merge
1
commit into
moquette-io
:
master
from
hylkevds
:
io.netty.buffer.ByteBuf
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelFuture
;
import
io.netty.channel.ChannelPipeline
;
import
io.netty.handler.codec.mqtt.*
;
import
io.netty.handler.timeout.IdleStateHandler
;
import
org.slf4j.Logger
ProTip!
Use
n
and
p
to navigate between commits in a pull request.
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.12.1
-SNAPSHOT
"
echo
"
version: 0.12.1
"
cd
.
versionAsInProject(),
mavenBundle(
"
io.dropwizard.metrics
"
,
"
metrics-jvm
"
)
.
versionAsInProject(),
mavenBundle(
"
com.hazelcast
"
</
repository
>
</
distributionManagement
>
</
project
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
==
0
) {
if
(clientId
==
null
||
clientId
.
length()
==
0
) {
if
(
!
brokerConfig
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
fix_529_npe_in_ctrie
Conversation
0
Commits
1
Checks
0
Files changed
Conversation
Copy link
Quote reply
Contributor
hylkevds
commented
Aug 13, 2020
This PR
fixes
;
import
org.slf4j.LoggerFactory
;
import
java.net.InetSocketAddress
;
import
java.nio.charset.StandardCharsets
;
import
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
"
$(
dirname
"
$0
"
)
"
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
,
"
hazelcast
"
)
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
,
"
netty-common
"
)
.
versionAsInProject(),
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
.
isAllowZeroByteClientId()) {
if
(
!
brokerConfig
.
isAllowZeroByteClientId()) {
LOG
.
warn
(
"
"
, username, channel);
LOG
.
info
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Support
Help
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
#529
,
#505
.
In high load conditions, TNodes are not removed from the tree fast enough, and are evaluated when matching topics.
This PR moves the check that skips TNodes forward, before child nodes are even considered. As a side effect, no EmptySet is created and added to the matched subscriptions.
Fixes
#529
,
#505
: NPE caused by matching on a TNode
72a21ef
Sign up for free
to join this conversation on GitHub
. Already have an account?
java.util.*
;
import
java.util.concurrent.TimeUnit
;
import
java.util.concurrent.atomic.AtomicInteger
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
import static
io.netty.handler.codec.mqtt.MqttConnectReturnCode.*
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
@@ -1,5 +1,5 @@
@GrabResolver
(
name
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
mavenBundle(
"
io.netty
"
,
"
netty-buffer
"
)
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
,
"
netty-transport
"
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
(
"
"
, username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
return
;
}
}
if
(
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
NullPointerException in CTrie.evaluate
1 participant
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
;
import static
io.netty.handler.codec.mqtt.MqttMessageIdVariableHeader.from
;
import static
io.netty.handler.codec.mqtt.MqttQoS.*
;
final
class
MQTTConnection
{
private
static
final
Logger
LOG
=
LoggerFactory
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.12.1
-SNAPSHOT
'
)
@Grab
)
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
,
"
netty-resolver
"
)
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
!
cleanSession) {
if
(
!
cleanSession) {
LOG
.
warn
(
"
"
,
LOG
.
info
(
"
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
.
getLogger(
MQTTConnection
.
class);
final
Channel
channel;
private
BrokerConfiguration
brokerConfig;
private
IAuthenticator
authenticator;
private
SessionRegistry
sessionRegistry;
private
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
(
group
=
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.12.1
'
)
import
,
"
netty-handler
"
)
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
,
"
netty-handler
"
)
.
versionAsInProject(),
mavenBundle(
"
,
username, channel);
username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
return
;
@@ -229,17 +229,17 @@ private boolean login(MqttConnectMessage msg, final String clientId) {
if
(msg
.
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Already on GitHub?
Sign in
to your account
Jump to bottom
Mqtt websocket http
#538
Open
strautins
opened this issue
Oct 22, 2020
· 1 comment
Open
Mqtt websocket http
#538
strautins
opened this issue
Oct 22, 2020
· 1 comment
Comments
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
final
PostOffice
postOffice;
private
boolean
connected;
private
final
AtomicInteger
lastPacketId
=
new
AtomicInteger
(
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
io.moquette.server.Server
Toggle all file notes
0 comments on commit
26e43c5
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
"
io.netty
"
,
"
netty-codec
"
)
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
,
"
netty-codec-http
"
)
variableHeader()
.
hasPassword()) {
if
(msg
.
variableHeader()
.
hasPassword()) {
pwd
=
msg
.
payload()
.
password()
.
getBytes(
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Copy link
Quote reply
strautins
commented
Oct 22, 2020
Hello,
Trying to understand http api for moquette broker.
Can somebody give me documentation info of how to post on http mqtt messages to moquette?
With client id, login, password etc.
WEB_SOCKET_PORT_PROPERTY_NAME = "websocket_port";
WEB_SOCKET_PATH_PROPERTY_NAME = "websocket_path";
so far I get
ERROR NewNettyMQTTHandler - Unexpected exception while processing MQTT message. Closing Netty channel. CId=null java.lang.ClassCastException: io.netty.handler.codec.http.HttpObjectAggregator$AggregatedFullHttpRequest cannot be cast to io.netty.handler.codec.mqtt.MqttMessage
Can't get good info from google,
Thanks
Copy link
Author
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
0
);
MQTTConnection
(
Channel
channel
,
BrokerConfiguration
brokerConfig
,
IAuthenticator
authenticator
,
SessionRegistry
sessionRegistry
,
PostOffice
postOffice
) {
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
,
"
netty-codec-mqtt
"
)
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
,
"
StandardCharsets
.
UTF_8
);
pwd
=
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
63 Open
314 Closed
63 Open
314 Closed
strautins
commented
Oct 22, 2020
Correcting, there is no default http post for mqtt, false info I have got. AWS created their own support. So info how to implement websockets?
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
this
.
channel
=
channel;
this
.
brokerConfig
=
brokerConfig;
this
.
authenticator
=
authenticator;
this
.
sessionRegistry
=
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
netty-transport-native-epoll
"
)
.
versionAsInProject(),
mavenBundle(
"
io.netty
"
,
"
netty-transport-native-unix-common
"
)
.
versionAsInProject(),
mavenBundle(
"
commons-codec
Issues · moquette-io/moquette · GitHub
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
}
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Sign in to GitHub · GitHub
sessionRegistry;
this
.
postOffice
=
postOffice;
this
.
connected
=
false
;
}
void
handleMessage
(
"
,
"
commons-codec
"
)
.
versionAsInProject(),
mavenBundle(
"
javax.servlet
"
,
"
javax.servlet-api
"
)
.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
LOG
.
info
(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
return
false
;
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
MqttMessage
msg
) {
MqttMessageType
messageType
=
msg
.
fixedHeader()
.
messageType();
LOG
.
debug(
"
"
, messageType, channel);
switch
versionAsInProject(),
mavenBundle(
"
io.moquette
"
,
"
moquette-broker
"
)
.
versionAsInProject(),
mavenBundle(
"
com.h2database
"
,
Issues · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
return
false
;
}
}
final
String
login
=
msg
.
payload()
.
userName();
final
String
login
❤️
🚀
👀
client can't reconnect to the broker once exception happened inner processSubscribe()
#388 opened
Feb 6, 2018
by
fjcyue
6
Add Ping Request handling to the interceptors
#481 opened
Jun 5, 2019
by
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Sign in to GitHub · GitHub
Skip to content
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
(messageType) {
case
CONNECT
:
processConnect((
MqttConnectMessage
) msg);
break
;
case
SUBSCRIBE
:
processSubscribe((
MqttSubscribeMessage
) msg);
break
;
case
"
h2-mvstore
"
)
.
versionAsInProject(),
mavenBundle(
"
io.moquette
"
,
"
moquette-h2-storage
"
)
.
versionAsInProject(),
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
=
msg
.
payload()
.
userName();
if
(
!
authenticator
.
checkValid(clientId, login, pwd)) {
if
(
!
authenticator
.
djbr-david
6
Potential Bug in NextPacketID
bug
#237 opened
Nov 29, 2016
by
peacecoder
Memory grows infinitely when Qos set 2
#423 opened
Jul 10, 2018
by
zhengyangyong
3
Will Message lost if client reconnect before server clear the old connection
#366 opened
Oct 22, 2017
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
UNSUBSCRIBE
:
processUnsubscribe((
MqttUnsubscribeMessage
) msg);
break
;
case
PUBLISH
:
processPublish((
MqttPublishMessage
) msg);
break
;
case
PUBREC
:
processPubRec(msg);
mavenBundle(
"
org.mapdb
"
,
"
mapdb
"
)
.
versionAsInProject(),
mavenBundle(
"
io.moquette
"
,
"
moquette-mapdb-storage
Sign in to GitHub · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
checkValid(clientId, login, pwd)) {
LOG
.
error
(
"
"
, clientId, login);
LOG
.
info
(
"
"
, clientId, login);
return
false
;
by
fjcyue
1
1
Mqtt websocket http
#538 opened
Oct 22, 2020
by
strautins
1
Plans to support MQTT 5?
#490 opened
Jul 23, 2019
by
mpe85
6
Buffering settings to reduce latency
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
break
;
case
PUBCOMP
:
processPubComp(msg);
break
;
case
PUBREL
:
processPubRel(msg);
break
;
case
DISCONNECT
:
processDisconnect(msg);
"
)
.
versionAsInProject()
);
}
@@ -55,15 +96,23 @@
*/
@Test
public
void
testCanFindOsgiBundle
()
throws
Exception
{
List<
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
return
false
;
}
}
NettyUtils
.
userName(channel, login);
NettyUtils
.
userName(channel, login);
}
else
if
(
!
brokerConfig
.
#527 opened
May 8, 2020
by
impliedx
1
checkHeaderAvailability don't check max remaininglength
#217 opened
Oct 12, 2016
by
beyondfengyu
1
New configuration parameter : setting the HandshakeTimeout on SslHandler
#531 opened
Jul 23, 2020
by
dsoulayrol
Authorizator based on client Certificate information
#328 opened
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
break
;
case
PUBACK
:
processPubAck(msg);
break
;
case
PINGREQ
:
MqttFixedHeader
pingHeader
=
new
MqttFixedHeader
(
MqttMessageType
String
>
list
=
new
LinkedList<>
(
Arrays
.
asList(
"
io.moquette.broker
"
,
"
io.moquette.h2-storage
"
,
"
Sign in to GitHub · GitHub
Skip to content
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
isAllowAnonymous()) {
}
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error
(
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
Jun 15, 2017
by
edenmob
1
Broker does not reject connections with clientId longer than 23 characters for MQTT v3.1
#522 opened
Mar 31, 2020
by
mjacoby
Embedding example throws java.lang.UnsupportedOperationException: direct buffer
#534 opened
Sep 16, 2020
by
micw
.
PINGRESP
,
false
,
AT_MOST_ONCE
,
false
,
0
);
MqttMessage
pingResp
=
new
MqttMessage
(pingHeader);
channel
io.moquette.mapdb-storage
"
));
List<
String
>
inactive
=
new
LinkedList<>
();
for
(
Bundle
b
:
bundleContext
.
getBundles()) {
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Join GitHub · GitHub
Security Policy · moquette-io/moquette · GitHub
LOG
.
info
(
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
return
false
;
return
false
;
}
}
return
Error processing protocol message: PUBACK
#483 opened
Jun 13, 2019
by
Demitrius
Significant (>90%) message loss under heavy load
#480 opened
Jun 5, 2019
by
flonix8
2
In BytesMetrics wroteBytes always return 0
#425 opened
Jul 27, 2018
by
mjpatelsls
1
java.lang.ClassCastException: io.netty.handler.codec.http.HttpObjectAggregator$AggregatedFullHttpRequest cannot be cast to io.moquette.parser.proto.messages.AbstractMessage
.
writeAndFlush(pingResp)
.
addListener(
CLOSE_ON_FAILURE
);
break
;
default
:
LOG
.
error(
"
"
, messageType, channel);
break
;
Sign in to GitHub · GitHub
Skip to content
String
symbolicName
=
b
.
getSymbolicName();
System
.
out
.
format(
"
%s %d
\n
"
, symbolicName, b
.
getState());
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Travis CI - Test and Deploy Your Code with Confidence
Hey there!
Looks like you have JavaScript disabled.
The Travis CI webclient needs JavaScript to work properly.
Please enable JavaScript to get the best Travis CI experience.
Thank you!
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
true
;
return
true
;
Toggle all file notes
0 comments on commit
7b9db6e
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
#290 opened
Mar 23, 2017
by
leesangboo
7
ConcurrentModificationException while stress testing
invalid
#427 opened
Aug 9, 2018
by
rakechan
2
BrokerInterceptor thread pool never closing on serverStop
#506 opened
Oct 9, 2019
by
}
}
private
void
processPubComp
(
MqttMessage
msg
) {
final
int
messageID
=
((
MqttMessageIdVariableHeader
) msg
.
variableHeader())
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
if
(symbolicName
!=
null
&&
symbolicName
.
indexOf(
"
moquette
"
)
!=
-
1
) {
return
;
LOG
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
bobrowskim
license is missing in artifact
#492 opened
Jul 30, 2019
by
ascheman
Subscription breaks during performance test
#505 opened
Oct 4, 2019
by
JinseonyLee
1
MQTT SSL not working
#499 opened
Aug 20, 2019
by
francesco98
1
.
messageId();
final
Session
session
=
sessionRegistry
.
retrieve(getClientId());
session
.
processPubComp(messageID);
}
private
void
processPubRec
(
MqttMessage
msg
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
.
info(
"
{} {}
"
, symbolicName, b
.
getState());
System
.
out
.
println(
"
"
+
symbolicName);
if
Clear current search query, filters, and sorts
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Allow for multiple server side clients to share a topic with queue behavior...
feature req
#158 opened
Mar 4, 2016
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Netty Leak Detection.
#467 opened
Apr 4, 2019
by
kopens
1
Exception: java.lang.NoClassDefFoundError: org/mapdb/DBMaker
#248 opened
Jan 5, 2017
by
ThomasSchemmer
3
Repeating receiving non clear session messages.
bug
#197 opened
Aug 11, 2016
by
) {
final
int
messageID
=
((
MqttMessageIdVariableHeader
) msg
.
variableHeader())
.
messageId();
final
Session
session
=
sessionRegistry
.
retrieve(getClientId());
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
(symbolicName
!=
null
) {
list
.
remove(symbolicName);
if
(b
.
getState()
!=
Bundle
.
ACTIVE
)
inactive
.
add(symbolicName);
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
by
redboy1972
updated
Jun 4, 2016
4
Repeating receiving non clear session messages.
bug
#197 opened
Aug 11, 2016
by
stayclean
updated
Sep 12, 2016
1
Authentication interface should return Optional< Principal>
feature req
#176 opened
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Pull requests · moquette-io/moquette · GitHub
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
stayclean
1
Previous
1
2
3
Next
Previous
Next
ProTip!
Adding
no:label
will show everything without a label.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
session
.
processPubRec(messageID);
}
static
MqttMessage
pubrel
(
int
messageID
) {
MqttFixedHeader
pubRelHeader
=
new
MqttFixedHeader
(
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
}
}
//
If found no bundles with moquette in the name, fail the test.
fail();
if
(
!
inactive
.
isEmpty()
||
!
list
.
isEmpty())
fail(
"
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Retained message with QoS 0
#125 opened
Nov 11, 2015
by
env3d
5
[FR]Moquette clusters
feature req
#131 opened
May 6, 2016
by
windbender
updated
Sep 12, 2016
2
Server API to get subscriptions information
feature req
#207 opened
Sep 14, 2016
by
teranisi
updated
Sep 14, 2016
3
when protocol processor is inited with ssl port the word "disabled" is used to indicate the server name
#209 opened
Password
Make sure it's
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
0
Insights
More
Code
Issues
Pull requests
Actions
Projects
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
MqttMessageType
.
PUBREL
,
false
,
AT_LEAST_ONCE
,
false
,
0
);
return
new
MqttMessage
(pubRelHeader, from(messageID));
}
private
This osgi bundles are missing:
"
+
list
+
"
this osgi packages are NOT active
"
+
inactive
);
}
}
12
osgi_test/src/test/resources/log4j.properties
Show comments
View file
Dec 11, 2015
by
pabloa
0.9
19
Avoid OutOfMemory error
feature req
#141 opened
Jan 17, 2016
by
andsel
0.9
3
Allow for multiple server side clients to share a topic with queue behavior...
feature req
#158 opened
Mar 4, 2016
by
Sep 15, 2016
by
windbender
updated
Sep 15, 2016
Intermittent concurrentModificationExceptions
bug
#208 opened
Sep 14, 2016
by
kjayashankar
updated
Sep 22, 2016
1
checkHeaderAvailability don't check max remaininglength
#217 opened
Oct 12, 2016
by
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Wiki
Security
Insights
Overview
Security policy
Security advisories
0
Overview
Security policy
Security advisories
0
No security policy detected
This project has not set up a
SECURITY.md
file yet.
© 2020 GitHub, Inc.
Terms
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
void
processPubAck
(
MqttMessage
msg
) {
final
int
messageID
=
((
MqttMessageIdVariableHeader
) msg
.
variableHeader())
.
messageId();
Session
Edit file
Delete file
@@ -0,0 +1,12 @@
#
Set root logger level to DEBUG and its only appender to A1.
log4j.rootLogger
=
ERROR, stdout
log4j.logger.io.moquette
=
DEBUG
#
stdout appender is set to be a ConsoleAppender.
log4j.appender.stdout
=
org.apache.log4j.ConsoleAppender
log4j.appender.stdout.Threshold
=
redboy1972
4
Authentication interface should return Optional< Principal>
feature req
#176 opened
May 6, 2016
by
windbender
2
Repeating receiving non clear session messages.
bug
#197 opened
Aug 11, 2016
by
stayclean
1
Server API to get subscriptions information
beyondfengyu
updated
Oct 14, 2016
1
Potential Bug in NextPacketID
bug
#237 opened
Nov 29, 2016
by
peacecoder
updated
Dec 13, 2016
processConnectionLost miss to remove the subscriptions of the client
Electron
GitHub Desktop
Support
Help
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
session
=
sessionRegistry
.
retrieve(getClientId());
session
.
pubAckReceived(messageID);
}
void
processConnect
(
MqttConnectMessage
msg
) {
MqttConnectPayload
payload
=
msg
DEBUG
#
for debug trace
log4j.appender.stdout.layout
=
org.apache.log4j.PatternLayout
#
log4j.appender.stdout.layout.ConversionPattern
=
Toggle all file notes
0 comments on commit
7c4f902
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
feature req
#207 opened
Sep 14, 2016
by
teranisi
3
Intermittent concurrentModificationExceptions
bug
#208 opened
Sep 14, 2016
by
kjayashankar
1
when protocol processor is inited with ssl port the word "disabled" is used to indicate the server name
#209 opened
Sep 15, 2016
by
windbender
question
#236 opened
Nov 18, 2016
by
shuzhongling
updated
Dec 14, 2016
1
republishing messages fails....
bug
#234 opened
Nov 17, 2016
by
windbender
updated
Dec 14, 2016
7
Exception: java.lang.NoClassDefFoundError: org/mapdb/DBMaker
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Added Apache 2.0 license · moquette-io/moquette@af8c0e3 · GitHub
.
payload();
String
clientId
=
payload
.
clientIdentifier();
final
String
username
=
payload
.
userName();
LOG
.
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
checkHeaderAvailability don't check max remaininglength
#217 opened
Oct 12, 2016
by
beyondfengyu
1
republishing messages fails....
bug
#234 opened
Nov 17, 2016
by
windbender
7
processConnectionLost miss to remove the subscriptions of the client
question
#236 opened
Nov 18, 2016
#248 opened
Jan 5, 2017
by
ThomasSchemmer
updated
Jan 24, 2017
3
Avoid OutOfMemory error
feature req
#141 opened
Jan 17, 2016
by
andsel
updated
Apr 14, 2017
0.9
3
if unchecked exception is throw while running processSubscription then remove() will never be called
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
trace(
"
"
, clientId, username, channel);
if
(isNotProtocolVersion(msg,
MqttVersion
.
MQTT_3_1
)
&&
isNotProtocolVersion(msg,
MqttVersion
.
MQTT_3_1_1
)) {
LOG
.
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
by
shuzhongling
1
Potential Bug in NextPacketID
bug
#237 opened
Nov 29, 2016
by
peacecoder
Exception: java.lang.NoClassDefFoundError: org/mapdb/DBMaker
#248 opened
Jan 5, 2017
by
ThomasSchemmer
3
java.lang.ClassCastException: io.netty.handler.codec.http.HttpObjectAggregator$AggregatedFullHttpRequest cannot be cast to io.moquette.parser.proto.messages.AbstractMessage
#290 opened
#316 opened
May 19, 2017
by
windbender
updated
May 19, 2017
java.lang.ClassCastException: io.netty.handler.codec.http.HttpObjectAggregator$AggregatedFullHttpRequest cannot be cast to io.moquette.parser.proto.messages.AbstractMessage
#290 opened
Mar 23, 2017
by
leesangboo
updated
Jun 21, 2017
7
[FR]Moquette clusters
feature req
#131 opened
Dec 11, 2015
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Pull requests
Actions
Projects
Wiki
Security
Insights
Labels
7
Milestones
5
Labels
7
Milestones
5
New pull request
New
Clear current search query, filters, and sorts
11 Open
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
warn(
"
"
, clientId, channel);
abortConnection(
CONNECTION_REFUSED_UNACCEPTABLE_PROTOCOL_VERSION
);
return
;
}
final
boolean
cleanSession
=
msg
.
variableHeader()
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Mar 23, 2017
by
leesangboo
7
if unchecked exception is throw while running processSubscription then remove() will never be called
#316 opened
May 19, 2017
by
windbender
Message size >64kB is not handled via Websocket connection.
#319 opened
May 25, 2017
by
raipratheek
1
Authorizator based on client Certificate information
#328 opened
Jun 15, 2017
by
pabloa
updated
Jul 11, 2017
0.9
19
Retained message with QoS 0
#125 opened
Nov 11, 2015
by
env3d
updated
Aug 8, 2017
5
Netty Leak Detection
#356 opened
Aug 31, 2017
by
somejavadev
149 Closed
11 Open
149 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Reviews
Filter by reviews
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
.
isCleanSession();
if
(clientId
==
null
||
clientId
.
length()
==
0
) {
if
(
!
brokerConfig
by
edenmob
1
Netty Leak Detection
#356 opened
Aug 31, 2017
by
somejavadev
1
cannot make a distinction between bad user and not authorized when connect
#359 opened
Sep 5, 2017
by
rongwei84n
2
Will Message lost if client reconnect before server clear the old connection
#366 opened
Oct 22, 2017
updated
Aug 31, 2017
1
Authorizator based on client Certificate information
#328 opened
Jun 15, 2017
by
edenmob
updated
Sep 14, 2017
1
cannot make a distinction between bad user and not authorized when connect
#359 opened
Sep 5, 2017
by
rongwei84n
updated
Apr 29, 2018
No reviews
Review required
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
moquette/ChangeLog.txt at master · moquette-io/moquette · GitHub
.
isAllowZeroByteClientId()) {
LOG
.
info(
"
"
, username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
}
if
(
!
cleanSession) {
by
fjcyue
1
1
client can't reconnect to the broker once exception happened inner processSubscribe()
#388 opened
Feb 6, 2018
by
fjcyue
6
The server throws an exception when the message is received
#406 opened
Jun 4, 2018
by
ma-yadong
3
Memory grows infinitely when Qos set 2
#423 opened
2
The server throws an exception when the message is received
#406 opened
Jun 4, 2018
by
ma-yadong
updated
Jun 6, 2018
3
client can't reconnect to the broker once exception happened inner processSubscribe()
#388 opened
Feb 6, 2018
by
fjcyue
updated
Jul 26, 2018
6
In BytesMetrics wroteBytes always return 0
😄
🎉
😕
❤️
🚀
👀
Fix java 11+ build and tests
#533 opened
Aug 14, 2020
by
hylkevds
1
Fixes #529, #505: NPE caused by matching on a TNode
#532 opened
Aug 13, 2020
by
hylkevds
1
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Minor, changed header by andsel · Pull Request #536 · moquette-io/moquette · GitHub
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
LOG
.
info(
"
"
,
username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
}
//
Generating client id.
clientId
=
Jul 10, 2018
by
zhengyangyong
3
In BytesMetrics wroteBytes always return 0
#425 opened
Jul 27, 2018
by
mjpatelsls
1
Previous
1
2
3
Next
Previous
Next
ProTip!
#425 opened
Jul 27, 2018
by
mjpatelsls
updated
Aug 6, 2018
1
Memory grows infinitely when Qos set 2
#423 opened
Jul 10, 2018
by
zhengyangyong
updated
Aug 12, 2018
3
Abnormal disconnection of the connection will result in InterceptHandler.onConnectionLost() called twice
#430 opened
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Bugfix/stop broker interceptor
#530 opened
May 26, 2020
by
Northram511
one get
#520 opened
Mar 4, 2020
by
luoliangtiger
fixed throw NullPointerException when new connection
#519 opened
Mar 2, 2020
by
luoliangtiger
Authentication changes
#507 opened
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Added Apache 2.0 license
Loading branch information
andsel
committed
Oct 4, 2013
1 parent
f4162c2
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
UUID
.
randomUUID()
.
toString()
.
replace(
"
-
"
,
"
"
);
LOG
.
debug(
"
Adding
no:label
will show everything without a label.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
Sep 20, 2018
by
CoderBigL
updated
Sep 20, 2018
Publish Failed Acknowledgment
#433 opened
Oct 22, 2018
by
BigGitWorld
updated
Sign in to GitHub · GitHub
Skip to content
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Oct 11, 2019
by
ndchandar
2
Java 11 compatibility
#498 opened
Aug 17, 2019
by
qbast
Clean test storage on exit to prevent assert in next test
#497 opened
Aug 16, 2019
by
qbast
fix trie match bug and bytesMetrics bug
#479 opened
Jun 2, 2019
by
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
commit
af8c0e3b9a186faf144f51218b934188af8b1120
Unified
Split
Showing
1 changed file
with
205 additions
and
0 deletions
.
+205
−0
license.txt
205
license.txt
Show comments
View file
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
"
, clientId,
username, channel);
}
if
(
!
login(msg, clientId)) {
abortConnection(
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Oct 22, 2018
Previous
1
2
3
Next
Previous
Next
ProTip!
Mix and match filters to narrow down what you’re looking for.
© 2020 GitHub, Inc.
Sign in to GitHub · GitHub
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
ilylia
4
Make the number of Netty worker threads number configurable
#468 opened
Apr 8, 2019
by
komamitsu
1
Fix a bug Session#resendInflightNotAcked() fails due to handling a freed ByteBuf
#464 opened
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
Edit file
Delete file
@@ -0,0 +1,205 @@
Copyright 2012-2013 (c) Andrea Selva
Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/
TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
1. Definitions.
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
CONNECTION_REFUSED_BAD_USER_NAME_OR_PASSWORD
);
channel
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
return
;
}
try
{
LOG
.
trace(
"
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Mar 31, 2019
by
komamitsu
4
ProTip!
no:milestone
will show everything without a milestone.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
"License" shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.
"Licensor" shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.
"Legal Entity" shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
control with that entity. For the purposes of this definition,
"control" means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.
"You" (or "Your") shall mean an individual or Legal Entity
exercising permissions granted by this License.
"Source" form shall mean the preferred form for making modifications,
including but not limited to software source code, documentation
source, and configuration files.
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Travis CI - Test and Deploy Your Code with Confidence
Hey there!
Looks like you have JavaScript disabled.
The Travis CI webclient needs JavaScript to work properly.
Please enable JavaScript to get the best Travis CI experience.
Thank you!
Binding MQTTConnection (channel: {}) to session
"
, channel);
sessionRegistry
.
bindToSession(
this
, msg, clientId);
initializeKeepAliveTimeout(channel, msg, clientId);
setupInflightResender(channel);
NettyUtils
.
clientID(channel, clientId);
LOG
.
trace(
"
Learn more
Accept
Reject
Save preferences
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
"Object" form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
not limited to compiled object code, generated documentation,
and conversions to other media types.
"Work" shall mean the work of authorship, whether in Source or
Object form, made available under the License, as indicated by a
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).
"Derivative Works" shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
enable the usage of Netty OpenSSL provider implementation · moquette-io/moquette@d50a291 · GitHub
CONNACK sent, channel: {}
"
, channel);
postOffice
.
dispatchConnection(msg);
LOG
.
trace(
"
dispatch connection: {}
"
, msg
.
toString());
}
catch
(
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
"Contribution" shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
or by an individual or Legal Entity authorized to submit on behalf of
the copyright owner. For the purposes of this definition, "submitted"
means any form of electronic, verbal, or written communication sent
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
designated in writing by the copyright owner as "Not a Contribution."
"Contributor" shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
subsequently incorporated within the Work.
Sign up
master
moquette
/
ChangeLog.txt
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
103 lines (93 sloc)
6.14 KB
Raw
Blame
Version 0.12:
Fixed issue #415
Sign in to GitHub · GitHub
Skip to content
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Bumped dev cycle 0.13 · moquette-io/moquette@db4349b · GitHub
SessionCorruptedException
scex) {
LOG
.
warn(
"
"
, clientId, channel);
abortConnection(
CONNECTION_REFUSED_SERVER_UNAVAILABLE
);
}
}
private
void
setupInflightResender
(
Channel
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Minor, changed header
#536
Merged
andsel
merged 1 commit into
moquette-io
2. Grant of Copyright License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
Work and such Derivative Works in Source or Object form.
3. Grant of Patent License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Rewritten completly the broker to introduce the concept of MqttConnection
Dropped suppoert for MapDB and keeped only H2 MvStore for persistence
Version 0.10:
Netty epoll system added
Separated in memory and MapDB storage implementations
Cleanly separated inflight part (inbound and outbound)
Version 0.9:
Moved canRead check to topic from publish phase to subscribe (#144)
Added javadoc and src jars creations for JCenter/Maven central
Added persisting of clean session flag for already existing client session (fix issue #145)
Moved the message logic management fo FSM, to better control the concurrency.
Changed default config to use in memory store and not default moquette.mapdb
Version 0.8:
Introduced authenticator and authorizator implementations.
Fixed bug, doesn't close the channel when connect doesn't contains a valid proto name, issue #65
Fixed bug, does not check for zero length topic (filters) in PUBLISH, SUBSCRIBE, and UNSUBSCRIBE, issue #67
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
channel
) {
channel
.
pipeline()
.addFirst(
"
inflightResender
"
,
new
InflightResender
(
5_000
,
TimeUnit
.
Sign in to GitHub · GitHub
Skip to content
:
master
from
andsel
:
fix/minor_desciption_change
Oct 1, 2020
Merged
Minor, changed header
#536
andsel
merged 1 commit into
moquette-io
:
master
from
andsel
:
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.
4. Redistribution. You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You
meet the following conditions:
(a) You must give any other recipients of the Work or
Derivative Works a copy of this License; and
(b) You must cause any modified files to carry prominent notices
stating that You changed the files; and
(c) You must retain, in the Source form of any Derivative Works
that You distribute, all copyright, patent, trademark, and
attribution notices from the Source form of the Work,
excluding those notices that do not pertain to any part of
the Derivative Works; and
Fixed issue #69
Fixed bug #68, UNSUBSCRIBE has to fail on bad topicFilter names
Fixed bug #81, on stop of moquette broker it doesn't shutdown due to no shutdown of ringbuffer used on the back of ProtocolProcessor
Moved config to be not only filesystem based, but also classpath and memory (fix issue #73)
Switched from commit persistence on every change to time based to fix delay in handling many msgs/sec (fix issue #79)
Changed willMessage and password in CONNECT message from String to byte[] (fix issue #94 and #95)
Fixed ugly empty session storage, avoid fake NullObject empty subscription subscription
Added check to avoid creation of LostConnectionEvents for not yet completed connects (fix issue #88)
Removed LMAX ringbuffer to use multi threading with persistent (copy on write) data structures
Fixed bug that on connection stolen dropped also the new connection (fix issue #108)
Refactored the storage part to be more rational and use ClientSession concept
Added config property 'autosave_interval' (issue #97)
Removed leaking ref to parent's node (issue #119 and #126)
Added internal publish once the broker is embedded (issue #113)
Removed client active/not active state from persistence (issue #118)
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
MILLISECONDS
));
}
private
void
initializeKeepAliveTimeout
(
Channel
channel
,
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
fix/minor_desciption_change
Oct 1, 2020
Conversation
0
Commits
1
Checks
0
Files changed
Conversation
Copy link
Quote reply
Collaborator
andsel
commented
Oct 1, 2020
No description provided.
(d) If the Work includes a "NOTICE" text file as part of its
distribution, then any Derivative Works that You distribute must
include a readable copy of the attribution notices contained
within such NOTICE file, excluding those notices that do not
pertain to any part of the Derivative Works, in at least one
of the following places: within a NOTICE text file distributed
as part of the Derivative Works; within the Source form or
documentation, if provided along with the Derivative Works; or,
within a display generated by the Derivative Works, if and
wherever such third-party notices normally appear. The contents
of the NOTICE file are for informational purposes only and
do not modify the License. You may add Your own attribution
notices within Derivative Works that You distribute, alongside
or as an addendum to the NOTICE text from the Work, provided
that such additional attribution notices cannot be construed
as modifying the License.
Avoid deletion of client descriptor in case of multiple clients with same clientID (issues #116 and #124)
Removed a queue per client of inFlightIds (never cleaned) in favor of single atomic generator
Version 0.7:
Fix issue #38, added aligned to MQTT 3.1.1
Refactored big event switch to @Annotation dispatcher
Switched from HawtDB to MapDB
Fixed bug that didn't update client subscription on persistent store so that on server restart there where ghost subscriptions.
Fixed Issue #11, multiple republish of persisted QoS1/2 messages on clients reconnections.
Refactored the publish logic for QoS 1 2 to try to be more readable
Added packetIdentifier storage and generation
Fixed issue #16, bad packetId for will messages with qos > 0
Added store path variable "persistent_store" to configuration file (picked from Steven Warwick fork)
Removed OSGi bundle, developer time burner
Fixed github issue #30, returning error on mapdb file not deleted that corrupt reiterated builds
Added handling of allow_anonymous clients (as in mosquitto issue #34)
Modified the password_file format to use password stored in sha256 and not plain text
Added ACL file for topic read|write operations.
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Moquette Broker
Moquette
Documentation
Mailing list
Moquette MQTT broker
JVM lightweight MQTT broker for the Internet of Things. Simply embeddable in your IoT projects
Learn more
Follow on twitter
@moquetteproject
.
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
MqttConnectMessage
msg
,
String
clientId
) {
int
keepAlive
=
msg
.
variableHeader()
.
keepAliveTimeSeconds();
NettyUtils
.
keepAlive(channel, keepAlive);
NettyUtils
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Minor, changed header
Loading status checks…
b6e5fa7
Hide details
View details
andsel
merged commit
8ba0b4d
into
moquette-io
:
master
Oct 1, 2020
1 check was pending
1 check was pending
continuous-integration/travis-ci/pr
You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
for any such Derivative Works as a whole, provided Your use,
reproduction, and distribution of the Work otherwise complies with
the conditions stated in this License.
5. Submission of Contributions. Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.
6. Trademarks. This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
Removed cause of leakage of Netty Sessions (fix issue #39)
Cleaned Netty's stuff reference from Events used in Disruptor (fix issue #40)
Bad assignment of PacketID during publish to subscribed QoS0 topics (fix issue #38)
Fixed duplicated subscription with different QoS same client and topic (fix issue #49)
Fixed UNSUBSCRIBE that missed to remove the subscription from the persistent store (fix issue #50)
Fixed issue on multiple publish for overlapping subscription by the same client (fix issue #52).
Moved the authorization check before dropping an already connected client with same clientID (fix issue #44).
Fixed subscription tree that was unable to update clean session flag on subs with same client, topic and qos (fix issue #55)
Fixed overwriting of published qos in forward publish loop (fix issue #56)
Version 0.6:
Fix issue #42, bad password file path composition
Fix issue #43, missed topic case (finance/+ does has to match finance)
Integrated WebSocket support (issue #37)
Integrated SSL support (issue #41)
Fixed issue #40, check Logging inside the Felix OSGi
Fixed issue #46, implement correct behaviour for Will stuff
Splitted stores to persist messages and sessions into different interfaces
Removed perf module to be move in separate project, and disabled leak… · moquette-io/moquette@8f7b7df · GitHub
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
.
cleanSession(channel, msg
.
variableHeader()
.
isCleanSession());
NettyUtils
.
clientID(channel, clientId);
int
idleTime
=
Math
.
round(keepAlive
*
1.5f
);
setIdleTime(channel
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
The Travis CI build is in progress
Details
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked issues
origin of the Work and reproducing the content of the NOTICE file.
7. Disclaimer of Warranty. Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
Contributor provides its Contributions) on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.
8. Limitation of Liability. In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
negligent acts) or agreed to in writing, shall any Contributor be
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
Renamed some methods in sessions store
Moved logging conf and slf4j-log4j deps out of broker to let it use the container's log configuration
Version 0.5:
Fix issue 20 (no flush of message on PINGREQ)
Fix issue 21 (bad channel timeout handler)
Created a self contained distribution package (issue 22)
Fix issue 28, OSGi-fied the broker
Fixed issue #31 missed to insert the hawtdb jars
Added a separate mvn module to host the OSGi bundle declaration
Fixed issue #30
Added password file for identity management on connect (Fix #23)
Version 0.4:
Dropped support for MINA
Fix Issue 15 (bad re-activation of client's subscriptions after a recconection)
Fix Issue 16 (bad re-publish of stored messages after a client reconnection)
Fixed a bug in unsubscribe due to missed clientID check
Fixed Issue 18 (descriptor of a disconnected (not active) client)
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
enable the usage of Netty OpenSSL provider implementation
Loading branch information
mscheibler
committed
Jun 22, 2018
1 parent
0fae292
commit
d50a291366f1b5a16011266dbf770c020d241eee
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Minor, changed header by andsel · Pull Request #536 · moquette-io/moquette · GitHub
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
.
pipeline(), idleTime);
LOG
.
debug(
"
"
,
clientId, keepAlive, msg
.
variableHeader()
.
isCleanSession(), idleTime);
}
private
void
setIdleTime
(
Save preferences
Successfully merging this pull request may close these issues.
None yet
1 participant
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.
9. Accepting Warranty or Additional Liability. While redistributing
the Work or Derivative Works thereof, You may choose to offer,
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.
END OF TERMS AND CONDITIONS
APPENDIX: How to apply the Apache License to your work.
Bug fix for override subscriptions to the same /topic but with different QoS (latest wins)
Added test to check the downgrading of QoS of messages sent to registered subscribers (fixed a bug of double delivery of QoS2 messages)
Version 0.3:
Added Netty IO connectors
Dropped tests based on Fuse source client lib moving to Paho java client
Version 0.2:
Fixed issues (10, 11, 12, 13)
Fixed interdependency bug in test
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Unified
Split
Showing
8 changed files
with
241 additions
and
96 deletions
.
+1
−0
.gitignore
+1
−0
broker/build.gradle
+9
−0
broker/src/main/java/io/moquette/BrokerConstants.java
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Bumped dev cycle 0.13
Loading branch information
andsel
committed
Mar 17, 2019
1 parent
Skip to content
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
moquette/build.gradle at master · moquette-io/moquette · GitHub
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
ChannelPipeline
pipeline
,
int
idleTime
) {
if
(pipeline
.
names()
.
contains(
"
idleStateHandler
"
)) {
pipeline
.
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets "[]"
replaced with your own identifying information. (Don't include
the brackets!) The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
file or class name and description of purpose be included on the
same "printed page" as the copyright notice for easier
identification within third-party archives.
Copyright [yyyy] [name of copyright owner]
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
+116
−59
broker/src/main/java/io/moquette/server/DefaultMoquetteSslContextCreator.java
+50
−34
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
+2
−2
broker/src/main/java/io/moquette/spi/security/ISslContextCreator.java
+60
−0
broker/src/test/java/io/moquette/server/ServerIntegrationOpenSSLTest.java
+2
−1
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
1
.gitignore
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
f3faee6
commit
db4349ba669ee4a216b6104382e4cf320f5a7864
Unified
Split
Showing
5 changed files
with
6 additions
and
6 deletions
.
+1
−1
broker/src/main/java/io/moquette/broker/Server.java
+2
−2
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
remove(
"
idleStateHandler
"
);
}
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(idleTime,
0
,
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
limitations under the License.
Toggle all file notes
0 comments on commit
af8c0e3
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Show comments
View file
Edit file
Delete file
@@ -25,6 +25,7 @@ broker/runner
.settings
/
.project
.classpath
/
*
/
bin
/
*
.swp
*
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
build.gradle
+1
−1
distribution/src/main/scripts/moquette.bat
+1
−1
distribution/src/main/scripts/moquette.sh
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
2
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -55,7 +55,7 @@
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
moquette/Server.java at db4349ba669ee4a216b6104382e4cf320f5a7864 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
0
));
}
private
boolean
isNotProtocolVersion
(
MqttConnectMessage
msg
,
MqttVersion
version
) {
return
msg
.
variableHeader()
.
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
.class
1
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -34,4 +34,5 @@ dependencies {
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
public
static
void
main
(
String
[]
args
)
throws
IOException
{
final
Server
server
=
new
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
moquette/.gitignore at d50a291366f1b5a16011266dbf770c020d241eee · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
version()
!=
version
.
protocolLevel();
}
private
void
abortConnection
(
MqttConnectReturnCode
returnCode
) {
MqttConnAckMessage
badProto
=
connAck(returnCode,
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Removed perf module to be move in separate project, and disabled leak…
Loading branch information
andsel
committed
Nov 11, 2018
1 parent
8e17e99
commit
8f7b7df1240f569b5baa4feb0219b1936f66e062
Unified
Split
Showing
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
com.h2database
'
,
name
:
'
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Server
();
server
.
startServer();
System
.
out
.
println(
"
Server started, version 0.
12.1
"
);
System
.
out
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
false
);
channel
.
writeAndFlush(badProto)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
channel
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
}
private
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
15 changed files
with
12 additions
and
1,476 deletions
.
+12
−11
gradle/test.gradle
+0
−17
perf/build.gradle
+0
−150
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
+0
−169
h2
'
,
version
:
'
1.4.191
'
testRuntime
group
:
'
io.netty
'
,
name
:
'
netty-tcnative
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
.
println(
"
Server started, version 0.
13-SNAPSHOT
"
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
(server
::
stopServer));
Insights
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Minor, changed header
#536
moquette/BenchmarkPublisher.java at 8e17e99428bdae8f7a7fd5c52ad1f4520229ec84 · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
MqttConnAckMessage
connAck
(
MqttConnectReturnCode
returnCode
,
boolean
sessionPresent
) {
MqttFixedHeader
mqttFixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
+0
−210
perf/src/main/java/io/moquette/parser/netty/performance/LoopMQTTHandler.java
+0
−94
perf/src/main/java/io/moquette/parser/netty/performance/NettyPublishReceiverHandler.java
+0
−187
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolDecodingServer.java
+0
−123
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolPublishDecodingServer.java
+0
−108
perf/src/main/java/io/moquette/parser/netty/performance/PublishBomber.java
+0
'
,
version
:
'
2.0.10.Final
'
,
classifier
:
'
linux-x86_64
'
}
9
broker/src/main/java/io/moquette/BrokerConstants.java
Show comments
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
}
4
build.gradle
Show comments
View file
Edit file
Delete file
@@ -3,7 +3,7 @@ allprojects {
apply
plugin
:
'
maven-publish
'
group
=
Merged
andsel
merged 1 commit into
moquette-io
:
master
from
andsel
:
fix/minor_desciption_change
Oct 1, 2020
Conversation
0
Commits
1
Checks
0
Files changed
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
build.gradle
Go to file
Go to file
T
Go to line
L
CONNACK
,
false
,
MqttQoS
.
AT_MOST_ONCE
,
false
,
0
);
MqttConnAckVariableHeader
mqttConnAckVariableHeader
=
new
MqttConnAckVariableHeader
(returnCode, sessionPresent);
−81
perf/src/main/java/io/moquette/parser/netty/performance/PublishReceiverHandler.java
+0
−100
perf/src/main/java/io/moquette/performance/clients/mqttbee/BeeBenchmarker.java
+0
−56
perf/src/main/java/io/moquette/performance/clients/paho/PahoBenchmarker.java
+0
−63
perf/src/main/java/io/moquette/performance/clients/paho/SubscriberCallback.java
+0
−104
perf/src/main/java/io/moquette/spi/impl/subscriptions/PerformanceTest.java
+0
−3
settings.gradle
View file
Edit file
Delete file
@@ -32,8 +32,17 @@
+
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
;
public
static
final
String
WEB_SOCKET_PORT_PROPERTY_NAME
=
"
websocket_port
"
;
public
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
'
io.moquette
'
version
=
'
0.
12.1
'
version
=
'
0.
13-SNAPSHOT
'
}
buildscript
{
Minor, changed header
b6e5fa7
Select commit
b6e5fa7
Minor, changed header
andsel
Oct 1, 2020
Merged
Minor, changed header
#536
Minor, changed header
b6e5fa7
Select commit
b6e5fa7
Minor, changed header
andsel
Oct 1, 2020
enable the usage of Netty OpenSSL provider implementation · moquette-io/moquette@d50a291 · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Copy path
Cannot retrieve contributors at this time
117 lines (100 sloc)
3.09 KB
Raw
Blame
allprojects
{
apply
plugin
:
'
maven
'
apply
plugin
:
'
return
new
MqttConnAckMessage
(mqttFixedHeader, mqttConnAckVariableHeader);
}
private
boolean
login
(
MqttConnectMessage
msg
,
final
String
clientId
) {
//
handle user authentication
23
gradle/test.gradle
Show comments
View file
Edit file
Delete file
@@ -6,8 +6,8 @@ test {
class
OutputReporter
implements
TestListener
,
TestOutputListener
{
private
StringBuilder
stdout
static
final
String
WSS_PORT_PROPERTY_NAME
=
"
secure_websocket_port
"
;
/**
* Defines the SSL implementation to use, default to "JDK".
*
@see
io.netty.handler.ssl.SslProvider#name()
*/
public
static
final
@@ -92,7 +92,7 @@ subprojects {
from components
.
java
groupId
"
$p
roject
.
group
"
artifactId
"
${
project.name
}
"
version
'
Workflow runs completed with no jobs
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
db4349ba66
moquette
/
broker
/
src
/
main
/
maven-publish
'
group
=
'
io.moquette
'
version
=
'
0.13-SNAPSHOT
'
}
buildscript
{
repositories {
maven {
url
"
if
(msg
.
variableHeader()
.
hasUserName()) {
byte
[] pwd
=
null
;
if
(msg
.
variableHeader()
.
hasPassword()) {
=
new
StringBuilder
()
;
private
StringBuilder
stderr
=
new
StringBuilder
()
;
private
StringBuilder
stdout
=
new
String
SSL_PROVIDER
=
"
ssl_provider
"
;
public
static
final
String
SSL_PORT_PROPERTY_NAME
=
"
ssl_port
"
;
public
0.
12.1
'
version
'
0.
13-SNAPSHOT
'
}
}
}
2
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
moquette/DefaultMoquetteSslContextCreator.java at d50a291366f1b5a16011266dbf770c020d241eee · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
d50a291366
moquette
/
.gitignore
Go to file
Go to file
java
/
io
/
moquette
/
broker
/
Server.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
https://plugins.gradle.org/m2/
"
}
}
dependencies {
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.13
'
classpath
'
gradle.plugin.com.github.spotbugs:gradlePlugin:1.6.0
'
classpath
'
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
pwd
=
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
else
if
(
StringBuilder
()
private
StringBuilder
stderr
=
new
StringBuilder
()
@Override
static
final
String
JKS_PATH_PROPERTY_NAME
=
"
jks_path
"
;
/*
* @see java.security.KeyStore#getInstance(String) for allowed types, default to "jks"
*/
echo
"
| |
"
echo
"
|_|
"
echo
"
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
49 lines (44 sloc)
730 Bytes
Raw
Blame
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
389 lines (349 sloc)
17.3 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
'
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
'
}
}
subprojects
{
repositories {
moquette/build.gradle at 8e17e99428bdae8f7a7fd5c52ad1f4520229ec84 · moquette-io/moquette · GitHub
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
info(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
return
false
;
}
final
String
login
void
beforeSuite
(
TestDescriptor
suite
) {
@@ -22,8 +22,8 @@ class OutputReporter implements TestListener, TestOutputListener {
@Override
void
beforeTest
(
TestDescriptor
testDescriptor
) {
if
(
!
testDescriptor
public
static
final
String
KEY_STORE_TYPE
=
"
key_store_type
"
;
public
static
final
String
KEY_STORE_PASSWORD_PROPERTY_NAME
=
"
key_store_password
"
"
echo
"
version: 0.
12.1
"
echo
"
version: 0.
13-SNAPSHOT
"
set
"
CURRENT_DIR
=
%cd%
"
if
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
/
build
*
/
build
/
/
target
/
/
parser
/
target
/
/
benchmarking
/
target
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
mavenLocal()
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
}
maven { url
"
https://repo.maven.apache.org/maven2
"
}
}
apply
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
=
msg
.
payload()
.
userName();
if
(
!
authenticator
.
checkValid(clientId, login, pwd)) {
LOG
.
info(
"
.
isComposite()) {
stdout
.
setLength(
0
)
;
stderr
.
setLength(
0
)
;
stdout
.
setLength(
0
)
;
public
static
final
String
KEY_MANAGER_PASSWORD_PROPERTY_NAME
=
"
key_manager_password
"
;
public
static
final
String
ALLOW_ANONYMOUS_PROPERTY_NAME
=
"
not
"
%MOQUETTE_HOME%
"
==
"
"
goto
gotHome
2
distribution/src/main/scripts/moquette.sh
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
Sign up
8e17e99428
moquette
/
perf
/
src
/
main
/
java
/
io
/
moquette
/
parser
/
/
.idea
/
*
.iml
broker
/
target
/
client
/
target
/
parser_commons
/
target
/
netty_parser
io.moquette.BrokerConstants
;
import
io.moquette.broker.config.*
;
import
io.moquette.interception.InterceptHandler
;
import
io.moquette.persistence.H2Builder
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.moquette.interception.BrokerInterceptor
;
import
from
:
new
File
(rootDir,
'
gradle/java.gradle
'
)
apply
from
:
new
File
(rootDir,
'
gradle/test.gradle
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
"
, clientId, login);
return
false
;
}
NettyUtils
.
userName(channel, login);
}
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
stderr
.
setLength(
0
)
}
}
@@ -50,13 +50,14 @@ class OutputReporter implements TestListener, TestOutputListener {
@Override
void
onOutput
(
TestDescriptor
testDescriptor
,
TestOutputEvent
outputEvent
) {
allow_anonymous
"
;
175
broker/src/main/java/io/moquette/server/DefaultMoquetteSslContextCreator.java
Show comments
View file
Edit file
Delete file
@@ -16,19 +16,34 @@
package
io.moquette.server
;
import
java.io.File
;
import
| |
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.
12.1
"
echo
"
version: 0.
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
enable the usage of Netty OpenSSL provider implementation
Bumped dev cycle 0.13 · moquette-io/moquette@db4349b · GitHub
netty
/
performance
/
BenchmarkPublisher.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
/
target
/
netty_parser
/
target
/
parser_commons
/
target
/
distribution
/
target
/
broker
/
moquette.log
io.moquette.broker.security.*
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
'
)
apply
from
:
new
File
(rootDir,
'
gradle/lint.gradle
'
)
apply
plugin
:
'
com.jfrog.bintray
'
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
.
info(
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
return
false
;
}
return
true
;
}
void
handleConnectionLost
() {
String
if
(
!
testDescriptor
.
isComposite()) {
def
buffer
=
(outputEvent
.
getDestination()
==
TestOutputEvent.Destination.StdOut
)
?
stdout
:
stderr;
java.io.FileInputStream
;
import
java.io.FileNotFoundException
;
import
java.io.IOException
;
import
java.io.InputStream
;
import
java.net.URL
;
import
java.security.GeneralSecurityException
;
import
.13-SNAPSHOT
"
cd
"
$(
dirname
"
$0
"
)
"
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
Loading branch information
mscheibler
committed
Jun 22, 2018
1 parent
0fae292
commit
d50a291366f1b5a16011266dbf770c020d241eee
Unified
Split
Showing
8 changed files
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
R
Copy path
Cannot retrieve contributors at this time
150 lines (123 sloc)
5.19 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
broker
/
runner
/
bundle
/
target
/
/
bundle
/
runner
/
/
osgi_test
/
target
/
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.io.File
;
import
java.io.IOException
;
import
java.lang.reflect.InvocationTargetException
;
import
java.text.ParseException
;
apply
plugin
:
'
eclipse
'
ext {
nettyVersion
=
'
4.1.22.Final
'
}
task packageTests(
type
:
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
clientID
=
NettyUtils
.
clientID(channel);
if
(clientID
==
null
||
clientID
.
isEmpty()) {
return
;
}
LOG
.
buffer
.
append(outputEvent
.
getMessage());
if
(outputEvent
.
getMessage()
.
contains(
"
LEAK:
"
)) {
println
stdout
println
stderr
java.security.KeyManagementException
;
import
java.security.KeyStore
;
import
java.security.KeyStoreException
;
import
java.security.NoSuchAlgorithmException
;
import
java.security.PrivateKey
;
import
java.security.cert.Certificate
;
import
@GrabResolver
(
name
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
'
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
with
241 additions
and
96 deletions
.
+1
−0
.gitignore
+1
−0
broker/build.gradle
+9
−0
broker/src/main/java/io/moquette/BrokerConstants.java
+116
−59
broker/src/main/java/io/moquette/server/DefaultMoquetteSslContextCreator.java
+50
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.parser.netty.performance
;
import
org.eclipse.jetty.toolchain.perf.PlatformTimer
;
import
org.eclipse.paho.client.mqttv3.*
;
import
org.slf4j.Logger
/
perf
/
target
/
/
mapdb_storage
/
target
/
*
~
*
.log
*
.DS_Store
.settings
import
java.util.*
;
import
java.util.concurrent.Executors
;
import
java.util.concurrent.ScheduledExecutorService
;
import static
io.moquette.logging.LoggingUtils.getInterceptorIds
;
public
class
Server
{
private
static
Jar
) {
from sourceSets
.
test
.
output
from sourceSets
.
test
.
allSource
from sourceSets
.
test
.
resources
classifier
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
info(
"
"
, clientID, channel);
Session
session
=
sessionRegistry
.
retrieve(clientID);
if
(session
.
hasWill()) {
postOffice
.
fireWill(session
.
throw
new
RuntimeException
(
"
Netty ResourceLeakDetector
"
);
}
def
buffer
=
(outputEvent
.
getDestination()
==
TestOutputEvent.Destination.StdOut
)
java.security.cert.X509Certificate
;
import
java.util.Collections
;
import
java.util.Objects
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.spi.security.ISslContextCreator
;
import
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.
12.1
'
)
@Grab
(
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
d50a291366
moquette
/
broker
/
src
/
main
/
java
/
io
/
−34
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
+2
−2
broker/src/main/java/io/moquette/spi/security/ISslContextCreator.java
+60
−0
broker/src/test/java/io/moquette/server/ServerIntegrationOpenSSLTest.java
+2
−1
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
1
.gitignore
Show comments
View file
Edit file
Delete file
Pull requests · moquette-io/netty-mqtt5-codec · GitHub
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
;
import
org.slf4j.LoggerFactory
;
import
java.io.UnsupportedEncodingException
;
import
java.util.concurrent.CountDownLatch
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
class
BenchmarkPublisher
{
private
/
.project
.classpath
/
*
/
bin
/
*
.swp
*
.class
#
Mobile Tools for Java (J2ME)
.mtj.tmp
/
#
Package Files #
final
Logger
LOG
=
LoggerFactory
.
getLogger(
io.moquette.broker
.
Server
.
class);
private
ScheduledExecutorService
scheduler;
private
NewNettyAcceptor
acceptor;
private
Issues · moquette-io/netty-mqtt5-codec · GitHub
=
'
tests
'
}
task javadocJar (
type
:
Jar
,
dependsOn
: javadoc) {
classifier
=
'
javadoc
moquette/gradlew.bat at master · moquette-io/moquette · GitHub
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
8e17e99428
moquette
/
perf
/
build.gradle
Go to file
Go to file
getWill());
}
if
(session
.
isClean()) {
sessionRegistry
.
remove(clientID);
}
else
{
sessionRegistry
.
disconnect(clientID);
}
connected
?
stdout
:
stderr
buffer
.
append(outputEvent
.
getMessage())
//
TODO re-enable this
//
if (outputEvent.getMessage().contains("LEAK:")) {
//
println stdout
//
println stderr
//
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
io.netty.handler.ssl.ClientAuth
;
import
io.netty.handler.ssl.SslContext
;
import
io.netty.handler.ssl.SslContextBuilder
;
import
io.netty.handler.ssl.SslProvider
;
import
group
=
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.
13-SNAPSHOT
'
moquette
/
server
/
DefaultMoquetteSslContextCreator.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
@@ -25,6 +25,7 @@ broker/runner
.settings
/
.settings
/
.project
.project
.classpath
.classpath
/
*
/
bin
/
*
.swp
*
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
BenchmarkPublisher
.
class);
static
class
PublishCallback
implements
IMqttActionListener
{
@Override
*
.war
*
.ear
#
virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml
hs_err_pid
*
broker
/
*
moquette_store.
*
embedding_moquette
/
target
/
volatile
boolean
initialized;
private
PostOffice
dispatcher;
private
BrokerInterceptor
interceptor;
private
H2Builder
h2Builder;
private
SessionRegistry
sessions;
public
static
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
'
from javadoc
.
destinationDir
}
task sourceJar (
type
:
Jar
) {
classifier
=
'
sources
'
from sourceSets
.
main
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
17 lines (14 sloc)
655 Bytes
Raw
Blame
description
=
'
Moquette - performance tests
'
repositories
{
jcenter()
=
false
;
//
dispatch connection lost to intercept.
String
userName
=
NettyUtils
.
userName(channel);
postOffice
.
dispatchConnectionLost(clientID,userName);
LOG
.
trace(
"
throw new RuntimeException("Netty ResourceLeakDetector")
//
}
}
}
}
17
perf/build.gradle
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
150
javax.net.ssl.KeyManagerFactory
;
import
javax.net.ssl.SSLContext
;
import
javax.net.ssl.TrustManager
;
import
javax.net.ssl.TrustManagerFactory
;
import
java.io.*
;
import
java.net.URL
;
import
)
import
io.moquette.server.Server
Toggle all file notes
0 comments on commit
db4349b
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Cannot retrieve contributors at this time
187 lines (171 sloc)
8.12 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
.swp
*
.class
*
.class
1
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -34,4 +34,5 @@ dependencies {
testCompile
group
:
'
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
public
void
onFailure
(
IMqttToken
asyncActionToken
,
Throwable
exception
) {
LOG
.
error(
"
PUB: Publish failed
"
, exception);
exception
broker
/
nb-configuration.xml
broker
/
nbactions-Server.xml
maven-metadata.xml
/
.gradle
/
/
bin
/
Copy lines
Copy permalink
View git blame
Reference in new issue
void
main
(
String
[]
args
)
throws
IOException
{
final
Server
server
=
new
Server
();
server
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
.
allSource
}
//
summarize artifacts
artifacts {
archives jar
archives sourceJar
archives javadocJar
archives packageTests
}
dependencies {
compile
group
:
'
org.slf4j
'
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
mavenCentral()
maven { url
'
https://oss.jfrog.org/artifactory/oss-snapshot-local
'
}
}
dependencies
{
compile project(
'
:moquette-broker
'
)
compile
group
:
"
, clientID, userName);
}
void
sendConnAck
(
boolean
isSessionAlreadyPresent
) {
connected
=
true
;
final
MqttConnAckMessage
ackMessage
=
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
169
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
java.security.*
;
import
java.security.cert.CertificateException
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
/**
* Moquette server implementation to load SSL certificate from local filesystem path configured in
@@ -38,77 +53,120 @@
private
static
final
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Sign in to GitHub · GitHub
Skip to content
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.server
;
import
java.io.File
;
import
java.io.FileInputStream
;
import
java.io.FileNotFoundException
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Bumped dev cycle 0.13
Loading branch information
andsel
committed
Mar 17, 2019
.
printStackTrace();
System
.
exit(
2
);
}
@Override
public
void
onSuccess
(
IMqttToken
asyncActionToken
) {
}
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
.
startServer();
System
.
out
.
println(
"
Server started, version 0.13-SNAPSHOT
"
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
,
name
:
'
slf4j-api
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
junit
'
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
'
io.netty
'
,
name
:
'
netty-codec-mqtt
'
,
version
:
"
${
nettyVersion
}
"
compile
connAck(
CONNECTION_ACCEPTED
, isSessionAlreadyPresent);
channel
.
writeAndFlush(ackMessage)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
boolean
isConnected
() {
return
connected;
}
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
8f7b7df
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Logger
LOG
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
IConfig
props;
private
final
IConfig
props;
DefaultMoquetteSslContextCreator
(
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
;
import
java.io.IOException
;
import
java.io.InputStream
;
import
java.net.URL
;
import
java.security.GeneralSecurityException
;
import
java.security.KeyManagementException
;
import
java.security.KeyStore
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
com.h2database
Issues · moquette-io/moquette · GitHub
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
netty-mqtt5-codec
Watch
3
1 parent
f3faee6
commit
db4349ba669ee4a216b6104382e4cf320f5a7864
Unified
Split
Showing
5 changed files
with
6 additions
and
6 deletions
.
+1
−1
broker/src/main/java/io/moquette/broker/Server.java
+2
−2
}
static
class
ExitTopicCallback
implements
IMqttActionListener
{
private
final
long
startedTime;
private
final
long
numToSend;
private
final
CountDownLatch
stopLatch;
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Issues · moquette-io/moquette · GitHub
new
Thread
(server
::
stopServer));
}
/**
* Starts Moquette bringing the configuration from the file located at m_config/moquette.conf
*
*
@throws
IOException in case of any IO error.
*/
public
void
startServer
()
throws
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
netty-mqtt5-codec
Watch
3
Star
17
Fork
8
,
name
:
'
junit
'
,
version
:
'
4.8.2
'
testCompile
group
:
'
org.slf4j
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
group
:
'
org.hdrhistogram
'
,
name
:
'
HdrHistogram
'
,
version
:
'
2.1.2
'
compile
group
void
dropConnection
() {
channel
.
close()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
void
processDisconnect
(
MqttMessage
msg
) {
final
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
IConfig
props
) {
this
.
props
=
props;
this
.
props
=
Objects
.
requireNonNull(
props
)
;
Reject
Save preferences
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
;
import
java.security.KeyStoreException
;
import
java.security.NoSuchAlgorithmException
;
import
java.security.PrivateKey
;
import
java.security.cert.Certificate
;
import
java.security.cert.X509Certificate
;
import
java.util.Collections
'
,
name
:
'
h2
'
,
version
:
'
1.4.191
'
testCompile
group
:
'
com.h2database
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Star
17
Fork
8
Code
Issues
1
Pull requests
0
Actions
Projects
0
Security
Insights
More
Code
Issues
Pull requests
build.gradle
+1
−1
distribution/src/main/scripts/moquette.bat
+1
−1
distribution/src/main/scripts/moquette.sh
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
2
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -55,7 +55,7 @@
public
ExitTopicCallback
(
long
startedTime
,
long
numToSend
,
CountDownLatch
stopLatch
) {
this
.
startedTime
=
startedTime;
this
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
IOException
{
File
defaultConfigurationFile
=
defaultConfigFile();
LOG
.
info(
"
Starting Moquette integration. Configuration file path={}
"
, defaultConfigurationFile
.
getAbsolutePath());
IResourceLoader
filesystemLoader
=
Code
Issues
1
Pull requests
0
Actions
Projects
0
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Security
Insights
Labels
'
,
name
:
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
org.assertj
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.2.0
'
compile
group
:
String
clientID
=
NettyUtils
.
clientID(channel);
LOG
.
trace(
"
"
, clientID, channel);
if
(
!
connected) {
LOG
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
}
@Override
public
SSLContext
initSSLContext
() {
public
SslContext
initSSLContext
() {
LOG
.
info(
"
Checking SSL configuration properties...
"
);
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
;
import
java.util.Objects
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.spi.security.ISslContextCreator
;
import
io.netty.handler.ssl.ClientAuth
;
import
io.netty.handler.ssl.SslContext
'
,
name
:
'
h2
'
,
version
:
'
1.4.191
'
testRuntime
group
:
'
io.netty
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Actions
Projects
Security
Insights
Labels
8
Milestones
0
Labels
8
Milestones
0
New pull request
New
0 Open
0 Closed
0 Open
0 Closed
static
void
main
(
String
[]
args
)
throws
IOException
{
public
static
void
main
(
String
[]
args
numToSend
=
numToSend;
this
.
stopLatch
=
stopLatch;
}
@Override
public
void
onSuccess
(
IMqttToken
asyncActionToken
) {
long
stopTime
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
new
FileResourceLoader
(defaultConfigurationFile);
final
IConfig
config
=
new
ResourceLoaderConfig
(filesystemLoader);
startServer(config);
}
private
static
File
defaultConfigFile
() {
String
8
Milestones
0
Labels
8
Milestones
0
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
'
,
name
:
'
assertj-core
'
,
version
:
'
2.6.0
'
testCompile
group
:
'
org.mockito
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
'
org.eclipse.jetty.toolchain
'
,
name
:
'
jetty-perf-helper
'
,
version
:
'
1.0.5
'
compile(
group
:
.
info(
"
"
, clientID, channel);
return
;
}
sessionRegistry
.
disconnect(clientID);
connected
=
false
;
channel
.
close()
Reject
Save preferences
final
String
keyPassword
=
props
.
getProperty(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
);
if
(keyPassword
==
null
||
keyPassword
.
;
import
io.netty.handler.ssl.SslContextBuilder
;
import
io.netty.handler.ssl.SslProvider
;
import
javax.net.ssl.KeyManagerFactory
;
import
javax.net.ssl.TrustManagerFactory
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
'
,
name
:
'
netty-tcnative
'
,
version
:
'
2.0.10.Final
'
,
classifier
:
'
linux-x86_64
'
}
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Reviews
Filter by reviews
No reviews
Review required
)
throws
IOException
{
final
Server
server
=
new
Server
();
final
Server
server
=
new
Server
();
server
=
System
.
currentTimeMillis();
long
spentTime
=
stopTime
-
startedTime;
LOG
.
info(
"
PUB: published in {} ms
"
, spentTime);
//
try {
//
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
configPath
=
System
.
getProperty(
"
moquette.path
"
,
null
);
return
new
File
(configPath,
IConfig
.
DEFAULT_CONFIG
);
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
1 Open
0 Closed
1 Open
0 Closed
Author
Filter by author
Label
Filter by label
'
,
name
:
'
mockito-core
'
,
version
:
'
1.9.0
'
testCompile
group
:
'
org.awaitility
'
moquette
/
gradlew.bat
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
84 lines (61 sloc)
2.21 KB
Raw
Blame
@
if
"
'
org.mqttbee
'
,
name
:
'
mqtt-bee
'
,
version
:
'
mqtt-bee-1.0.0-20181105.094934-4
'
)
}
Copy lines
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
LOG
.
trace(
"
"
, clientID, channel);
String
userName
isEmpty()) {
LOG
.
warn(
"
The key manager password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
;
/**
* Moquette server implementation to load SSL certificate from local filesystem path configured in
* config file.
*/
class
DefaultMoquetteSslContextCreator
implements
ISslContextCreator
{
private
}
9
broker/src/main/java/io/moquette/BrokerConstants.java
Show comments
View file
Edit file
Delete file
@@ -32,8 +32,17 @@
+
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
;
+
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
;
public
static
final
String
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
.
startServer();
server
.
startServer();
System
.
out
.
println(
"
Server started, version 0.
12.1
"
);
System
.
this.connection.disconnect();
//
} catch (MqttException mex) {
//
LOG.error("Disconnect error", mex);
//
}
double
msgPerSec
=
(numToSend
/
spentTime)
*
1000
;
LOG
.
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
}
/**
* Starts Moquette bringing the configuration from the given file
*
*
@param
configFile text file that contains the configuration.
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
(
File
configFile
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
,
name
:
'
awaitility
'
,
version
:
'
3.0.0
'
}
test {
systemProperties
.
put
"
%DEBUG%
"
==
"
"
@
echo
off
@
rem
##########################################################################
@
rem
@
rem
Gradle startup script for Windows
@
rem
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
=
NettyUtils
.
userName(channel);
postOffice
.
dispatchDisconnection(clientID,userName);
LOG
.
trace(
"
"
, clientID, userName);
}
void
processSubscribe
(
MqttSubscribeMessage
try
{
SslProvider
sslProvider
=
getSSLProvider();
KeyStore
ks
=
loadKeyStore();
SslContextBuilder
contextBuilder;
switch
(sslProvider) {
case
JDK
:
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
final
IConfig
props;
DefaultMoquetteSslContextCreator
(
IConfig
WEB_SOCKET_PORT_PROPERTY_NAME
=
"
websocket_port
"
;
public
static
final
String
WEB_SOCKET_PORT_PROPERTY_NAME
=
"
websocket_port
"
;
public
static
final
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
❤️
🚀
👀
There aren’t any open pull requests.
You could search
all of GitHub
or try an
advanced search
.
ProTip!
no:milestone
will show everything without a milestone.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
out
.
println(
"
Server started, version 0.
13-SNAPSHOT
"
);
//
Bind a shutdown hook
//
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
info(
"
PUB: speed {} msg/sec
"
, msgPerSec);
this
.
stopLatch
.
countDown();
}
@Override
public
void
onFailure
(
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
)
throws
IOException
{
LOG
.
info(
"
Starting Moquette integration. Configuration file path: {}
"
, configFile
.
getAbsolutePath());
IResourceLoader
filesystemLoader
=
new
FileResourceLoader
(configFile);
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Move to different package?
#1 opened
May 9, 2019
by
flozano
1
ProTip!
moquette.path
"
,
"
build/resources/test/
"
systemProperties
.
put
"
io.netty.leakDetectionLevel
"
,
"
paranoid
"
testLogging {
exceptionFormat
@
rem
##########################################################################
@
rem
Set local scope for the variables with windows NT shell
if
"
%OS%
"
==
"
Windows_NT
"
setlocal
set
DIRNAME
=
%
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
msg
) {
final
String
clientID
=
NettyUtils
.
clientID(channel);
if
(
!
connected) {
LOG
.
warn(
"
"
contextBuilder
=
builderWithJdkProvider(ks, keyPassword);
break
;
case
OPENSSL
:
case
OPENSSL_REFCNT
:
contextBuilder
=
builderWithOpenSSLProvider(ks, keyPassword);
break
;
default
:
props
) {
this
.
props
=
Objects
.
requireNonNull(props);
}
@Override
public
SslContext
initSSLContext
() {
LOG
.
info(
String
WSS_PORT_PROPERTY_NAME
=
"
secure_websocket_port
"
;
public
static
final
String
WSS_PORT_PROPERTY_NAME
=
"
secure_websocket_port
"
;
/**
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
5
New issue
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
(server
::
stopServer));
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
(server
::
stopServer));
}
}
4
build.gradle
Show comments
View file
IMqttToken
asyncActionToken
,
Throwable
th
) {
LOG
.
error(
"
PUB: Publish failed:
"
+
th);
System
.
exit(
2
);
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
final
IConfig
config
=
new
ResourceLoaderConfig
(filesystemLoader);
startServer(config);
}
/**
* Starts the integration with the given properties.
* <
p
>
* Its suggested to at least have the following properties:
* <
ul
>
* <
Adding
no:label
will show everything without a label.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
'
full
'
events
"
passed
"
,
"
skipped
"
,
"
failed
"
}
}
~dp0
if
"
%DIRNAME%
"
==
"
"
set
DIRNAME
=
.
set
APP_BASE_NAME
=
%
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
, clientID, channel);
dropConnection();
return
;
}
postOffice
.
subscribeClientToTopics(msg, clientID,
NettyUtils
.
userName(channel),
this
);
}
void
sendSubAckMessage
(
int
messageID
LOG
.
error(
"
unsupported SSL provider {}
"
, sslProvider);
return
null
;
}
//
if client authentification is enabled a trustmanager needs to be added to the ServerContext
String
sNeedsClientAuth
=
"
Checking SSL configuration properties...
"
);
final
String
keyPassword
=
props
.
getProperty(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
);
* Defines the SSL implementation to use, default to "JDK".
*
@see
io.netty.handler.ssl.SslProvider#name()
*/
public
static
final
String
SSL_PROVIDER
=
"
ssl_provider
"
;
public
static
final
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
63 Open
314 Closed
63 Open
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Edit file
Delete file
@@ -3,7 +3,7 @@ allprojects {
apply
plugin
:
'
maven-publish
'
apply
plugin
:
'
maven-publish
'
}
}
private
int
qos;
private
boolean
retain;
private
final
int
numToSend;
private
final
int
messagesPerSecond;
private
final
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
li
>port</li>
* <
li
>password_file</li>
* </ul>
*
*
@param
configProps the properties map to use as configuration.
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
//
Deploy set environment variables and run ./gradlew bintrayUpload
//
publication to maven repo
publishing {
publications {
bintrayPublication(
MavenPublication
) {
from components
.
java
~n0
set
APP_HOME
=
%DIRNAME%
@
rem
Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
set
DEFAULT_JVM_OPTS
=
@
rem
Find java.exe
,
MqttSubAckMessage
ackMessage
) {
final
String
clientId
=
NettyUtils
.
clientID(channel);
LOG
.
trace(
"
"
, clientId, messageID);
channel
props
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
if
(
Boolean
.
valueOf(sNeedsClientAuth)) {
addClientAuthentication(ks, contextBuilder);
}
if
(keyPassword
==
null
||
keyPassword
.
isEmpty()) {
LOG
.
warn(
"
The key manager password is null or empty. The SSL context won't be initialized.
"
);
return
null
String
SSL_PORT_PROPERTY_NAME
=
"
ssl_port
"
;
public
static
final
String
SSL_PORT_PROPERTY_NAME
=
"
ssl_port
"
;
public
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Save preferences
group
=
'
io.moquette
'
group
=
'
io.moquette
'
version
=
'
0.
12.1
'
version
String
dialog_id;
private
final
IMqttAsyncClient
client;
private
CountDownLatch
m_latch;
BenchmarkPublisher
(
MqttAsyncClient
client
,
int
numToSend
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
(
Properties
configProps
)
throws
IOException
{
LOG
.
debug(
"
Starting Moquette integration using properties object
"
);
final
IConfig
config
=
NullPointerException in CTrie.evaluate · Issue #529 · moquette-io/moquette · GitHub
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
groupId
"
$p
roject
.
group
"
artifactId
"
${
project.name
}
"
version
'
0.13-SNAPSHOT
'
}
if
defined
JAVA_HOME
goto
findJavaFromJavaHome
set
JAVA_EXE
=
java.exe
%JAVA_EXE%
-version
>
NUL
2
>&
1
if
.
writeAndFlush(ackMessage)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
private
void
processUnsubscribe
(
MqttUnsubscribeMessage
msg
) {
List<
String
>
topics
contextBuilder
.
sslProvider(sslProvider);
SslContext
sslContext
=
contextBuilder
.
build();
LOG
.
info(
"
The SSL context has been initialized successfully.
"
);
return
sslContext;
}
;
}
try
{
SslProvider
sslProvider
=
getSSLProvider();
KeyStore
ks
=
loadKeyStore();
SslContextBuilder
contextBuilder;
switch
(sslProvider) {
case
JDK
:
static
final
String
JKS_PATH_PROPERTY_NAME
=
"
jks_path
"
;
public
static
final
String
JKS_PATH_PROPERTY_NAME
=
"
jks_path
"
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
if unchecked exception is throw while running processSubscription then remove() will never be called
=
'
0.
13-SNAPSHOT
'
}
}
buildscript
{
buildscript
{
@@ -92,7 +92,7 @@ subprojects {
from components
.
java
from components
.
java
groupId
,
int
messagesPerSecond
,
String
dialog_id
) {
this
.
client
=
client;
this
.
numToSend
=
numToSend;
this
.
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
new
MemoryConfig
(configProps);
startServer(config);
}
/**
* Starts Moquette bringing the configuration files from the given Config implementation.
*
*
@param
config the configuration to use to start the broker.
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Save preferences
}
}
bintray {
println
"
Bintray deploy with user [
${
System.getenv('BINTRAY_USER')
}
] while working on
${
project.name
}
"
user
=
System
.
getenv(
"
%ERRORLEVEL%
"
==
"
0
"
goto
init
echo
.
echo
ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.
echo
.
echo
Please set the JAVA_HOME variable in your environment to match the
echo
=
msg
.
payload()
.
topics();
String
clientID
=
NettyUtils
.
clientID(channel);
LOG
.
trace(
"
"
catch
(
GeneralSecurityException
|
IOException
ex) {
LOG
.
error(
"
Unable to initialize SSL context.
"
, ex);
return
null
;
}
contextBuilder
=
builderWithJdkProvider(ks, keyPassword);
break
;
case
OPENSSL
:
case
OPENSSL_REFCNT
:
contextBuilder
=
builderWithOpenSSLProvider(ks, keyPassword);
break
;
default
:
;
/*
* @see java.security.KeyStore#getInstance(String) for allowed types, default to "jks"
*/
public
static
final
String
KEY_STORE_TYPE
=
"
key_store_type
"
;
public
static
final
String
#316 opened
May 19, 2017
by
windbender
Publish javadoc & sources of 0.13
#528 opened
May 13, 2020
by
hylkevds
Moquette & 2-way SSL authentication
#508 opened
Nov 25, 2019
by
lukaszsoszynski
Will it be compatible with Graalvm in the future?
#509 opened
Dec 12, 2019
by
"
$p
roject
.
group
"
groupId
"
$p
roject
.
group
"
artifactId
"
${
project.name
}
"
messagesPerSecond
=
messagesPerSecond;
this
.
dialog_id
=
dialog_id;
}
public
void
connect
()
👀
Mqtt websocket http
#538 opened
Oct 22, 2020
by
strautins
updated
Oct 22, 2020
1
Embedding example throws java.lang.UnsupportedOperationException: direct buffer
#534 opened
Sep 16, 2020
by
micw
updated
Sep 16, 2020
(
IConfig
config
)
throws
IOException
{
LOG
.
debug(
"
Starting Moquette integration using IConfig instance
"
);
startServer(config,
null
);
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
'
BINTRAY_USER
'
)
key
=
System
.
getenv(
'
BINTRAY_KEY
'
)
pkg {
repo
=
'
maven
location of your Java installation.
goto
fail
:
findJavaFromJavaHome
set
JAVA_HOME
=
%JAVA_HOME:
"
=%
set
JAVA_EXE
=
%JAVA_HOME%
/bin/java.exe
if
, clientID, topics);
postOffice
.
unsubscribe(topics,
this
, msg
.
variableHeader()
.
messageId());
}
void
sendUnsubAckMessage
(
List<
String
>
}
private
KeyStore
loadKeyStore
()
throws
IOException
,
GeneralSecurityException
{
final
String
jksPath
=
props
.
getProperty(
LOG
.
error(
"
unsupported SSL provider {}
"
, sslProvider);
return
null
;
}
KEY_STORE_PASSWORD_PROPERTY_NAME
=
"
key_store_password
"
;
public
static
final
String
KEY_STORE_PASSWORD_PROPERTY_NAME
=
"
key_store_password
coolbeevip
BrokerInterceptor thread pool never closing on serverStop
#506 opened
Oct 9, 2019
by
bobrowskim
queue is full
#521 opened
Mar 28, 2020
by
arifainchtein
Publish Failed Acknowledgment
#433 opened
Oct 22, 2018
by
artifactId
"
${
project.name
}
"
version
'
0.
12.1
'
version
'
0.
13-SNAPSHOT
'
}
}
}
throws
MqttException
{
MqttConnectOptions
connectOptions
=
new
MqttConnectOptions
();
connectOptions
.
setCleanSession(
true
);
this
.
client
.
connect(connectOptions,
New configuration parameter : setting the HandshakeTimeout on SslHandler
#531 opened
Jul 23, 2020
by
dsoulayrol
updated
Jul 23, 2020
NullPointerException in CTrie.evaluate
#529 opened
May 13, 2020
by
hylkevds
updated
May 25, 2020
1
3
Publish javadoc & sources of 0.13
}
/**
* Starts Moquette with config provided by an implementation of IConfig class and with the set
* of InterceptHandler.
*
*
@param
config the configuration to use to start the broker.
*
@param
handlers the handlers to install in the broker.
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
(
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
'
//
name
=
"
${
project.group
}
.
${
project.name
}
"
userOrg
=
'
andsel
'
licenses
exist
"
%JAVA_EXE%
"
goto
init
echo
.
echo
ERROR: JAVA_HOME is set to an invalid directory:
%JAVA_HOME%
echo
.
echo
Please set the JAVA_HOME variable in your environment to match the
echo
topics
,
String
clientID
,
int
messageID
) {
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
UNSUBACK
,
BrokerConstants
.
JKS_PATH_PROPERTY_NAME
);
LOG
.
info(
"
Initializing SSL context. KeystorePath = {}.
"
, jksPath);
if
(jksPath
==
null
||
jksPath
.
//
if client authentification is enabled a trustmanager needs to be added to the ServerContext
String
sNeedsClientAuth
=
props
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
if
(
"
;
public
static
final
String
KEY_MANAGER_PASSWORD_PROPERTY_NAME
=
"
key_manager_password
"
;
public
static
final
String
KEY_MANAGER_PASSWORD_PROPERTY_NAME
=
"
BigGitWorld
Broker does not reject connections with clientId longer than 23 characters for MQTT v3.1
#522 opened
Mar 31, 2020
by
mjacoby
Connection dropped when publishing message with payload greater 8KB.
#503 opened
Aug 30, 2019
by
r-t-s
java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes
#518 opened
Feb 27, 2020
by
carlsberg-stack
Error processing protocol message: PUBACK
#483 opened
}
}
}
2
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
"
echo
"
| |
"
null
,
new
IMqttActionListener
() {
@Override
public
void
onFailure
(
IMqttToken
asyncActionToken
,
Throwable
exception
) {
LOG
#528 opened
May 13, 2020
by
hylkevds
updated
May 13, 2020
Buffering settings to reduce latency
#527 opened
May 8, 2020
by
impliedx
updated
May 13, 2020
1
Broker does not reject connections with clientId longer than 23 characters for MQTT v3.1
#522 opened
Mar 31, 2020
IConfig
config
,
List<? extends
InterceptHandler
>
handlers
)
throws
IOException
{
LOG
.
debug(
"
Starting moquette integration using IConfig instance and intercept handlers
"
);
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
=
[
'
Apache-2.0
'
]
vcsUrl
=
"
https://api.bintray.com/maven/andsel/maven/
${
project.group
}
.
${
project.name
}
"
location of your Java installation.
goto
fail
:
init
@
rem
Get command-line arguments, handling Windows variants
if
not
"
%OS%
"
==
"
Windows_NT
false
,
AT_MOST_ONCE
,
false
,
0
);
MqttUnsubAckMessage
ackMessage
=
new
MqttUnsubAckMessage
(fixedHeader, from(messageID));
LOG
.
trace(
"
isEmpty()) {
//
key_store_password or key_manager_password are empty
LOG
.
warn(
"
The keystore path is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
//
if we have the port also the jks then keyStorePassword and keyManagerPassword
//
Boolean
.
valueOf(sNeedsClientAuth)) {
addClientAuthentication(ks, contextBuilder);
}
contextBuilder
.
sslProvider(sslProvider);
SslContext
sslContext
=
contextBuilder
.
build();
LOG
.
info(
"
key_manager_password
"
;
public
static
final
String
ALLOW_ANONYMOUS_PROPERTY_NAME
=
"
allow_anonymous
"
;
public
static
final
String
ALLOW_ANONYMOUS_PROPERTY_NAME
Jun 13, 2019
by
Demitrius
New configuration parameter : setting the HandshakeTimeout on SslHandler
#531 opened
Jul 23, 2020
by
dsoulayrol
Question: disconnecting a client when authentication details removed
#516 opened
Jan 23, 2020
by
MattyyttaM
when protocol processor is inited with ssl port the word "disabled" is used to indicate the server name
#209 opened
Sep 15, 2016
by
windbender
echo
"
|_|
"
echo
"
|_|
"
echo
"
"
echo
"
"
echo
"
version: 0.
12.1
.
error(
"
PUB: connect fail
"
, exception);
System
.
exit(
2
);
}
@Override
public
void
onSuccess
(
IMqttToken
by
mjacoby
updated
Mar 31, 2020
queue is full
#521 opened
Mar 28, 2020
by
arifainchtein
updated
Mar 28, 2020
java.lang.NoSuchMethodError: No static method encodeHexString([B)Ljava/lang/String; in class Lorg/apache/commons/codec/binary/Hex; or its super classes
#518 opened
Feb 27, 2020
by
carlsberg-stack
updated
startServer(config, handlers,
null
,
null
,
null
);
}
public
void
startServer
(
IConfig
config
,
List<? extends
InterceptHandler
>
handlers
Buffering settings to reduce latency · Issue #527 · moquette-io/moquette · GitHub
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
publications
=
[
'
bintrayPublication
'
]
}
}
}
task
wrapper
(
type
:
Wrapper
"
goto
win9xME_args
:
win9xME_args
@
rem
Slurp the command line arguments.
set
CMD_LINE_ARGS
=
set
_SKIP
=
2
:
win9xME_args_slurp
if
"
, clientID, messageID, topics);
channel
.
writeAndFlush(ackMessage)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
LOG
.
trace(
"
"
, clientID, topics);
}
void
processPublish
has to be defined
final
String
keyStorePassword
=
props
.
getProperty(
BrokerConstants
.
KEY_STORE_PASSWORD_PROPERTY_NAME
);
final
String
keyManagerPassword
=
props
.
getProperty(
The SSL context has been initialized successfully.
"
);
return
sslContext;
}
catch
(
GeneralSecurityException
|
IOException
ex) {
LOG
.
error(
"
Unable to initialize SSL context.
"
=
"
allow_anonymous
"
;
175
broker/src/main/java/io/moquette/server/DefaultMoquetteSslContextCreator.java
Show comments
View file
Edit file
Delete file
@@ -16,19 +16,34 @@
package
io.moquette.server
;
package
io.moquette.server
How one port supports both unidirectional and two-way certificate authentication for TLS
#491 opened
Jul 30, 2019
by
cnneillee
Deploy -javadoc and -source jars
#465 opened
Apr 1, 2019
by
joker1
Subscription storage
#482 opened
Jun 12, 2019
"
echo
"
version: 0.
13-SNAPSHOT
"
set
"
CURRENT_DIR
=
%cd%
"
set
"
CURRENT_DIR
=
%cd%
"
asyncActionToken
) {
LOG
.
info(
"
PUB: Successfully connected to server
"
);
}
});
this
.
m_latch
=
new
CountDownLatch
(
1
Feb 28, 2020
BUG - null Session in subscribe procedure
#517 opened
Feb 14, 2020
by
BigGitWorld
updated
Feb 14, 2020
Question: disconnecting a client when authentication details removed
#516 opened
Jan 23, 2020
by
MattyyttaM
updated
Jan 23, 2020
NullPointerException.I think is a bug
#473 opened
,
ISslContextCreator
sslCtxCreator
,
IAuthenticator
authenticator
,
IAuthorizatorPolicy
authorizatorPolicy
) {
final
long
start
=
System
.
currentTimeMillis();
if
(handlers
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
) {
gradleVersion
=
'
4.6
'
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
"
x%
~1
"
==
"
x
"
goto
execute
set
CMD_LINE_ARGS
=
%
*
:
execute
@
(
MqttPublishMessage
msg
) {
final
MqttQoS
qos
=
msg
.
fixedHeader()
.
qosLevel();
final
String
username
=
NettyUtils
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
);
if
(keyStorePassword
==
null
||
keyStorePassword
.
isEmpty()) {
//
key_store_password or key_manager_password are empty
LOG
.
warn(
"
, ex);
return
null
;
}
}
private
KeyStore
loadKeyStore
()
throws
IOException
,
GeneralSecurityException
{
final
String
jksPath
;
import
java.io.File
;
import
java.io.FileInputStream
;
import
java.io.FileNotFoundException
;
import
java.io.IOException
;
import
java.io.InputStream
;
import
by
BigGitWorld
Abnormal disconnection of the connection will result in InterceptHandler.onConnectionLost() called twice
#430 opened
Sep 20, 2018
by
CoderBigL
getSubscriptions() always return an Empty list
#438 opened
Nov 19, 2018
by
abdollahpour
BUG - null Session in subscribe procedure
#517 opened
Feb 14, 2020
by
BigGitWorld
if
not
"
%MOQUETTE_HOME%
"
==
"
"
goto
gotHome
if
not
"
%MOQUETTE_HOME%
"
==
"
"
);
}
public
void
firePublishes
()
throws
MqttException
,
UnsupportedEncodingException
{
long
pauseMicroseconds
=
(
int
) ((
1.0
Apr 22, 2019
by
liuhanjim
updated
Jan 22, 2020
3
Bridging to a cloud broker [Microsoft Azure -- IOT Hub] ?
#513 opened
Jan 17, 2020
by
carlsberg-stack
updated
Jan 20, 2020
5
Moquette shows topics, but subscribers won't receive anything - Subscription missing?
#510 opened
Dec 18, 2019
==
null
) {
handlers
=
Collections
.
emptyList();
}
LOG
.
trace(
"
Starting Moquette Server. MQTT message interceptors={}
"
, getInterceptorIds(handlers));
scheduler
=
Packages · Moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Already on GitHub?
Sign in
to your account
Jump to bottom
NullPointerException in CTrie.evaluate
#529
Open
hylkevds
opened this issue
May 13, 2020
· 3 comments
· May be fixed by
#532
Open
NullPointerException in CTrie.evaluate
#529
hylkevds
opened this issue
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
rem
Setup the command line
set
CLASSPATH
=
%APP_HOME%
\gradle\wrapper\gradle-wrapper.jar
@
rem
Execute Gradle
"
%JAVA_EXE%
"
%DEFAULT_JVM_OPTS%
%JAVA_OPTS%
%GRADLE_OPTS%
"
-Dorg.gradle.appname=
%APP_BASE_NAME%
.
userName(channel);
final
String
topicName
=
msg
.
variableHeader()
.
topicName();
final
String
clientId
=
getClientId();
LOG
.
The keystore password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
if
(keyManagerPassword
==
null
||
keyManagerPassword
.
isEmpty()) {
//
key_manager_password or key_manager_password are empty
LOG
.
=
props
.
getProperty(
BrokerConstants
.
JKS_PATH_PROPERTY_NAME
);
LOG
.
info(
"
Initializing SSL context. KeystorePath = {}.
"
, jksPath);
if
(jksPath
==
null
java.net.URL
;
import
java.security.GeneralSecurityException
;
import
java.security.KeyManagementException
;
import
java.security.KeyStore
;
import
java.security.KeyStoreException
;
import
java.security.NoSuchAlgorithmException
;
import
java.security.PrivateKey
license is missing in artifact
#492 opened
Jul 30, 2019
by
ascheman
Potential Bug in NextPacketID
bug
#237 opened
Nov 29, 2016
by
peacecoder
Embedding example throws java.lang.UnsupportedOperationException: direct buffer
#534 opened
Sep 16, 2020
by
micw
Netty Leak Detection.
goto
gotHome
2
distribution/src/main/scripts/moquette.sh
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
"
echo
"
| |
"
echo
/
messagesPerSecond)
*
1000
*
1000
);
LOG
.
info(
"
PUB: Pause over the each message sent {} microsecs
"
, pauseMicroseconds);
LOG
.
info(
"
by
beniroquai
updated
Jan 2, 2020
1
Will it be compatible with Graalvm in the future?
#509 opened
Dec 12, 2019
by
coolbeevip
updated
Dec 12, 2019
Subscription breaks during performance test
#505 opened
Oct 4, 2019
by
JinseonyLee
Executors
.
newScheduledThreadPool(
1
);
final
String
handlerProp
=
System
.
getProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
);
if
(handlerProp
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
May 13, 2020
· 3 comments
· May be fixed by
#532
Comments
Copy link
Quote reply
Contributor
hylkevds
commented
May 13, 2020
Expected behavior
No exceptions when publishing a message
Actual behavior
Steps to reproduce
git clone
git@github.com
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
"
-classpath
"
%CLASSPATH%
"
org.gradle.wrapper.GradleWrapperMain
%CMD_LINE_ARGS%
:
end
@
rem
End local scope for the variables with windows NT shell
if
"
%ERRORLEVEL%
"
==
"
trace(
"
"
, clientId, topicName,
msg
.
variableHeader()
.
packetId(), qos);
ByteBuf
payload
=
msg
.
payload();
final
boolean
retain
warn(
"
The key manager password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
String
ksType
=
props
.
getProperty(
BrokerConstants
.
KEY_STORE_TYPE
,
"
||
jksPath
.
isEmpty()) {
LOG
.
warn(
"
The keystore path is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
final
String
keyStorePassword
;
import
java.security.cert.Certificate
;
import
java.security.cert.X509Certificate
;
import
java.util.Collections
;
import
java.util.Objects
#467 opened
Apr 4, 2019
by
kopens
1
Mqtt websocket http
#538 opened
Oct 22, 2020
by
strautins
1
Previous
1
2
3
Next
Previous
Next
"
|_|
"
echo
"
|_|
"
echo
"
"
echo
"
"
echo
"
version: 0.
12.1
"
PUB: publishing..
"
);
CountDownLatch
m_latch
=
new
CountDownLatch
(
1
);
final
long
startTime
=
System
.
currentTimeMillis();
updated
Dec 10, 2019
1
Moquette & 2-way SSL authentication
#508 opened
Nov 25, 2019
by
lukaszsoszynski
updated
Nov 25, 2019
MQTT SSL not working
#499 opened
Aug 20, 2019
by
francesco98
updated
Nov 9, 2019
1
!=
null
) {
config
.
setProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
, handlerProp);
}
final
String
persistencePath
=
config
.
getProperty(
BrokerConstants
.
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
:FraunhoferIOSB/FROST-Server.git
cd FROST-Server
mvn install
https://travis-ci.org/github/FraunhoferIOSB/FROST-Server/jobs/686452716
It seems it does not always happen on my machine, but it's very reproducable on Travis. I've not been able to debug Moquette, since it does not compile on java 11.
Moquette MQTT version
0.13
JVM version (e.g.
java -version
)
11.0.7
Copy link
Contributor
Author
hylkevds
commented
May 13, 2020
Learn more
Accept
Reject
Save preferences
0
"
goto
mainEnd
:
fail
rem
Set variable GRADLE_EXIT_CONSOLE if you need the _script_ return code instead of
rem
the _cmd.exe /c_ return code!
if
not
"
"
==
"
%GRADLE_EXIT_CONSOLE%
=
msg
.
fixedHeader()
.
isRetain();
final
Topic
topic
=
new
Topic
(topicName);
if
(
!
topic
.
jks
"
);
final
KeyStore
keyStore
=
KeyStore
.
getInstance(ksType);
LOG
.
info(
"
Loading keystore. KeystorePath = {}.
"
, jksPath);
=
props
.
getProperty(
BrokerConstants
.
KEY_STORE_PASSWORD_PROPERTY_NAME
);
if
(keyStorePassword
==
;
import
io.moquette.BrokerConstants
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.server.config.IConfig
;
import
ProTip!
Exclude everything labeled
bug
with
-label:bug
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
echo
"
version: 0.
.13-SNAPSHOT
"
cd
"
$(
dirname
"
$0
"
)
"
cd
"
$(
dirname
//
initialize the timer
PlatformTimer
timer
=
PlatformTimer
.
detect();
IMqttActionListener
pubCallback
=
new
PublishCallback
();
for
(
int
i
BrokerInterceptor thread pool never closing on serverStop
#506 opened
Oct 9, 2019
by
bobrowskim
updated
Oct 10, 2019
failed to allocate 16777216 byte(s) of direct memory
#466 opened
Apr 4, 2019
by
FengXMGeek
updated
Sep 27, 2019
3
Plans to support MQTT 5?
PERSISTENT_STORE_PROPERTY_NAME
);
LOG
.
debug(
"
Configuring Using persistent store file, path: {}
"
, persistencePath);
initInterceptors(config, handlers);
LOG
.
debug(
"
Initialized MQTT protocol processor
"
);
if
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
•
edited
I've made a little minimal test project / torture test for this problem that will usually give the above exception in a few seconds:
https://github.com/hylkevds/moquetteTests
What it does is:
It spins up a Moquette
It creates 1 client for publishing
It creates 10 threads for publishing data
each publishes on 1 topic
each publishes as fast as it can
It creates 1 (or more) thread for listening, each with its own client.
In a loop they:
connect,
subscribe to all topics
count received messages for 2000 ms
unsubscribe from all topics
disconnect
sleep for 100 ms
"
exit
1
exit
/b
1
:
mainEnd
if
"
%OS%
"
==
"
Windows_NT
"
endlocal
:
isValid()) {
LOG
.
debug(
"
Drop connection because of invalid topic format
"
);
dropConnection();
}
switch
(qos) {
case
AT_MOST_ONCE
:
postOffice
.
receivedPublishQos0(topic, username, clientId, payload, retain, msg);
try
(
InputStream
jksInputStream
=
jksDatastore(jksPath)) {
keyStore
.
load(jksInputStream, keyStorePassword
.
toCharArray());
}
return
keyStore;
}
//
if client authentification is enabled a trustmanager needs to be
//
null
||
keyStorePassword
.
isEmpty()) {
LOG
.
warn(
"
The keystore password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
String
ksType
io.moquette.spi.security.ISslContextCreator
;
import
io.moquette.spi.security.ISslContextCreator
;
import
org.slf4j.Logger
;
import
io.netty.handler.ssl.ClientAuth
;
import
org.slf4j.LoggerFactory
;
import
io.netty.handler.ssl.SslContext
;
import
io.netty.handler.ssl.SslContextBuilder
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
"
$0
"
)
"
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
@GrabResolver
(
name
=
'
moquette-bintray
'
=
0
; i
<
numToSend; i
++
) {
long
nanos
=
System
.
nanoTime();
byte
[] message
=
(
"
#490 opened
Jul 23, 2019
by
mpe85
updated
Sep 20, 2019
6
Connection dropped when publishing message with payload greater 8KB.
#503 opened
Aug 30, 2019
by
r-t-s
updated
Aug 30, 2019
Will Message lost if client reconnect before server clear the old connection
#366 opened
Oct 22, 2017
(sslCtxCreator
==
null
) {
LOG
.
info(
"
Using default SSL context creator
"
);
sslCtxCreator
=
new
DefaultMoquetteSslContextCreator
(config);
}
authenticator
Publish javadoc & sources of 0.13 · Issue #528 · moquette-io/moquette · GitHub
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
Type:
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
If you increase the listener count to 10 or so, I also see lots of other exceptions and netty weirdness, but with just 1 client I only get the above exception.
I hope that helps you in finding the issue!
Copy link
Contributor
Author
hylkevds
commented
May 15, 2020
I managed to get moquette to compile with the help of PR
#498
and did a bit of debugging.
If the exception happens, it's because it is evaluating on a TNode, and I think TNodes should be excluded when fetching subscriptions from children:
in CTrie.java:86
But I've not fully gone through all details of your CTrie implementation, so I'm not sure this has no side effects.
Copy link
Contributor
Author
hylkevds
omega
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
break
;
case
AT_LEAST_ONCE
:
{
final
int
messageID
=
msg
.
variableHeader()
.
packetId();
postOffice
.
receivedPublishQos1(
added to the ServerContext
String
sNeedsClientAuth
=
props
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
boolean
needsClientAuth
=
Boolean
=
props
.
getProperty(
BrokerConstants
.
KEY_STORE_TYPE
,
"
jks
"
);
final
KeyStore
keyStore
=
KeyStore
.
getInstance(ksType);
;
import
io.netty.handler.ssl.SslProvider
;
import
javax.net.ssl.KeyManagerFactory
;
import
javax.net.ssl.KeyManagerFactory
;
import
javax.net.ssl.SSLContext
;
import
javax.net.ssl.TrustManager
;
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@GrabResolver
(
name
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
Hello world!!-
"
+
nanos)
.
getBytes(
UTF_8
);
this
.
client
.
publish(
"
/topic
"
+
dialog_id, message, qos, retain,
null
by
fjcyue
updated
Aug 13, 2019
1
1
How to forcefully disconnect the client from the broker?
#469 opened
Apr 8, 2019
by
giri110890
updated
Aug 9, 2019
9
license is missing in artifact
#492 opened
Jul 30, 2019
by
Reduce log level for log messages caused by client side input mistake… · moquette-io/moquette@7b9db6e · GitHub
=
initializeAuthenticator(authenticator, config);
authorizatorPolicy
=
initializeAuthorizatorPolicy(authorizatorPolicy, config);
final
ISubscriptionsRepository
subscriptionsRepository;
final
IQueueRepository
queueRepository;
final
IRetainedRepository
retainedRepository;
if
(persistencePath
!=
null
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
All
Select type
All
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
Public
Select visibility
All
Private
Public
Sort by:
Most downloads
Select sort view
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Buffering settings to reduce latency
#527
Open
impliedx
opened this issue
May 8, 2020
· 1 comment
Open
Buffering settings to reduce latency
#527
impliedx
commented
May 25, 2020
This seems to be a duplicate of
#505
The solution proposed there is essentially the same: Don't process TNodes.
The test project above is still useful for finding problems though :)
hylkevds
added a commit to hylkevds/moquette that referenced this issue
Aug 13, 2020
Fixes
moquette-io#529
,
moquette-io#505
: NPE caused by matching on a T…
…
9c1c2ff
hylkevds
added a commit to hylkevds/moquette that referenced this issue
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
this
, topic, username, payload, messageID, retain, msg);
break
;
}
case
EXACTLY_ONCE
:
{
final
int
messageID
=
msg
.
variableHeader()
.
.
valueOf(sNeedsClientAuth);
private
static
SslContextBuilder
builderWithJdkProvider
(
KeyStore
ks
,
String
LOG
.
info(
"
Loading keystore. KeystorePath = {}.
"
, jksPath);
try
(
InputStream
jksInputStream
=
jksDatastore(jksPath)) {
import
javax.net.ssl.TrustManagerFactory
;
import
javax.net.ssl.TrustManagerFactory
;
import
java.io.*
;
import
org.slf4j.Logger
;
import
java.net.URL
;
import
org.slf4j.LoggerFactory
;
'
)
@Grab
(
group
=
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
, pubCallback);
timer
.
sleep(pauseMicroseconds);
}
IMqttActionListener
exitCallback
=
new
ExitTopicCallback
(startTime, numToSend, m_latch);
long
nanosExit
=
System
.
nanoTime();
ascheman
updated
Jul 30, 2019
Previous
1
2
3
Next
Previous
Next
ProTip!
Type
g
p
on any issue or pull request to go back to the pull request listing page.
© 2020 GitHub, Inc.
Terms
Privacy
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
&&
!
persistencePath
.
isEmpty()) {
LOG
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
h2Builder
=
new
H2Builder
(config, scheduler)
.
initStore();
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Most downloads
Least downloads
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
opened this issue
May 8, 2020
· 1 comment
Comments
Copy link
Quote reply
impliedx
commented
May 8, 2020
There is a latency in the delivery of messages which seems to be from some buffering which flushes the messages only every few seconds. Is there a configuration where this latency can be reduced and the messages processed as soon as they come in?
Moquette MQTT version
1.12.1
JVM version (e.g.
java -version
)
8
OS version (e.g.
uname -a
Aug 13, 2020
Fixes
moquette-io#529
,
moquette-io#505
: NPE caused by matching on a T…
…
72a21ef
hylkevds
linked a pull request that will
close
this issue
Aug 13, 2020
Fixes #529, #505: NPE caused by matching on a TNode
#532
Open
Sign up for free
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
packetId();
final
Session
session
=
sessionRegistry
.
retrieve(clientId);
session
.
receivedPublishQos2(messageID, msg);
postOffice
.
receivedPublishQos2(
this
, msg, username);
//
msg.release();
keyPassword
)
throws
GeneralSecurityException
{
LOG
.
info(
"
Initializing key manager...
"
);
final
KeyManagerFactory
kmf
=
KeyManagerFactory
.
getInstance(
keyStore
.
load(jksInputStream, keyStorePassword
.
toCharArray());
}
return
keyStore;
}
private
static
SslContextBuilder
builderWithJdkProvider
(
KeyStore
ks
,
String
import
java.security.*
;
import
java.security.cert.CertificateException
;
/**
/**
* Moquette server implementation to load SSL certificate from local filesystem path configured in
* Moquette server implementation to load SSL certificate from local filesystem path configured in
@@ -38,77 +53,120 @@
private
static
final
Logger
LOG
=
LoggerFactory
'
0.
12.1
'
)
@Grab
(
group
=
'
io.moquette
'
,
module
=
'
moquette-broker
'
,
byte
[] exitMessage
=
(
"
Hello world!!-
"
+
nanosExit)
.
getBytes(
UTF_8
);
this
.
client
.
publish(
"
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
queueRepository
=
h2Builder
.
queueRepository();
retainedRepository
=
h2Builder
.
retainedRepository();
}
else
{
LOG
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
)
Windows 10 / Ubuntu 16.04
Copy link
Contributor
hylkevds
commented
May 13, 2020
Probably a duplicate of, or related to
#515
Sign up for free
to join this conversation on GitHub
. Already have an account?
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
Fixes #529, #505: NPE caused by matching on a TNode
1 participant
© 2020 GitHub, Inc.
Terms
break
;
}
default
:
LOG
.
error(
"
Unknown QoS-Type:{}
"
, qos);
break
;
}
}
void
sendPublishReceived
KeyManagerFactory
.
getDefaultAlgorithm());
kmf
.
init(ks, keyPassword
.
toCharArray());
LOG
.
info(
"
Initializing SSL context...
"
);
return
SslContextBuilder
.
forServer(kmf);
keyPassword
)
throws
GeneralSecurityException
{
LOG
.
info(
"
Initializing key manager...
"
);
final
KeyManagerFactory
kmf
=
KeyManagerFactory
.
getInstance(
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
IConfig
version
=
'
0.
13-SNAPSHOT
'
)
import
io.moquette.server.Server
import
io.moquette.server.Server
Toggle all file notes
0 comments on commit
db4349b
Please
sign in
/exit
"
+
dialog_id, exitMessage, qos, retain,
null
, exitCallback);
}
public
void
waitFinish
()
throws
InterruptedException
{
m_latch
.
await();
try
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Packages · Moquette · GitHub
.
trace(
"
Configuring in-memory subscriptions store
"
);
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
queueRepository
=
new
MemoryQueueRepository
();
retainedRepository
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
2 participants
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
(
int
messageID
) {
LOG
.
trace(
"
sendPubRec invoked on channel: {}
"
, channel);
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
}
try
{
LOG
.
info(
"
Loading keystore. KeystorePath = {}.
"
, jksPath);
InputStream
jksInputStream
=
jksDatastore(jksPath);
SSLContext
serverContext
=
SSLContext
KeyManagerFactory
.
getDefaultAlgorithm());
kmf
.
init(ks, keyPassword
.
toCharArray());
LOG
.
info(
"
Initializing SSL context...
"
);
return
SslContextBuilder
.
forServer(kmf);
props;
private
final
IConfig
props;
DefaultMoquetteSslContextCreator
(
IConfig
props
) {
DefaultMoquetteSslContextCreator
(
IConfig
props
) {
this
.
props
=
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
{
this
.
client
.
disconnect();
}
catch
(
MqttException
mex) {
LOG
.
error(
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
=
new
MemoryRetainedRepository
();
}
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
.
init(subscriptionsRepository);
final
Authorizator
authorizator
=
new
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
.
PUBREC
,
false
,
AT_MOST_ONCE
,
false
,
0
);
MqttPubAckMessage
pubRecMessage
=
new
MqttPubAckMessage
(fixedHeader, from(messageID));
sendIfWritableElseDrop(pubRecMessage);
.
getInstance(
"
TLS
"
);
final
KeyStore
ks
=
KeyStore
.
getInstance(
"
JKS
"
);
ks
.
}
/**
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the server
* certificate and key in order to provide it to OpenSSL.
* <
p
>
* TODO: SNI is currently not supported, we use only the first found private key.
*/
private
static
SslContextBuilder
builderWithOpenSSLProvider
(
KeyStore
ks
,
props;
this
.
props
=
Objects
.
requireNonNull(
props
)
;
}
}
@Override
@Override
public
SSLContext
initSSLContext
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
"
Disconnect error
"
, mex);
}
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Authorizator
(authorizatorPolicy);
sessions
=
new
SessionRegistry
(subscriptions, queueRepository, authorizator);
dispatcher
=
new
PostOffice
(subscriptions, retainedRepository, sessions, interceptor, authorizator);
final
BrokerConfiguration
brokerConfig
=
new
BrokerConfiguration
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
}
private
void
processPubRel
(
MqttMessage
msg
) {
final
Session
session
=
sessionRegistry
.
retrieve(getClientId());
final
int
load(jksInputStream, keyStorePassword
.
toCharArray());
LOG
.
info(
"
Initializing key manager...
"
);
final
KeyManagerFactory
kmf
=
KeyManagerFactory
.
getInstance(
KeyManagerFactory
.
String
keyPassword
)
throws
GeneralSecurityException
{
for
(
String
alias
:
Collections
.
list(ks
.
aliases())) {
if
(ks
() {
public
SslContext
initSSLContext
() {
LOG
.
info(
"
Checking SSL configuration properties...
"
);
LOG
.
info(
"
Checking SSL configuration properties...
"
);
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Reduce log level for log messages caused by client side input mistakes (
Loading branch information
PHameete
and
Pieter Hameete
committed
Oct 9, 2020
Verified
This commit was created on GitHub.com and signed with a
verified signature
Issues · moquette-io/moquette · GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
(config);
MQTTConnectionFactory
connectionFactory
=
new
MQTTConnectionFactory
(brokerConfig, authenticator, sessions,
dispatcher);
final
NewNettyMQTTHandler
mqttHandler
=
new
NewNettyMQTTHandler
(connectionFactory);
acceptor
=
new
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Publish javadoc & sources of 0.13
#528
Open
hylkevds
opened this issue
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
messageID
=
((
MqttMessageIdVariableHeader
) msg
.
variableHeader())
.
messageId();
session
.
receivedPubRelQos2(messageID);
sendPubCompMessage(messageID);
}
void
sendPublish
(
MqttPublishMessage
getDefaultAlgorithm());
kmf
.
init(ks, keyManagerPassword
.
toCharArray());
TrustManager
[] trustManagers
=
null
;
if
(needsClientAuth) {
LOG
.
warn(
"
.
entryInstanceOf(alias,
KeyStore
.
PrivateKeyEntry
.
class)) {
PrivateKey
key
=
(
PrivateKey
) ks
.
getKey(alias, keyPassword
.
toCharArray());
Certificate
final
String
keyPassword
=
props
.
getProperty(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
);
if
(keyPassword
==
null
||
keyPassword
.
isEmpty()) {
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
8ba0b4d
commit
7b9db6eafd6b2beaf59184b91493360b16c5e97f
Unified
Split
Showing
1 changed file
with
5 additions
and
5 deletions
.
+5
−5
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
Type:
All
NewNettyAcceptor
();
acceptor
.
initialize(mqttHandler, config, sslCtxCreator);
final
long
startTime
=
System
.
currentTimeMillis()
-
start;
LOG
.
info(
"
Moquette integration has been started successfully in {} ms
May 13, 2020
· 0 comments
Open
Publish javadoc & sources of 0.13
#528
hylkevds
opened this issue
May 13, 2020
· 0 comments
Comments
Copy link
Quote reply
Contributor
hylkevds
commented
May 13, 2020
It seems something went wrong during the publication of 0.13 to the bintray repository. The sources jar is missing:
https://jcenter.bintray.com/io/moquette/moquette-broker/0.13/
publishMsg
) {
final
int
packetId
=
publishMsg
.
variableHeader()
.
packetId();
final
String
topicName
=
publishMsg
Client authentication is enabled.
"
+
"
The keystore will be used as a truststore. KeystorePath = {}.
"
,
jksPath);
//
use keystore as truststore, as server needs to trust certificates signed by the
//
server certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
[] chain
=
ks
.
getCertificateChain(alias);
X509Certificate
[] certChain
=
new
X509Certificate
[chain
.
length];
System
.
arraycopy(chain,
0
, certChain,
0
LOG
.
warn(
"
The key manager password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
try
{
SslProvider
sslProvider
=
getSSLProvider();
KeyStore
ks
Learn more
Accept
Reject
Save preferences
broker/src/main/java/io/moquette/broker/MQTTConnection.java
10
broker/src/main/java/io/moquette/broker/MQTTConnection.java
Show comments
View file
Edit file
Delete file
@@ -140,13 +140,13 @@ void processConnect(MqttConnectMessage msg) {
final
boolean
cleanSession
=
msg
.
variableHeader()
.
isCleanSession();
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Select type
All
Container
npm
RubyGems
Maven
Docker
NuGet
Visibility:
All
Select visibility
All
Private
Public
Sort by:
Most downloads
Select sort view
"
, startTime);
initialized
=
true
;
}
private
IAuthorizatorPolicy
initializeAuthorizatorPolicy
(
IAuthorizatorPolicy
authorizatorPolicy
,
IConfig
props
) {
LOG
Though I just noticed they are also missing for 0.12.
0.11 does have sources.
👍
1
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
.
variableHeader()
.
topicName();
final
String
clientId
=
getClientId();
MqttQoS
qos
=
publishMsg
.
fixedHeader()
.
qosLevel();
if
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.
init(ks);
trustManagers
=
tmf
.
getTrustManagers();
/**
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the server
* certificate and key in order to provide it to OpenSSL.
* <
, chain
.
length);
return
SslContextBuilder
.
forServer(key, certChain);
}
}
throw
new
KeyManagementException
(
"
the SSL key-store does not contain a private key
"
=
loadKeyStore();
SslContextBuilder
contextBuilder;
switch
(sslProvider) {
case
JDK
:
contextBuilder
=
builderWithJdkProvider(ks, keyPassword);
break
;
case
OPENSSL
:
case
OPENSSL_REFCNT
if
(clientId
==
null
||
clientId
.
length()
==
0
) {
if
(
!
brokerConfig
.
isAllowZeroByteClientId()) {
LOG
.
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Most downloads
Least downloads
Clear current search query, filters, and sorts
0 packages
No results matched your search.
Try
browsing all packages
to find what you're looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
.
debug(
"
Configuring MQTT authorizator policy
"
);
String
authorizatorClassName
=
props
.
getProperty(
BrokerConstants
.
AUTHORIZATOR_CLASS_NAME
,
"
"
);
Linked pull requests
Successfully merging a pull request may close this issue.
None yet
1 participant
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
(
LOG
.
isTraceEnabled()) {
LOG
.
trace(
"
"
, qos, packetId,
clientId, topicName,
DebugUtils
.
payload2Str(publishMsg
.
payload()));
}
else
p
>
* TODO: SNI is currently not supported, we use only the first found private key.
*/
private
static
SslContextBuilder
builderWithOpenSSLProvider
(
KeyStore
ks
,
String
keyPassword
)
throws
GeneralSecurityException
{
);
}
private
static
void
addClientAuthentication
(
KeyStore
ks
,
SslContextBuilder
contextBuilder
)
throws
NoSuchAlgorithmException
,
KeyStoreException
{
:
contextBuilder
=
builderWithOpenSSLProvider(ks, keyPassword);
break
;
default
:
LOG
.
error(
"
unsupported SSL provider {}
"
, sslProvider);
return
null
Issues · moquette-io/moquette · GitHub
warn
(
"
"
, username, channel);
LOG
.
info
(
"
"
, username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
Issues · moquette-io/moquette · GitHub
if
(authorizatorPolicy
==
null
&&
!
authorizatorClassName
.
isEmpty()) {
authorizatorPolicy
=
loadClass(authorizatorClassName,
IAuthorizatorPolicy
.
class,
IConfig
.
class, props);
}
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
{
LOG
.
debug(
"
"
, qos, packetId, clientId,
topicName);
}
sendIfWritableElseDrop(publishMsg);
}
void
sendIfWritableElseDrop
(
MqttMessage
msg
) {
for
(
String
alias
:
Collections
.
list(ks
.
aliases())) {
if
(ks
.
entryInstanceOf(alias,
KeyStore
.
PrivateKeyEntry
.
LOG
.
warn(
"
Client authentication is enabled. The keystore will be used as a truststore.
"
);
//
use keystore as truststore, as server needs to trust certificates signed by the server certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
Join GitHub · GitHub
;
}
//
if client authentification is enabled a trustmanager needs to be added to the ServerContext
String
sNeedsClientAuth
=
props
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
}
if
(
!
cleanSession) {
LOG
.
warn
(
"
"
,
LOG
.
info
(
"
"
Join GitHub · GitHub
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
if
(authorizatorPolicy
==
null
) {
String
aclFilePath
=
props
.
getProperty(
BrokerConstants
.
ACL_FILE_PROPERTY_NAME
,
"
Compare · moquette-io/moquette · GitHub
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
if
(
LOG
.
isDebugEnabled()) {
LOG
.
debug(
"
"
, msg
.
fixedHeader()
.
messageType(), channel);
}
if
(channel
class)) {
PrivateKey
key
=
(
PrivateKey
) ks
.
getKey(alias, keyPassword
.
toCharArray());
Certificate
[] chain
=
ks
.
getCertificateChain(alias);
X509Certificate
tmf
.
init(ks);
contextBuilder
.
clientAuth(
ClientAuth
.
REQUIRE
);
contextBuilder
.
trustManager(tmf);
}
private
SslProvider
getSSLProvider
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
if
(
Boolean
.
valueOf(sNeedsClientAuth)) {
addClientAuthentication(ks, contextBuilder);
}
contextBuilder
.
sslProvider(sslProvider);
SslContext
sslContext
=
contextBuilder
.
build();
LOG
Pull requests · moquette-io/moquette · GitHub
moquette/license.txt at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
,
username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
@@ -229,17 +229,17 @@ private boolean login(MqttConnectMessage msg, final String clientId) {
if
(msg
.
variableHeader()
.
hasPassword()) {
pwd
=
msg
.
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
Milestones
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
"
);
if
(aclFilePath
!=
null
&&
!
aclFilePath
.
isEmpty()) {
authorizatorPolicy
=
new
DenyAllAuthorizatorPolicy
();
try
{
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Packages · Moquette · GitHub
Join GitHub · GitHub
.
isWritable()) {
ChannelFuture
channelFuture;
if
(brokerConfig
.
isImmediateBufferFlush()) {
channelFuture
=
channel
.
writeAndFlush(msg);
}
else
{
channelFuture
[] certChain
=
new
X509Certificate
[chain
.
length];
System
.
arraycopy(chain,
0
, certChain,
0
, chain
.
length);
() {
String
providerName
=
props
.
getProperty(
BrokerConstants
.
SSL_PROVIDER
,
SslProvider
.
JDK
.
name());
try
{
GitHub - moquette-io/netty-mqtt5-codec: Netty codec implementation for MQTT3 and MQTT5
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
.
info(
"
The SSL context has been initialized successfully.
"
);
return
sslContext;
}
catch
(
GeneralSecurityException
|
IOException
ex) {
LOG
.
error(
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
People · Moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error
Security Advisories · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
LOG
.
info(
"
Parsing ACL file. Path = {}
"
, aclFilePath);
IResourceLoader
resourceLoader
=
props
.
getResourceLoader();
authorizatorPolicy
=
ACLFileParser
.
parse(resourceLoader
.
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Skip to content
moquette-io
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
=
channel
.
write(msg);
}
channelFuture
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
}
public
void
writabilityChanged
() {
if
(channel
return
SslContextBuilder
.
forServer(key, certChain);
}
//
init sslContext
LOG
.
info(
"
Initializing SSL context...
"
);
serverContext
.
init(kmf
.
getKeyManagers(), trustManagers,
return
SslProvider
.
valueOf(providerName);
}
catch
(
IllegalArgumentException
e) {
LOG
.
warn(
"
unknown SSL Provider {}, falling back on JDK provider
"
, providerName);
return
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
"
Unable to initialize SSL context.
"
, ex);
return
null
;
}
}
private
KeyStore
loadKeyStore
()
throws
IOException
,
GeneralSecurityException
{
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Skip to content
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
LOG
.
info
(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
return
false
;
}
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
loadResource(aclFilePath));
}
catch
(
ParseException
pex) {
LOG
.
error(
"
Unable to parse ACL file. path = {}
"
, aclFilePath, pex);
}
}
else
{
authorizatorPolicy
=
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
.
isWritable()) {
LOG
.
debug(
"
Channel {} is again writable
"
, channel);
final
Session
session
=
sessionRegistry
.
retrieve(getClientId());
session
null
);
LOG
.
info(
"
The SSL context has been initialized successfully.
"
);
}
throw
new
KeyManagementException
(
"
the SSL key-store does not contain a private key
"
SslProvider
.
JDK
;
}
}
private
InputStream
jksDatastore
(
String
jksPath
)
throws
FileNotFoundException
{
URL
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
final
String
jksPath
=
props
.
getProperty(
BrokerConstants
.
JKS_PATH_PROPERTY_NAME
);
final
String
jksPath
=
props
.
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
final
String
login
=
msg
.
payload()
.
userName();
if
(
!
authenticator
.
checkValid(clientId, login, pwd)) {
LOG
.
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
at least 15 characters
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
new
PermitAllAuthorizatorPolicy
();
}
LOG
.
info(
"
Authorizator policy {} instance will be used
"
, authorizatorPolicy
.
getClass()
.
getName());
}
return
authorizatorPolicy;
}
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
.
writabilityChanged();
}
}
void
sendPubAck
(
int
messageID
) {
LOG
.
trace(
"
sendPubAck invoked
"
);
);
}
return
serverContext;
}
catch
(
NoSuchAlgorithmException
|
UnrecoverableKeyException
|
CertificateException
|
KeyStoreException
|
KeyManagementException
|
IOException
ex) {
jksUrl
=
getClass()
.
getClassLoader()
.
getResource(jksPath);
if
(jksUrl
!=
null
) {
LOG
.
info(
"
"
, jksUrl
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
getProperty(
BrokerConstants
.
JKS_PATH_PROPERTY_NAME
);
LOG
.
info(
"
Initializing SSL context. KeystorePath = {}.
"
, jksPath);
LOG
.
info(
"
Initializing SSL context. KeystorePath = {}.
"
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
7
Milestones
5
Labels
7
error
(
"
"
, clientId, login);
LOG
.
info
(
"
"
, clientId, login);
return
false
;
}
NettyUtils
.
userName(channel, login);
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
👀
client can't reconnect to the broker once exception happened inner processSubscribe()
#388 opened
Feb 6, 2018
by
fjcyue
6
Add Ping Request handling to the interceptors
#481 opened
Jun 5, 2019
by
djbr-david
6
Potential Bug in NextPacketID
bug
#237 opened
Nov 29, 2016
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Pinned issues
MQTT durable subscription exception
#455 opened
Mar 8, 2019
by
OleksandrBerezianskyi
Open
1
Labels
private
IAuthenticator
initializeAuthenticator
(
IAuthenticator
authenticator
,
IConfig
props
) {
LOG
.
debug(
"
Configuring MQTT authenticator
"
);
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
Packages
People
Projects
There aren’t any packages here
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
at least 15 characters
moquette/brokerEmbeddedTest.groovy at db4349ba669ee4a216b6104382e4cf320f5a7864 · moquette-io/moquette · GitHub
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBACK
,
false
,
AT_MOST_ONCE
,
false
,
0
LOG
.
error(
"
"
,
ex
.
getCause(),
ex
.
getMessage());
return
null
;
private
static
void
.
toExternalForm(), jksUrl);
return
getClass()
.
getClassLoader()
.
getResourceAsStream(jksPath);
}
LOG
.
warn(
"
No keystore has been found in the bundled resources. Scanning filesystem...
"
);
File
jksFile
=
Bumped dev cycle 0.13 · moquette-io/moquette@db4349b · GitHub
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
netty-mqtt5-codec
Watch
3
Star
17
Fork
8
Netty codec implementation for MQTT3 and MQTT5
Pull requests · moquette-io/moquette · GitHub
Product
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
, jksPath);
if
(jksPath
==
null
||
jksPath
.
isEmpty()) {
if
(jksPath
==
null
||
jksPath
.
isEmpty()) {
//
key_store_password or key_manager_password are empty
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Jump to
↵
No suggested jump to results
Search
All GitHub
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Sign up
Moquette
Repositories
moquette/settings.gradle at master · moquette-io/moquette · GitHub
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
}
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error
(
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
LOG
.
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
Professional Services
Learning Lab
by
peacecoder
Memory grows infinitely when Qos set 2
#423 opened
Jul 10, 2018
by
zhengyangyong
3
Will Message lost if client reconnect before server clear the old connection
#366 opened
Oct 22, 2017
by
fjcyue
1
1
Mqtt websocket http
#538 opened
Oct 22, 2020
7
Milestones
5
Labels
7
Milestones
5
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
String
authenticatorClassName
=
props
.
getProperty(
BrokerConstants
.
AUTHENTICATOR_CLASS_NAME
,
"
"
);
if
(authenticator
==
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Compare changes
Compare changes across branches, commits, tags, and more below. If you need to, you can also
compare across forks
.
base repository:
moquette-io/moquette
Choose a Base Repository
moquette-io/moquette
19317362/moquette
908626950/moquette
With GitHub Packages you can safely publish and consume packages.
Learn more
about GitHub Packages
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Features
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
);
MqttPubAckMessage
pubAckMessage
=
new
MqttPubAckMessage
(fixedHeader, from(messageID));
sendIfWritableElseDrop(pubAckMessage);
}
private
void
sendPubCompMessage
(
int
messageID
) {
LOG
.
addClientAuthentication
(
KeyStore
ks
,
SslContextBuilder
contextBuilder
)
throws
NoSuchAlgorithmException
,
KeyStoreException
{
LOG
.
warn(
"
Client authentication is enabled. The keystore will be used as a truststore.
"
new
File
(jksPath);
if
(jksFile
.
exists()) {
LOG
.
info(
"
Loading external keystore. Url = {}.
"
, jksFile
.
getAbsolutePath());
return
new
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
moquette/license-eplv10-aslv20.html at master · moquette-io/moquette · GitHub
Apache-2.0 License
17
stars
8
forks
Star
Watch
Code
Issues
1
Pull requests
0
Actions
Projects
0
Security
Insights
More
moquette/moquette.sh at db4349ba669ee4a216b6104382e4cf320f5a7864 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
LOG
.
warn(
"
The keystore path is null or empty. The SSL context won't be initialized.
"
);
LOG
.
warn(
Fixes #456, update the H2 version · moquette-io/moquette@f3faee6 · GitHub
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Labels
7
Milestones
5
Packages
People
Projects
Organization permissions
Members
This organization has no public members.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
license.txt
Go to file
Go to file
T
Go to line
Clear current search query, filters, and sorts
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
info
(
"
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
return
false
;
}
return
true
;
Toggle all file notes
0 comments on commit
7b9db6e
Please
sign in
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
0
Insights
More
Code
Issues
Pull requests
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
by
strautins
1
Plans to support MQTT 5?
#490 opened
Jul 23, 2019
by
mpe85
6
Buffering settings to reduce latency
#527 opened
May 8, 2020
by
impliedx
1
checkHeaderAvailability don't check max remaininglength
#217 opened
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Clear current search query, filters, and sorts
63 Open
314 Closed
63 Open
314 Closed
Author
Filter by author
Label
Filter by label
Use
alt
null
&&
!
authenticatorClassName
.
isEmpty()) {
authenticator
=
loadClass(authenticatorClassName,
IAuthenticator
.
class,
IConfig
.
class, props);
}
IResourceLoader
resourceLoader
=
9612jhf/moquette
ASUSCloudIoT/moquette
Aviking88/moquette
CNXTEoEorg/moquette
Dev-Tony/moquette
GCPBigData/moquette
JamesLiAndroid/moquette
Jamesweng/moquette
LanKo-X/moquette
Lengbamboo/moquette
Matthew83/moquette
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
trace(
"
"
, channel, messageID);
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBCOMP
,
false
,
);
//
use keystore as truststore, as server needs to trust certificates signed by the server certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.
init(ks);
contextBuilder
.
clientAuth(
FileInputStream
(jksFile);
}
throw
new
FileNotFoundException
(
"
The keystore file does not exist. Url =
"
+
jksFile
.
getAbsolutePath());
}
}
Copy lines
moquette/build.gradle at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
moquette/test.gradle at 8f7b7df1240f569b5baa4feb0219b1936f66e062 · moquette-io/moquette · GitHub
moquette/moquette.bat at db4349ba669ee4a216b6104382e4cf320f5a7864 · moquette-io/moquette · GitHub
moquette/gradlew at master · moquette-io/moquette · GitHub
enable the usage of Netty OpenSSL provider implementation · moquette-io/moquette@d50a291 · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Code
Issues
Pull requests
Actions
Projects
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
1
branch
0
tags
Go to file
Code
Merge pull request #413 from infovista/netty_upgrade · moquette-io/moquette@0fae292 · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
"
The keystore path is null or empty. The SSL context won't be initialized.
"
);
return
null
;
return
null
;
}
}
//
if we have the port also the jks then keyStorePassword and keyManagerPassword
//
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Labels
7
Milestones
5
New pull request
New
Clear current search query, filters, and sorts
11 Open
149 Closed
11 Open
149 Closed
Author
Filter by author
Label
Filter by label
Use
alt
Added QueueRepository implemented in memory and on H2 · moquette-io/moquette@c4d928b · GitHub
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
L
Copy path
Cannot retrieve contributors at this time
205 lines (170 sloc)
11.3 KB
Raw
Blame
Copyright 2012-2013 (c) Andrea Selva
Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/
TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
1. Definitions.
"License" shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.
"Licensor" shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Actions
Projects
Wiki
Security
Insights
Overview
Security policy
Security advisories
0
Overview
Security policy
Security advisories
0
Security Advisories
View information about security vulnerabilities from this repository's maintainers.
0 Published
There aren’t any published security advisories
© 2020 GitHub, Inc.
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Oct 12, 2016
by
beyondfengyu
1
New configuration parameter : setting the HandshakeTimeout on SslHandler
#531 opened
Jul 23, 2020
by
dsoulayrol
Authorizator based on client Certificate information
#328 opened
Jun 15, 2017
by
edenmob
1
Broker does not reject connections with clientId longer than 23 characters for MQTT v3.1
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Assignee
Filter by who’s assigned
Sort
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
props
.
getResourceLoader();
if
(authenticator
==
null
) {
String
passwdPath
=
props
.
getProperty(
BrokerConstants
.
PASSWORD_FILE_PROPERTY_NAME
,
"
"
MehdiFal/moquette
MihoYamato/moquette
ShangarDeviNatarajan/moquette-1
SyedOsman33/moquette
VincentCaow/moquette
Wangab/moquette
WayChungChen/moquette
WeWebsterchen/moquette
WilliamKinaan/moquette
Wizzercn/moquette
XiaolinYi/moquette
YouAreAGeologist/moquette
YoungWalker/moquette
ZerroCool/moquette
activexJ/moquette
alex-mengx/moquette
alick2011/moquette
altair-albert/moquette
andsel/moquette
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Support
Help
Community Forum
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
AT_MOST_ONCE
,
false
,
0
);
MqttMessage
pubCompMessage
=
new
MqttMessage
(fixedHeader, from(messageID));
sendIfWritableElseDrop(pubCompMessage);
}
String
getClientId
() {
ClientAuth
.
REQUIRE
);
contextBuilder
.
trustManager(tmf);
}
private
SslProvider
getSSLProvider
() {
String
providerName
=
props
.
getProperty(
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
moquette/BenchmarkSubscriber.java at 8e17e99428bdae8f7a7fd5c52ad1f4520229ec84 · moquette-io/moquette · GitHub
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Fixed mqtt-bee dependency · moquette-io/moquette@8e17e99 · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Clone
HTTPS
GitHub CLI
Use Git or checkout with SVN using the web URL.
Work fast with our official CLI.
Learn more
.
Open with GitHub Desktop
Download ZIP
Launching GitHub Desktop
If nothing happens,
download GitHub Desktop
and try again.
Go back
Launching GitHub Desktop
If nothing happens,
download GitHub Desktop
and try again.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
has to be defined
final
String
keyStorePassword
=
props
.
getProperty(
BrokerConstants
.
KEY_STORE_PASSWORD_PROPERTY_NAME
);
final
String
keyStorePassword
=
props
.
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Build tools update. · moquette-io/moquette@7267264 · GitHub
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Reviews
Filter by reviews
No reviews
Review required
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Added copyright and license notice to every source file, added about.… · moquette-io/moquette@666cc29 · GitHub
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
"Legal Entity" shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
control with that entity. For the purposes of this definition,
"control" means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.
"You" (or "Your") shall mean an individual or Legal Entity
exercising permissions granted by this License.
"Source" form shall mean the preferred form for making modifications,
including but not limited to software source code, documentation
source, and configuration files.
"Object" form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
not limited to compiled object code, generated documentation,
and conversions to other media types.
"Work" shall mean the work of authorship, whether in Source or
Object form, made available under the License, as indicated by a
🚀
👀
Server API to get subscriptions information
feature req
#207 opened
Sep 14, 2016
by
teranisi
3
Publish javadoc & sources of 0.13
#528 opened
May 13, 2020
by
hylkevds
New configuration parameter : setting the HandshakeTimeout on SslHandler
#531 opened
Jul 23, 2020
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
#522 opened
Mar 31, 2020
by
mjacoby
Embedding example throws java.lang.UnsupportedOperationException: direct buffer
#534 opened
Sep 16, 2020
by
micw
Error processing protocol message: PUBACK
#483 opened
Jun 13, 2019
by
Demitrius
Significant (>90%) message loss under heavy load
#480 opened
Jun 5, 2019
👍
👎
😄
🎉
😕
❤️
🚀
👀
[FR]Moquette clusters
feature req
#131 opened
Dec 11, 2015
by
pabloa
0.9
19
How to forcefully disconnect the client from the broker?
);
if
(passwdPath
.
isEmpty()) {
authenticator
=
new
AcceptAllAuthenticator
();
}
else
{
authenticator
=
new
ResourceAuthenticator
(resourceLoader, passwdPath);
aploese/moquette
apqit/moquette
archive-j/moquette
ashengwang/moquette
banyue/moquette
bazi/moquette
bcw104/moquette
beckhamcm/moquette
bekirozgunlu/moquette
bemisguided/moquette
bhaecke/moquette
biddyweb/moquette
bingogh/moquette
bingzhuyou/moquette
blackadmin/moquette
briancarbs/moquette
butaji/moquette
LinkedIn
GitHub
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
return
NettyUtils
.
clientID(channel);
}
String
getUsername
() {
return
NettyUtils
.
userName(channel);
}
public
void
sendPublishRetainedQos0
(
Topic
BrokerConstants
.
SSL_PROVIDER
,
SslProvider
.
JDK
.
name());
try
{
return
SslProvider
.
valueOf(providerName);
}
catch
(
IllegalArgumentException
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
moquette/build.gradle at db4349ba669ee4a216b6104382e4cf320f5a7864 · moquette-io/moquette · GitHub
Removed perf module to be move in separate project, and disabled leak… · moquette-io/moquette@8f7b7df · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Go back
Launching Xcode
If nothing happens,
download Xcode
and try again.
Go back
Launching Visual Studio
If nothing happens,
download the GitHub extension for Visual Studio
and try again.
Go back
Latest commit
Git stats
2
commits
Files
Permalink
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
getProperty(
BrokerConstants
.
KEY_STORE_PASSWORD_PROPERTY_NAME
);
final
String
keyManagerPassword
=
props
.
getProperty(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
);
if
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Fixed checkStyle and ErrorProne warns · moquette-io/moquette@033a428 · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).
"Derivative Works" shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.
"Contribution" shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
or by an individual or Legal Entity authorized to submit on behalf of
the copyright owner. For the purposes of this definition, "submitted"
by
dsoulayrol
Authorizator based on client Certificate information
#328 opened
Jun 15, 2017
by
edenmob
1
Significant (>90%) message loss under heavy load
#480 opened
Jun 5, 2019
by
flonix8
2
InterceptAcknowledgedMessage.StoredMessage is inaccessible
#444 opened
Jan 14, 2019
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
by
flonix8
2
In BytesMetrics wroteBytes always return 0
#425 opened
Jul 27, 2018
by
mjpatelsls
1
java.lang.ClassCastException: io.netty.handler.codec.http.HttpObjectAggregator$AggregatedFullHttpRequest cannot be cast to io.moquette.parser.proto.messages.AbstractMessage
#290 opened
Mar 23, 2017
by
leesangboo
7
ConcurrentModificationException while stress testing
invalid
#469 opened
Apr 8, 2019
by
giri110890
9
java.lang.ClassCastException: io.netty.handler.codec.http.HttpObjectAggregator$AggregatedFullHttpRequest cannot be cast to io.moquette.parser.proto.messages.AbstractMessage
#290 opened
Mar 23, 2017
by
leesangboo
7
republishing messages fails....
bug
#234 opened
Nov 17, 2016
by
windbender
}
LOG
.
info(
"
An {} authenticator instance will be used
"
, authenticator
.
getClass()
.
getName());
}
return
authenticator;
}
private
ccf19881030/moquette
cheng04119/moquette
chengc017/moquette
chord1645/moquette
christopheblin/moquette
cimhealth/moquette
cm8421/moquette
coalba/moquette
cpacey/moquette
crooods/moquette
ctfree/moquette
cuidonghuan/moquette
dant3/moquette
daququ/moquette
daveztong/moquette
dc198798/moquette
ddyywu/moquette
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
topic
,
MqttQoS
qos
,
ByteBuf
payload
) {
MqttPublishMessage
publishMsg
=
retainedPublish(topic
.
toString(), qos, payload);
sendPublish(publishMsg);
}
public
void
e) {
LOG
.
warn(
"
unknown SSL Provider {}, falling back on JDK provider
"
, providerName);
return
SslProvider
.
JDK
;
}
}
@@ -124,7 +182,6 @@ private InputStream jksDatastore(String jksPath) throws FileNotFoundException {
LOG
.
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Failed to load latest commit information.
Type
Name
Latest commit message
Commit time
src
LICENSE
README.md
pom.xml
View code
README.md
netty-mqtt5-codec
Netty codec implementation for MQTT3 and MQTT5
About
Netty codec implementation for MQTT3 and MQTT5
Resources
Readme
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
(keyStorePassword
==
null
||
keyStorePassword
.
isEmpty()) {
if
(keyStorePassword
==
null
||
keyStorePassword
.
isEmpty()) {
//
key_store_password or key_manager_password are empty
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Clean test storage on exit to prevent assert in next test
#497 opened
Aug 16, 2019
by
qbast
Java 11 compatibility
#498 opened
Aug 17, 2019
by
qbast
fixed throw NullPointerException when new connection
#519 opened
Mar 2, 2020
by
luoliangtiger
one get
#520 opened
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
means any form of electronic, verbal, or written communication sent
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
designated in writing by the copyright owner as "Not a Contribution."
"Contributor" shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
subsequently incorporated within the Work.
2. Grant of Copyright License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
Work and such Derivative Works in Source or Object form.
3. Grant of Patent License. Subject to the terms and conditions of
by
austinw-fineart
0.13
3
distribute
#458 opened
Mar 18, 2019
by
dqqzj
7
Question: disconnecting a client when authentication details removed
#516 opened
Jan 23, 2020
by
MattyyttaM
Add Ping Request handling to the interceptors
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
#427 opened
Aug 9, 2018
by
rakechan
2
BrokerInterceptor thread pool never closing on serverStop
#506 opened
Oct 9, 2019
by
bobrowskim
license is missing in artifact
#492 opened
Jul 30, 2019
by
ascheman
Subscription breaks during performance test
#505 opened
7
distribute
#458 opened
Mar 18, 2019
by
dqqzj
7
Add Ping Request handling to the interceptors
#481 opened
Jun 5, 2019
by
djbr-david
6
Plans to support MQTT 5?
#490 opened
Jul 23, 2019
by
void
initInterceptors
(
IConfig
props
,
List<? extends
InterceptHandler
>
embeddedObservers
) {
LOG
.
info(
"
Configuring message interceptors...
"
);
dininen/moquette
dlanza1/kafka-mqtt-gateway
donaldlee2008/moquette
edd1225/moquette
extramoney/moquette
fchrist/moquette
frankzqy/moquette
gauravisworking/moquette
gavinljj/moquette
gui0778/moquette
guii/moquette
gujx/moquette
gunaones/moquette
guohongjun/moquette
heqingfei/moquette
himeshagile/moquette
hippocampi/moquette
horryq/moquette
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
db4349ba66
moquette
/
tools_scripts
sendPublishRetainedWithPacketId
(
Topic
topic
,
MqttQoS
qos
,
ByteBuf
payload
) {
final
int
packetId
=
nextPacketId();
MqttPublishMessage
publishMsg
info(
"
Loading external keystore. Url = {}.
"
, jksFile
.
getAbsolutePath());
return
new
FileInputStream
(jksFile);
}
LOG
.
warn(
"
The keystore file does not exist. Url = {}.
"
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Bumped dev cycle 0.13
Loading branch information
andsel
committed
Mar 17, 2019
1 parent
f3faee6
commit
db4349ba669ee4a216b6104382e4cf320f5a7864
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
License
Apache-2.0 License
Releases
No releases published
Packages
0
No packages published
Languages
Java
100.0%
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Labels
7
LOG
.
warn(
"
The keystore password is null or empty. The SSL context won't be initialized.
"
);
LOG
.
warn(
"
The keystore password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
return
null
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Mar 4, 2020
by
luoliangtiger
Bugfix/stop broker interceptor
#530 opened
May 26, 2020
by
Northram511
Fixes #529, #505: NPE caused by matching on a TNode
#532 opened
Aug 13, 2020
by
hylkevds
1
Make the number of Netty worker threads number configurable
#468 opened
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.
4. Redistribution. You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You
meet the following conditions:
#481 opened
Jun 5, 2019
by
djbr-david
6
Memory grows infinitely when Qos set 2
#423 opened
Jul 10, 2018
by
zhengyangyong
3
Will Message lost if client reconnect before server clear the old connection
#366 opened
Oct 22, 2017
by
fjcyue
1
1
Oct 4, 2019
by
JinseonyLee
1
MQTT SSL not working
#499 opened
Aug 20, 2019
by
francesco98
1
Netty Leak Detection.
#467 opened
Apr 4, 2019
by
kopens
1
Exception: java.lang.NoClassDefFoundError: org/mapdb/DBMaker
mpe85
6
client can't reconnect to the broker once exception happened inner processSubscribe()
#388 opened
Feb 6, 2018
by
fjcyue
6
Retained message with QoS 0
#125 opened
Nov 11, 2015
by
env3d
5
Bridging to a cloud broker [Microsoft Azure -- IOT Hub] ?
#513 opened
List<
InterceptHandler
>
observers
=
new
ArrayList<>
(embeddedObservers);
String
interceptorClassName
=
props
.
getProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
);
if
huilvhui/moquette
hurtonm/moquette
hvinayan/moquette
igorsilvamenezes/moquette
inexplicable/moquette
iodb/moquette
jimmy486/moquette
jincieryi/moquette
jiudong90/moquette
jkandasa/moquette
jun0813/moquette
jwoolston/moquette
kansifang/moquette
kevto/moquette
kjayashankar/moquette
/
integration
/
brokerEmbeddedTest.groovy
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
16 lines (14 sloc)
677 Bytes
Raw
Blame
@GrabResolver
(
=
retainedPublishWithMessageId(topic
.
toString(), qos, payload, packetId);
sendPublish(publishMsg);
}
private
static
MqttPublishMessage
retainedPublish
(
String
topic
,
MqttQoS
qos
,
ByteBuf
, jksFile
.
getAbsolutePath());
return
null
;
throw
new
FileNotFoundException
(
"
The keystore file does not exist. Url =
"
+
jksFile
.
getAbsolutePath());
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Unified
Split
Showing
5 changed files
with
6 additions
and
6 deletions
.
+1
−1
broker/src/main/java/io/moquette/broker/Server.java
+2
−2
build.gradle
+1
−1
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
license-eplv10-aslv20.html
Go to file
Go to file
T
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
db4349ba66
moquette
/
distribution
/
src
/
main
Milestones
5
Labels
7
Milestones
5
New pull request
New
Clear current search query, filters, and sorts
11 Open
149 Closed
11 Open
149 Closed
Author
Filter by author
Label
Filter by label
Use
;
}
}
if
(keyManagerPassword
==
null
||
keyManagerPassword
.
isEmpty()) {
String
ksType
=
props
Insights
Permalink
Browse files
Loading status checks…
Fixes
#456
, update the H2 version
Loading branch information
andsel
committed
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Apr 8, 2019
by
komamitsu
1
Fix java 11+ build and tests
#533 opened
Aug 14, 2020
by
hylkevds
1
fix trie match bug and bytesMetrics bug
#479 opened
Jun 2, 2019
by
ilylia
4
Authentication changes
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
master
moquette
/
settings.gradle
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
8 lines (7 sloc)
364 Bytes
Raw
Blame
rootProject
(a) You must give any other recipients of the Work or
Derivative Works a copy of this License; and
(b) You must cause any modified files to carry prominent notices
stating that You changed the files; and
(c) You must retain, in the Source form of any Derivative Works
that You distribute, all copyright, patent, trademark, and
attribution notices from the Source form of the Work,
excluding those notices that do not pertain to any part of
the Derivative Works; and
(d) If the Work includes a "NOTICE" text file as part of its
distribution, then any Derivative Works that You distribute must
include a readable copy of the attribution notices contained
within such NOTICE file, excluding those notices that do not
pertain to any part of the Derivative Works, in at least one
of the following places: within a NOTICE text file distributed
as part of the Derivative Works; within the Source form or
Mqtt websocket http
#538 opened
Oct 22, 2020
by
strautins
1
Plans to support MQTT 5?
#490 opened
Jul 23, 2019
by
mpe85
6
Buffering settings to reduce latency
#527 opened
May 8, 2020
by
impliedx
#248 opened
Jan 5, 2017
by
ThomasSchemmer
3
Repeating receiving non clear session messages.
bug
#197 opened
Aug 11, 2016
by
stayclean
1
Previous
1
2
3
Next
Jan 17, 2020
by
carlsberg-stack
5
Allow for multiple server side clients to share a topic with queue behavior...
feature req
#158 opened
Mar 4, 2016
by
redboy1972
4
NullPointerException in CTrie.evaluate
#529 opened
May 13, 2020
by
hylkevds
1
3
(interceptorClassName
!=
null
&&
!
interceptorClassName
.
isEmpty()) {
InterceptHandler
handler
=
loadClass(interceptorClassName,
InterceptHandler
.
class,
io.moquette.broker
.
Server
.
kmhughes/moquette
knayekihtrak/moquette
konradmichael/moquette
koolob/moquette
laizhouzhang/moquette
lance1232001/moquette
lanma/moquette
lants1/moquette
lbfalcons/moquette
leftshiftone/moquette
liheeng/moquette
lijian17/moquette
liuyanjunbj/moquette
lizhanhui/moquette
lovecc0923/moquette
maggu2810/moquette
mahmed8003/moquette
name
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
'
io.moquette
message
) {
return
retainedPublishWithMessageId(topic, qos, message,
0
);
}
private
static
MqttPublishMessage
retainedPublishWithMessageId
(
String
topic
,
MqttQoS
qos
,
ByteBuf
}
}
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
d50a291
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
build.gradle
Go to file
Go to file
T
Go to line
L
Copy path
distribution/src/main/scripts/moquette.bat
+1
−1
distribution/src/main/scripts/moquette.sh
+1
−1
tools_scripts/integration/brokerEmbeddedTest.groovy
2
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -55,7 +55,7 @@
public
static
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
8f7b7df124
moquette
/
gradle
/
test.gradle
Go to file
Go to file
T
Go to line
L
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
db4349ba66
moquette
/
distribution
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
gradlew
Go to file
Go to file
T
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
enable the usage of Netty OpenSSL provider implementation
Loading branch information
mscheibler
committed
Jun 22, 2018
1 parent
0fae292
commit
d50a291366f1b5a16011266dbf770c020d241eee
Unified
Split
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Go to line
L
Copy path
Cannot retrieve contributors at this time
576 lines (508 sloc)
29.3 KB
Raw
Blame
<
html
xmlns:o
="
urn:schemas-microsoft-com:office:office
"
xmlns:w
="
urn:schemas-microsoft-com:office:word
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Merge pull request
#413
from infovista/netty_upgrade
Loading branch information
/
scripts
/
moquette.sh
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
97 lines (78 sloc)
3.66 KB
Raw
Blame
#!
/bin/sh
#
alt
+
click/return
to exclude labels.
Projects
Filter by project
Milestones
Filter by milestone
Reviews
Filter by reviews
No reviews
Review required
Approved review
Changes requested
Assignee
Filter by who’s assigned
Sort
.
getProperty(
BrokerConstants
.
KEY_STORE_TYPE
,
"
jks
"
);
//
key_manager_password or key_manager_password are empty
final
KeyStore
keyStore
=
KeyStore
Mar 17, 2019
1 parent
c248096
commit
f3faee6fbe29400a4852e5925cecb370ad2380db
Unified
Split
Showing
1 changed file
with
2 additions
and
2 deletions
.
+2
−2
broker/build.gradle
4
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
#507 opened
Oct 11, 2019
by
ndchandar
2
Fix a bug Session#resendInflightNotAcked() fails due to handling a freed ByteBuf
#464 opened
Mar 31, 2019
by
komamitsu
4
ProTip!
Type
g
i
on any issue or pull request to go back to the issue listing page.
© 2020 GitHub, Inc.
Terms
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Added QueueRepository implemented in memory and on H2
Loading branch information
andsel
committed
Nov 22, 2018
1 parent
1141e9f
commit
c4d928bbd71e34dd22690edc054aa528bf618cbf
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
.
name
=
'
moquette-parent
'
include
'
:moquette-broker
'
include
'
:moquette-distribution
'
include
'
:moquette-embedded-test
'
project(
documentation, if provided along with the Derivative Works; or,
within a display generated by the Derivative Works, if and
wherever such third-party notices normally appear. The contents
of the NOTICE file are for informational purposes only and
do not modify the License. You may add Your own attribution
notices within Derivative Works that You distribute, alongside
or as an addendum to the NOTICE text from the Work, provided
that such additional attribution notices cannot be construed
as modifying the License.
You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
for any such Derivative Works as a whole, provided Your use,
reproduction, and distribution of the Work otherwise complies with
the conditions stated in this License.
5. Submission of Contributions. Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
1
checkHeaderAvailability don't check max remaininglength
#217 opened
Oct 12, 2016
by
beyondfengyu
1
Broker does not reject connections with clientId longer than 23 characters for MQTT v3.1
#522 opened
Mar 31, 2020
by
mjacoby
Embedding example throws java.lang.UnsupportedOperationException: direct buffer
#534 opened
Sep 16, 2020
by
micw
Previous
Next
ProTip!
Updated in the last three days:
updated:>2020-10-19
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
failed to allocate 16777216 byte(s) of direct memory
#466 opened
Apr 4, 2019
by
FengXMGeek
3
NullPointerException.I think is a bug
#473 opened
Apr 22, 2019
by
liuhanjim
3
Exception: java.lang.NoClassDefFoundError: org/mapdb/DBMaker
#248 opened
Jan 5, 2017
by
ThomasSchemmer
class,
this
);
if
(handler
!=
null
) {
observers
.
add(handler);
}
}
interceptor
=
new
BrokerInterceptor
(props, observers);
}
mahui1980/moquette
mapengfei00099/moquette
mgurevin/moquette
mindis/moquette
mingj/moquette
mkretzschmar/moquette
mojunneng/moquette
mpaatz/moquette
muka/moquette
myqhit/moquette
narry/moquette
nathantippy/moquette
nickman/moquette
nuspy/moquette
okse-3/moquette
oldshipmaster/moquette
oomhj/moquette
pamod/moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.13-SNAPSHOT
'
)
import
io.moquette.server.Server
println
"
message
,
int
messageId
) {
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBLISH
,
false
, qos,
true
,
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Cannot retrieve contributors at this time
117 lines (100 sloc)
3.09 KB
Raw
Blame
allprojects
{
apply
plugin
:
'
maven
'
apply
plugin
:
'
void
main
(
String
[]
args
)
throws
IOException
{
final
Server
server
=
new
Server
();
server
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Copy path
Cannot retrieve contributors at this time
63 lines (52 sloc)
1.78 KB
Raw
Blame
test
{
def
outputReporter
=
new
OutputReporter
()
addTestListener(outputReporter)
addTestOutputListener(outputReporter)
}
class
/
src
/
main
/
scripts
/
moquette.bat
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
88 lines (73 sloc)
3.79 KB
Raw
Go to line
L
Copy path
Cannot retrieve contributors at this time
executable file
172 lines (151 sloc)
5.17 KB
Raw
Blame
#!
/usr/bin/env sh
#
#############################################################################
#
#
#
# Gradle start up script for UN*X
Showing
8 changed files
with
241 additions
and
96 deletions
.
+1
−0
.gitignore
+1
−0
broker/build.gradle
+9
−0
broker/src/main/java/io/moquette/BrokerConstants.java
+116
−59
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
8e17e99428
moquette
/
perf
/
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Fixed mqtt-bee dependency
Loading branch information
andsel
committed
Nov 10, 2018
1 parent
284417e
commit
8e17e99428bdae8f7a7fd5c52ad1f4520229ec84
"
xmlns
="
http://www.w3.org/TR/REC-html40
"
>
<
head
>
<
meta
http-equiv
="
Content-Type
"
content
="
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
andsel
committed
Jun 20, 2018
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
2 parents
e824a22
+
63e27c2
commit
0fae29294608dc71a73b230d06642f0a7c5537c5
Unified
#
Copyright (c) 2012-2015 Andrea Selva
#
echo
"
"
echo
"
___ ___ _ _ ___ ________ _____ _____
"
echo
"
| \/ | | | | | | \/ | _ |_ _|_ _|
"
echo
"
| . . | ___ __ _ _ _ ___| |_| |_ ___ | . . | | | | | | | |
"
Sort by
Newest
Oldest
Most commented
Least commented
Recently updated
Least recently updated
Most reactions
👍
👎
😄
🎉
😕
❤️
🚀
👀
Reduce log level for log messages caused by client side input mistakes
#537 by
.
getInstance(ksType);
LOG
.
warn(
"
The key manager password is null or empty. The SSL context won't be initialized.
"
);
LOG
.
info(
"
Loading keystore. KeystorePath = {}.
"
, jksPath);
return
null
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ dependencies {
compile
group
:
'
io.netty
'
,
name
:
'
netty-transport-native-epoll
'
,
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Build tools update.
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Unified
Split
Showing
22 changed files
with
89 additions
and
214 deletions
.
+1
−1
broker/build.gradle
+8
−0
broker/src/main/java/io/moquette/broker/IQueueRepository.java
+12
−0
broker/src/main/java/io/moquette/broker/MemoryQueueRepository.java
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Added copyright and license notice to every source file, added about.…
Loading branch information
andsel
committed
'
:moquette-broker
'
)
.
projectDir
=
"
$r
ootDir
/broker
"
as
File
project(
'
:moquette-distribution
'
)
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.
6. Trademarks. This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
origin of the Work and reproducing the content of the NOTICE file.
7. Disclaimer of Warranty. Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
Contributor provides its Contributions) on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
Error processing protocol message: PUBACK
#483 opened
Jun 13, 2019
by
Demitrius
In BytesMetrics wroteBytes always return 0
#425 opened
Jul 27, 2018
by
mjpatelsls
1
java.lang.ClassCastException: io.netty.handler.codec.http.HttpObjectAggregator$AggregatedFullHttpRequest cannot be cast to io.moquette.parser.proto.messages.AbstractMessage
#290 opened
Mar 23, 2017
by
leesangboo
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
3
The server throws an exception when the message is received
#406 opened
Jun 4, 2018
by
ma-yadong
3
Server API to get subscriptions information
feature req
#207 opened
Sep 14, 2016
by
teranisi
3
Avoid OutOfMemory error
feature req
#141 opened
Jan 17, 2016
@SuppressWarnings
(
"
unchecked
"
)
private
<
T
,
U
>
T
loadClass
(
String
className
,
Class<
parksangkil/moquette
pillimede/moquette
plechi/moquette
popeye0807/moquette
qchen006/moquette
qiuzhanghua/moquette
quyf/moquette
redboy1972/moquette
redlion99/moquette
redsolo/moquette
robbyb67/moquette
robgratz/moquette
rubberbird/moquette
runafter/moquette
saeedhadi/moquette
salmanebah/moquette
sangkyunyoon/moquette
Starting broker in embedded mode
"
Server
server
=
new
Server
()
//
Properties props = [port: 1883, host: "0.0.0.0", 'password_file': '../broker/config/password_file.conf'] as Properties
Properties
props
=
new
Properties
()
props
.
setProperty(
0
);
MqttPublishVariableHeader
varHeader
=
new
MqttPublishVariableHeader
(topic, messageId);
return
new
MqttPublishMessage
(fixedHeader, varHeader, message);
}
//
TODO move this method in Session
void
sendPublishNotRetainedQos0
(
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
maven-publish
'
group
=
'
io.moquette
'
version
=
'
0.13-SNAPSHOT
'
}
buildscript
{
repositories {
maven {
url
"
https://plugins.gradle.org/m2/
.
startServer();
System
.
out
.
println(
"
Server started, version 0.
12.1
"
);
System
.
out
.
println(
"
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
db4349ba66
moquette
/
build.gradle
Go to file
Go to file
T
Go to line
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Removed perf module to be move in separate project, and disabled leak…
Loading branch information
andsel
committed
Nov 11, 2018
1 parent
OutputReporter
implements
TestListener
,
TestOutputListener
{
private
StringBuilder
stdout
=
new
StringBuilder
()
private
StringBuilder
stderr
=
new
Blame
@
ECHO
OFF
rem
#
rem
# Copyright (c) 2012-2015 Andrea Selva
rem
#
echo
"
"
echo
"
___ ___ _ _ ___ ________ _____ _____
"
echo
#
#
#
#############################################################################
#
Attempt to set APP_HOME
#
Resolve links: $0 may be a link
PRG=
"
$0
"
#
Need this for relative symlinks.
while
[
-h
"
broker/src/main/java/io/moquette/server/DefaultMoquetteSslContextCreator.java
+50
−34
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
+2
−2
broker/src/main/java/io/moquette/spi/security/ISslContextCreator.java
+60
−0
broker/src/test/java/io/moquette/server/ServerIntegrationOpenSSLTest.java
+2
−1
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
1
.gitignore
src
/
main
/
java
/
io
/
moquette
/
parser
/
netty
/
performance
/
BenchmarkSubscriber.java
/
Unified
Split
Showing
2 changed files
with
3 additions
and
3 deletions
.
+2
−2
broker/src/test/resources/log4j.properties
+1
−1
perf/build.gradle
4
broker/src/test/resources/log4j.properties
text/html; charset=windows-1252
"
>
<
meta
name
="
ProgId
"
content
="
Word.Document
"
>
<
meta
name
="
Split
Showing
4 changed files
with
4 additions
and
3 deletions
.
+1
−0
.gitignore
+1
−1
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
+1
−1
broker/src/test/java/io/moquette/testclient/Client.java
+1
echo
"
| |\/| |/ _ \ / _\ | | | |/ _ \ __| __/ _ \ | |\/| | | | | | | | |
"
echo
"
| | | | (_) | (_| | |_| | __/ |_| || __/ | | | \ \/' / | | | |
"
echo
"
\_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/
"
echo
"
| |
"
echo
"
PHameete
was merged
Oct 9, 2020
1
5
Minor, changed header
#536 by
andsel
was merged
Oct 1, 2020
Bumped release 0.13
#523 by
andsel
was merged
Apr 11, 2020
Upgrade build, OSGi metadata
#504 by
;
try
(
InputStream
jksInputStream
=
jksDatastore(jksPath)) {
keyStore
.
load(jksInputStream, keyStorePassword
.
toCharArray());
}
}
return
keyStore;
}
//
version
: nettyVersion,
classifier
:
'
linux-x86_64
'
//
compile
group
:
'
com.h2database
'
,
name
:
Loading branch information
AndreasMager
committed
Mar 12, 2018
1 parent
2fb475a
commit
7267264503b8926699bb00c855b35bd31f95c5e8
Unified
Split
Showing
6 changed files
with
30 additions
and
31 deletions
.
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Fixed checkStyle and ErrorProne warns
Loading branch information
andsel
committed
+6
−3
broker/src/main/java/io/moquette/broker/Server.java
+1
−3
broker/src/main/java/io/moquette/broker/Session.java
+7
−6
broker/src/main/java/io/moquette/broker/SessionRegistry.java
+5
−0
broker/src/main/java/io/moquette/persistence/H2Builder.java
Jun 11, 2014
1 parent
0bbe719
commit
666cc29d47f57fc00798856e335e5270c0075a10
Unified
Split
Showing
133 changed files
with
2,569 additions
.
projectDir
=
"
$r
ootDir
/distribution
"
as
File
project(
'
:moquette-embedded-test
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.
8. Limitation of Liability. In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
negligent acts) or agreed to in writing, shall any Contributor be
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.
9. Accepting Warranty or Additional Liability. While redistributing
the Work or Derivative Works thereof, You may choose to offer,
7
ConcurrentModificationException while stress testing
invalid
#427 opened
Aug 9, 2018
by
rakechan
2
BrokerInterceptor thread pool never closing on serverStop
#506 opened
Oct 9, 2019
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
by
andsel
0.9
3
InterceptAcknowledgedMessage.StoredMessage is inaccessible
#444 opened
Jan 14, 2019
by
austinw-fineart
0.13
3
Memory grows infinitely when Qos set 2
#423 opened
Jul 10, 2018
by
zhengyangyong
3
T
>
intrface
,
Class<
U
>
constructorArgClass
,
U
props
) {
T
instance
=
null
;
try
{
sayi21cn/moquette
sboorlagadda/moquette
senspace/moquette
seraya-fan/moquette
sgano1/moquette
sixtop/moquette
slacrey/moquette
soenter/moquette
soken-su/moquette
sonecabr/moquette
sonson1023/moquette
splade/moquette
stannislin/moquette
sumyfly/moquette
superdjz/moquette
superposition/moquette
sureddy/moquette
'
port
'
,
'
1883
'
)
props
.
setProperty(
'
host
'
,
"
0.0.0.0
"
)
Topic
topic
,
MqttQoS
qos
,
ByteBuf
payload
) {
MqttPublishMessage
publishMsg
=
notRetainedPublish(topic
.
toString(), qos, payload);
sendPublish(publishMsg);
}
Save preferences
"
}
}
dependencies {
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.13
'
classpath
'
gradle.plugin.com.github.spotbugs:gradlePlugin:1.6.0
'
classpath
'
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
'
Server started, version 0.
13-SNAPSHOT
"
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
(server
::
stopServer));
}
L
Copy path
Cannot retrieve contributors at this time
117 lines (100 sloc)
3.09 KB
Raw
Blame
allprojects
{
apply
plugin
:
'
maven
'
apply
plugin
:
8e17e99
commit
8f7b7df1240f569b5baa4feb0219b1936f66e062
Unified
Split
Showing
15 changed files
with
12 additions
and
1,476 deletions
.
+12
−11
gradle/test.gradle
+0
−17
perf/build.gradle
StringBuilder
()
@Override
void
beforeSuite
(
TestDescriptor
suite
) {
}
@Override
void
afterSuite
(
TestDescriptor
suite
,
TestResult
"
| \/ | | | | | | \/ | _ |_ _|_ _|
"
echo
"
| . . | ___ __ _ _ _ ___| |_| |_ ___ | . . | | | | | | | |
"
echo
"
| |\/| |/ _ \ / _\ | | | |/ _ \ __| __/ _ \ | |\/| | | | | | | | |
"
echo
"
| | | | (_) | (_| | |_| | __/ |_| || __/ | | | \ \/' / | | | |
"
echo
"
\_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/
$PRG
"
]
;
do
ls=
`
ls -ld
"
$PRG
"
`
link=
`
expr
"
$ls
"
Show comments
View file
Edit file
Delete file
@@ -25,6 +25,7 @@ broker/runner
.settings
/
.project
.classpath
/
*
/
bin
/
*
.swp
*
.class
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
169 lines (145 sloc)
6.23 KB
Raw
Blame
/*
Show comments
View file
Edit file
Delete file
@@ -1,7 +1,7 @@
log4j.rootLogger
=
ERROR, stdout, file
log4j.logger.io.moquette
=
DEBUG
log4j.logger.io.moquette.broker
=
DEBUG
log4j.logger.io.moquette
=
WARN
log4j.logger.io.moquette.broker
Generator
"
content
="
Microsoft Word 9
"
>
<
meta
name
="
Originator
"
content
="
Microsoft Word 9
"
>
<
−1
build.gradle
1
.gitignore
Show comments
View file
Edit file
Delete file
@@ -45,3 +45,4 @@ broker/nbactions-Server.xml
maven-metadata.xml
/
.gradle
/
/
bin
/
2
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
|_|
"
echo
"
"
echo
"
version: 0..13-SNAPSHOT
"
cd
"
$(
dirname
"
$0
"
)
"
J-N-K
was closed
Aug 31, 2019
Fix retained messages with wildcard subscriptions
#489 by
davesters
was merged
Jul 21, 2019
2
Merge pull request #1 from moquette-io/master
#486 by
djbr-david
was closed
Jul 2, 2019
1
remove unnecessary quotes which fixes execution in windows 10
#478 by
if client authentification is enabled a trustmanager needs to be
private
static
SslContextBuilder
builderWithJdkProvider
(
KeyStore
ks
,
String
keyPassword
)
//
added to the ServerContext
throws
GeneralSecurityException
{
String
'
h2-mvstore
'
,
version
:
'
1.4.
196
'
compile
group
:
'
com.h2database
'
,
+4
−7
build.gradle
+8
−7
gradle/lint.gradle
BIN
gradle/wrapper/gradle-wrapper.jar
+1
−2
gradle/wrapper/gradle-wrapper.properties
+17
−9
gradlew
+0
−6
gradlew.bat
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Apr 26, 2018
1 parent
1a6dd8a
commit
033a428184ce1e8a134fda082c04346ac6858c61
Unified
Split
Showing
81 changed files
with
681 additions
and
425 deletions
.
+3
−1
broker/src/main/java/io/moquette/interception/HazelcastInterceptHandler.java
+2
−1
...io/moquette/persistence/h2 → broker/src/main/java/io/moquette/persistence}/H2PersistentQueue.java
+25
−0
broker/src/main/java/io/moquette/persistence/H2QueueRepository.java
+3
−1
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
+3
−1
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
+3
−2
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
+3
and
13 deletions
.
+28
−0
about.html
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMatchingCondition.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMessaging.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IPersistentSubscriptionStore.java
+15
−0
'
)
.
projectDir
=
"
$r
ootDir
/embedding_moquette
"
as
File
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.
END OF TERMS AND CONDITIONS
APPENDIX: How to apply the Apache License to your work.
To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets "[]"
replaced with your own identifying information. (Don't include
the brackets!) The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
file or class name and description of purpose be included on the
same "printed page" as the copyright notice for easier
by
bobrowskim
MQTT SSL not working
#499 opened
Aug 20, 2019
by
francesco98
1
Netty Leak Detection.
#467 opened
Apr 4, 2019
by
kopens
1
Repeating receiving non clear session messages.
bug
#197 opened
Aug 11, 2016
Save preferences
Significant (>90%) message loss under heavy load
#480 opened
Jun 5, 2019
by
flonix8
2
ConcurrentModificationException while stress testing
invalid
#427 opened
Aug 9, 2018
by
rakechan
2
Authentication interface should return Optional< Principal>
feature req
#176 opened
//
check if constructor with constructor arg class parameter
//
exists
LOG
.
info(
"
"
,
constructorArgClass
.
getName(), className, intrface
.
getName());
instance
=
this
surpass/moquette
swarwick/moquette
systembugtj/moquette
tanapop/moquette
tangxunye/moquette
technocreatives/moquette
teco-kit/moquette-lusagent
tennessine/moquette
teranisi/moquette
thangdc94/moquette
thinkjoyorg/moquette
tigersshi/moquette
timvanginderen/moquette
ttomato/moquette
uwitec/moquette
wanghaipeng789/moquette
watergit2016/moquette
wendersonferreira/moquette
props
.
setProperty(
'
password_file
'
,
'
../broker/config/password_file.conf
'
)
println
"
starting proprs
$p
static
MqttPublishMessage
notRetainedPublish
(
String
topic
,
MqttQoS
qos
,
ByteBuf
message
) {
return
notRetainedPublishWithMessageId(topic, qos, message,
0
);
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
'
}
}
subprojects
{
repositories {
mavenLocal()
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
}
4
build.gradle
Show comments
View file
Edit file
Delete file
@@ -3,7 +3,7 @@ allprojects {
apply
plugin
:
'
maven-publish
'
group
=
'
io.moquette
'
maven-publish
'
group
=
'
io.moquette
'
version
=
'
0.13-SNAPSHOT
'
}
buildscript
{
repositories {
maven {
+0
−150
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
+0
−169
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
+0
−210
perf/src/main/java/io/moquette/parser/netty/performance/LoopMQTTHandler.java
+0
−94
perf/src/main/java/io/moquette/parser/netty/performance/NettyPublishReceiverHandler.java
+0
−187
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolDecodingServer.java
+0
result
) {
}
@Override
void
beforeTest
(
TestDescriptor
testDescriptor
) {
if
(
!
testDescriptor
.
isComposite()) {
stdout
"
echo
"
| |
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.13-SNAPSHOT
"
set
"
CURRENT_DIR
:
'
.*-> \(.*\)$
'
`
if
expr
"
$link
"
:
'
/.*
'
>
/dev/null
;
then
1
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -34,4 +34,5 @@ dependencies {
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.parser.netty.performance
;
=
WARN
#
log4j.logger.io.moquette.broker=WARN
#
Storage service
2
perf/build.gradle
Show comments
View file
Edit file
Delete file
@@ -13,5 +13,5 @@ dependencies {
compile
group
:
'
link
rel
="
File-List
"
href
="
http://www.eclipse.org/legal/Eclipse%20EPL%202003_11_10%20Final_files/filelist.xml
"
>
<
title
>
Eclipse Public License - Version 1.0 / Apache License - Version 2.0
</
title
>
<!--[if gte mso 9]><xml>
Show comments
View file
Edit file
Delete file
@@ -97,7 +97,7 @@ private static MqttConnectMessage createConnectMessage(String clientID, int keep
MqttConnectVariableHeader
mqttConnectVariableHeader
=
new
MqttConnectVariableHeader
(
MqttVersion
.
MQTT_3_1
.
protocolName(),
MqttVersion
.
#
resolve links - $0 may be a softlink
PRG=
"
$0
"
while
[
-h
"
$PRG
"
]
;
do
ls=
`
ls -ld
"
joestr
was merged
May 21, 2019
1
Update Freedomotic references
#475 by
mcicolella
was merged
May 2, 2019
2
Added possibility to configure additional Netty channel handlers
#462 by
aemaem
was closed
Apr 5, 2019
7
sNeedsClientAuth
=
props
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
LOG
.
info(
"
Initializing key manager...
name
:
'
h2-mvstore
'
,
version
:
'
1.4.
199
'
compile
group
:
'
com.zaxxer
'
11
build.gradle
Show comments
View file
Edit file
Delete file
@@ -12,7 +12,8 @@ buildscript {
}
}
dependencies {
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.8
'
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.13
+4
−2
broker/src/main/java/io/moquette/interception/messages/InterceptConnectMessage.java
+1
−1
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
+1
−2
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
+7
−3
broker/src/main/java/io/moquette/server/ConnectionDescriptor.java
+3
−1
broker/src/main/java/io/moquette/server/config/ClasspathResourceLoader.java
+5
−8
−2
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
+3
−1
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
+3
−1
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
+3
−1
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
+1
−1
...oquette/persistence/h2 → broker/src/test/java/io/moquette/persistence}/H2PersistentQueueTest.java
+0
−2
distribution/build.gradle
+0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/DebugUtils.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticator.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/MemoryStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessor.java
+15
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
identification within third-party archives.
Copyright [yyyy] [name of copyright owner]
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
by
stayclean
1
Previous
1
2
3
Next
Previous
Next
ProTip!
What’s not been updated in a month:
updated:<2020-09-22
.
© 2020 GitHub, Inc.
Terms
Privacy
May 6, 2016
by
windbender
2
cannot make a distinction between bad user and not authorized when connect
#359 opened
Sep 5, 2017
by
rongwei84n
2
Moquette shows topics, but subscribers won't receive anything - Subscription missing?
#510 opened
Dec 18, 2019
by
beniroquai
1
Previous
1
.
getClass()
.
getClassLoader()
.loadClass(className)
.asSubclass(intrface)
.getConstructor(constructorArgClass)
.newInstance(props);
}
catch
(
InstantiationException
|
IllegalAccessException
|
ClassNotFoundException
ex) {
LOG
willenwu21/moquette
windbender/moquette
xintao222/moquette
xuchao/moquette
yangpeiyong/moquette
yanxuxiao/moquette
yunemr/moquette
zhangxiaofeng123/moquette
zhoudianyou/moquette
zhuyuming/moquette
zofuthan/moquette
zorowonder/moquette
zyy/moquette
Nothing to show
base:
master
head repository:
rops
"
server
.
startServer(props)
println
"
Stopping broker..
"
server
.
stopServer()
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
}
static
MqttPublishMessage
notRetainedPublishWithMessageId
(
String
topic
,
MqttQoS
qos
,
ByteBuf
message
,
int
messageId
) {
MqttFixedHeader
maven { url
"
https://repo.maven.apache.org/maven2
"
}
}
apply
from
:
new
File
(rootDir,
'
gradle/java.gradle
'
)
apply
from
'
version
=
'
0.
12.1
'
version
=
'
0.
13-SNAPSHOT
'
}
buildscript
{
@@ -92,7 +92,7 @@ subprojects {
from components
url
"
https://plugins.gradle.org/m2/
"
}
}
dependencies {
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.13
'
classpath
'
gradle.plugin.com.github.spotbugs:gradlePlugin:1.6.0
'
classpath
'
−123
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolPublishDecodingServer.java
+0
−108
perf/src/main/java/io/moquette/parser/netty/performance/PublishBomber.java
+0
−81
perf/src/main/java/io/moquette/parser/netty/performance/PublishReceiverHandler.java
+0
−100
perf/src/main/java/io/moquette/performance/clients/mqttbee/BeeBenchmarker.java
+0
−56
perf/src/main/java/io/moquette/performance/clients/paho/PahoBenchmarker.java
+0
.
setLength(
0
)
stderr
.
setLength(
0
)
}
}
@Override
void
=
%cd%
"
if
not
"
%MOQUETTE_HOME%
"
==
"
"
PRG=
"
$link
"
else
PRG=
`
dirname
"
$PRG
"
`
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
import
org.HdrHistogram.Histogram
;
import
org.eclipse.paho.client.mqttv3.*
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
org.hdrhistogram
'
,
name
:
'
HdrHistogram
'
,
version
<o:DocumentProperties>
<o:Revision>2</o:Revision>
<o:TotalTime>3</o:TotalTime>
<o:Created>2004-03-05T23:03:00Z</o:Created>
<o:LastSaved>2004-03-05T23:03:00Z</o:LastSaved>
<o:Pages>4</o:Pages>
<o:Words>1626</o:Words>
<o:Characters>9270</o:Characters>
<o:Lines>77</o:Lines>
<o:Paragraphs>18</o:Paragraphs>
<o:CharactersWithSpaces>11384</o:CharactersWithSpaces>
<o:Version>9.4402</o:Version>
MQTT_3_1
.
protocolLevel(),
false
,
false
,
false
,
1
,
$PRG
"
`
link=
`
expr
"
$ls
"
:
Extended websocket configuration
#461 by
aemaem
was merged
Apr 2, 2019
Refactors config implementation: Use java.util.Properties directly now
#459 by
flonix8
was closed
Jun 3, 2019
8
"
);
boolean
needsClientAuth
=
Boolean
.
valueOf(sNeedsClientAuth);
final
KeyManagerFactory
,
name
:
'
HikariCP
'
,
version
:
'
2.4.7
'
classpath
'
gradle.plugin.com.github.spotbugs:gradlePlugin:1.6.0
'
classpath
'
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
broker/src/main/java/io/moquette/server/config/ConfigurationParser.java
+7
−2
broker/src/main/java/io/moquette/server/config/FileResourceLoader.java
+3
−1
broker/src/main/java/io/moquette/server/netty/MoquetteIdleTimeoutHandler.java
+6
−2
−9
h2_storage/build.gradle
+0
−58
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
+0
−119
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+0
−2
settings.gradle
2
broker/build.gradle
Show comments
View file
Edit file
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/SimpleMessaging.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ValueEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/DisconnectEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/InitEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/LostConnectionEvent.java
+15
−0
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
2
3
Next
Previous
Next
ProTip!
Exclude everything labeled
bug
with
-label:bug
.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
.
warn(
"
"
+
"
errorMessage={}
"
, constructorArgClass
.
getName(), className, intrface
.
getName(), ex
.
getCause(),
ex
.
getMessage());
return
moquette-io/moquette
Choose a Head Repository
moquette-io/moquette
19317362/moquette
908626950/moquette
9612jhf/moquette
ASUSCloudIoT/moquette
Aviking88/moquette
CNXTEoEorg/moquette
Dev-Tony/moquette
GCPBigData/moquette
JamesLiAndroid/moquette
Jamesweng/moquette
LanKo-X/moquette
Lengbamboo/moquette
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBLISH
,
false
, qos,
false
,
0
);
MqttPublishVariableHeader
varHeader
=
new
MqttPublishVariableHeader
:
new
File
(rootDir,
'
gradle/test.gradle
'
)
apply
from
:
new
File
(rootDir,
'
gradle/lint.gradle
'
)
apply
.
java
groupId
"
$p
roject
.
group
"
artifactId
"
${
project.name
}
"
version
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
'
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
'
}
}
subprojects
{
−63
perf/src/main/java/io/moquette/performance/clients/paho/SubscriberCallback.java
+0
−104
perf/src/main/java/io/moquette/spi/impl/subscriptions/PerformanceTest.java
+0
−3
settings.gradle
23
gradle/test.gradle
Show comments
View file
afterTest
(
TestDescriptor
testDescriptor
goto
gotHome
set
"
MOQUETTE_HOME
=
%CURRENT_DIR%
"
if
exist
"
%MOQUETTE_HOME%
\bin\moquette.bat
"
goto
"
/
$link
"
fi
done
SAVED=
"
`
pwd
`
"
cd
"
`
dirname
\"
$PRG
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
1.4.191
'
testRuntime
group
:
import
java.util.concurrent.CountDownLatch
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
class
BenchmarkSubscriber
{
private
static
final
Logger
LOG
=
LoggerFactory
.
:
'
2.1.2
'
compile
group
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
</o:DocumentProperties>
</xml><![endif]-->
<!--[if gte mso 9]><xml>
<w:WordDocument>
<w:TrackRevisions/>
</w:WordDocument>
</xml><![endif]-->
<
style
>
<!
-
-
/* Font Definitions */
@font-face
{
false
,
true
, keepAlive);
MqttConnectPayload
mqttConnectPayload
=
new
MqttConnectPayload
(clientID,
null
,
null
,
null
,
null
);
MqttConnectPayload
'
.*-> \(.*\)$
'
`
if
expr
"
$link
"
:
'
/.*
'
>
/dev/null
;
then
PRG=
Flush written data in MQTTConnection#sendIfWritableElseDrop
#454 by
komamitsu
was merged
Mar 17, 2019
19
Enhanced exception handling / logging for invalid messages
#450 by
mscheibler
was merged
Jan 28, 2019
1
#449 by
SpeckiJ
was closed
Feb 10, 2019
1
kmf
=
KeyManagerFactory
.
getInstance(
KeyManagerFactory
.
getDefaultAlgorithm());
kmf
.
init(ks, keyPassword
.
toCharArray());
LOG
.
info(
"
Initializing SSL context...
'
@@ -33,7 +33,7 @@ dependencies {
testCompile
group
:
'
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
'
,
version
:
'
'
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
'
}
@@ -25,18 +26,14 @@ subprojects {
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
}
maven { url
"
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
+8
−6
broker/src/main/java/io/moquette/server/netty/NettyMQTTHandler.java
+3
−1
broker/src/main/java/io/moquette/server/netty/metrics/BytesMetricsHandler.java
+2
−1
broker/src/main/java/io/moquette/server/netty/metrics/MQTTMessageLogger.java
+3
−1
broker/src/main/java/io/moquette/server/netty/metrics/MessageMetricsHandler.java
+0
−16
broker/src/main/java/io/moquette/spi/DurableSession.java
+16
Delete file
@@ -33,7 +33,7 @@ dependencies {
testCompile
group
:
'
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
'
,
version
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/MessagingEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/OutputMessagingEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/ProtocolEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PubAckEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PublishEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/RepublishEvent.java
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
null
;
}
catch
(
NoSuchMethodException
|
InvocationTargetException
e) {
try
{
LOG
.
info(
"
"
, className, intrface
.
Matthew83/moquette
MehdiFal/moquette
MihoYamato/moquette
ShangarDeviNatarajan/moquette-1
SyedOsman33/moquette
VincentCaow/moquette
Wangab/moquette
WayChungChen/moquette
WeWebsterchen/moquette
WilliamKinaan/moquette
Wizzercn/moquette
XiaolinYi/moquette
YouAreAGeologist/moquette
YoungWalker/moquette
ZerroCool/moquette
activexJ/moquette
alex-mengx/moquette
alick2011/moquette
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
(topic, messageId);
return
new
MqttPublishMessage
(fixedHeader, varHeader, message);
}
public
void
resendNotAckedPublishes
() {
final
Session
session
=
sessionRegistry
.
retrieve(getClientId());
session
plugin
:
'
com.jfrog.bintray
'
apply
plugin
:
'
eclipse
'
ext {
nettyVersion
=
'
4.1.22.Final
'
0.
12.1
'
version
'
0.
13-SNAPSHOT
'
}
}
}
2
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
repositories {
mavenLocal()
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
}
maven { url
"
https://repo.maven.apache.org/maven2
"
}
Edit file
Delete file
@@ -6,8 +6,8 @@ test {
class
OutputReporter
implements
TestListener
,
TestOutputListener
{
class
OutputReporter
implements
TestListener
,
TestOutputListener
{
private
,
TestResult
result
) {
if
(
!
testDescriptor
.
isComposite()
&&
result
.
getResultType()
==
TestResult.ResultType
.
FAILURE
) {
okHome
cd
..
set
"
MOQUETTE_HOME
=
%cd%
"
cd
"
%CURRENT_DIR%
"
:
gotHome
if
exist
"
\"
`
/
"
>
/dev/null
APP_HOME=
"
`
pwd -P
`
"
cd
"
$SAVED
"
>
/dev/null
APP_NAME=
'
io.netty
'
,
name
:
'
netty-tcnative
'
,
version
:
'
2.0.10.Final
'
,
classifier
:
'
getLogger(
BenchmarkSubscriber
.
class);
class
SubscriberCallback
implements
MqttCallback
{
@Override
public
void
messageArrived
(
String
topic
,
MqttMessage
message
'
1.2.0
'
compile
group
:
'
org.eclipse.jetty.toolchain
'
,
name
:
'
jetty-perf-helper
'
,
version
:
'
font-family
:Tahoma;
panose-1
:
2
11
6
4
3
5
4
4
2
4
;
mso-font-charset
:
0
;
mqttConnectPayload
=
new
MqttConnectPayload
(clientID,
(
String
)
null
,
(
byte
[])
null
,
(
String
)
null
"
$link
"
else
PRG=
`
dirname
"
$PRG
"
`
/
"
$link
"
fi
done
#
Get standard environment variables
DenyAllAuthorizatorPolicy should return false; dispatch connection&disconnection&connectionLost event to interceptor
#445 by
zhangliangbo
was closed
Jan 20, 2019
2
LoggerFactory.getLogger: Wrong logging class
#432 by
davidgraeff
was closed
Dec 1, 2018
3
Fixes NPE when client disconnects from the broker
#431 by
jcroig
was closed
Dec 1, 2018
1
"
);
return
SslContextBuilder
.
forServer(kmf);
}
try
{
/**
LOG
.
info(
"
Loading keystore. KeystorePath = {}.
"
, jksPath);
* The OpenSSL provider does not support the {
@link
1.12
'
testCompile
group
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.2.0
http
://repo.maven.apache.org/maven2
"
}
maven { url
"
https
://repo.maven.apache.org/maven2
"
}
}
apply
from
:
new
File
(rootDir,
'
gradle/java.gradle
−0
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
+32
−0
broker/src/main/java/io/moquette/spi/InboundFlightZone.java
+2
−2
broker/src/main/java/io/moquette/spi/TransientSession.java
+3
−1
broker/src/main/java/io/moquette/spi/impl/DebugUtils.java
+6
−4
broker/src/main/java/io/moquette/spi/impl/MessagesPublisher.java
+4
−4
:
'
1.12
'
testCompile
group
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/StopEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/SubscribeEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/storage/StoredPublishEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/Subscription.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/SubscriptionsStore.java
+15
−0
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
getName());
//
fallback to default constructor
instance
=
this
.
getClass()
.
getClassLoader()
.loadClass(className)
.asSubclass(intrface)
.getDeclaredConstructor()
.
newInstance();
}
catch
(
InstantiationException
altair-albert/moquette
andsel/moquette
aploese/moquette
apqit/moquette
archive-j/moquette
ashengwang/moquette
banyue/moquette
bazi/moquette
bcw104/moquette
beckhamcm/moquette
bekirozgunlu/moquette
bemisguided/moquette
bhaecke/moquette
biddyweb/moquette
bingogh/moquette
bingzhuyou/moquette
blackadmin/moquette
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
resendInflightNotAcked();
}
int
nextPacketId
() {
return
lastPacketId
.
incrementAndGet();
}
@Override
public
String
toString
() {
return
'
}
task packageTests(
type
:
Jar
) {
from sourceSets
.
test
.
output
from sourceSets
.
test
.
allSource
from sourceSets
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.
12.1
}
apply
from
:
new
File
(rootDir,
'
gradle/java.gradle
'
)
apply
from
:
new
File
(rootDir,
StringBuilder
stdout
=
new
StringBuilder
()
;
private
StringBuilder
stdout
=
new
StringBuilder
()
private
if
(stdout
.
length()
!=
0
) {
println
"
"
println
"
--- STDOUT ---
"
print
stdout
println
"
%MOQUETTE_HOME%
\bin\moquette.bat
"
goto
okHome
echo
The MOQUETTE_HOME environment variable is not defined correctly
echo
This environment variable is needed to run this program
goto
end
:
okHome
rem
Set JavaHome if it exists
if
exist
{
"
Gradle
"
APP_BASE_NAME=
`
basename
"
$0
"
`
#
Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
DEFAULT_JVM_OPTS=
"
"
#
Use the maximum available, or set MAX_FD != -1 to use that value.
linux-x86_64
'
}
9
broker/src/main/java/io/moquette/BrokerConstants.java
Show comments
View file
Edit file
Delete file
@@ -32,8 +32,17 @@
+
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
;
public
static
final
)
throws
Exception
{
//
used to catch the first message published
if
(
!
alreadyStarted) {
startTime
=
System
.
currentTimeMillis();
alreadyStarted
=
true
;
1.0.5
'
compile(
group
:
'
org.mqttbee
'
,
name
:
'
mqtt-bee
'
,
version
:
'
mso-generic-font-family
:swiss;
mso-font-pitch
:variable;
mso-font-signature
:
553679495
-2147483648
8
0
66047
0
;}
/* Style Definitions */
p
.
MsoNormal
,
,
(
byte
[])
null
);
return
new
MqttConnectMessage
(mqttFixedHeader, mqttConnectVariableHeader, mqttConnectPayload);
}
2
broker/src/test/java/io/moquette/testclient/Client.java
Show comments
View file
Edit file
Delete file
PRGDIR=
`
dirname
"
$PRG
"
`
#
Only set MOQUETTE_HOME if not already set
[
-f
"
$MOQUETTE_HOME
"
/bin/moquette.sh ]
||
MOQUETTE_HOME=
`
cd
Update MQTTMessageLogger.java
#428 by
ricardojlrufino
was merged
Aug 11, 2018
1
Adds client remote address getter to ConnectionDescriptor class.
#422 by
jcroig
was merged
Jul 19, 2018
1
Fixed executor not shutting down.
#421 by
hylkevds
was merged
Jul 19, 2018
Refactor metrics management
KeyManagerFactory}, so we have to lookup the server
InputStream
jksInputStream
=
jksDatastore(jksPath);
* certificate and key in order to provide it to OpenSSL.
SSLContext
serverContext
=
SSLContext
.
getInstance(
"
TLS
"
);
* <
p
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
'
)
apply
from
:
new
File
(rootDir,
'
gradle/test.gradle
'
)
apply
from
:
new
File
(rootDir,
broker/src/main/java/io/moquette/spi/impl/PersistentQueueMessageSender.java
+46
−71
broker/src/main/java/io/moquette/spi/impl/ProtocolProcessor.java
+8
−6
broker/src/main/java/io/moquette/spi/impl/ProtocolProcessorBootstrapper.java
+48
−0
broker/src/main/java/io/moquette/spi/impl/RunningSubscription.java
+3
−1
broker/src/main/java/io/moquette/spi/impl/SessionsRepository.java
+12
−4
broker/src/main/java/io/moquette/spi/impl/security/ACLFileParser.java
+1
1.2.0
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/Token.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/TreeNode.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ConfigurationParser.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ConnectionDescriptor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/Constants.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/IAuthenticator.java
Accept
Reject
Save preferences
|
IllegalAccessException
|
ClassNotFoundException
|
NoSuchMethodException
|
InvocationTargetException
ex) {
LOG
.
error(
"
"
+
"
errorMessage={}
"
, className, intrface
briancarbs/moquette
butaji/moquette
ccf19881030/moquette
cheng04119/moquette
chengc017/moquette
chord1645/moquette
christopheblin/moquette
cimhealth/moquette
cm8421/moquette
coalba/moquette
cpacey/moquette
crooods/moquette
ctfree/moquette
cuidonghuan/moquette
dant3/moquette
daququ/moquette
daveztong/moquette
"
MQTTConnection{channel=
"
+
channel
+
"
, connected=
"
+
connected
+
'
}
'
;
}
InetSocketAddress
remoteAddress
.
test
.
resources
classifier
=
'
tests
'
}
task javadocJar (
type
:
Jar
,
dependsOn
: javadoc) {
"
echo
"
version: 0.
13-SNAPSHOT
"
set
"
CURRENT_DIR
=
%cd%
"
if
not
"
%MOQUETTE_HOME%
"
==
"
'
gradle/test.gradle
'
)
apply
from
:
new
File
(rootDir,
'
gradle/lint.gradle
'
)
apply
plugin
:
'
StringBuilder
stderr
=
new
StringBuilder
()
;
private
StringBuilder
stderr
=
new
StringBuilder
()
@Override
@Override
void
--- STDOUT ---
"
}
if
(stderr
.
length()
!=
0
) {
println
"
"
println
"
--- STDERR ---
"
println
stderr
"
%JAVA_HOME%
\bin\java
"
} (
set
"
JAVA
=
"
%JAVA_HOME%
\bin\java
"
)
echo
Using JAVA_HOME:
MAX_FD=
"
maximum
"
warn
() {
echo
"
$*
"
}
die
() {
echo
echo
"
$*
"
echo
String
WEB_SOCKET_PORT_PROPERTY_NAME
=
"
websocket_port
"
;
public
static
final
String
WSS_PORT_PROPERTY_NAME
=
"
secure_websocket_port
"
;
/**
* Defines the SSL implementation to use, default to "JDK".
}
//
if
(topic
.
startsWith(
"
/exit
"
)) {
LOG
.
info(
"
SUB: ok Exit!
"
);
LOG
1.0.0-
SNAPSHOT
'
)
compile(
group
:
'
org.mqttbee
'
,
name
:
'
mqtt-bee
li
.
MsoNormal
,
div
.
MsoNormal
{
mso-style-parent
:
""
;
margin
:
0
in
;
@@ -109,7 +109,7 @@ public void connect(String willTestamentTopic, String willTestamentMsg) {
MqttConnectPayload
mqttConnectPayload
=
new
MqttConnectPayload
(
this
.
clientId,
willTestamentTopic,
willTestamentMsg,
willTestamentMsg
.
getBytes()
,
null
,
"
$PRGDIR
/..
"
;
pwd
`
export
MOQUETTE_HOME
#
Set JavaHome if it exists
if
[
-f
"
/bin/java
"
]
;
#419 by
sbouchex
was closed
Jul 19, 2018
1
Fixed NPE while logging an unknown packet (Replaced with an IOException)
#417 by
sbouchex
was merged
Jun 28, 2018
1
Fix issue #412, Zero-length topic messages accepting
#416 by
hiro-gh27
was closed
Jun 28, 2018
2
enable the usage of Netty OpenSSL provider implementation and PKCS12 key stores
>
final
KeyStore
ks
=
KeyStore
.
getInstance(
"
JKS
"
);
* TODO: SNI is currently not supported, we use only the first found private key.
ks
.
load(jksInputStream, keyStorePassword
.
toCharArray());
*/
testCompile
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
1.4.
196
'
gradle/lint.gradle
'
)
apply
plugin
:
'
com.jfrog.bintray
'
apply
plugin
:
'
eclipse
'
apply
plugin
−0
broker/src/main/java/io/moquette/spi/impl/security/AcceptAllAuthenticator.java
+10
−8
broker/src/main/java/io/moquette/spi/impl/subscriptions/CNode.java
+10
−75
broker/src/main/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectory.java
+67
−0
broker/src/main/java/io/moquette/spi/impl/subscriptions/DumpTreeVisitor.java
+33
−0
broker/src/main/java/io/moquette/spi/impl/subscriptions/SubscriptionCounterVisitor.java
+2
−2
broker/src/main/java/io/moquette/spi/impl/subscriptions/Token.java
'
testCompile
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/Server.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ServerAcceptor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ServerChannel.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/MoquetteIdleTimoutHandler.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyAcceptor.java
+15
−0
.
getName(), ex
.
getCause(), ex
.
getMessage());
return
null
;
}
}
return
instance;
}
/**
* Use the broker to publish a message. It's intended for embedding applications. It can be used
* only after the integration is correctly started with startServer.
*
dc198798/moquette
ddyywu/moquette
dininen/moquette
dlanza1/kafka-mqtt-gateway
donaldlee2008/moquette
edd1225/moquette
extramoney/moquette
fchrist/moquette
frankzqy/moquette
gauravisworking/moquette
gavinljj/moquette
gui0778/moquette
guii/moquette
gujx/moquette
gunaones/moquette
() {
return
(
InetSocketAddress
) channel
.
remoteAddress();
}
public
void
readCompleted
() {
classifier
=
'
javadoc
'
from javadoc
.
destinationDir
}
task sourceJar (
"
goto
gotHome
2
distribution/src/main/scripts/moquette.sh
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@ echo " \_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/ "
echo
"
| |
com.jfrog.bintray
'
apply
plugin
:
'
eclipse
'
ext {
nettyVersion
=
'
beforeSuite
(
TestDescriptor
suite
) {
void
beforeSuite
(
TestDescriptor
suite
) {
@@ -22,8 +22,8 @@ class OutputReporter implements TestListener, TestOutputListener {
@Override
@Override
void
beforeTest
(
TestDescriptor
println
"
--- STDERR ---
"
}
}
}
@Override
void
onOutput
(
TestDescriptor
testDescriptor
,
TestOutputEvent
outputEvent
) {
if
(
"
%JAVA_HOME%
"
echo
Using MOQUETTE_HOME:
"
%MOQUETTE_HOME%
"
rem
set LOG_CONSOLE_LEVEL=info
rem
set LOG_FILE_LEVEL=fine
set
JAVA_OPTS
=
set
JAVA_OPTS_SCRIPT
exit
1
}
#
OS specific support (must be 'true' or 'false').
cygwin=false
msys=false
darwin=false
nonstop=false
case
"
`
uname
`
"
in
CYGWIN
*
*
@see
io.netty.handler.ssl.SslProvider#name()
*/
public
static
final
String
SSL_PROVIDER
=
"
ssl_provider
"
;
public
static
final
String
SSL_PORT_PROPERTY_NAME
.
debug(
"
Before disconnect
"
);
//
client.disconnect(1000) //wait max 1 sec
//
client.disconnectForcibly()
//
client.close()
LOG
.
debug(
"
After disconnect
"
'
,
version
:
'
mqtt-bee-
1.0.0-
20181105.094934-4
'
)
}
Toggle all file notes
0 comments on commit
8e17e99
Please
sign in
to comment.
© 2020 GitHub, Inc.
margin-bottom
:
.0001
pt
;
mso-pagination
:widow-orphan;
font-size
:
12.0
pt
;
font-family
:
"Times New Roman"
;
mso-fareast-font-family
:
null
);
MqttConnectMessage
connectMessage
=
new
MqttConnectMessage
(
2
build.gradle
Show comments
View file
Edit file
Delete file
@@ -37,7 +37,7 @@ subprojects {
apply
plugin
then
JAVA=
/bin/java
else
JAVA=java
fi
export
JAVA
LOG_FILE=
$MOQUETTE_HOME
/config/moquette-log.properties
MOQUETTE_PATH=
$MOQUETTE_HOME
/
#
LOG_CONSOLE_LEVEL=info
#
#414 by
mscheibler
was merged
Jun 25, 2018
8
Upgrade netty to 4.1.22
#413 by
sbouchex
was merged
Jun 20, 2018
4
Previous
1
2
3
4
5
LOG
.
info(
"
Initializing key manager...
"
);
private
static
SslContextBuilder
builderWithOpenSSLProvider
(
KeyStore
ks
,
String
keyPassword
)
'
testCompile
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
1.4.
199
'
:
'
net.ltgt.errorprone
'
configurations
.
errorprone {
resolutionStrategy
.
force
'
com.google.errorprone:error_prone_core:2.0.14
'
}
ext {
nettyVersion
+5
−9
broker/src/main/java/io/moquette/spi/impl/subscriptions/Topic.java
+4
−4
broker/src/test/java/io/moquette/Utils.java
+24
−5
broker/src/test/java/io/moquette/persistence/MessageStoreTCK.java
+1
−1
broker/src/test/java/io/moquette/server/MessageCollector.java
+3
−1
broker/src/test/java/io/moquette/server/ServerIntegrationFuseTest.java
+4
−3
1.4.
191
'
testCompile
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyChannel.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyMQTTHandler.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetrics.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetricsCollector.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetricsHandler.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetrics.java
*
@param
msg the message to forward.
*
@param
clientId the id of the sending integration.
*
@throws
IllegalStateException if the integration is not yet started
*/
public
void
internalPublish
(
MqttPublishMessage
msg
,
final
guohongjun/moquette
heqingfei/moquette
himeshagile/moquette
hippocampi/moquette
horryq/moquette
huilvhui/moquette
hurtonm/moquette
hvinayan/moquette
igorsilvamenezes/moquette
inexplicable/moquette
iodb/moquette
jimmy486/moquette
jincieryi/moquette
jiudong90/moquette
jkandasa/moquette
jun0813/moquette
jwoolston/moquette
kansifang/moquette
//
TODO drain all messages in target's session in-flight message queue
postOffice
.
flushInFlight(
this
);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
type
:
Jar
) {
classifier
=
'
sources
'
from sourceSets
.
main
.
allSource
}
//
summarize artifacts
artifacts {
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.
12.1
"
echo
"
version: 0.
.13-SNAPSHOT
"
4.1.22.Final
'
}
task packageTests(
type
:
Jar
) {
from sourceSets
.
test
.
output
from sourceSets
.
test
.
allSource
testDescriptor
) {
void
beforeTest
(
TestDescriptor
testDescriptor
) {
if
(
!
testDescriptor
.
isComposite()) {
if
(
!
testDescriptor
!
testDescriptor
.
isComposite()) {
def
buffer
=
(outputEvent
.
getDestination()
==
TestOutputEvent.Destination.StdOut
)
?
stdout
:
stderr
buffer
.
=
-XX:+HeapDumpOnOutOfMemoryError -Djava.awt.headless=true
set
MOQUETTE_PATH
=
%MOQUETTE_HOME%
set
LOG_FILE
=
%MOQUETTE_HOME%
\config\moquette-log.properties
rem
# Use the Hotspot garbage-first collector.
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+UseG1GC
rem
)
cygwin=true
;;
Darwin
*
)
darwin=true
;;
MINGW
*
)
msys=true
;;
NONSTOP
*
)
nonstop=true
;;
=
"
ssl_port
"
;
public
static
final
String
JKS_PATH_PROPERTY_NAME
=
"
jks_path
"
;
/*
* @see java.security.KeyStore#getInstance(String) for allowed types, default to "jks"
*/
);
long
stopTime
=
System
.
currentTimeMillis();
long
spentTime
=
stopTime
-
startTime;
LOG
.
info(
"
SUB: {} received
"
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
"Times New Roman"
;}
p
{
margin-right
:
0
in
;
mso-margin-top-alt
:auto;
mso-margin-bottom-alt
:auto;
margin-left
:
0
in
;
:
'
eclipse
'
ext {
nettyVersion
=
'
4.1.
12
.Final
'
nettyVersion
=
'
4.1.
22
.Final
LOG_FILE_LEVEL=fine
JAVA_OPTS_SCRIPT=
"
-XX:+HeapDumpOnOutOfMemoryError -Djava.awt.headless=true
"
#
# Use the Hotspot garbage-first collector.
JAVA_OPTS=
"
$JAVA_OPTS
-XX:+UseG1GC
"
#
# Have the JVM do less remembered set work during STW, instead
#
# preferring concurrent GC. Reduces p99.9 latency.
JAVA_OPTS=
6
Next
Previous
Next
ProTip!
Mix and match filters to narrow down what you’re looking for.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
final
KeyManagerFactory
kmf
=
KeyManagerFactory
.
getInstance(
KeyManagerFactory
.
getDefaultAlgorithm());
throws
GeneralSecurityException
{
kmf
.
init(ks, keyManagerPassword
.
testRuntime
group
:
'
io.netty
'
,
name
:
'
netty-tcnative
'
,
version
:
'
2.0.10.Final
=
'
4.1.12.Final
'
@@ -85,5 +82,5 @@ subprojects {
}
task
wrapper
(
type
:
Wrapper
) {
gradleVersion
=
'
broker/src/test/java/io/moquette/server/ServerIntegrationHazelcastHandlerInterceptorTest.java
+10
−10
broker/src/test/java/io/moquette/server/ServerIntegrationPahoTest.java
+11
−9
broker/src/test/java/io/moquette/server/ServerIntegrationQoSValidationTest.java
+8
−6
broker/src/test/java/io/moquette/server/ServerIntegrationRestartTest.java
+2
−1
broker/src/test/java/io/moquette/server/ServerIntegrationSSLTest.java
+1
−0
1.4.
192
'
testRuntime
group
:
'
io.netty
'
,
name
:
'
netty-tcnative
'
,
version
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetricsCollector.java
+15
−1
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetricsHandler.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticatorTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageServiceTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/MockAuthenticator.java
String
clientId
) {
final
int
messageID
=
msg
.
variableHeader()
.
packetId();
if
(
!
initialized) {
LOG
.
error(
kevto/moquette
kjayashankar/moquette
kmhughes/moquette
knayekihtrak/moquette
konradmichael/moquette
koolob/moquette
laizhouzhang/moquette
lance1232001/moquette
lanma/moquette
lants1/moquette
lbfalcons/moquette
leftshiftone/moquette
liheeng/moquette
lijian17/moquette
liuyanjunbj/moquette
lizhanhui/moquette
lovecc0923/moquette
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
archives jar
archives sourceJar
archives javadocJar
archives packageTests
}
dependencies {
compile
group
:
'
org.slf4j
'
,
name
:
cd
"
$(
dirname
"
$0
"
)
"
2
tools_scripts/integration/brokerEmbeddedTest.groovy
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
@GrabResolver
(
from sourceSets
.
test
.
resources
classifier
=
'
tests
'
}
task javadocJar (
type
:
Jar
,
dependsOn
: javadoc) {
.
isComposite()) {
stdout
.
setLength(
0
)
;
stdout
.
setLength(
0
)
stderr
.
setLength(
0
)
append(outputEvent
.
getMessage())
//
TODO re-enable this
//
if (outputEvent.getMessage().contains("LEAK:")) {
//
println stdout
//
println stderr
//
throw new RuntimeException("Netty ResourceLeakDetector")
//
}
}
}
# Have the JVM do less remembered set work during STW, instead
rem
# preferring concurrent GC. Reduces p99.9 latency.
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:G1RSetUpdatingPauseTimePercent=
5
rem
# Main G1GC tunable: lowering the pause target will lower throughput and vise versa.
rem
# 200ms is the JVM default and lowest viable setting
rem
# 1000ms increases throughput. Keep it smaller than the timeouts.
set
JAVA_OPTS
=
esac
CLASSPATH=
$APP_HOME
/gradle/wrapper/gradle-wrapper.jar
#
Determine the Java command to use to start the JVM.
if
[
-n
"
$JAVA_HOME
"
]
;
then
if
[
public
static
final
String
KEY_STORE_TYPE
=
"
key_store_type
"
;
public
static
final
String
KEY_STORE_PASSWORD_PROPERTY_NAME
=
"
key_store_password
, topic);
LOG
.
info(
"
"
, numReceived, spentTime);
double
msgPerSec
=
(numReceived
/
spentTime)
*
1000
;
LOG
.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
mso-pagination
:widow-orphan;
font-size
:
12.0
pt
;
font-family
:
"Times New Roman"
;
mso-fareast-font-family
:
"Times New Roman"
;}
p
.
'
}
task packageTests(
type
:
Jar
) {
Toggle all file notes
0 comments on commit
0fae292
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
"
$JAVA_OPTS
-XX:G1RSetUpdatingPauseTimePercent=5
"
#
# Main G1GC tunable: lowering the pause target will lower throughput and vise versa.
#
# 200ms is the JVM default and lowest viable setting
#
# 1000ms increases throughput. Keep it smaller than the timeouts.
JAVA_OPTS=
"
$JAVA_OPTS
-XX:MaxGCPauseMillis=500
"
#
# Optional G1 Settings
#
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
toCharArray());
for
(
String
alias
:
Collections
.
list(ks
.
aliases())) {
TrustManager
[] trustManagers
=
null
;
if
(ks
.
'
,
classifier
:
'
linux-x86_64
'
}
Toggle all file notes
0 comments on commit
f3faee6
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
3.3
'
gradleVersion
=
'
4.6
'
}
15
gradle/lint.gradle
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,10 @@
apply
plugin
broker/src/test/java/io/moquette/server/ServerIntegrationWebSocketTest.java
+3
−2
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
+5
−4
broker/src/test/java/io/moquette/spi/ClientSessionTest.java
+17
−15
broker/src/test/java/io/moquette/spi/impl/AbstractProtocolProcessorCommonUtils.java
+2
−1
broker/src/test/java/io/moquette/spi/impl/BrokerInterceptorTest.java
+4
−1
broker/src/test/java/io/moquette/spi/impl/MockAuthenticator.java
:
'
2.0.10.Final
'
,
classifier
:
'
linux-x86_64
'
}
8
broker/src/main/java/io/moquette/broker/IQueueRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,8 @@
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessorTest.java
+15
−0
.../src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/SubscriptionsStoreTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ConfigurationParserTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/MQTTWebSocket.java
+15
−1
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationFuseTest.java
"
"
, clientId,
messageID);
throw
new
IllegalStateException
(
"
Can't publish on a integration is not yet started
"
);
}
LOG
.
trace(
"
"
maggu2810/moquette
mahmed8003/moquette
mahui1980/moquette
mapengfei00099/moquette
mgurevin/moquette
mindis/moquette
mingj/moquette
mkretzschmar/moquette
mojunneng/moquette
mpaatz/moquette
muka/moquette
myqhit/moquette
narry/moquette
nathantippy/moquette
nickman/moquette
nuspy/moquette
okse-3/moquette
oldshipmaster/moquette
oomhj/moquette
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
'
slf4j-api
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
junit
'
,
name
:
name
=
'
moquette-bintray
'
,
root
=
'
http://dl.bintray.com/andsel/maven/
'
)
@Grab
(
group
=
'
io.moquette
'
classifier
=
'
javadoc
'
from javadoc
.
destinationDir
}
task sourceJar (
type
:
Jar
) {
classifier
=
'
;
stderr
.
setLength(
0
)
}
}
}
}
@@ -50,13 +50,14 @@ class OutputReporter implements TestListener, TestOutputListener {
@Override
@Override
void
onOutput
(
TestDescriptor
testDescriptor
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
%JAVA_OPTS%
-XX:MaxGCPauseMillis=
500
rem
# Optional G1 Settings
rem
Save CPU time on large (
>
= 16GB) heaps by delaying region scanning
rem
until the heap is 70% full. The default in Hotspot 8u40 is 40%.
rem
set JAVA_OPTS=%JAVA_OPTS% -XX:InitiatingHeapOccupancyPercent=70
rem
For systems with
>
8 cores, the default ParallelGCThreads is 5/8 the number of logical cores.
rem
-x
"
$JAVA_HOME
/jre/sh/java
"
]
;
then
#
IBM's JDK on AIX uses strange locations for the executables
JAVACMD=
"
$JAVA_HOME
/jre/sh/java
"
else
JAVACMD=
"
$JAVA_HOME
"
;
public
static
final
String
KEY_MANAGER_PASSWORD_PROPERTY_NAME
=
"
key_manager_password
"
;
public
static
final
String
ALLOW_ANONYMOUS_PROPERTY_NAME
=
"
info(
"
SUB: Speed: {} msg/sec
"
, msgPerSec);
LOG
.
info(
"
SUB: Latency diagram [microsecs]
"
);
histogram
.
outputPercentileDistribution(
System
.
out,
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
BalloonText
,
li
.
BalloonText
,
div
.
BalloonText
{
mso-style-name
:
"Balloon Text"
;
margin
:
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Save CPU time on large (>= 16GB) heaps by delaying region scanning
#
until the heap is 70% full. The default in Hotspot 8u40 is 40%.
#
JAVA_OPTS="$JAVA_OPTS -XX:InitiatingHeapOccupancyPercent=70"
#
For systems with > 8 cores, the default ParallelGCThreads is 5/8 the number of logical cores.
#
Otherwise equal to the number of cores when 8 or less.
#
Machines with > 10 cores should try setting these to <= full cores.
#
JAVA_OPTS="$JAVA_OPTS -XX:ParallelGCThreads=16"
#
By default, ConcGCThreads is 1/4 of ParallelGCThreads.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
entryInstanceOf(alias,
KeyStore
.
PrivateKeyEntry
.
class)) {
if
(needsClientAuth) {
PrivateKey
key
=
(
PrivateKey
) ks
.
getKey(alias, keyPassword
.
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
:
'
checkstyle
'
apply
plugin
:
'
findbugs
'
apply
plugin
:
'
com.github.spotbugs
'
+3
−3
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessorTest.java
+4
−3
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_CONNECT_Test.java
+2
−2
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_VariousUseCases_Test.java
+5
−3
broker/src/test/java/io/moquette/spi/impl/security/DBAuthenticatorTest.java
+5
package
io.moquette.broker
;
import
java.util.Queue
;
public
interface
IQueueRepository
{
Queue<
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
String
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationPahoTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationQoSValidationTest.java
+15
−3
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationSSLTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationWebSocketTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerLowlevelMessagesIntegrationTests.java
+15
−0
, clientId, messageID);
dispatcher
.
internalPublish(msg);
}
public
void
stopServer
() {
LOG
.
info(
"
Unbinding integration from the configured ports
"
);
pamod/moquette
parksangkil/moquette
pillimede/moquette
plechi/moquette
popeye0807/moquette
qchen006/moquette
qiuzhanghua/moquette
quyf/moquette
redboy1972/moquette
redlion99/moquette
redsolo/moquette
robbyb67/moquette
robgratz/moquette
rubberbird/moquette
runafter/moquette
saeedhadi/moquette
salmanebah/moquette
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
'
junit
'
,
version
:
'
4.8.2
'
testCompile
group
:
'
org.slf4j
'
,
name
:
,
module
=
'
moquette-broker
'
,
version
=
'
0.
12.1
'
)
@Grab
(
group
=
'
sources
'
from sourceSets
.
main
.
allSource
}
//
summarize artifacts
artifacts {
archives jar
archives sourceJar
archives javadocJar
archives packageTests
}
dependencies {
compile
,
TestOutputEvent
outputEvent
) {
void
onOutput
(
TestDescriptor
testDescriptor
,
TestOutputEvent
outputEvent
) {
if
(
!
testDescriptor
.
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Otherwise equal to the number of cores when 8 or less.
rem
Machines with
>
10 cores should try setting these to
<
= full cores.
rem
set JAVA_OPTS=%JAVA_OPTS% -XX:ParallelGCThreads=16
rem
By default, ConcGCThreads is 1/4 of ParallelGCThreads.
rem
Setting both to the same value can reduce STW durations.
rem
set JAVA_OPTS=%JAVA_OPTS% -XX:ConcGCThreads=16
rem
## GC logging options -- uncomment to enable
set
/bin/java
"
fi
if
[
!
-x
"
$JAVACMD
"
]
;
then
die
"
ERROR: JAVA_HOME is set to an invalid directory:
$JAVA_HOME
Please set the JAVA_HOME variable in your environment to match the
allow_anonymous
"
;
175
broker/src/main/java/io/moquette/server/DefaultMoquetteSslContextCreator.java
Show comments
View file
Edit file
Delete file
@@ -16,19 +16,34 @@
1000.0
);
//
nanos/1000
m_latch
.
countDown();
}
else
{
String
payload
0
in
;
margin-bottom
:
.0001
pt
;
mso-pagination
:widow-orphan;
font-size
:
8.0
pt
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
#
Setting both to the same value can reduce STW durations.
#
JAVA_OPTS="$JAVA_OPTS -XX:ConcGCThreads=16"
#
## GC logging options -- uncomment to enable
JAVA_OPTS=
"
$JAVA_OPTS
-XX:+PrintGCDetails
"
JAVA_OPTS=
"
$JAVA_OPTS
-XX:+PrintGCDateStamps
"
JAVA_OPTS=
"
toCharArray());
LOG
.
warn(
Certificate
[] chain
=
ks
.
getCertificateChain(alias);
"
Client authentication is enabled.
"
X509Certificate
[] certChain
=
new
X509Certificate
[chain
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
apply
plugin
:
'
net.ltgt.errorprone
'
dependencies
{
errorprone
"
com.google.errorprone:error_prone_core:2.2.0
"
}
checkstyle
{
configProperties
.
checkstyleConfigDir
−3
broker/src/test/java/io/moquette/spi/impl/security/FileAuthenticatorTest.java
+5
−4
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryMatchingTest.java
+7
−14
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryTest.java
+0
−1
broker/src/test/java/io/moquette/spi/impl/subscriptions/TopicTest.java
+8
−2
broker/src/test/java/io/moquette/testclient/Client.java
+4
−2
cli
,
boolean
clean
);
}
12
broker/src/main/java/io/moquette/broker/MemoryQueueRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,12 @@
package
io.moquette.broker
;
import
broker/src/test/java/org/dna/mqtt/moquette/server/ServerRestartIntegrationTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/TestCallback.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/testclient/Client.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/testclient/ClientNettyMQTTHandler.java
+15
−0
bundle/src/main/java/org/dna/mqtt/moquette/bundle/Activator.java
+576
−0
license-eplv10-aslv20.html
+15
acceptor
.
close();
LOG
.
trace(
"
Stopping MQTT protocol processor
"
);
initialized
=
false
;
//
calling shutdown() does not actually stop tasks that are not cancelled,
//
and SessionsRepository does not stop its tasks. Thus shutdownNow().
sangkyunyoon/moquette
sayi21cn/moquette
sboorlagadda/moquette
senspace/moquette
seraya-fan/moquette
sgano1/moquette
sixtop/moquette
slacrey/moquette
soenter/moquette
soken-su/moquette
sonecabr/moquette
sonson1023/moquette
splade/moquette
stannislin/moquette
sumyfly/moquette
superdjz/moquette
superposition/moquette
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
org.assertj
'
,
name
:
'
assertj-core
io.moquette
'
,
module
=
'
moquette-broker
'
,
version
=
'
0.
13-SNAPSHOT
'
)
import
group
:
'
org.slf4j
'
,
name
:
'
slf4j-api
'
,
version
:
'
1.7.5
'
testCompile
isComposite()) {
if
(
!
testDescriptor
.
isComposite()) {
def
buffer
=
(outputEvent
.
getDestination()
==
TestOutputEvent.Destination.StdOut
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintGCDetails
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintGCDateStamps
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintHeapAtGC
set
JAVA_OPTS
=
location of your Java installation.
"
fi
else
JAVACMD=
"
java
"
which java
>
/dev/null
2>&1
||
die
"
ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.
Please set the JAVA_HOME variable in your environment to match the
location of your Java installation.
package
io.moquette.server
;
import
java.io.File
;
import
java.io.FileInputStream
;
import
java.io.FileNotFoundException
;
import
java.io.IOException
;
import
java.io.InputStream
=
new
String
(message
.
getPayload(),
UTF_8
);
//
long sentTime = Long.parseLong(payload.split("-")[1]);
long
sentTime
=
Long
.
parseLong(payload
.
;
font-family
:Tahoma;
mso-fareast-font-family
:
"Times New Roman"
;}
@page
Section1
{
size
:
8.5
in
11.0
in
;
margin
Learn more
Accept
Reject
Save preferences
$JAVA_OPTS
-XX:+PrintHeapAtGC
"
JAVA_OPTS=
"
$JAVA_OPTS
-XX:+PrintTenuringDistribution
"
JAVA_OPTS=
"
$JAVA_OPTS
-XX:+PrintGCApplicationStoppedTime
"
JAVA_OPTS=
"
$JAVA_OPTS
-XX:+PrintPromotionFailure
"
.
length];
+
"
The keystore will be used as a truststore. KeystorePath = {}.
"
,
System
.
arraycopy(chain,
0
, certChain,
0
, chain
.
length);
jksPath);
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
=
"
.
"
@@ -8,12 +13,8 @@ checkstyle {
toolVersion
=
'
6.7
'
}
findbugs
{
toolVersion
=
'
3.
0
broker/src/test/java/io/moquette/testclient/ClientNettyMQTTHandler.java
+8
−6
broker/src/test/java/io/moquette/testclient/RawClient.java
+2
−2
checkstyle.xml
+9
−11
distribution/build.gradle
+5
−3
embedding_moquette/src/main/java/io/moquette/testembedded/EmbeddedLauncher.java
+15
−0
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentQueue.java
+6
java.util.Queue
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
public
class
MemoryQueueRepository
implements
IQueueRepository
{
@Override
public
Queue<
SessionRegistry
.
EnqueuedMessage
>
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnectDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnectEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DemuxDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DemuxEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DisconnectDecoder.java
scheduler
.
shutdownNow();
if
(h2Builder
!=
null
) {
LOG
.
trace(
"
Shutting down H2 persistence {}
"
);
h2Builder
.
sureddy/moquette
surpass/moquette
swarwick/moquette
systembugtj/moquette
tanapop/moquette
tangxunye/moquette
technocreatives/moquette
teco-kit/moquette-lusagent
tennessine/moquette
teranisi/moquette
thangdc94/moquette
thinkjoyorg/moquette
tigersshi/moquette
timvanginderen/moquette
ttomato/moquette
uwitec/moquette
wanghaipeng789/moquette
watergit2016/moquette
'
,
version
:
'
2.6.0
'
testCompile
group
:
'
org.mockito
'
,
name
:
'
mockito-core
io.moquette.server.Server
Toggle all file notes
0 comments on commit
db4349b
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
group
:
'
junit
'
,
name
:
'
junit
'
,
version
:
'
4.8.2
'
testCompile
group
)
?
stdout
:
stderr;
def
buffer
=
(outputEvent
.
getDestination()
==
TestOutputEvent.Destination.StdOut
)
?
stdout
:
stderr
%JAVA_OPTS%
-XX:+PrintTenuringDistribution
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintGCApplicationStoppedTime
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintPromotionFailure
rem
set JAVA_OPTS=%JAVA_OPTS% -XX:PrintFLSStatistics=1
rem
set JAVA_OPTS=%JAVA_OPTS% -Xloggc:/var/log/moquette/gc.log
set
JAVA_OPTS
"
fi
#
Increase the maximum file descriptors if we can.
if
[
"
$cygwin
"
=
"
false
"
-a
"
$darwin
"
=
"
;
import
java.net.URL
;
import
java.security.GeneralSecurityException
;
import
java.security.KeyManagementException
;
import
java.security.KeyStore
;
import
java.security.KeyStoreException
;
import
split(
"
-
"
)[
1
]);
long
delay
=
System
.
nanoTime()
-
sentTime;
histogram
.
:
1.0
in
1.25
in
1.0
in
1.25
in
;
mso-header-margin
:
.5
in
;
mso-footer-margin
:
#
JAVA_OPTS="$JAVA_OPTS -XX:PrintFLSStatistics=1"
#
JAVA_OPTS="$JAVA_OPTS -Xloggc:/var/log/moquette/gc.log"
JAVA_OPTS=
"
$JAVA_OPTS
-Xloggc:
$MOQUETTE_HOME
/gc.log
"
JAVA_OPTS=
"
$JAVA_OPTS
-XX:+UseGCLogFileRotation
"
JAVA_OPTS=
return
SslContextBuilder
.
forServer(key, certChain);
//
use keystore as truststore, as server needs to trust certificates signed by the
//
server certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.1
'
spotbugs
{
toolVersion
=
'
3.
1
.1
'
ignoreFailures true
omitVisitors
=
[
'
RuntimeExceptionCapture
'
−10
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentStore.java
+17
−11
h2_storage/src/main/java/io/moquette/persistence/h2/H2SessionsStore.java
+17
−2
h2_storage/src/test/java/io/moquette/persistence/h2/H2PersistentQueueTest.java
+2
−1
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+1
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBMessagesStore.java
+1
−0
createQueue
(
String
cli
,
boolean
clean
) {
return
new
ConcurrentLinkedQueue<>
();
}
}
9
broker/src/main/java/io/moquette/broker/Server.java
Show comments
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DisconnectEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MQTTDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MQTTEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MessageIDDecoder.java
+15
−1
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingReqDecoder.java
+15
closeStore();
}
LOG
.
info(
"
Moquette integration has been stopped.
"
);
}
public
int
getPort
() {
return
acceptor
.
getPort();
}
wendersonferreira/moquette
willenwu21/moquette
windbender/moquette
xintao222/moquette
xuchao/moquette
yangpeiyong/moquette
yanxuxiao/moquette
yunemr/moquette
zhangxiaofeng123/moquette
zhoudianyou/moquette
zhuyuming/moquette
zofuthan/moquette
zorowonder/moquette
zyy/moquette
Nothing to show
compare:
master
'
,
version
:
'
1.9.0
'
testCompile
group
:
'
org.awaitility
'
,
name
:
'
awaitility
'
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
:
'
org.slf4j
'
,
name
:
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
testCompile
group
buffer
.
append(outputEvent
.
getMessage());
buffer
.
append(outputEvent
.
getMessage())
if
(outputEvent
.
getMessage()
.
contains(
"
=
%JAVA_OPTS%
-XX:+UseGCLogFileRotation
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:NumberOfGCLogFiles=
10
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
"
%JAVA%
-server
%JAVA_OPTS%
false
"
-a
"
$nonstop
"
=
"
false
"
]
;
then
MAX_FD_LIMIT=
`
ulimit -H -n
`
if
java.security.NoSuchAlgorithmException
;
import
java.security.PrivateKey
;
import
java.security.cert.Certificate
;
import
java.security.cert.X509Certificate
;
import
recordValue(delay);
//
print '+'
numReceived
++
;
//
if ((numReceived % 10000) == 0) {
//
print '.'
//
}
}
}
@Override
public
void
connectionLost
.5
in
;
mso-paper-source
:
0
;}
div
.
Section1
{
page
:Section1;}
--
>
</
style
>
</
"
$JAVA_OPTS
-XX:NumberOfGCLogFiles=10
"
JAVA_OPTS=
"
$JAVA_OPTS
-XX:GCLogFileSize=10M
"
$JAVA
-server
$JAVA_OPTS
$JAVA_OPTS_SCRIPT
-Dlog4j.configuration=
"
file:
$LOG_FILE
"
.
init(ks);
trustManagers
=
tmf
.
getTrustManagers();
}
}
//
init sslContext
}
LOG
.
info(
"
Initializing SSL context...
"
);
]
}
tasks
.
withType(
FindBugs
) {
maxHeapSize
=
'
2g
'
}
BIN
+1005 Bytes (100%)
gradle/wrapper/gradle-wrapper.jar
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBPersistentStore.java
+8
−6
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBSessionsStore.java
+3
−1
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBPersistentStoreTest.java
+2
−1
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBSessionsStoreTest.java
+17
−6
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
+14
−1
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
View file
Edit file
Delete file
@@ -161,18 +161,21 @@ public void startServer(IConfig config, List<? extends InterceptHandler> handler
authorizatorPolicy
=
initializeAuthorizatorPolicy(authorizatorPolicy, config);
final
ISubscriptionsRepository
subscriptionsRepository;
final
IQueueRepository
queueRepository;
if
(persistencePath
!=
null
−1
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingReqEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingRespDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingRespEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubAckEncoder.java
+15
−0
public
int
getSslPort
() {
return
acceptor
.
getSslPort();
}
/**
* SPI method used by Broker embedded applications to get list of subscribers. Returns null if
* the broker is not started.
*
*
@return
list of subscriptions.
*/
Choose different branches or forks above to discuss and review changes.
Learn about pull requests
Create pull request
Compare and review just about anything
Branches, tags, commit ranges, and time ranges. In the same repository and across forks.
Example comparisons
gh-pages
Jun 7, 2020
rel_0.13
Apr 11, 2020
,
version
:
'
3.0.0
'
}
test {
systemProperties
.
put
"
moquette.path
"
,
"
build/resources/test/
"
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
:
'
org.assertj
'
,
name
:
'
assertj-core
'
,
version
:
'
2.6.0
'
testCompile
group
:
'
LEAK:
"
)) {
//
TODO re-enable this
println
stdout
//
if (outputEvent.getMessage().contains("LEAK:")) {
println
stderr
//
println stdout
throw
new
RuntimeException
(
"
Netty ResourceLeakDetector
%JAVA_OPTS_SCRIPT%
-Dlog4j.configuration=file:
%LOG_FILE%
-Dmoquette.path=
%MOQUETTE_PATH%
-cp
%MOQUETTE_HOME%
\lib\* io.moquette.broker.Server
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
[
$?
-eq
0 ]
;
then
if
[
"
$MAX_FD
"
=
"
maximum
"
-o
"
$MAX_FD
"
java.util.Collections
;
import
java.util.Objects
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.spi.security.ISslContextCreator
;
import
org.slf4j.Logger
;
(
Throwable
cause
) {
LOG
.
error(
"
Client Subscriber lost connection, caused by
"
, cause);
try
{
client
.
disconnect();
}
catch
(
head
>
<
body
style
=""
lang
="
EN-US
"
>
<
div
class
="
Section1
"
>
-Dmoquette.path=
"
$MOQUETTE_PATH
"
-cp
"
$MOQUETTE_HOME
/lib/*
"
io.moquette.broker.Server
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
throw
new
KeyManagementException
(
"
the SSL key-store does not contain a private key
"
);
serverContext
.
init(kmf
.
getKeyManagers(), trustManagers,
null
);
}
LOG
Show comments
View file
Edit file
Delete file
Binary file not shown.
3
gradle/wrapper/gradle-wrapper.properties
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,5 @@
#
Thu Aug 10 18:13:58 CEST 2017
distributionBase
=GRADLE_USER_HOME
+9
−8
perf/src/main/java/io/moquette/parser/netty/performance/LoopMQTTHandler.java
+6
−3
perf/src/main/java/io/moquette/parser/netty/performance/NettyPublishReceiverHandler.java
+10
−5
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolDecodingServer.java
+8
−3
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolPublishDecodingServer.java
+10
−4
perf/src/main/java/io/moquette/parser/netty/performance/PublishBomber.java
+4
−3
&&
!
persistencePath
.
isEmpty()) {
LOG
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
h2Builder
=
new
H2Builder
(config, scheduler);
subscriptionsRepository
=
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubCompDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubCompEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRecDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRecEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRelDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRelEncoder.java
+15
//
TODO reimplement this
//
public List<Subscription> getSubscriptions() {
//
if (m_processorBootstrapper == null) {
//
return null;
//
}
//
return this.subscriptionsStore.listAllSubscriptions();
//
}
/**
* SPI method used by Broker embedded applications to add intercept handlers.
*
*
test_branch
Oct 1, 2019
broker_restructuring_connections
Nov 1, 2018
persistent_starved_session_cleaner
Oct 18, 2017
24 hours ago
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
systemProperties
.
put
"
io.netty.leakDetectionLevel
"
,
"
paranoid
"
testLogging {
exceptionFormat
'
full
'
events
"
passed
org.mockito
'
,
name
:
'
mockito-core
'
,
version
:
'
1.9.0
'
testCompile
group
:
'
"
);
//
println stderr
}
//
throw new RuntimeException("Netty ResourceLeakDetector")
//
}
}
}
}
}
}
}
17
perf/build.gradle
Show comments
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
=
"
max
"
]
;
then
MAX_FD=
"
$MAX_FD_LIMIT
"
fi
ulimit
-n
$MAX_FD
if
[
$?
import
org.slf4j.LoggerFactory
;
import
io.netty.handler.ssl.ClientAuth
;
import
io.netty.handler.ssl.SslContext
;
import
io.netty.handler.ssl.SslContextBuilder
;
import
io.netty.handler.ssl.SslProvider
;
import
javax.net.ssl.KeyManagerFactory
;
MqttException
mex) {
LOG
.
error(
null
, mex);
}
LOG
.
error(
"
SUB: Something failed during message reception
"
);
m_latch
.
<
p
style
="
text-align: center;
"
align
="
center
"
>
<
b
>
Eclipse Public License - v 1.0
</
b
>
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
Sign in to GitHub · GitHub
Skip to content
.
info(
"
The SSL context has been initialized successfully.
"
);
return
serverContext;
private
static
void
addClientAuthentication
(
KeyStore
ks
,
SslContextBuilder
distributionPath
=wrapper/dists
distributionUrl
=https\://services.gradle.org/distributions/gradle-4.6-bin.zip
zipStoreBase
=GRADLE_USER_HOME
zipStorePath
=wrapper/dists
distributionUrl
=
https\://services.gradle.org/distributions/gradle-3.3-bin.zip
26
gradlew
Show comments
View file
Edit file
Delete file
perf/src/main/java/io/moquette/parser/netty/performance/PublishReceiverHandler.java
+1
−2
tools_scripts/integration/bunch_publish_issue12.groovy
4
broker/src/main/java/io/moquette/interception/HazelcastInterceptHandler.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,7 @@
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
h2Builder
.
initStore()
.
subscriptionsRepository();
h2Builder
=
new
H2Builder
(config, scheduler)
.
initStore();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
queueRepository
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PublishDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PublishEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubscribeDecoder.java
+15
−0
@param
interceptHandler the handler to add.
*/
public
void
addInterceptHandler
(
InterceptHandler
interceptHandler
) {
if
(
!
initialized) {
LOG
.
error(
"
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Sign in to GitHub · GitHub
moquette/PublishEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
"
,
"
skipped
"
,
"
failed
"
}
}
//
Deploy set environment variables and run ./gradlew bintrayUpload
//
publication to maven repo
publishing {
publications {
org.awaitility
'
,
name
:
'
awaitility
'
,
version
:
'
3.0.0
'
}
test {
systemProperties
.
moquette/DurableSession.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
150
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
-ne
0 ]
;
then
warn
"
Could not set maximum file descriptor limit:
$MAX_FD
"
fi
else
warn
"
Could not query maximum file descriptor limit:
$MAX_FD_LIMIT
"
fi
fi
import
javax.net.ssl.SSLContext
;
import
javax.net.ssl.TrustManager
;
import
javax.net.ssl.TrustManagerFactory
;
import
java.io.*
;
import
java.net.URL
;
import
java.security.*
moquette/MessageMetricsHandler.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
countDown();
}
@Override
public
void
deliveryComplete
(
IMqttDeliveryToken
token
) {
}
}
private
int
numReceived;
private
long
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
THE ACCOMPANYING PROGRAM IS PROVIDED UNDER
THE TERMS OF THIS ECLIPSE PUBLIC LICENSE ("AGREEMENT"). ANY USE,
REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE
OF THIS AGREEMENT.
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
moquette/MQTTMessageLogger.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
contextBuilder
)
}
catch
(
NoSuchAlgorithmException
|
UnrecoverableKeyException
|
CertificateException
|
KeyStoreException
throws
NoSuchAlgorithmException
,
KeyStoreException
{
|
KeyManagementException
@@ -1,4 +1,4 @@
#!
/usr/bin/env
bash
#!
/usr/bin/env
sh
#
#############################################################################
#
#
@@ -33,11 +33,11 @@ DEFAULT_JVM_OPTS=""
#
Use the maximum available, or set MAX_FD != -1 to use that value.
MAX_FD=
"
maximum
;
import static
io.moquette.spi.impl.Utils.readBytesAndRewind
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
public
class
HazelcastInterceptHandler
extends
AbstractInterceptHandler
{
@@ -45,7 +46,8 @@ public void onPublish(InterceptPublishMessage msg) {
ByteBuf
payload
=
=
h2Builder
.
queueRepository();
}
else
{
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
);
subscriptionsRepository
=
new
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubscribeEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/Utils.java
Moquette is not started, MQTT message interceptor cannot be added. InterceptorId={}
"
,
interceptHandler
.
getID());
throw
new
IllegalStateException
(
"
Can't register interceptors on a integration that is not yet started
"
);
}
LOG
.
info(
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
bintrayPublication(
MavenPublication
) {
from components
.
java
groupId
"
$p
roject
.
group
"
artifactId
"
${
project.name
put
"
moquette.path
"
,
"
build/resources/test/
"
systemProperties
.
put
"
io.netty.leakDetectionLevel
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
moquette/ProtocolEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
169
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
8f7b7df
Please
Reject
Save preferences
#
For Darwin, add options to specify how the application appears in the dock
if
$darwin
;
then
GRADLE_OPTS=
"
$GRADLE_OPTS
\"
-Xdock:name=
$APP_NAME
\"
\"
-Xdock:icon=
$APP_HOME
/media/gradle.icns
\"
;
import
java.security.cert.CertificateException
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
/**
* Moquette server implementation to load SSL certificate from local filesystem path configured in
@@ -38,77 +53,120 @@
private
static
final
Logger
LOG
moquette/PubAckEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
startTime
=
System
.
currentTimeMillis();
private
CountDownLatch
m_latch
=
new
CountDownLatch
(
1
);
private
boolean
alreadyStarted;
private
</
span
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
Learn more
Accept
Reject
Save preferences
moquette/ISubscriptionsStore.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
|
IOException
ex) {
LOG
.
warn(
"
Client authentication is enabled. The keystore will be used as a truststore.
"
);
LOG
.
error(
//
use keystore as truststore, as server needs to trust certificates signed by the server certificates
"
"
,
"
warn (
) {
warn
() {
echo
"
$*
"
}
die (
) {
die
() {
echo
echo
"
$*
msg
.
getPayload();
byte
[] payloadContent
=
readBytesAndRewind(payload);
LOG
.
info(
"
"
, msg
.
getClientID(), msg
.
getTopicName(),
new
MemorySubscriptionsRepository
();
queueRepository
=
new
MemoryQueueRepository
();
}
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
.
init(subscriptionsRepository);
SessionRegistry
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnAckDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnAckEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnectDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnectEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PubAckDecoderTest.java
+15
"
Adding MQTT message interceptor. InterceptorId={}
"
, interceptHandler
.
getID());
interceptor
.
addInterceptHandler(interceptHandler);
}
/**
* SPI method used by Broker embedded applications to remove intercept handlers.
*
*
@param
interceptHandler the handler to remove.
*/
public
Save preferences
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
}
"
version
'
0.13-SNAPSHOT
'
}
}
}
bintray {
println
"
Bintray deploy with user [
${
System.getenv('BINTRAY_USER')
}
] while working on
${
"
,
"
paranoid
"
testLogging {
exceptionFormat
'
full
'
events
"
passed
"
,
"
skipped
moquette/MessagingEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
moquette/LostConnectionEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
moquette/InitEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
moquette/BytesMetricsHandler.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
"
fi
#
For Cygwin, switch paths to Windows format before running java
if
$cygwin
;
then
APP_HOME=
`
cygpath --path --mixed
"
$APP_HOME
"
`
CLASSPATH=
`
cygpath --path --mixed
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
IConfig
props;
private
final
IConfig
props;
DefaultMoquetteSslContextCreator
(
IConfig
props
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Histogram
histogram
=
new
Histogram
(
5
);
private
final
IMqttAsyncClient
client;
private
final
String
dialog_id;
BenchmarkSubscriber
(
MqttAsyncClient
>
1. DEFINITIONS
</
span
>
</
b
>
</
p
>
<
p
>
<
span
style
="
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
ex
.
getCause(),
tmf
.
init(ks);
ex
.
getMessage());
"
echo
@@ -154,11 +154,19 @@ if $cygwin ; then
esac
fi
#
Split up the JVM_OPTS And GRADLE_OPTS values into an array, following the shell quoting and substitution rules
splitJvmOpts()
{
JVM_OPTS=(
"
$@
"
)
#
Escape application args
String
(payloadContent));
LOG
.
info(
"
"
, msg
.
getClientID(), msg
.
getTopicName(),
new
String
(payloadContent,
UTF_8
));
sessions
=
new
SessionRegistry
(subscriptions,
interceptor
);
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions,
queueRepository
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PubAckEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PublishDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PublishEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubAckDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubAckEncoderTest.java
+15
void
removeInterceptHandler
(
InterceptHandler
interceptHandler
) {
if
(
!
initialized) {
LOG
.
error(
"
Moquette is not started, MQTT message interceptor cannot be removed. InterceptorId={}
"
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
project.name
}
"
user
=
System
.
getenv(
'
BINTRAY_USER
'
)
key
=
System
.
getenv(
"
,
"
failed
"
}
}
//
Deploy set environment variables and run ./gradlew bintrayUpload
//
publication to maven repo
publishing {
publications {
bintrayPublication(
MavenPublication
) {
from components
.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
"
$CLASSPATH
"
`
JAVACMD=
`
cygpath --unix
"
$JAVACMD
"
`
moquette/NettyMQTTHandler.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
moquette/OutputMessagingEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
) {
this
.
props
=
props;
this
.
props
=
Objects
.
requireNonNull(
props
)
;
}
@Override
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
client
,
String
dialog_id
) {
this
.
client
=
client;
this
.
dialog_id
=
dialog_id;
}
public
void
font-size: 10pt;
"
>
"Contribution" means:
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
contextBuilder
.
clientAuth(
ClientAuth
.
REQUIRE
);
return
null
;
contextBuilder
.
trustManager(tmf);
}
private
SslProvider
getSSLProvider
() {
save
() {
for
i
do
printf
%s
\\
n
"
$i
"
|
sed
"
s/'/'
\\\\
ITopic<
HazelcastMsg
>
topic
=
hz
.
getTopic(
"
moquette
"
);
HazelcastMsg
hazelcastMsg
=
new
HazelcastMsg
(msg);
);
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
new
MemoryRetainedRepository
(), sessions,
interceptor);
final
BrokerConfiguration
brokerConfig
=
new
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubscribeDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubscribeEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/TestUtils.java
+15
−1
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeDecoderTest.java
+15
−1
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeEncoderTest.java
+15
−0
,
interceptHandler
.
getID());
throw
new
IllegalStateException
(
"
Can't deregister interceptors from a integration that is not yet started
"
);
}
LOG
.
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
'
BINTRAY_KEY
'
)
pkg {
repo
=
'
maven
'
//
name
=
"
${
project.group
}
.
java
groupId
"
$p
roject
.
group
"
artifactId
"
${
project.name
}
"
version
'
0.13-SNAPSHOT
'
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
moquette/NettyAcceptor.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
moquette/MoquetteIdleTimeoutHandler.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
#
We build the pattern for arguments to be converted via cygpath
ROOTDIRSRAW=
`
find -L / -maxdepth 1 -mindepth 1 -type d
2>
/dev/null
`
SEP=
"
"
for
dir
in
$ROOTDIRSRAW
;
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
public
SSLContext
initSSLContext
() {
public
SslContext
initSSLContext
() {
LOG
.
info(
"
Checking SSL configuration properties...
"
);
final
String
keyPassword
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
connect
()
throws
MqttException
{
MqttConnectOptions
connectOptions
=
new
MqttConnectOptions
();
connectOptions
.
setCleanSession(
true
);
this
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
a)
in the case of the initial Contributor, the initial code and documentation
distributed under this Agreement, and
<
br
clear
="
left
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
String
providerName
=
props
.
getProperty(
BrokerConstants
.
SSL_PROVIDER
,
SslProvider
.
JDK
.
name());
try
{
return
''/g;1s/^/'/;
\$
s/
\$
/'
\\\\
/
"
;
done
echo
"
"
}
eval
splitJvmOpts
$DEFAULT_JVM_OPTS
topic
.
publish(hazelcastMsg);
6
broker/src/main/java/io/moquette/interception/messages/InterceptConnectMessage.java
Show comments
View file
Edit file
Delete file
@@ -18,6 +18,8 @@
import
io.netty.handler.codec.mqtt.MqttConnectMessage
;
import
java.nio.charset.StandardCharsets
;
BrokerConfiguration
(config);
4
broker/src/main/java/io/moquette/broker/Session.java
Show comments
View file
Edit file
Delete file
@@ -97,10 +97,8 @@ public int compareTo(Delayed o) {
private
final
AtomicInteger
inflightSlots
=
new
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UtilsTest.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/commons/Constants.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/MQTTException.java
+15
−4
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/Utils.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/AbstractMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ConnAckMessage.java
info(
"
Removing MQTT message interceptor. InterceptorId={}
"
, interceptHandler
.
getID());
interceptor
.
removeInterceptHandler(interceptHandler);
}
/**
* Return a list of descriptors of connected clients.
*
*/
public
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
${
project.name
}
"
userOrg
=
'
andsel
'
licenses
=
[
'
Apache-2.0
'
]
vcsUrl
}
}
}
bintray {
println
"
Bintray deploy with user [
${
System.getenv('BINTRAY_USER')
}
] while working on
${
project.name
}
"
user
=
System
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
do
ROOTDIRS=
"
$ROOTDIRS$SEP$dir
"
SEP=
"
|
"
done
OURCYGPATTERN=
"
(^(
$ROOTDIRS
))
"
#
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
=
props
.
getProperty(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
);
if
(keyPassword
==
null
||
keyPassword
.
isEmpty()) {
LOG
.
warn(
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
.
client
.
setCallback(
new
SubscriberCallback
());
this
.
client
.
connect(connectOptions,
null
,
new
IMqttActionListener
() {
@Override
public
"
>
b) in the case of each subsequent Contributor:
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
SslProvider
.
valueOf(providerName);
}
catch
(
IllegalArgumentException
e) {
LOG
.
warn(
"
unknown SSL Provider {}, falling back on JDK provider
"
, providerName);
return
SslProvider
.
JDK
$JAVA_OPTS
$GRADLE_OPTS
JVM_OPTS[
${
#
JVM_OPTS[*]}
]=
"
-Dorg.gradle.appname=
$APP_BASE_NAME
"
APP_ARGS=
$(
save
"
$@
"
)
exec
public
class
InterceptConnectMessage
extends
InterceptAbstractMessage
{
private
final
MqttConnectMessage
msg;
@@ -72,14 +74,14 @@ public String getUsername() {
}
public
byte
[]
getPassword
AtomicInteger
(
INFLIGHT_WINDOW_SIZE
);
//
this should be configurable
Session
(
String
clientId
,
boolean
clean
,
Will
will
,
Queue<
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ConnectMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/DisconnectMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/MessageIDMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PingReqMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PingRespMessage.java
+15
Collection<
ClientDescriptor
>
listConnectedClients
() {
return
sessions
.
listConnectedClients();
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
/
=
"
https://api.bintray.com/maven/andsel/maven/
${
project.group
}
.
${
project.name
}
"
publications
=
[
'
bintrayPublication
'
]
}
.
getenv(
'
BINTRAY_USER
'
)
key
=
System
.
getenv(
'
BINTRAY_KEY
'
)
pkg {
repo
=
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
Add a user-defined pattern to the cygpath arguments
if
[
"
$GRADLE_CYGPATTERN
"
!=
"
"
]
;
then
OURCYGPATTERN=
"
$OURCYGPATTERN
|(
$GRADLE_CYGPATTERN
)
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
"
The key manager password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
try
{
SslProvider
sslProvider
=
getSSLProvider();
KeyStore
ks
=
loadKeyStore();
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
void
onFailure
(
IMqttToken
asyncActionToken
,
Throwable
exception
) {
LOG
.
error(
"
SUB: connect fail
"
, exception);
System
.
>
<
span
style
="
font-size: 10pt;
"
>
i)
changes to the Program, and
</
span
>
</
p
>
<
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
;
}
}
}
}
@@ -124,7 +182,6 @@ private InputStream jksDatastore(String jksPath) throws FileNotFoundException {
LOG
.
info(
"
Loading external keystore. Url = {}.
"
, jksFile
.
getAbsolutePath());
LOG
.
"
$JAVACMD
"
"
"
-classpath
"
$CLASSPATH
"
org.gradle.wrapper.GradleWrapperMain
"
$@
"
#
Collect all arguments for the java command, following the shell quoting and substitution rules
eval
set
--
$DEFAULT_JVM_OPTS
() {
return
msg
.
payload()
.
password()
.
getBytes();
return
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
) {
this
.
clientId
=
clientId;
this
.
clean
=
clean;
this
(clean, clientId, sessionQueue);
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubCompMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubRecMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubRelMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PublishMessage.java
+15
−0
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
events
/
PublishEvent.java
}
}
task
wrapper
(
type
:
Wrapper
) {
gradleVersion
=
'
4.6
'
}
Copy lines
Copy permalink
'
maven
'
//
name
=
"
${
project.group
}
.
${
project.name
}
"
userOrg
=
'
andsel
'
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
main
/
java
/
io
/
moquette
/
spi
/
DurableSession.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
"
fi
#
Now convert the arguments - kludge to limit ourselves to /bin/sh
i=0
for
arg
in
"
$@
"
;
do
CHECK=
`
echo
"
$arg
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
SslContextBuilder
contextBuilder;
switch
(sslProvider) {
case
JDK
:
contextBuilder
=
builderWithJdkProvider(ks, keyPassword);
break
;
case
OPENSSL
:
case
OPENSSL_REFCNT
:
contextBuilder
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
main
/
java
/
io
/
moquette
/
server
/
netty
/
metrics
/
MessageMetricsHandler.java
/
Jump to
exit(
2
);
}
@Override
public
void
onSuccess
(
IMqttToken
asyncActionToken
) {
try
{
client
.
subscribe(
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
ii)
additions to the Program;
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
main
/
java
/
src
/
main
/
java
/
io
/
moquette
/
server
/
netty
/
metrics
/
MQTTMessageLogger.java
info(
"
Loading external keystore. Url = {}.
"
, jksFile
.
getAbsolutePath());
return
new
FileInputStream
(jksFile);
return
new
FileInputStream
(jksFile);
}
}
$JAVA_OPTS
$GRADLE_OPTS
"
\"
-Dorg.gradle.appname=
$APP_BASE_NAME
\"
"
-classpath
"
\"
$CLASSPATH
\"
"
org.gradle.wrapper.GradleWrapperMain
"
$APP_ARGS
.
UTF_8
);
}
public
String
getWillTopic
() {
return
msg
.
payload()
.
willTopic();
}
public
byte
[]
this
.
will
=
will;
this
.
sessionQueue
=
sessionQueue;
}
Session
(
boolean
clean
,
String
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/SubAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/SubscribeMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/UnsubAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/UnsubscribeMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ZeroLengthMessage.java
28
about.html
Show comments
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
106 lines (91 sloc)
2.91 KB
Raw
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
licenses
=
[
'
Apache-2.0
'
]
vcsUrl
=
"
https://api.bintray.com/maven/andsel/maven/
${
project.group
}
.
${
project.name
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
213 lines (182 sloc)
7.61 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
main
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
"
|
egrep -c
"
$OURCYGPATTERN
"
-
`
CHECK2=
`
echo
"
$arg
"
|
egrep -c
"
^-
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
=
builderWithOpenSSLProvider(ks, keyPassword);
break
;
default
:
LOG
.
error(
"
unsupported SSL provider {}
"
, sslProvider);
return
null
;
}
//
src
/
main
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
71 lines (58 sloc)
2.51 KB
Raw
Blame
/*
"
/topic
"
+
dialog_id,
1
,
null
,
new
IMqttActionListener
() {
@Override
public
void
onFailure
(
IMqttToken
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
/
io
/
moquette
/
spi
/
ISubscriptionsStore.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
106 lines (96 sloc)
3.94 KB
Raw
Blame
LOG
.
warn(
"
The keystore file does not exist. Url = {}.
"
, jksFile
.
getAbsolutePath());
throw
new
FileNotFoundException
(
"
The keystore file does not exist. Url =
"
+
jksFile
.
"
#
by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
if
[
"
$(
uname
)
"
=
"
Darwin
"
]
&&
[
"
getWillMessage
() {
return
msg
.
payload()
.
willMessage()
.
getBytes();
return
msg
.
payload()
.
willMessage()
.
clientId
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
) {
13
broker/src/main/java/io/moquette/broker/SessionRegistry.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
package
io.moquette.broker
;
View file
Edit file
Delete file
@@ -0,0 +1,28 @@
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
>
<
html
xmlns
="
http://www.w3.org/1999/xhtml
"
>
<
head
>
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
}
"
publications
=
[
'
bintrayPublication
'
]
}
}
}
task
wrapper
(
type
:
Wrapper
666cc29d47
moquette
/
broker
/
src
/
main
/
java
/
org
/
dna
/
mqtt
/
moquette
main
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.spi
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
import
events
/
ProtocolEvent.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
46 lines (40 sloc)
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
broker
/
src
/
main
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
server
/
"
`
#
## Determine if an option
if
[
$CHECK
-ne
0 ]
&&
[
$CHECK2
-eq
0 ]
;
then
#
## Added a condition
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
main
/
java
/
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
/
if client authentification is enabled a trustmanager needs to be added to the ServerContext
String
sNeedsClientAuth
=
props
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
if
(
Boolean
events
/
PubAckEvent.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
39 lines (33 sloc)
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
asyncActionToken2
,
Throwable
exception
) {
try
{
client
.
disconnect();
}
catch
(
MqttException
mex) {
LOG
.
error(
span
style
="
font-size: 10pt;
"
>
where
such changes and/or additions to the Program originate from and are distributed
by that particular Contributor. A Contribution 'originates' from a Contributor
if it was added to the Program by such Contributor itself or anyone acting on
such Contributor's behalf. Contributions do not include additions to the
Program which: (i) are separate modules of software distributed in conjunction
with the Program under their own license agreement, and (ii) are not derivative
works of the Program.
</
span
>
</
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
69 lines (59 sloc)
1.94 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.server.netty.metrics
;
getAbsolutePath());
return
null
;
}
}
}
}
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
d50a291
Please
sign in
to comment.
$HOME
"
=
"
$PWD
"
]
;
then
cd
"
$(
dirname
"
$0
"
)
"
fi
getBytes(
StandardCharsets
.
UTF_8
);
}
}
2
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
Show comments
View file
Edit file
Delete file
@@ -41,7 +41,7 @@ public void initStore() {
public
void
storeRetained
import
io.moquette.broker.Session.SessionStatus
;
import
io.moquette.interception.BrokerInterceptor
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
@@ -32,9 +31,9 @@
import
<
meta
http-equiv
="
Content-Type
"
content
="
text/html; charset=ISO-8859-1
"/>
<
title
>
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage.QOSType
;
import
java.nio.ByteBuffer
;
import
org.dna.mqtt.moquette.proto.messages.PublishMessage
;
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
) {
gradleVersion
=
'
4.6
'
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
/
messaging
/
spi
/
impl
/
events
/
MessagingEvent.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
events
/
LostConnectionEvent.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
34 lines (30 sloc)
io.moquette.spi.impl.subscriptions.Topic
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.Collection
;
import
java.util.HashSet
;
import
java.util.Set
;
public
class
1.42 KB
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
impl
/
events
/
InitEvent.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
netty
/
metrics
/
BytesMetricsHandler.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
eval
`
echo args
$i
`
=
`
cygpath --path --ignore --mixed
"
$arg
"
`
else
eval
`
echo args
$i
`
io
/
moquette
/
server
/
netty
/
NettyMQTTHandler.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
events
.
valueOf(sNeedsClientAuth)) {
addClientAuthentication(ks, contextBuilder);
}
contextBuilder
.
sslProvider(sslProvider);
SslContext
sslContext
=
contextBuilder
.
build();
LOG
.
info(
"
1.07 KB
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
package
io.moquette.server.netty.metrics
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelPromise
;
import
io.netty.util.Attribute
;
null
, mex);
}
}
@Override
public
void
onSuccess
(
IMqttToken
asyncActionToken2
) {
LOG
.
info(
"
SUB: subscribed to /topic{} qos: 1
"
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"Contributor" means any person or
entity that distributes the Program.
</
span
>
</
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.spi
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
import
io.moquette.spi.impl.subscriptions.Topic
import
io.moquette.server.netty.NettyUtils
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelPromise
;
import
io.netty.handler.codec.mqtt.*
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
exec
"
$JAVACMD
"
"
$@
"
6
gradlew.bat
Show comments
View file
Edit file
Delete file
@@ -49,7 +49,6 @@ goto fail
(
Topic
topic
,
StoredMessage
storedMessage
) {
LOG
.
debug(
"
"
, topic, storedMessage
.
getClientID());
if
(storedMessage
.
java.util.concurrent.ConcurrentLinkedQueue
;
import
java.util.concurrent.ConcurrentMap
;
class
SessionRegistry
{
public
class
SessionRegistry
{
abstract
static
class
EnqueuedMessage
About
</
title
>
</
head
>
<
body
lang
="
EN-US
"
>
<
h2
>
About Moquette MQT broker
import
org.dna.mqtt.moquette.server.ServerChannel
;
/**
*
*
@author
andrea
*/
public
class
PublishEvent
extends
MessagingEvent
{
String
m_topic;
QOSType
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
25 lines (23 sloc)
790 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
978 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
DurableSession
extends
ClientSession
{
class
OutboundFlightZone
{
/**
* Save the binding messageID, clientID - message
*
*
@param
messageID the packet ID used in transmission
*
@param
msg the message to put in flight zone
*/
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.Utils
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
/**
* Event used to carry ProtocolMessages from front handler to event processor
*/
public
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
server
/
netty
/
NettyAcceptor.java
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
server
/
netty
/
MoquetteIdleTimeoutHandler.java
Go to definition
R
Copy path
Cannot retrieve contributors at this time
34 lines (28 sloc)
936 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
Copy path
Cannot retrieve contributors at this time
72 lines (59 sloc)
2.56 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
=
"
\"
$arg
\"
"
fi
i=
$((
i
+
1
))
done
case
$i
in
(0)
set
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
123 lines (112 sloc)
4.9 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
/
OutputMessagingEvent.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
The SSL context has been initialized successfully.
"
);
return
sslContext;
}
catch
(
GeneralSecurityException
|
IOException
ex) {
LOG
.
error(
"
Unable to initialize SSL context.
"
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
* Used to send the ack message back to the client after a publish
*/
public
class
PubAckEvent
extends
MessagingEvent
{
int
m_messageId;
String
m_clientID;
public
import
io.netty.util.AttributeKey
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
public
class
MessageMetricsHandler
extends
ChannelDuplexHandler
{
private
static
final
AttributeKey<
MessageMetrics
, dialog_id);
}
});
}
catch
(
MqttException
e) {
e
.
printStackTrace();
}
try
{
client
.
subscribe(
"
/exit
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"Licensed Patents " mean patent
claims licensable by a Contributor which are necessarily infringed by the use
or sale of its Contribution alone or when combined with the Program.
</
span
>
;
import
java.util.Collection
;
import
java.util.List
;
public
interface
ISubscriptionsStore
{
/**
* Add a new subscription to the session
*
*
@param
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.List
;
import static
io.moquette.spi.impl.Utils.messageId
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
/**
*
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
@
rem
Get command-line arguments, handling Windows variants
if
not
"
%OS%
"
==
"
Windows_NT
"
goto
win9xME_args
if
"
%@eval[2+2]
"
getClientID()
==
null
) {
throw
new
IllegalArgumentException
(
"
Message to be persisted must have a not null client ID
"
);
throw
new
IllegalArgumentException
(
"
{
public
abstract
static
class
EnqueuedMessage
{
}
static
class
PublishedMessage
extends
EnqueuedMessage
{
@@ -61,10 +60,12 @@
private
</
h2
>
<
p
>
June 11, 2014
</
p
>
<
h3
>
License
</
h3
>
<
m_qos;
//
byte[] m_message;
ByteBuffer
m_message;
boolean
m_retain;
String
m_clientID;
//
Optional attribute, available only fo QoS 1 and 2
int
m_msgID;
transient
ServerChannel
m_session;
public
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
*Event used to push work request on the SimpleMessaging.
*
*
@author
andrea
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
* Used to model the connection lost event
*
*
@author
andrea
*/
public
class
LostConnectionEvent
extends
MessagingEvent
{
void
waitingAck
(
int
messageID
,
IMessagesStore
.
StoredMessage
msg
) {
if
(
LOG
.
isTraceEnabled()) {
LOG
class
ProtocolEvent
extends
MessagingEvent
{
ServerChannel
m_session;
AbstractMessage
message;
public
ProtocolEvent
(
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
406 lines (365 sloc)
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
54 lines (48 sloc)
2.04 KB
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
java.util.Properties
;
/**
*/
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.server.netty.metrics
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelDuplexHandler
;
import
-- ;;
(1)
set
--
"
$args0
"
;;
(2)
set
--
"
$args0
"
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.server.netty
;
import
io.moquette.spi.impl.ProtocolProcessor
;
43 lines (36 sloc)
1.21 KB
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
, ex);
return
null
;
}
}
private
KeyStore
loadKeyStore
()
throws
IOException
,
GeneralSecurityException
{
PubAckEvent
(
int
messageID
,
String
clientID
) {
m_messageId
=
messageID ;
m_clientID
=
clientID;
}
public
int
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
"
MessageMetrics
"
);
private
MessageMetricsCollector
m_collector;
public
MessageMetricsHandler
(
MessageMetricsCollector
"
+
dialog_id,
1
,
null
,
new
IMqttActionListener
() {
@Override
public
void
onFailure
(
IMqttToken
asyncActionToken2
,
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"Program" means the Contributions
distributed in accordance with this Agreement.
</
span
>
newSubscription
* the subscription to add.
*/
void
addNewSubscription
(
Subscription
newSubscription
);
/**
* Removed a specific subscription
*
*
@param
topic
* the topic of the subscription.
*
*
@author
andrea
*/
@Sharable
public
class
MQTTMessageLogger
extends
ChannelDuplexHandler
{
private
static
final
Logger
LOG
=
LoggerFactory
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
==
"
4
"
goto
4NT_args
:
win9xME_args
@
rem
Slurp the command line arguments.
@@ -60,11 +59,6 @@ set _SKIP=2
if
"
x%
~1
"
Message to be persisted must have a not null client ID
"
);
}
m_retainedStore
.
put(topic, storedMessage);
}
3
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
Show comments
View file
Edit file
Delete file
@@ -33,7 +33,7 @@
final
ConcurrentMap<
String
,
Session
>
pool
=
new
ConcurrentHashMap<>
();
private
final
ISubscriptionsDirectory
subscriptionsDirectory;
private
final
p
>
The Eclipse Foundation makes available all content in this plug-in (&quot;Moquette MQTT&quot;). Unless otherwise
indicated below, the Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
PublishEvent
(
PublishMessage
pubMsg
,
String
clientID
,
ServerChannel
session
) {
m_topic
=
pubMsg
.
getTopicName();
m_qos
=
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
*/
public
abstract
class
MessagingEvent
{
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
private
String
m_clientID;
public
LostConnectionEvent
(
String
clienID
) {
m_clientID
=
clienID;
}
public
String
getClientID
() {
.
trace(
"
"
, messageID, msg
.
getGuid());
}
sessionsStore
.
inFlight(clientID, messageID, msg);
}
IMessagesStore
.
StoredMessage
acknowledged
(
int
messageID
ServerChannel
session
,
AbstractMessage
message
) {
this
.
m_session
=
session;
this
.
message
=
message;
}
public
20.1 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
public
final
class
InitEvent
extends
MessagingEvent
{
private
Properties
config;
public
InitEvent
(
Properties
config
) {
this
.
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelPromise
;
import
io.netty.util.Attribute
;
import
io.netty.util.AttributeKey
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
public
class
BytesMetricsHandler
extends
"
$args1
"
;;
(3)
set
--
"
$args0
"
"
$args1
"
"
$args2
"
;;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelInboundHandlerAdapter
;
import
io.netty.handler.codec.mqtt.*
;
import
io.netty.util.ReferenceCountUtil
;
import
org.slf4j.Logger
;
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
/**
*
*
@author
final
String
jksPath
=
props
.
getProperty(
BrokerConstants
.
JKS_PATH_PROPERTY_NAME
);
LOG
.
info(
"
Initializing SSL context. KeystorePath = {}.
"
, jksPath);
getMessageId
() {
return
m_messageId;
}
public
String
getClientID
() {
return
m_clientID;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
collector
) {
m_collector
=
collector;
}
@Override
public
void
channelActive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
Throwable
exception
) {
try
{
client
.
disconnect();
}
catch
(
MqttException
e) {
e
.
printStackTrace();
}
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"Recipient" means anyone who
receives the Program under this Agreement, including all Contributors.
</
span
@param
clientID
* the session client.
*/
void
removeSubscription
(
Topic
topic
,
String
clientID
);
/**
.
getLogger(
"
messageLogger
"
);
@Override
public
void
channelRead
(
ChannelHandlerContext
ctx
,
Object
message
) {
==
"
x
"
goto
execute
set
CMD_LINE_ARGS
=
%
*
goto
execute
:
4NT_args
@
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
MemorySessionStore
.
class);
class
Session
{
static
IQueueRepository
queueRepository;
private
final
ConcurrentMap<
String
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
>
queues
=
new
ConcurrentHashMap<>
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
<
p
>
If you did not receive this Content directly from the Eclipse Foundation, the Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
indicated below, the terms and conditions of the EPL still apply to any source code in the Content
and such source code may be obtained at
<
a
href
pubMsg
.
getQos();
m_message
=
pubMsg
.
getPayload();
m_retain
=
pubMsg
.
isRetainFlag();
m_clientID
=
clientID;
m_session
=
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
return
m_clientID;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
) {
if
(
LOG
.
isTraceEnabled()) {
LOG
.
trace(
"
"
, clientID, messageID);
}
return
sessionsStore
.
inFlightAck(clientID, messageID);
}
ServerChannel
getSession
() {
return
m_session;
}
public
AbstractMessage
getMessage
() {
return
message;
}
@Override
public
package
io.moquette.server.netty
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.ServerAcceptor
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.server.netty.metrics.*
;
import
*/
package
io.moquette.server.netty
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
config
=
config;
}
public
Properties
getConfig
() {
return
config;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
ChannelDuplexHandler
{
private
static
final
AttributeKey<
BytesMetrics
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
"
BytesMetrics
"
(4)
set
--
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
;;
(5)
set
--
import
org.slf4j.LoggerFactory
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_MOST_ONCE
;
@Sharable
public
class
NettyMQTTHandler
extends
ChannelInboundHandlerAdapter
{
private
static
final
andrea
*/
public
class
OutputMessagingEvent
extends
MessagingEvent
{
private
ServerChannel
m_channel;
private
AbstractMessage
m_message;
public
OutputMessagingEvent
(
if
(jksPath
==
null
||
jksPath
.
isEmpty()) {
//
key_store_password or key_manager_password are empty
LOG
.
warn(
"
The keystore path is null or empty. The SSL context won't be initialized.
"
);
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
Attribute<
MessageMetrics
>
attr
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
);
attr
.
set(
new
MessageMetrics
m_latch
.
countDown();
}
@Override
public
void
onSuccess
(
IMqttToken
asyncActionToken2
) {
LOG
.
info(
"
SUB: subscribed to /exit{} qos: 1
"
, dialog_id);
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
2. GRANT OF RIGHTS
* Remove all the subscriptions of the session
*
*
@param
clientID
* the client ID
*/
void
wipeSubscriptions
(
String
clientID
);
/**
* Return all topic filters to recreate the subscription tree.
*/
List<
logMQTTMessage(ctx, message,
"
C->B
"
);
ctx
.
fireChannelRead(message);
}
private
void
logMQTTMessage
(
ChannelHandlerContext
ctx
,
rem
Get arguments from the 4NT Shell from JP Software
set
CMD_LINE_ARGS
=
%$
:
execute
@
rem
Setup the command line
Toggle all file notes
0 comments on commit
7267264
Please
sign in
class
Session
{
final
String
clientID;
final
Map<
Topic
,
Subscription
>
subscriptions
=
new
ConcurrentHashMap<>
();
boolean
();
SessionRegistry
(
ISubscriptionsDirectory
subscriptionsDirectory
,
BrokerInterceptor
m_interceptor
) {
SessionRegistry
(
ISubscriptionsDirectory
subscriptionsDirectory
,
IQueueRepository
queueRepository
) {
="
http://www.eclipse.org/
"
>
http://www.eclipse.org
</
a
>
.
</
p
>
</
body
>
</
html
>
session;
if
(pubMsg
.
getQos()
!=
QOSType
.
MOST_ONE
) {
m_msgID
=
pubMsg
.
getMessageID();
}
}
public
PublishEvent
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
}
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DurableSession
.
class);
private
final
ISessionsStore
sessionsStore;
String
toString
() {
return
"
ProtocolEvent wrapping
"
+
Utils
.
msgType2String(message
.
getMessageType());
}
}
Copy lines
Copy permalink
io.moquette.spi.impl.ProtocolProcessor
;
import
io.moquette.spi.security.ISslContextCreator
;
import
io.netty.bootstrap.ServerBootstrap
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.channel.*
;
import
io.netty.channel.epoll.EpollEventLoopGroup
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.handler.timeout.IdleState
;
import
io.netty.handler.timeout.IdleStateEvent
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
@Sharable
class
MoquetteIdleTimeoutHandler
extends
ChannelDuplexHandler
{
private
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
);
private
BytesMetricsCollector
m_collector;
public
BytesMetricsHandler
(
BytesMetricsCollector
collector
) {
m_collector
=
collector;
}
@Override
public
void
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
"
;;
(6)
Logger
LOG
=
LoggerFactory
.
getLogger(
NettyMQTTHandler
.
class);
private
final
ProtocolProcessor
m_processor;
public
NettyMQTTHandler
(
ServerChannel
channel
,
AbstractMessage
message
) {
m_channel
=
channel;
m_message
=
message;
}
public
ServerChannel
getChannel
() {
return
return
null
;
}
//
if we have the port also the jks then keyStorePassword and keyManagerPassword
//
has to be defined
final
String
keyStorePassword
=
props
.
getProperty(
BrokerConstants
.
KEY_STORE_PASSWORD_PROPERTY_NAME
);
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
());
super
.
channelActive(ctx);
}
@Override
public
void
channelRead
(
ChannelHandlerContext
ctx
,
Object
msg
)
throws
Exception
}
});
}
catch
(
MqttException
e) {
e
.
printStackTrace();
}
}
</
span
>
</
b
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
Subscription
>
listAllSubscriptions
();
/**
* Load from storage all the subscriptions of the specified client.
*
*/
Collection<
Subscription
>
listClientSubscriptions
(
String
clientID
);
/**
*
@param
Object
message
,
String
direction
) {
if
(
!
(message
instanceof
MqttMessage
)) {
return
;
}
MqttMessage
msg
=
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
cleanSession;
@@ -170,7 +170,6 @@ public Subscription reload(Subscription subcription) {
return
subscriptions
.
get(subcription
.
getTopicFilter());
}
@Override
public
StoredMessage
inFlightAck
(
String
this
.
subscriptionsDirectory
=
subscriptionsDirectory;
this
.
queueRepository
=
queueRepository;
}
void
bindToSession
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMatchingCondition.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
(
String
topic
,
QOSType
qos
,
ByteBuffer
message
,
boolean
retain
,
String
clientID
,
ServerChannel
session
) {
m_topic
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
private
final
ISubscriptionsStore
subscriptionsStore;
private
final
OutboundFlightZone
outboundFlightZone;
private
final
InboundFlightZone
inboundFlightZone;
public
DurableSession
(
String
clientID
,
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
io.netty.channel.epoll.EpollServerSocketChannel
;
import
io.netty.channel.nio.NioEventLoopGroup
;
import
io.netty.channel.socket.ServerSocketChannel
;
import
io.netty.channel.socket.SocketChannel
;
import
io.netty.channel.socket.nio.NioServerSocketChannel
;
import
io.netty.handler.codec.MessageToMessageDecoder
;
import
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
MoquetteIdleTimeoutHandler
.
class);
@Override
public
void
userEventTriggered
(
ChannelHandlerContext
ctx
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
channelActive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
Attribute<
BytesMetrics
>
attr
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
);
set
--
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
"
"
ProtocolProcessor
processor
) {
m_processor
=
processor;
}
@Override
public
void
channelRead
(
ChannelHandlerContext
ctx
,
Object
message
) {
m_channel;
}
public
AbstractMessage
getMessage
() {
return
m_message;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
final
String
keyManagerPassword
=
props
.
getProperty(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
);
if
(keyStorePassword
==
null
||
keyStorePassword
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
{
MessageMetrics
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
get();
metrics
.
incrementRead(
1
});
}
public
void
waitFinish
()
throws
InterruptedException
,
MqttException
{
this
.
m_latch
.
await();
this
.
"
>
<
span
style
="
font-size: 10pt;
"
>
a)
Subject to the terms of this Agreement, each Contributor hereby grants Recipient
a non-exclusive, worldwide, royalty-free copyright license to
<
span
style
="
color: red;
subcription
* the subscription to reaload from storage.
*
@return
the subscription stored by clientID and topicFilter, if any else null;
*/
Subscription
reload
(
Subscription
subcription
);
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
(
MqttMessage
) message;
String
clientID
=
NettyUtils
.
clientID(ctx
.
channel());
MqttMessageType
messageType
=
msg
.
fixedHeader()
.
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
clientID
,
int
messageID
) {
return
getSession(clientID)
.
outboundFlightMessages
.
remove(messageID);
10
broker/src/main/java/io/moquette/server/ConnectionDescriptor.java
Show comments
View file
Edit file
Delete file
msg
,
String
clientId
) {
@@ -178,9 +179,9 @@ private void unsubscribe(Session session) {
}
private
Session
createNewSession
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
msg
,
String
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
/**
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMessaging.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
=
topic;
m_qos
=
qos;
m_message
=
message;
m_retain
=
retain;
m_clientID
=
clientID;
m_session
=
session;
Learn more
Accept
Reject
Save preferences
ISessionsStore
sessions
,
ISubscriptionsStore
subscriptionsStore
) {
super
(clientID);
this
.
subscriptionsStore
=
subscriptionsStore;
this
.
sessionsStore
=
sessions;
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
io.netty.handler.codec.MessageToMessageEncoder
;
import
io.netty.handler.codec.http.HttpObjectAggregator
;
import
io.netty.handler.codec.http.HttpRequestDecoder
;
import
io.netty.handler.codec.http.HttpResponseEncoder
;
import
io.netty.handler.codec.http.HttpServerCodec
;
import
io.netty.handler.codec.http.websocketx.BinaryWebSocketFrame
;
import
,
Object
evt
)
throws
Exception
{
if
(evt
instanceof
IdleStateEvent
) {
IdleState
e
=
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
attr
.
set(
new
BytesMetrics
());
super
.
channelActive(ctx);
}
@Override
public
void
channelRead
(
ChannelHandlerContext
ctx
$args5
"
;;
(7)
set
--
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
MqttMessage
msg
=
(
MqttMessage
) message;
MqttMessageType
messageType
=
msg
.
fixedHeader()
.
messageType();
LOG
.
debug(
"
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
isEmpty()) {
//
key_store_password or key_manager_password are empty
LOG
.
warn(
"
The keystore password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
if
(keyManagerPassword
==
null
||
);
ctx
.
fireChannelRead(msg);
}
@Override
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
client
.
disconnect(
1000
);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
"
>
</
span
>
reproduce, prepare derivative works of, publicly
display, publicly perform, distribute and sublicense the Contribution of such
Contributor, if any, and such derivative works, in source code and object code
form.
</
span
>
</
p
>
<
p
class
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
messageType();
switch
(messageType) {
case
CONNECT
:
case
CONNACK
:
case
PINGREQ
:
case
PINGRESP
:
case
DISCONNECT
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
@@ -29,6 +29,10 @@
import
io.moquette.server.netty.metrics.MessageMetricsHandler
;
import
io.netty.channel.Channel
;
import static
io.netty.channel.ChannelFutureListener.CLOSE
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
clientId
) {
final
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
=
queues
.
computeIfAbsent(clientId, (
String
cli)
-
>
new
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
}
public
PublishEvent
(
String
topic
,
QOSType
qos
,
ByteBuffer
message
,
boolean
retain
,
String
clientID
,
moquette/ConfigurationParser.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
moquette/InterceptConnectMessage.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
moquette/MemorySessionStore.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
moquette/FileResourceLoader.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
moquette/ClasspathResourceLoader.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
this
.
outboundFlightZone
=
new
OutboundFlightZone
();
this
.
inboundFlightZone
=
new
InboundFlightZone
();
}
public
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler
;
import
io.netty.handler.codec.mqtt.MqttDecoder
;
import
io.netty.handler.codec.mqtt.MqttEncoder
;
import
io.netty.handler.ssl.SslHandler
;
import
io.netty.handler.timeout.IdleStateHandler
;
import
io.netty.util.concurrent.Future
;
import
io.netty.util.concurrent.GenericFutureListener
((
IdleStateEvent
) evt)
.
state();
if
(e
==
IdleState
.
READER_IDLE
) {
LOG
.
info(
"
Firing channel inactive event. MqttClientId = {}.
"
moquette/ConnectionDescriptor.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
,
Object
msg
)
throws
Exception
{
BytesMetrics
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
"
$args4
"
"
$args5
"
"
$args6
"
;;
(8)
set
--
"
$args0
"
"
$args1
Processing MQTT message, type={}
"
, messageType);
try
{
switch
(messageType) {
case
CONNECT
:
m_processor
.
processConnect(ctx
.
channel(), (
MqttConnectMessage
) msg);
break
moquette/MemoryMessagesStore.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
keyManagerPassword
.
isEmpty()) {
//
key_manager_password or key_manager_password are empty
LOG
.
warn(
"
The key manager password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
String
ksType
=
)
throws
Exception
{
MessageMetrics
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
get();
metrics
.
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
b)
Subject to the terms of this Agreement, each Contributor hereby grants
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
:
LOG
.
info(
"
"
, direction, messageType, clientID);
break
;
case
SUBSCRIBE
:
MqttSubscribeMessage
subscribe
=
(
MqttSubscribeMessage
) msg;
/**
* Value object to maintain the information of single connection, like ClientID, Channel, and clean
* session flag.
@@ -62,7 +66,7 @@ public ConnectionDescriptor(String clientID, Channel session, boolean cleanSessi
}
public
void
writeAndFlush
(
Object
payload
) {
this
.
channel
.
writeAndFlush(payload);
ConcurrentLinkedQueue<>
());
final
boolean
clean
=
msg
.
variableHeader()
.
isCleanSession();
final
Queue<
SessionRegistry
.
EnqueuedMessage
>
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IPersistentSubscriptionStore.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
int
msgID
,
ServerChannel
session
) {
this
(topic, qos, message, retain, clientID, session);
m_msgID
=
msgID;
}
public
String
getTopic
() {
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
void
reloadAllSubscriptionsFromStore
() {
Collection<
Subscription
>
reloadedSubscriptions
=
this
.
subscriptionsStore
.
listClientSubscriptions(
this
.
clientID);
this
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
javax.net.ssl.SSLContext
;
import
javax.net.ssl.SSLEngine
;
import
java.io.IOException
;
import
java.util.List
,
NettyUtils
.
clientID(ctx
.
channel()));
//
fire a channelInactive to trigger publish of Will
ctx
.
fireChannelInactive();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
get();
metrics
.
incrementRead(((
ByteBuf
) msg)
.
readableBytes());
ctx
.
fireChannelRead(msg);
}
@Override
public
void
write
"
"
$args2
"
"
$args3
"
"
$args4
"
"
$args5
"
"
$args6
"
"
$args7
;
case
SUBSCRIBE
:
m_processor
.
processSubscribe(ctx
.
channel(), (
MqttSubscribeMessage
) msg);
break
;
case
UNSUBSCRIBE
:
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
moquette/HazelcastInterceptHandler.java at 033a428184ce1e8a134fda082c04346ac6858c61 · moquette-io/moquette · GitHub
props
.
getProperty(
BrokerConstants
.
KEY_STORE_TYPE
,
"
jks
"
);
final
KeyStore
keyStore
=
KeyStore
.
getInstance(ksType);
incrementWrote(
1
);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
);
}
@Override
public
void
close
(
ChannelHandlerContext
ctx
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Recipient a non-exclusive, worldwide,
<
span
style
="
color: green;
"
>
</
span
>
royalty-free
patent license under Licensed Patents to make, use, sell, offer to sell, import
and otherwise transfer the Contribution of such Contributor, if any, in source
code and object code form. This patent license shall apply to the combination
of the Contribution and the Program if, at the time the Contribution is added
by the Contributor, such addition of the Contribution causes such combination
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
LOG
.
info(
"
"
, direction, clientID,
subscribe
.
payload()
.
topicSubscriptions());
break
;
case
UNSUBSCRIBE
:
MqttUnsubscribeMessage
unsubscribe
this
.
channel
.
writeAndFlush(payload)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
)
;
}
public
void
setupAutoFlusher
(
int
flushIntervalMs
) {
sessionQueue
=
queues
.
computeIfAbsent(clientId, (
String
cli)
-
>
queueRepository
.
createQueue(cli, clean));
final
Session
newSession;
if
(msg
.
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
import
java.util.List
return
m_topic;
}
public
QOSType
getQos
() {
return
m_qos;
}
public
ByteBuffer
getMessage
() {
return
m_message;
}
public
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
.
subscriptions
.
addAll(reloadedSubscriptions);
}
@Override
public
boolean
isCleanSession
() {
return
false
;
}
@Override
public
boolean
subscribe
;
import
java.util.Optional
;
import
java.util.concurrent.TimeUnit
;
import static
io.moquette.BrokerConstants.*
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
public
class
NettyAcceptor
implements
ServerAcceptor
}
}
else
{
if
(
LOG
.
isDebugEnabled()) {
LOG
.
debug(
"
"
,
NettyUtils
.
moquette/DisconnectEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
moquette/ValueEvent.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
moquette/SimpleMessaging.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
moquette/ProtocolProcessor.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
moquette/MemoryStorageService.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
BytesMetrics
metrics
=
ctx
.
channel()
"
;;
(9)
set
--
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
m_processor
.
processUnsubscribe(ctx
.
channel(), (
MqttUnsubscribeMessage
) msg);
break
;
case
PUBLISH
:
m_processor
.
processPublish(ctx
.
channel(), (
MqttPublishMessage
) msg);
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
LOG
.
info(
"
Loading keystore. KeystorePath = {}.
"
, jksPath);
try
(
InputStream
jksInputStream
=
,
ChannelPromise
promise
)
throws
Exception
{
MessageMetrics
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
to be covered by the Licensed Patents. The patent license shall not apply to
any other combinations which include the Contribution. No hardware per se is
licensed hereunder.
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
=
(
MqttUnsubscribeMessage
) msg;
LOG
.
info(
"
"
, direction, clientID, unsubscribe
.
payload()
.
topics());
break
;
case
PUBLISH
@@ -88,7 +92,7 @@ public boolean close() {
if
(
!
success) {
return
false
;
}
this
.
channel
.
close();
this
.
channel
variableHeader()
.
isWillFlag()) {
final
Session
.
Will
will
=
createWill(msg);
5
broker/src/main/java/io/moquette/persistence/H2Builder.java
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,7 @@
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
boolean
isRetain
() {
return
m_retain;
}
public
String
getClientID
() {
return
m_clientID;
}
public
int
getMessageID
() {
return
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
(
Subscription
newSubscription
) {
LOG
.
info(
"
"
, newSubscription
.
getClientId(),
newSubscription
.
getTopicFilter(), newSubscription
.
getRequestedQos());
boolean
validTopic
=
{
private
static
final
String
MQTT_SUBPROTOCOL_CSV_LIST
=
"
mqtt, mqttv3.1, mqttv3.1.1
"
;
static
class
WebSocketFrameToByteBufDecoder
extends
MessageToMessageDecoder<
BinaryWebSocketFrame
>
{
clientID(ctx
.
channel()),
evt
.
getClass()
.
getName());
}
super
.
userEventTriggered(ctx, evt);
}
}
}
Copy lines
Copy permalink
View git blame
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
.
attr(
ATTR_KEY_METRICS
)
.
get();
metrics
.
incrementWrote(((
ByteBuf
) msg)
.
writableBytes());
ctx
.
write(msg, promise)
.
"
"
$args5
"
"
$args6
"
"
$args7
"
"
$args8
"
;;
esac
fi
#
Escape application args
save
break
;
case
PUBREC
:
m_processor
.
processPubRec(ctx
.
channel(), msg);
break
;
case
PUBCOMP
:
m_processor
.
processPubComp(ctx
Fixed checkStyle and ErrorProne warns · moquette-io/moquette@033a428 · GitHub
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
jksDatastore(jksPath)) {
keyStore
.
load(jksInputStream, keyStorePassword
.
toCharArray());
}
return
keyStore;
}
//
if client authentification is enabled a trustmanager needs to be
//
added to the ServerContext
String
sNeedsClientAuth
=
.
get();
m_collector
.
sumReadMessages(metrics
.
messagesRead());
m_collector
.
sumWroteMessages(metrics
.
messagesWrote());
super
.
close(ctx, promise);
}
public
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
c)
Recipient understands that although each Contributor grants the licenses to its
Contributions set forth herein, no assurances are provided by any Contributor
that the Program does not infringe the patent or other intellectual property
rights of any other entity. Each Contributor disclaims any liability to Recipient
for claims brought by any other entity based on infringement of intellectual
property rights or otherwise. As a condition to exercising the rights and
:
MqttPublishMessage
publish
=
(
MqttPublishMessage
) msg;
LOG
.
info(
"
"
, direction, clientID, publish
.
variableHeader()
.
topicName());
break
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
return
true
;
}
@@ -100,7 +104,7 @@ public void abort() {
LOG
.
info(
"
Closing connection descriptor. MqttClientId = {}.
package
io.moquette.persistence
;
import
io.moquette.BrokerConstants
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.config.IConfig
;
import
org.h2.mvstore.MVStore
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
import
java.nio.ByteBuffer
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/DebugUtils.java
Show comments
View file
Edit file
m_msgID;
}
public
ServerChannel
getSession
() {
return
m_session;
}
@Override
public
String
toString
() {
return
"
PublishEvent{
"
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
newSubscription
.
getTopicFilter()
.
isValid();
if
(
!
validTopic) {
LOG
.
warn(
"
"
, newSubscription
.
getClientId(),
newSubscription
.
@Override
protected
void
decode
(
ChannelHandlerContext
chc
,
BinaryWebSocketFrame
frame
,
List<
Object
>
out
)
throws
Exception
{
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Fixed checkStyle and ErrorProne warns · moquette-io/moquette@033a428 · GitHub
moquette/HawtDBStorageService.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
addListener(
CLOSE_ON_FAILURE
);
}
@Override
public
void
close
(
ChannelHandlerContext
ctx
,
ChannelPromise
promise
)
throws
Exception
{
BytesMetrics
() {
for
i
do
printf
%s
\\
n
"
$i
"
|
sed
"
s/'/'
\\\\
''/g;1s/^/'/;
.
channel(), msg);
break
;
case
PUBREL
:
m_processor
.
processPubRel(ctx
.
channel(), msg);
break
;
case
DISCONNECT
:
m_processor
.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
props
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
boolean
needsClientAuth
=
Boolean
.
valueOf(sNeedsClientAuth);
private
static
MessageMetrics
getMessageMetrics
(
Channel
channel
) {
return
channel
.
attr(
ATTR_KEY_METRICS
)
.
get();
}
}
Copy lines
licenses granted hereunder, each Recipient hereby assumes sole responsibility
to secure any other intellectual property rights needed, if any. For example,
if a third party patent license is required to allow Recipient to distribute
the Program, it is Recipient's responsibility to acquire that license before
distributing the Program.
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
;
case
PUBREC
:
case
PUBCOMP
:
case
PUBREL
:
case
PUBACK
:
case
UNSUBACK
:
LOG
"
, clientID);
//
try {
//
this.channel.disconnect().sync();
this
.
channel
.
close();
//
.sync();
this
.
channel
.
close()
.
;
@@ -52,4 +53,8 @@ public ISubscriptionsRepository subscriptionsRepository() {
public
void
closeStore
() {
mvStore
.
close();
}
public
IQueueRepository
queueRepository
() {
return
new
H2QueueRepository
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
+
"
m_msgID=
"
+
m_msgID
+
"
, m_clientID='
"
+
m_clientID
+
'
\'
'
+
"
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
getTopicFilter());
//
send SUBACK with 0x80 for this topic filter
return
false
;
}
Subscription
existingSub
=
subscriptionsStore
.
reload(newSubscription);
//
update the selected subscriptions if not present or if has a greater qos
if
(existingSub
==
//
convert the frame to a ByteBuf
ByteBuf
bb
=
frame
.
content();
//
System.out.println("WebSocketFrameToByteBufDecoder decode - " +
//
ByteBufUtil.hexDump(bb));
bb
.
retain();
out
.
add(bb);
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
get();
m_collector
.
sumReadBytes(metrics
.
readBytes());
\$
s/
\$
/'
\\\\
/
"
;
done
echo
"
"
}
APP_ARGS=
$(
save
"
processDisconnect(ctx
.
channel());
break
;
case
PUBACK
:
m_processor
.
processPubAck(ctx
.
channel(), (
MqttPubAckMessage
) msg);
break
;
case
PINGREQ
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
static
SslContextBuilder
builderWithJdkProvider
(
KeyStore
ks
,
String
keyPassword
)
throws
GeneralSecurityException
{
LOG
.
info(
"
Initializing key manager...
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
d)
Each Contributor represents that to its knowledge it has sufficient copyright
rights in its Contribution, if any, to grant the copyright license set forth in
.
info(
"
"
, direction, messageType, clientID, messageId(msg));
break
;
case
SUBACK
:
MqttSubAckMessage
suback
=
(
MqttSubAckMessage
) msg;
final
List<
addListener(
CLOSE_ON_FAILURE
)
;
//
.sync();
//
} catch (InterruptedException e) {
//
e.printStackTrace();
//
}
4
broker/src/main/java/io/moquette/server/config/ClasspathResourceLoader.java
Show comments
View file
Edit file
(mvStore);
}
}
3
...tte/persistence/h2/H2PersistentQueue.java → ...quette/persistence/H2PersistentQueue.java
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.persistence
.h2
;
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.nio.ByteBuffer
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticator.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
, m_retain=
"
+
m_retain
+
"
, m_qos=
"
+
m_qos
+
"
, m_topic='
"
+
m_topic
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
main
/
java
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
main
/
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
null
||
existingSub
.
qosLessThan(newSubscription)) {
if
(existingSub
!=
null
) {
LOG
.
info(
"
Subscription already existed with a lower QoS value. It will be updated. CId={},
"
+
"
}
}
static
class
ByteBufToWebSocketFrameEncoder
extends
MessageToMessageEncoder<
ByteBuf
>
{
@Override
protected
void
encode
(
ChannelHandlerContext
chc
,
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
/
broker
/
src
/
m_collector
.
sumWroteBytes(metrics
.
wroteBytes());
super
.
close(ctx, promise);
}
public
static
BytesMetrics
getBytesMetrics
(
Channel
channel
) {
$@
"
)
#
Collect all arguments for the java command, following the shell quoting and substitution rules
eval
set
--
$DEFAULT_JVM_OPTS
$JAVA_OPTS
$GRADLE_OPTS
"
\"
-Dorg.gradle.appname=
$APP_BASE_NAME
\"
"
-classpath
:
MqttFixedHeader
pingHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PINGRESP
,
false
,
AT_MOST_ONCE
,
false
,
0
);
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
moquette
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
"
);
final
KeyManagerFactory
kmf
=
KeyManagerFactory
.
getInstance(
KeyManagerFactory
.
getDefaultAlgorithm());
kmf
.
init(ks, keyPassword
.
toCharArray());
LOG
.
info(
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
this Agreement.
</
span
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
Integer
>
grantedQoSLevels
=
suback
.
payload()
.
grantedQoSLevels();
LOG
.
info(
"
"
, direction, clientID, messageId(msg),
grantedQoSLevels);
break
;
}
Delete file
@@ -19,6 +19,8 @@
import
java.io.InputStream
;
import
java.io.InputStreamReader
;
import
java.io.Reader
;
import
java.nio.charset.StandardCharsets
;
import
package
io.moquette.persistence
;
import
org.h2.mvstore.MVMap
;
import
org.h2.mvstore.MVStore
;
@@ -88,6 +88,7 @@ public T poll() {
}
final
long
nextTail
=
tail
.
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
+
'
\'
'
+
'
}
'
;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
moquette
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
server
/
config
/
ConfigurationParser.java
/
io
/
moquette
/
interception
/
messages
/
InterceptConnectMessage.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
java
/
io
/
moquette
/
persistence
/
MemorySessionStore.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
main
/
java
/
io
/
moquette
/
server
/
config
/
FileResourceLoader.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
/
main
/
java
/
io
/
moquette
/
server
/
config
/
ClasspathResourceLoader.java
/
Jump to
Code definitions
No definitions found in this file.
"
, newSubscription
.
getClientId(),
newSubscription
.
getTopicFilter(), existingSub
.
getRequestedQos(), newSubscription
.
getRequestedQos());
subscriptions
.
remove(newSubscription);
}
ByteBuf
bb
,
List<
Object
>
out
)
throws
Exception
{
//
convert the ByteBuf to a WebSocketFrame
BinaryWebSocketFrame
result
=
new
BinaryWebSocketFrame
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
main
/
java
/
io
/
moquette
/
server
/
ConnectionDescriptor.java
/
Jump to
Code definitions
return
channel
.
attr(
ATTR_KEY_METRICS
)
.
get();
}
}
"
\"
$CLASSPATH
\"
"
org.gradle.wrapper.GradleWrapperMain
"
$APP_ARGS
"
#
by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
if
MqttMessage
pingResp
=
new
MqttMessage
(pingHeader);
ctx
.
writeAndFlush(pingResp)
.
addListener(
CLOSE_ON_FAILURE
);
break
;
default
:
LOG
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
persistence
/
MemoryMessagesStore.java
/
Jump to
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
033a428184
"
Initializing SSL context...
"
);
return
SslContextBuilder
.
forServer(kmf);
}
try
{
LOG
.
info(
"
Loading keystore. KeystorePath = {}.
"
, jksPath);
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
>
3. REQUIREMENTS
</
span
>
</
b
>
</
p
>
<
p
>
<
span
}
@Override
public
void
channelInactive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
String
clientID
=
NettyUtils
.
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
@@ -51,7 +53,7 @@ public Reader loadDefaultResource() {
public
Reader
loadResource
(
String
relativePath
) {
LOG
.
info(
"
getAndIncrement();
final
T
tail
=
this
.
queueMap
.
get(nextTail);
queueMap
.
remove(nextTail);
this
.
metadataMap
.
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.io.BufferedReader
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
121 lines (110 sloc)
3.87 KB
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
87 lines (67 sloc)
2.26 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
302 lines (254 sloc)
10.2 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
88 lines (72 sloc)
2.54 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
64 lines (51 sloc)
1.94 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
subscriptions
.
add(newSubscription);
subscriptionsStore
.
addNewSubscription(newSubscription);
}
return
true
;
}
@Override
public
void
unsubscribeFrom
(
Topic
topicFilter
();
//
System.out.println("ByteBufToWebSocketFrameEncoder encode - " +
//
ByteBufUtil.hexDump(bb));
result
.
content()
.
writeBytes(bb);
out
.
add(result);
}
}
abstract
static
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
/
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
/
java
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
/
java
/
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
/
java
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
165 lines (143 sloc)
5.66 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
[
"
$(
uname
)
"
=
"
Darwin
"
]
&&
[
"
$HOME
"
=
"
$PWD
.
error(
"
Unkonwn MessageType:{}
"
, messageType);
break
;
}
}
catch
(
Throwable
ex) {
LOG
.
error(
"
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
69 lines (55 sloc)
moquette
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
interception
/
HazelcastInterceptHandler.java
InputStream
jksInputStream
=
jksDatastore(jksPath);
SSLContext
serverContext
=
SSLContext
.
getInstance(
"
TLS
"
);
final
KeyStore
ks
style
="
font-size: 10pt;
"
>
A Contributor may choose to distribute the
Program in object code form under its own license agreement, provided that:
</
span
>
</
p
>
<
p
class
="
clientID(ctx
.
channel());
if
(clientID
!=
null
&&
!
clientID
.
isEmpty()) {
LOG
.
info(
"
Loading resource. RelativePath = {}.
"
, relativePath);
InputStream
is
=
this
.
classLoader
.
getResourceAsStream(relativePath);
return
is
!=
null
?
new
InputStreamReader
put(
"
tail
"
, nextTail
+
1
);
return
tail;
}
25
broker/src/main/java/io/moquette/persistence/H2QueueRepository.java
Show comments
View file
Edit file
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.interception.messages
;
import
io.netty.handler.codec.mqtt.MqttConnectMessage
;
import
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.persistence
;
import
io.moquette.server.Constants
;
import
io.moquette.spi.IMessagesStore.StoredMessage
;
import
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.server.config
;
import
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.server.config
;
import
java.io.InputStream
;
) {
LOG
.
info(
"
"
, clientID, topicFilter);
subscriptionsStore
.
removeSubscription(topicFilter, clientID);
Set<
Subscription
>
subscriptionsToRemove
=
new
HashSet<>
();
class
PipelineInitializer
{
abstract
void
init
(
ChannelPipeline
pipeline
)
throws
Exception
;
}
private
static
final
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
events
/
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
ValueEvent.java
/
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
SimpleMessaging.java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
ProtocolProcessor.java
/
Jump to
Code definitions
No definitions found in this file.
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
MemoryStorageService.java
/
Jump to
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.server
;
import
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
"
]
;
then
cd
"
$(
dirname
"
$0
"
)
"
fi
exec
"
$JAVACMD
"
Exception was caught while processing MQTT message, {}
"
, ex
.
getCause(), ex);
ctx
.
fireExceptionCaught(ex);
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
}
finally
{
ReferenceCountUtil
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Fixed checkStyle and ErrorProne warns
Loading branch information
andsel
committed
Apr 26, 2018
1 parent
1a6dd8a
commit
033a428184ce1e8a134fda082c04346ac6858c61
Unified
Split
2.18 KB
Raw
Blame
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
56 lines (47 sloc)
1.95 KB
Raw
Blame
=
KeyStore
.
getInstance(
"
JKS
"
);
ks
.
load(jksInputStream, keyStorePassword
.
toCharArray());
LOG
.
info(
"
Initializing key manager...
"
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
a)
it complies with the terms and conditions of this Agreement; and
</
span
>
Channel closed <{}>
"
, clientID);
}
ctx
.
fireChannelInactive();
}
@Override
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
(is)
:
null
;
return
is
!=
null
?
new
InputStreamReader
(is
,
StandardCharsets
.
UTF_8
)
:
Delete file
@@ -0,0 +1,25 @@
package
io.moquette.persistence
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.SessionRegistry
;
import
org.h2.mvstore.MVStore
java.io.File
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/MemoryStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
package
io.moquette.server.config
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.io.BufferedReader
;
import
java.io.File
;
import
java.io.FileNotFoundException
java.nio.charset.StandardCharsets
;
public
class
InterceptConnectMessage
extends
InterceptAbstractMessage
{
private
final
MqttConnectMessage
msg;
public
InterceptConnectMessage
(
MqttConnectMessage
msg
) {
io.moquette.spi.ISessionsStore
;
import
io.moquette.spi.ISubscriptionsStore
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
import
io.moquette.spi.impl.subscriptions.Topic
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
java.io.File
;
import
java.io.FileNotFoundException
;
import
java.io.FileReader
;
import
java.io.IOException
;
import
java.io.Reader
;
import
java.nio.file.Files
;
import
org.slf4j.Logger
import
java.io.InputStreamReader
;
import
java.io.Reader
;
import
java.nio.charset.StandardCharsets
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
public
class
ClasspathResourceLoader
for
(
Subscription
sub
:
this
.
subscriptions) {
if
(sub
.
getTopicFilter()
.
equals(topicFilter)) {
subscriptionsToRemove
.
add(sub);
}
Logger
LOG
=
LoggerFactory
.
getLogger(
NettyAcceptor
.
class);
EventLoopGroup
m_bossGroup;
EventLoopGroup
m_workerGroup;
BytesMetricsCollector
m_bytesMetricsCollector
=
DisconnectEvent.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
37 lines (30 sloc)
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Fixed checkStyle and ErrorProne warns
Loading branch information
andsel
committed
Apr 26, 2018
1 parent
1a6dd8a
commit
033a428184ce1e8a134fda082c04346ac6858c61
Unified
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
/
java
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
44 lines (37 sloc)
1.23 KB
Raw
Blame
/*
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
223 lines (187 sloc)
9.43 KB
Raw
Blame
/*
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
526 lines (447 sloc)
23.6 KB
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
161 lines (136 sloc)
6.13 KB
Raw
Blame
java.util.NoSuchElementException
;
import
java.util.concurrent.TimeUnit
;
import
java.util.concurrent.atomic.AtomicReference
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
io.moquette.server.netty.AutoFlushHandler
;
import
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
$@
"
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
.
release(msg);
}
}
@Override
public
void
channelInactive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
String
clientID
Showing
81 changed files
with
681 additions
and
425 deletions
.
+3
−1
broker/src/main/java/io/moquette/interception/HazelcastInterceptHandler.java
+4
−2
broker/src/main/java/io/moquette/interception/messages/InterceptConnectMessage.java
+1
−1
package
io.moquette.persistence
;
import
io.moquette.spi.IMatchingCondition
;
import
io.moquette.spi.IMessagesStore
;
import
io.moquette.spi.impl.subscriptions.Topic
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.interception
);
final
KeyManagerFactory
kmf
=
KeyManagerFactory
.
getInstance(
KeyManagerFactory
.
getDefaultAlgorithm());
kmf
.
init(ks, keyManagerPassword
.
toCharArray());
TrustManager
[] trustManagers
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
ChannelPromise
promise
)
throws
Exception
{
logMQTTMessage(ctx, msg,
"
C<-B
"
);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
null
;
}
@Override
13
broker/src/main/java/io/moquette/server/config/ConfigurationParser.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
java.io.FileReader
;
import
java.io.IOException
;
import
java.util.Queue
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
public
class
H2QueueRepository
implements
IQueueRepository
{
private
MVStore
mvStore;
public
H2QueueRepository
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.nio.ByteBuffer
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessor.java
;
import
java.io.FileReader
;
import
java.io.IOException
;
import
java.io.Reader
;
import
java.nio.charset.StandardCharsets
;
import
java.nio.file.Files
;
import
java.text.ParseException
super
(msg);
this
.
msg
=
msg;
}
public
String
getClientID
() {
import
java.time.LocalDateTime
;
import
java.util.*
;
import
java.util.concurrent.*
;
public
;
import
org.slf4j.LoggerFactory
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
public
class
FileResourceLoader
implements
IResourceLoader
{
implements
IResourceLoader
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
ClasspathResourceLoader
.
class);
private
final
String
}
subscriptions
.
removeAll(subscriptionsToRemove);
}
@Override
public
void
cleanSession
() {
sessionsStore
.
removeTemporaryQoS2(
this
.
clientID);
new
BytesMetricsCollector
();
MessageMetricsCollector
m_metricsCollector
=
new
MessageMetricsCollector
();
private
Optional<? extends
ChannelInboundHandler
>
metrics;
1002 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
Split
Showing
81 changed files
with
681 additions
and
425 deletions
.
+3
−1
broker/src/main/java/io/moquette/interception/HazelcastInterceptHandler.java
+4
−2
broker/src/main/java/io/moquette/interception/messages/InterceptConnectMessage.java
+1
−1
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
HawtDBStorageService.java
/
Jump to
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
io.moquette.server.netty.NettyUtils
;
import
io.moquette.server.netty.metrics.BytesMetrics
;
import
io.moquette.server.netty.metrics.BytesMetricsHandler
;
import
io.moquette.server.netty.metrics.MessageMetrics
;
import
io.moquette.server.netty.metrics.MessageMetricsHandler
;
import
io.netty.channel.Channel
;
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
=
NettyUtils
.
clientID(ctx
.
channel());
if
(clientID
!=
null
&&
!
clientID
.
isEmpty()) {
LOG
.
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
+1
−2
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
+7
−3
broker/src/main/java/io/moquette/server/ConnectionDescriptor.java
+3
−1
broker/src/main/java/io/moquette/server/config/ClasspathResourceLoader.java
+5
−8
broker/src/main/java/io/moquette/server/config/ConfigurationParser.java
+7
−2
;
import
java.util.*
;
public
class
MemoryMessagesStore
implements
IMessagesStore
{
private
static
final
Logger
LOG
=
LoggerFactory
.
;
import
com.hazelcast.core.HazelcastInstance
;
import
com.hazelcast.core.ITopic
;
import
io.moquette.interception.messages.InterceptPublishMessage
;
import
io.moquette.server.Server
;
import
io.netty.buffer.ByteBuf
;
=
null
;
if
(needsClientAuth) {
LOG
.
warn(
"
Client authentication is enabled.
"
+
"
The keystore will be used as a truststore. KeystorePath = {}.
"
,
jksPath);
font-size: 10pt;
"
>
b)
its license agreement:
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
;
import
java.io.Reader
;
import
java.nio.charset.StandardCharsets
;
import
java.nio.file.Files
;
import
java.text.ParseException
;
import
java.util.Properties
;
@@ -55,15 +57,10 @@ void parse(File file) throws ParseException {
(
MVStore
mvStore
) {
this
.
mvStore
=
mvStore;
}
@Override
public
Queue<
SessionRegistry
.
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
;
import
java.util.Properties
;
/**
* Mosquitto configuration parser.
*
* A line that at the very first has # is a comment Each line has key value format, where the
* separator used it the space.
*/
class
ConfigurationParser
{
private
static
final
Logger
return
msg
.
payload()
.
clientIdentifier();
}
public
boolean
isCleanSession
() {
return
msg
.
variableHeader()
.
class
MemorySessionStore
implements
ISessionsStore
,
ISubscriptionsStore
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
MemorySessionStore
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
FileResourceLoader
.
class);
private
final
File
defaultFile;
private
defaultResource;
private
final
ClassLoader
classLoader;
public
ClasspathResourceLoader
() {
this
(
IConfig
.
DEFAULT_CONFIG
);
}
public
ClasspathResourceLoader
LOG
.
info(
"
Wiping existing subscriptions. ClientId={}
"
, clientID);
subscriptionsStore
.
wipeSubscriptions(clientID);
LOG
.
info(
"
Removing queues. ClientId={}
"
, clientID);
sessionsStore
.
private
Optional<? extends
ChannelInboundHandler
>
errorsCather;
private
int
nettySoBacklog;
private
boolean
nettySoReuseaddr;
private
boolean
nettyTcpNodelay;
private
boolean
nettySoKeepalive;
private
int
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
/**
*
*
@author
andrea
*/
public
class
DisconnectEvent
extends
MessagingEvent
+1
−2
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
+7
−3
broker/src/main/java/io/moquette/server/ConnectionDescriptor.java
+3
−1
broker/src/main/java/io/moquette/server/config/ClasspathResourceLoader.java
+5
−8
broker/src/main/java/io/moquette/server/config/ConfigurationParser.java
+7
−2
broker/src/main/java/io/moquette/server/config/FileResourceLoader.java
+3
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
313 lines (264 sloc)
12 KB
com.lmax.disruptor.EventFactory
;
import
org.dna.mqtt.moquette.messaging.spi.impl.events.MessagingEvent
;
/**
* Carrier value object for the RingBuffer.
*
*
@author
andrea
*/
public
final
class
ValueEvent
{
private
org.dna.mqtt.moquette.messaging.spi.impl
;
import
com.lmax.disruptor.BatchEventProcessor
;
import
com.lmax.disruptor.EventHandler
;
import
com.lmax.disruptor.RingBuffer
;
import
com.lmax.disruptor.SequenceBarrier
;
import
java.util.Properties
;
com.lmax.disruptor.BatchEventProcessor
;
import
com.lmax.disruptor.EventHandler
;
import
com.lmax.disruptor.RingBuffer
;
import
com.lmax.disruptor.SequenceBarrier
;
import
java.nio.ByteBuffer
;
import
java.util.Collection
;
import
;
import
java.nio.ByteBuffer
;
import
java.util.ArrayList
;
import
org.dna.mqtt.moquette.messaging.spi.IMatchingCondition
;
import
org.dna.mqtt.moquette.messaging.spi.IStorageService
;
import
org.dna.mqtt.moquette.messaging.spi.impl.events.PublishEvent
;
import
org.dna.mqtt.moquette.messaging.spi.impl.subscriptions.Subscription
import static
io.netty.channel.ChannelFutureListener.CLOSE
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
/**
* Value object to maintain the information of single connection, like ClientID, Channel, and clean
* session flag.
*/
public
class
ConnectionDescriptor
{
private
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
info(
"
Notifying connection lost event. MqttClientId = {}
"
, clientID);
m_processor
.
processConnectionLost(clientID, ctx
.
channel());
}
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
}
broker/src/main/java/io/moquette/server/config/FileResourceLoader.java
+3
−1
broker/src/main/java/io/moquette/server/netty/MoquetteIdleTimeoutHandler.java
+6
−2
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
+8
−6
broker/src/main/java/io/moquette/server/netty/NettyMQTTHandler.java
+3
−1
broker/src/main/java/io/moquette/server/netty/metrics/BytesMetricsHandler.java
+2
−1
broker/src/main/java/io/moquette/server/netty/metrics/MQTTMessageLogger.java
+3
getLogger(
MemoryMessagesStore
.
class);
private
Map<
Topic
,
StoredMessage
>
m_retainedStore
=
new
HashMap<>
();
MemoryMessagesStore
() {
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import static
io.moquette.spi.impl.Utils.readBytesAndRewind
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
public
class
HazelcastInterceptHandler
extends
AbstractInterceptHandler
{
private
//
use keystore as truststore, as server needs to trust certificates signed by the
//
server certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.
init(ks);
trustManagers
=
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
i)
effectively disclaims on behalf of all Contributors all warranties and
conditions, express and implied, including warranties or conditions of title
and non-infringement, and implied warranties or conditions of merchantability
and fitness for a particular purpose;
</
span
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
return
;
}
try
{
FileReader
reader
=
new
FileReader
(file);
Reader
reader
=
Files
.
newBufferedReader
(file
EnqueuedMessage
>
createQueue
(
String
cli
,
boolean
clean
) {
if
(
!
clean) {
return
new
H2PersistentQueue<>
(mvStore, cli);
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
com.lmax.disruptor.BatchEventProcessor
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/SimpleMessaging.java
Show comments
View file
Edit file
Delete file
LOG
=
LoggerFactory
.
getLogger(
ConfigurationParser
.
class);
private
Properties
m_properties
=
new
Properties
();
/**
* Parse the configuration from file.
*/
isCleanSession();
}
public
int
getKeepAlive
() {
return
msg
.
variableHeader()
.
keepAliveTimeSeconds();
}
public
boolean
isPasswordFlag
() {
.
class);
static
class
Session
{
final
String
clientID;
final
Map<
Topic
,
Subscription
>
subscriptions
=
new
final
String
parentPath;
public
FileResourceLoader
() {
this
((
File
)
null
);
}
public
FileResourceLoader
(
File
(
String
defaultResource
) {
this
(defaultResource,
Thread
.
currentThread()
.
getContextClassLoader());
}
public
ClasspathResourceLoader
(
String
defaultResource
,
dropQueue(clientID);
}
@Override
public
void
disconnect
() {
LOG
.
info(
"
Client disconnected. Removing its subscriptions. CId={}
"
, clientID);
//
cleanup topic subscriptions
cleanSession();
}
nettyChannelTimeoutSeconds;
private
int
maxBytesInMessage;
private
Class<? extends
ServerSocketChannel
>
channelClass;
@Override
public
void
initialize
(
ProtocolProcessor
processor
,
{
ServerChannel
m_session;
public
DisconnectEvent
(
ServerChannel
session
) {
m_session
=
session;
}
public
ServerChannel
getSession
() {
−1
broker/src/main/java/io/moquette/server/netty/MoquetteIdleTimeoutHandler.java
+6
−2
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
+8
−6
broker/src/main/java/io/moquette/server/netty/NettyMQTTHandler.java
+3
−1
broker/src/main/java/io/moquette/server/netty/metrics/BytesMetricsHandler.java
+2
−1
broker/src/main/java/io/moquette/server/netty/metrics/MQTTMessageLogger.java
+3
−1
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
MessagingEvent
m_event;
public
MessagingEvent
getEvent
() {
return
m_event;
}
public
void
setEvent
(
MessagingEvent
event
) {
m_event
=
event;
import
java.util.concurrent.CountDownLatch
;
import
java.util.concurrent.ExecutorService
;
import
java.util.concurrent.Executors
;
import
java.util.concurrent.TimeUnit
;
import
org.dna.mqtt.moquette.messaging.spi.IMessaging
;
import
org.dna.mqtt.moquette.messaging.spi.IStorageService
;
java.util.HashMap
;
import
java.util.List
;
import
java.util.Map
;
import
java.util.concurrent.ExecutorService
;
import
java.util.concurrent.Executors
;
import
org.dna.mqtt.moquette.messaging.spi.IMatchingCondition
;
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import
java.util.Collection
;
import
java.util.HashMap
;
import
java.util.HashSet
;
import
java.util.List
;
import
java.util.Map
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
ConnectionDescriptor
.
class);
public
enum
ConnectionState
{
//
Connection states
DISCONNECTED
Accept
Reject
Save preferences
@Override
public
void
exceptionCaught
(
ChannelHandlerContext
ctx
,
Throwable
cause
)
throws
Exception
{
LOG
.
error(
"
An unexpected exception was caught while processing MQTT message. Closing Netty channel. CId={},
−1
broker/src/main/java/io/moquette/server/netty/metrics/MessageMetricsHandler.java
+0
−16
broker/src/main/java/io/moquette/spi/DurableSession.java
+16
−0
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
+32
−0
broker/src/main/java/io/moquette/spi/InboundFlightZone.java
+2
−2
broker/src/main/java/io/moquette/spi/TransientSession.java
}
@Override
public
void
initStore
() {
}
@Override
public
void
storeRetained
(
Topic
topic
,
StoredMessage
storedMessage
) {
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
HazelcastInterceptHandler
.
class);
private
final
HazelcastInstance
hz;
public
HazelcastInterceptHandler
(
Server
tmf
.
getTrustManagers();
/**
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the server
* certificate and key in order to provide it to OpenSSL.
* <
p
>
* TODO: SNI is currently not supported, we use only the first found private key.
*/
private
static
SslContextBuilder
builderWithOpenSSLProvider
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
.
toPath(),
StandardCharsets
.
UTF_8
);
parse(reader);
}
catch
(
FileNotFoundException
fex) {
LOG
.
warn(
String
.
format(
}
return
new
ConcurrentLinkedQueue<>
();
}
}
4
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
Show comments
View file
Edit file
Delete file
@@ -52,6 +52,7 @@
private
static
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
void
parse
(
File
file
)
throws
ParseException
{
if
(file
==
null
) {
LOG
.
warn(
"
parsing NULL file, so fallback on default configuration!
return
msg
.
variableHeader()
.
hasPassword();
}
public
byte
getProtocolVersion
() {
return
(
byte
) msg
.
ConcurrentHashMap<>
();
boolean
cleanSession;
final
BlockingQueue<
StoredMessage
>
queue
=
new
ArrayBlockingQueue<>
(
Constants
.
MAX_MESSAGE_QUEUE
);
final
Map<
defaultFile
) {
this
(defaultFile,
System
.
getProperty(
"
moquette.path
"
,
null
));
}
public
FileResourceLoader
(
ClassLoader
classLoader
) {
this
.
defaultResource
=
defaultResource;
this
.
classLoader
=
classLoader;
}
@Override
public
Reader
loadDefaultResource
@Override
protected
int
nextPacketId
() {
return
this
.
sessionsStore
.
nextPacketID(
this
.
clientID);
}
@Override
public
IMessagesStore
IConfig
props
,
ISslContextCreator
sslCtxCreator
)
throws
IOException
{
LOG
.
info(
"
Initializing Netty acceptor...
"
);
nettySoBacklog
=
return
m_session;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
broker/src/main/java/io/moquette/server/netty/metrics/MessageMetricsHandler.java
+0
−16
broker/src/main/java/io/moquette/spi/DurableSession.java
+16
−0
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
+32
−0
broker/src/main/java/io/moquette/spi/InboundFlightZone.java
+2
−2
broker/src/main/java/io/moquette/spi/TransientSession.java
+3
−1
broker/src/main/java/io/moquette/spi/impl/DebugUtils.java
+6
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.io.File
;
import
java.io.IOException
;
import
java.io.Serializable
;
import
java.nio.ByteBuffer
;
import
}
public
final
static
EventFactory<
ValueEvent
>
EVENT_FACTORY
=
new
EventFactory<
ValueEvent
>
() {
public
ValueEvent
newInstance
() {
import
org.dna.mqtt.moquette.messaging.spi.impl.events.*
;
import
org.dna.mqtt.moquette.messaging.spi.impl.subscriptions.SubscriptionsStore
;
import
org.dna.mqtt.moquette.proto.messages.PubCompMessage
;
import
org.dna.mqtt.moquette.proto.messages.*
;
import
org.dna.mqtt.moquette.server.Constants
;
import
org.dna.mqtt.moquette.server.IAuthenticator
import
org.dna.mqtt.moquette.messaging.spi.IStorageService
;
import
org.dna.mqtt.moquette.messaging.spi.impl.events.MessagingEvent
;
import
org.dna.mqtt.moquette.messaging.spi.impl.events.OutputMessagingEvent
;
import
org.dna.mqtt.moquette.messaging.spi.impl.events.PubAckEvent
;
import
org.dna.mqtt.moquette.messaging.spi.impl.events.PublishEvent
;
import
org.dna.mqtt.moquette.messaging.spi.impl.subscriptions.Subscription
;
;
import
java.util.Set
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
/**
*/
public
class
MemoryStorageService
implements
IStorageService
{
private
,
SENDACK
,
SESSION_CREATED
,
MESSAGES_REPUBLISHED
,
ESTABLISHED
,
//
Disconnection states
SUBSCRIPTIONS_REMOVED
,
MESSAGES_DROPPED
,
INTERCEPTORS_NOTIFIED
;
}
public
"
+
"
"
,
NettyUtils
.
clientID(ctx
.
channel()), cause
.
getCause(), cause
.
getMessage());
ctx
.
close()
.
+3
−1
broker/src/main/java/io/moquette/spi/impl/DebugUtils.java
+6
−4
broker/src/main/java/io/moquette/spi/impl/MessagesPublisher.java
+4
−4
broker/src/main/java/io/moquette/spi/impl/PersistentQueueMessageSender.java
+46
−71
broker/src/main/java/io/moquette/spi/impl/ProtocolProcessor.java
+8
−6
broker/src/main/java/io/moquette/spi/impl/ProtocolProcessorBootstrapper.java
+48
LOG
.
debug(
"
"
, topic, storedMessage
.
getClientID());
if
(storedMessage
.
getClientID()
==
null
) {
throw
new
IllegalArgumentException
(
server
) {
this
.
hz
=
server
.
getHazelcastInstance();
}
@Override
public
String
getID
() {
return
HazelcastInterceptHandler
.
(
KeyStore
ks
,
String
keyPassword
)
throws
GeneralSecurityException
{
for
(
String
alias
:
Collections
.
list(ks
.
span
style
="
font-size: 10pt;
"
>
ii)
effectively excludes on behalf of all Contributors all liability for damages,
including direct, indirect, special, incidental and consequential damages, such
as lost profits;
</
span
>
</
p
>
<
p
Reject
Save preferences
"
parsing not existing file %s, so fallback on default configuration!
"
,
file
.
getAbsolutePath()),
fex);
return
;
}
catch
(
IOException
fex) {
LOG
.
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
IAuthenticator
mockAuthenticator;
private
PostOffice
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
com.lmax.disruptor.BatchEventProcessor
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ValueEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
"
);
return
;
}
if
(
!
file
.
exists()) {
LOG
.
warn(
String
.
format(
variableHeader()
.
version();
}
public
String
getProtocolName
() {
return
msg
.
variableHeader()
.
name();
}
public
boolean
Integer
,
StoredMessage
>
secondPhaseStore
=
new
ConcurrentHashMap<>
();
final
Map<
Integer
,
StoredMessage
>
outboundFlightMessages
=
Collections
String
parentPath
) {
this
(
null
, parentPath);
}
public
FileResourceLoader
(
File
defaultFile
,
String
parentPath
) {
this
() {
return
loadResource(defaultResource);
}
@Override
public
Reader
loadResource
(
String
relativePath
) {
LOG
.
info(
"
Loading resource. RelativePath = {}.
"
, relativePath);
.
StoredMessage
inFlightAcknowledged
(
int
messageID
) {
return
outboundFlightZone
.
acknowledged(messageID);
}
@Override
public
int
inFlightAckWaiting
(
IMessagesStore
Integer
.
parseInt(props
.
getProperty(
BrokerConstants
.
NETTY_SO_BACKLOG_PROPERTY_NAME
,
"
128
"
));
nettySoReuseaddr
=
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
−4
broker/src/main/java/io/moquette/spi/impl/MessagesPublisher.java
+4
−4
broker/src/main/java/io/moquette/spi/impl/PersistentQueueMessageSender.java
+46
−71
broker/src/main/java/io/moquette/spi/impl/ProtocolProcessor.java
+8
−6
broker/src/main/java/io/moquette/spi/impl/ProtocolProcessorBootstrapper.java
+48
−0
broker/src/main/java/io/moquette/spi/impl/RunningSubscription.java
+3
−1
java.util.*
;
import
org.dna.mqtt.moquette.MQTTException
;
import
org.dna.mqtt.moquette.messaging.spi.IMatchingCondition
;
import
org.dna.mqtt.moquette.messaging.spi.IStorageService
;
import
org.dna.mqtt.moquette.messaging.spi.impl.events.PublishEvent
;
import
org.dna.mqtt.moquette.messaging.spi.impl.storage.StoredPublishEvent
;
return
new
ValueEvent
();
}
};
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
/**
*
* Singleton class that orchestrate the execution of the protocol.
*
* Uses the LMAX Disruptor to serialize the incoming, requests, because it work in a evented fashion.
*
*
import
org.dna.mqtt.moquette.messaging.spi.impl.subscriptions.SubscriptionsStore
;
import
org.dna.mqtt.moquette.proto.messages.PubCompMessage
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import
org.dna.mqtt.moquette.proto.messages.ConnAckMessage
;
import
org.dna.mqtt.moquette.proto.messages.ConnectMessage
;
import
org.dna.mqtt.moquette.proto.messages.PubAckMessage
;
Map<
String
,
Set<
Subscription
>
>
m_persistentSubscriptions
=
new
HashMap<
String
,
Set<
Subscription
>
>
();
final
String
clientID;
private
final
Channel
channel;
public
final
boolean
cleanSession;
private
final
AtomicReference<
ConnectionState
>
channelState
=
addListener(
CLOSE_ON_FAILURE
);
}
@Override
public
void
channelWritabilityChanged
(
ChannelHandlerContext
ctx
)
throws
Exception
{
if
(ctx
−0
broker/src/main/java/io/moquette/spi/impl/RunningSubscription.java
+3
−1
broker/src/main/java/io/moquette/spi/impl/SessionsRepository.java
+12
−4
broker/src/main/java/io/moquette/spi/impl/security/ACLFileParser.java
+1
−0
broker/src/main/java/io/moquette/spi/impl/security/AcceptAllAuthenticator.java
+10
−8
broker/src/main/java/io/moquette/spi/impl/subscriptions/CNode.java
+10
−75
broker/src/main/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectory.java
"
Message to be persisted must have a not null client ID
"
);
}
m_retainedStore
.
put(topic, storedMessage);
}
@Override
public
Collection<
StoredMessage
>
searchMatching
(
IMatchingCondition
condition
class
.
getName()
+
"
@
"
+
hz
.
getName();
}
@Override
public
void
onPublish
(
InterceptPublishMessage
msg
aliases())) {
if
(ks
.
entryInstanceOf(alias,
KeyStore
.
PrivateKeyEntry
.
class)) {
PrivateKey
key
=
(
PrivateKey
) ks
.
getKey(alias, keyPassword
.
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
iii)
warn(
"
parsing not existing file {}, fallback on default configuration!
"
, file
.
getAbsolutePath(), fex);
}
}
9
broker/src/main/java/io/moquette/server/config/FileResourceLoader.java
Show comments
View file
Edit file
Delete file
@@ -19,10 +19,15 @@
import
postOffice;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
@@ -62,8 +63,9 @@ public void setUp() {
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
"
parsing not existing file %s, so fallback on default configuration!
"
,
file
.
getAbsolutePath()));
return
;
}
try
{
Reader
reader
=
Files
.
isUserFlag
() {
return
msg
.
variableHeader()
.
hasUserName();
}
public
boolean
isWillFlag
() {
return
msg
.
variableHeader()
.
synchronizedMap(
new
HashMap<
Integer
,
StoredMessage
>
());
final
Map<
Integer
,
StoredMessage
>
inboundFlightMessages
.
defaultFile
=
defaultFile;
this
.
parentPath
=
parentPath;
}
@Override
public
Reader
loadDefaultResource
() {
if
(defaultFile
!=
null
InputStream
is
=
this
.
classLoader
.
getResourceAsStream(relativePath);
return
is
!=
null
?
new
InputStreamReader
(is,
StandardCharsets
.
UTF_8
.
StoredMessage
msg
) {
LOG
.
debug(
"
Adding message to inflight zone. CId={}
"
, clientID);
int
messageId
=
this
.
nextPacketId();
outboundFlightZone
Boolean
.parseBoolean(props
.
getProperty(
BrokerConstants
.
NETTY_SO_REUSEADDR_PROPERTY_NAME
,
"
true
"
));
nettyTcpNodelay
=
Boolean
.parseBoolean(props
.
getProperty(
BrokerConstants
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
broker/src/main/java/io/moquette/spi/impl/SessionsRepository.java
+12
−4
broker/src/main/java/io/moquette/spi/impl/security/ACLFileParser.java
+1
−0
broker/src/main/java/io/moquette/spi/impl/security/AcceptAllAuthenticator.java
+10
−8
broker/src/main/java/io/moquette/spi/impl/subscriptions/CNode.java
+10
−75
broker/src/main/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectory.java
+67
−0
broker/src/main/java/io/moquette/spi/impl/subscriptions/DumpTreeVisitor.java
import
org.dna.mqtt.moquette.messaging.spi.impl.subscriptions.Subscription
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import
org.dna.mqtt.moquette.server.Server
;
import
org.fusesource.hawtbuf.codec.StringCodec
;
import
org.fusesource.hawtdb.api.*
;
import
org.slf4j.Logger
;
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
@author
andrea
*/
public
class
SimpleMessaging
implements
IMessaging
,
EventHandler<
ValueEvent
>
{
private
static
final
Logger
LOG
=
import
org.dna.mqtt.moquette.proto.messages.PubRecMessage
;
import
org.dna.mqtt.moquette.proto.messages.PubRelMessage
;
import
org.dna.mqtt.moquette.proto.messages.PublishMessage
;
import
org.dna.mqtt.moquette.proto.messages.SubAckMessage
;
import
org.dna.mqtt.moquette.proto.messages.SubscribeMessage
;
import
org.dna.mqtt.moquette.proto.messages.UnsubAckMessage
private
Map<
String
,
HawtDBStorageService
.
StoredMessage
>
m_retainedStore
=
new
HashMap<
String
,
HawtDBStorageService
.
StoredMessage
>();
//
new
AtomicReference<>
(
ConnectionState
.
DISCONNECTED
);
public
ConnectionDescriptor
(
String
clientID
,
Channel
session
,
boolean
.
channel()
.
isWritable()) {
m_processor
.
notifyChannelWritable(ctx
.
channel());
}
ctx
.
fireChannelWritabilityChanged();
}
}
Copy lines
Copy permalink
View git blame
+67
−0
broker/src/main/java/io/moquette/spi/impl/subscriptions/DumpTreeVisitor.java
+33
−0
broker/src/main/java/io/moquette/spi/impl/subscriptions/SubscriptionCounterVisitor.java
+2
−2
broker/src/main/java/io/moquette/spi/impl/subscriptions/Token.java
+5
−9
broker/src/main/java/io/moquette/spi/impl/subscriptions/Topic.java
+4
−4
) {
LOG
.
debug(
"
searchMatching scanning all retained messages, presents are {}
"
, m_retainedStore
.
size());
List<
StoredMessage
>
results
=
new
ArrayList<>
();
) {
//
TODO ugly, too much array copy
ByteBuf
payload
=
msg
.
getPayload();
byte
[] payloadContent
=
readBytesAndRewind(payload);
LOG
.
info(
"
toCharArray());
Certificate
[] chain
=
ks
.
getCertificateChain(alias);
X509Certificate
[] certChain
=
new
X509Certificate
[chain
.
length];
System
.
arraycopy(chain,
states that any provisions which differ from this Agreement are offered by that
Contributor alone and not by any other party; and
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
java.io.File
;
import
java.io.FileNotFoundException
;
import
java.io.FileReader
;
import
java.io.IOException
;
import
java.io.Reader
;
import
java.nio.file.Files
;
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
com.lmax.disruptor.EventFactory
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/DisconnectEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
newBufferedReader(file
.
toPath(),
StandardCharsets
.
UTF_8
);
parse(reader);
}
catch
(
IOException
fex) {
LOG
.
warn(
"
parsing not existing file {}, fallback on default configuration!
"
.
isWillFlag();
}
public
byte
getWillQos
() {
return
(
byte
) msg
.
variableHeader()
.
willQos();
}
public
boolean
isWillRetain
=
new
ConcurrentHashMap<>
();
Session
(
String
clientID
,
boolean
cleanSession
) {
this
.
clientID
=
clientID;
this
) {
return
loadResource(defaultFile);
}
else
{
throw
new
IllegalArgumentException
(
"
Default file not set!
"
);
}
}
@Override
public
)
:
null
;
}
@Override
public
String
getName
() {
return
"
classpath resource
"
;
}
}
Copy lines
.
waitingAck(messageId, msg);
return
messageId;
}
@Override
public
IMessagesStore
.
StoredMessage
inboundInflight
(
int
messageID
) {
return
inboundFlightZone
.
.
NETTY_TCP_NODELAY_PROPERTY_NAME
,
"
true
"
));
nettySoKeepalive
=
Boolean
.parseBoolean(props
.
getProperty(
BrokerConstants
.
NETTY_SO_KEEPALIVE_PROPERTY_NAME
,
"
Save preferences
+33
−0
broker/src/main/java/io/moquette/spi/impl/subscriptions/SubscriptionCounterVisitor.java
+2
−2
broker/src/main/java/io/moquette/spi/impl/subscriptions/Token.java
+5
−9
broker/src/main/java/io/moquette/spi/impl/subscriptions/Topic.java
+4
−4
broker/src/test/java/io/moquette/Utils.java
+24
−5
broker/src/test/java/io/moquette/persistence/MessageStoreTCK.java
+1
−1
import
org.slf4j.LoggerFactory
;
/**
* Implementation of IStorageService backed by HawtDB
*/
public
class
HawtDBStorageService
implements
IStorageService
{
public
static
class
StoredMessage
implements
Serializable
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
LoggerFactory
.
getLogger(
SimpleMessaging
.
class);
private
SubscriptionsStore
subscriptions;
private
RingBuffer<
ValueEvent
>
m_ringBuffer;
private
IStorageService
m_storageService;
;
import
org.dna.mqtt.moquette.server.ConnectionDescriptor
;
import
org.dna.mqtt.moquette.server.Constants
;
import
org.dna.mqtt.moquette.server.IAuthenticator
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
TODO move in a multimap because only Qos1 and QoS2 are stored here and they have messageID(key of secondary map)
private
Map<
String
,
List<
PublishEvent
>
>
m_persistentMessageStore
=
new
HashMap<
String
,
List<
PublishEvent
>
>
cleanSession
) {
this
.
clientID
=
clientID;
this
.
channel
=
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
broker/src/test/java/io/moquette/Utils.java
+24
−5
broker/src/test/java/io/moquette/persistence/MessageStoreTCK.java
+1
−1
broker/src/test/java/io/moquette/server/MessageCollector.java
+3
−1
broker/src/test/java/io/moquette/server/ServerIntegrationFuseTest.java
+4
for
(
Map
.
Entry<
Topic
,
StoredMessage
>
entry
:
m_retainedStore
.
"
, msg
.
getClientID(), msg
.
getTopicName(),
new
String
(payloadContent,
UTF_8
));
ITopic<
HazelcastMsg
>
topic
=
0
, certChain,
0
, chain
.
length);
return
SslContextBuilder
.
forServer(key, certChain);
}
//
init sslContext
LOG
.
info(
"
>
<
span
style
="
font-size: 10pt;
"
>
iv)
states that source code for the Program is available from such Contributor, and
informs licensees how to obtain it in a reasonable manner on or through a
medium customarily used for software exchange.
<
span
style
="
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
public
class
FileResourceLoader
implements
IResourceLoader
{
private
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
);
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/InitEvent.java
Show comments
, file
.
getAbsolutePath(), fex);
}
}
/**
* Parse the configuration
*
*
@throws
ParseException
* if the format is not compliant.
*/
void
parse
(
Reader
reader
() {
return
msg
.
variableHeader()
.
isWillRetain();
}
public
String
getUsername
() {
return
msg
.
payload()
.
userName();
}
.
cleanSession
=
cleanSession;
}
}
private
final
Map<
String
,
Session
>
sessions
=
new
ConcurrentHashMap<>
();
Reader
loadResource
(
String
relativePath
) {
return
loadResource(
new
File
(parentPath, relativePath));
}
public
Reader
loadResource
(
File
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
lookup(messageID);
}
@Override
public
void
markAsInboundInflight
(
int
messageID
,
IMessagesStore
.
StoredMessage
msg
) {
inboundFlightZone
.
waitingRel(messageID, msg);
true
"
));
nettyChannelTimeoutSeconds
=
Integer
.parseInt(props
.
getProperty(
BrokerConstants
.
NETTY_CHANNEL_TIMEOUT_SECONDS_PROPERTY_NAME
,
"
10
"
));
maxBytesInMessage
broker/src/test/java/io/moquette/server/MessageCollector.java
+3
−1
broker/src/test/java/io/moquette/server/ServerIntegrationFuseTest.java
+4
−3
broker/src/test/java/io/moquette/server/ServerIntegrationHazelcastHandlerInterceptorTest.java
+10
−10
broker/src/test/java/io/moquette/server/ServerIntegrationPahoTest.java
+11
−9
broker/src/test/java/io/moquette/server/ServerIntegrationQoSValidationTest.java
+8
−6
broker/src/test/java/io/moquette/server/ServerIntegrationRestartTest.java
{
AbstractMessage
.
QOSType
m_qos;
byte
[] m_payload;
String
m_topic;
StoredMessage
(
byte
[]
message
,
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
private
ExecutorService
m_executor;
BatchEventProcessor<
ValueEvent
>
m_eventProcessor;
private
static
SimpleMessaging
INSTANCE
;
private
ProtocolProcessor
m_processor
=
new
ProtocolProcessor
;
/**
* Class responsible to handle the logic of MQTT protocol it's the director of
* the protocol execution.
*
* Used by the front facing class SimpleMessaging.
*
*
@author
andrea
*/
class
ProtocolProcessor
implements
EventHandler<
ValueEvent
>
{
();
private
Map<
String
,
PublishEvent
>
m_inflightStore
=
new
HashMap<
String
,
PublishEvent
>
();
private
Map<
session;
this
.
cleanSession
=
cleanSession;
}
public
void
writeAndFlush
(
Object
payload
) {
this
.
channel
.
writeAndFlush(payload)
.
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
−3
broker/src/test/java/io/moquette/server/ServerIntegrationHazelcastHandlerInterceptorTest.java
+10
−10
broker/src/test/java/io/moquette/server/ServerIntegrationPahoTest.java
+11
−9
broker/src/test/java/io/moquette/server/ServerIntegrationQoSValidationTest.java
+8
−6
broker/src/test/java/io/moquette/server/ServerIntegrationRestartTest.java
+2
−1
broker/src/test/java/io/moquette/server/ServerIntegrationSSLTest.java
+1
−0
entrySet()) {
StoredMessage
storedMsg
=
entry
.
getValue();
if
(condition
.
match(entry
.
getKey())) {
results
.
add(storedMsg);
}
}
hz
.
getTopic(
"
moquette
"
);
HazelcastMsg
hazelcastMsg
=
new
HazelcastMsg
(msg);
topic
.
publish(hazelcastMsg);
}
}
Copy lines
Initializing SSL context...
"
);
serverContext
.
init(kmf
.
getKeyManagers(), trustManagers,
null
);
LOG
.
info(
"
The SSL context has been initialized successfully.
"
);
}
throw
color: blue;
"
>
</
span
>
</
span
>
</
p
>
<
p
>
<
span
style
="
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
FileResourceLoader
.
class);
@@ -68,8 +73,8 @@ public Reader loadResource(File f) {
throw
new
ResourceIsDirectoryException
(
"
File
new
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
4
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
Show comments
View file
Edit file
Delete file
@@ -45,6 +45,7 @@
private
EmbeddedChannel
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
)
throws
ParseException
{
if
(reader
==
null
) {
//
just log and return default properties
LOG
.
warn(
"
parsing NULL reader, so fallback on default configuration!
"
);
return
public
byte
[]
getPassword
() {
return
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
public
private
ConcurrentNavigableMap<
LocalDateTime
,
Set<
String
>
>
sessionsClosingTimes
=
new
ConcurrentSkipListMap<>
();
MemorySessionStore
() {
}
private
Session
f
) {
LOG
.
info(
"
Loading file. Path = {}.
"
, f
.
getAbsolutePath());
if
(f
.
isDirectory()) {
LOG
.
error(
"
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
}
@Override
public
void
moveInFlightToSecondPhaseAckWaiting
(
int
messageID
,
IMessagesStore
.
StoredMessage
msg
) {
this
.
sessionsStore
.
=
Integer
.parseInt(props
.
getProperty(
BrokerConstants
.
NETTY_MAX_BYTES_PROPERTY_NAME
,
String
.
valueOf(
BrokerConstants
.
DEFAULT_NETTY_MAX_BYTES_IN_MESSAGE
)));
boolean
epoll
=
+2
−1
broker/src/test/java/io/moquette/server/ServerIntegrationSSLTest.java
+1
−0
broker/src/test/java/io/moquette/server/ServerIntegrationWebSocketTest.java
+3
−2
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
+5
−4
broker/src/test/java/io/moquette/spi/ClientSessionTest.java
+17
−15
broker/src/test/java/io/moquette/spi/impl/AbstractProtocolProcessorCommonUtils.java
+2
−1
AbstractMessage
.
QOSType
qos
,
String
topic
) {
m_qos
=
qos;
m_payload
=
message;
m_topic
=
topic;
}
();
CountDownLatch
m_stopLatch;
private
SimpleMessaging
() {
}
public
static
SimpleMessaging
getInstance
() {
if
(
INSTANCE
==
null
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
ProtocolProcessor
.
class);
private
Map<
String
,
ConnectionDescriptor
>
String
,
PublishEvent
>
m_qos2Store
=
new
HashMap<
String
,
PublishEvent
>
();
private
static
final
Logger
LOG
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
public
void
setupAutoFlusher
(
int
flushIntervalMs
) {
try
{
this
.
channel
.
pipeline()
.
addAfter(
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
broker/src/test/java/io/moquette/server/ServerIntegrationWebSocketTest.java
+3
−2
broker/src/test/java/io/moquette/server/ServerLowlevelMessagesIntegrationTests.java
+5
−4
broker/src/test/java/io/moquette/spi/ClientSessionTest.java
+17
−15
broker/src/test/java/io/moquette/spi/impl/AbstractProtocolProcessorCommonUtils.java
+2
−1
broker/src/test/java/io/moquette/spi/impl/BrokerInterceptorTest.java
+4
−1
broker/src/test/java/io/moquette/spi/impl/MockAuthenticator.java
return
results;
}
@Override
public
void
cleanRetained
(
Topic
topic
) {
m_retainedStore
.
remove(topic);
}
}
Copy lines
Copy permalink
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
new
KeyManagementException
(
"
the SSL key-store does not contain a private key
"
);
}
return
serverContext;
}
catch
(
NoSuchAlgorithmException
|
UnrecoverableKeyException
|
font-size: 10pt;
"
>
When the Program is made available in source
code form:
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
\"
"
+
f
+
"
\"
is a directory!
"
);
}
try
{
return
new
FileReader
(f
);
channel;
private
SessionRegistry
sessionRegistry;
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
java.util.Properties
;
15
...er/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/LostConnectionEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
;
}
BufferedReader
br
=
new
BufferedReader
(reader);
String
line;
try
{
while
((line
=
br
.
readLine())
String
getWillTopic
() {
return
msg
.
payload()
.
willTopic();
}
public
byte
[]
getWillMessage
() {
return
msg
.
getSession
(
String
clientID
) {
Session
session
=
sessions
.
get(clientID);
if
(session
==
null
) {
LOG
The given file is a directory. Path = {}.
"
, f
.
getAbsolutePath());
throw
new
ResourceIsDirectoryException
(
"
File
\"
"
+
f
+
"
\"
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
moveInFlightToSecondPhaseAckWaiting(
this
.
clientID, messageID, msg);
}
@Override
public
boolean
isEmptyQueue
() {
return
this
.
sessionsStore
.
queue(clientID)
.
isEmpty();
Boolean
.
parseBoolean(props
.
getProperty(
BrokerConstants
.
NETTY_EPOLL_PROPERTY_NAME
,
"
false
"
));
if
(epoll) {
LOG
.
info(
"
broker/src/test/java/io/moquette/spi/impl/BrokerInterceptorTest.java
+4
−1
broker/src/test/java/io/moquette/spi/impl/MockAuthenticator.java
+3
−3
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessorTest.java
+4
−3
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_CONNECT_Test.java
+2
−2
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_VariousUseCases_Test.java
+5
−3
broker/src/test/java/io/moquette/spi/impl/security/DBAuthenticatorTest.java
+5
AbstractMessage
.
QOSType
getQos
() {
return
m_qos;
}
ByteBuffer
getPayload
() {
return
(
ByteBuffer
)
ByteBuffer
.
allocate(m_payload
) {
INSTANCE
=
new
SimpleMessaging
();
}
return
INSTANCE
;
}
public
void
init
(
Properties
m_clientIDs
=
new
HashMap<
String
,
ConnectionDescriptor
>
();
private
SubscriptionsStore
subscriptions;
private
IStorageService
m_storageService;
private
IAuthenticator
=
LoggerFactory
.
getLogger(
MemoryStorageService
.
class);
public
void
initStore
() {
//
To change body of implemented methods use File | Settings | File Templates.
}
public
void
storeRetained
(
String
"
idleEventHandler
"
,
"
autoFlusher
"
,
new
AutoFlushHandler
(flushIntervalMs,
TimeUnit
.
MILLISECONDS
));
}
catch
(
Save preferences
+3
−3
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessorTest.java
+4
−3
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_CONNECT_Test.java
+2
−2
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_VariousUseCases_Test.java
+5
−3
broker/src/test/java/io/moquette/spi/impl/security/DBAuthenticatorTest.java
+5
−3
broker/src/test/java/io/moquette/spi/impl/security/FileAuthenticatorTest.java
+5
−4
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
CertificateException
|
KeyStoreException
|
KeyManagementException
|
IOException
ex) {
LOG
.
error(
"
"
,
ex
.
getCause(),
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
a)
it must be made available under this Agreement; and
</
span
>
</
p
>
}
catch
(
FileNotFoundException
e) {
return
Files
.
newBufferedReader(f
.
toPath(),
UTF_8
);
}
catch
(
IOException
@@ -67,8 +68,9 @@ private MQTTConnection createMQTTConnection(BrokerConfiguration config, Channel
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
!=
null
) {
int
commentMarker
=
line
.
indexOf(
'
#
'
);
if
(commentMarker
!=
-
1
) {
payload()
.
willMessage()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
.
error(
"
Can't find the session for client <{}>
"
, clientID);
throw
new
RuntimeException
(
"
Can't find the session for client <
"
+
clientID
+
"
>
"
is a directory!
"
);
}
try
{
return
Files
.
newBufferedReader(f
.
toPath(),
UTF_8
);
}
catch
(
IOException
e) {
Save preferences
}
@Override
public
void
dropQueue
() {
LOG
.
debug(
"
Removing messages of session. CId={}
"
,
this
.
clientID);
this
Netty is using Epoll
"
);
m_bossGroup
=
new
EpollEventLoopGroup
();
m_workerGroup
=
new
EpollEventLoopGroup
();
channelClass
=
EpollServerSocketChannel
.
class;
}
else
−3
broker/src/test/java/io/moquette/spi/impl/security/FileAuthenticatorTest.java
+5
−4
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryMatchingTest.java
+7
−14
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryTest.java
+0
−1
broker/src/test/java/io/moquette/spi/impl/subscriptions/TopicTest.java
+8
−2
broker/src/test/java/io/moquette/testclient/Client.java
+4
−2
.
length)
.
put(m_payload)
.
flip();
}
String
getTopic
() {
return
m_topic;
}
}
private
static
final
Logger
LOG
configProps
) {
subscriptions
=
new
SubscriptionsStore
();
m_executor
=
Executors
.
newFixedThreadPool(
1
);
m_ringBuffer
=
new
RingBuffer<
ValueEvent
m_authenticator;
private
ExecutorService
m_executor;
BatchEventProcessor<
ValueEvent
>
m_eventProcessor;
private
RingBuffer<
ValueEvent
>
m_ringBuffer;
ProtocolProcessor
() {}
/**
*
@param
topic
,
ByteBuffer
message
,
AbstractMessage
.
QOSType
qos
) {
if
(
!
message
.
hasRemaining()) {
//
clean the message from topic
NoSuchElementException
nseex) {
//
the idleEventHandler is not present on the pipeline
this
.
channel
.
pipeline()
.addFirst(
"
autoFlusher
"
,
new
AutoFlushHandler
(flushIntervalMs,
TimeUnit
.
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryMatchingTest.java
+7
−14
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryTest.java
+0
−1
broker/src/test/java/io/moquette/spi/impl/subscriptions/TopicTest.java
+8
−2
broker/src/test/java/io/moquette/testclient/Client.java
+4
−2
broker/src/test/java/io/moquette/testclient/ClientNettyMQTTHandler.java
+8
−6
broker/src/test/java/io/moquette/testclient/RawClient.java
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
ex
.
getMessage());
return
null
;
private
static
void
addClientAuthentication
(
KeyStore
ks
,
SslContextBuilder
contextBuilder
)
throws
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
e) {
LOG
.
error(
"
The file does not exist. Path = {}.
"
, f
.
getAbsolutePath());
return
null
;
}
4
broker/src/main/java/io/moquette/server/netty/MoquetteIdleTimeoutHandler.java
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
/**
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/MessagingEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
if
(commentMarker
==
0
) {
//
skip its a comment
continue
;
}
else
{
//
it's a malformed comment
throw
new
ParseException
(line, commentMarker);
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
);
}
return
session;
}
@Override
public
void
removeSubscription
(
Topic
topic
,
String
clientID
) {
LOG
.
LOG
.
error(
"
The file does not exist. Path = {}.
"
, f
.
getAbsolutePath());
return
null
;
.
sessionsStore
.
dropQueue(
this
.
clientID);
LOG
.
debug(
"
{
LOG
.
info(
"
Netty is using NIO
"
);
m_bossGroup
=
new
NioEventLoopGroup
();
m_workerGroup
=
broker/src/test/java/io/moquette/testclient/ClientNettyMQTTHandler.java
+8
−6
broker/src/test/java/io/moquette/testclient/RawClient.java
+2
−2
checkstyle.xml
+9
−11
distribution/build.gradle
+5
−3
embedding_moquette/src/main/java/io/moquette/testembedded/EmbeddedLauncher.java
+15
−0
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentQueue.java
+6
=
LoggerFactory
.
getLogger(
HawtDBStorageService
.
class);
private
MultiIndexFactory
m_multiIndexFactory;
private
PageFileFactory
pageFactory;
//
maps clientID to the list of pending messages stored
//
TODO move in a multimap because only Qos1 and QoS2 are stored here and they have messageID(key of secondary map)
private
>
(
ValueEvent
.
EVENT_FACTORY
,
1024
*
32
);
SequenceBarrier
barrier
=
m_ringBuffer
.
newBarrier();
m_eventProcessor
=
subscriptions the subscription store where are stored all the existing
* clients subscriptions.
*
@param
storageService the persistent store to use for save/load of messages
* for QoS1 and QoS2 handling.
*
@param
authenticator the authenticator used in connect messages
*/
void
init
(
SubscriptionsStore
subscriptions
,
IStorageService
storageService
,
m_retainedStore
.
remove(topic);
}
else
{
//
store the message to the topic
byte
[] raw
=
new
byte
[message
.
remaining()];
message
.
MILLISECONDS
));
}
}
public
boolean
doesNotUseChannel
(
Channel
channel
) {
return
!
(
this
.
channel
.
+2
−2
checkstyle.xml
+9
−11
distribution/build.gradle
+5
−3
embedding_moquette/src/main/java/io/moquette/testembedded/EmbeddedLauncher.java
+15
−0
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentQueue.java
+6
−10
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentStore.java
+17
−11
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
NoSuchAlgorithmException
,
KeyStoreException
{
LOG
.
warn(
"
Client authentication is enabled. The keystore will be used as a truststore.
"
);
//
use keystore as truststore, as server needs to trust certificates signed by the server certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
b) a
copy of this Agreement must be included with each copy of the Program.
</
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
io.netty.handler.timeout.IdleState
;
import
io.netty.handler.timeout.IdleStateEvent
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
@Sharable
class
MoquetteIdleTimeoutHandler
SessionRegistry
(subscriptions,
queueRepository
);
final
PostOffice
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(), sessionRegistry,
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
15
...r/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/OutputMessagingEvent.java
Show comments
View file
Edit file
Delete file
}
}
else
{
if
(line
.
isEmpty()
||
line
.
matches(
"
^
\\
s*$
"
)) {
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
debug(
"
"
, topic, clientID);
getSession(clientID)
.
subscriptions
.
remove(topic);
}
@Override
public
void
initStore
() {
}
@Override
public
}
}
@Override
public
String
getName
() {
return
"
file
"
;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Messages of the session have been removed. CId={}
"
,
this
.
clientID);
}
@Override
public
EnqueuedMessage
poll
() {
IMessagesStore
.
StoredMessage
msg
=
this
.
new
NioEventLoopGroup
();
channelClass
=
NioServerSocketChannel
.
class;
}
final
NettyMQTTHandler
mqttHandler
=
new
NettyMQTTHandler
(processor);
final
boolean
−10
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentStore.java
+17
−11
h2_storage/src/main/java/io/moquette/persistence/h2/H2SessionsStore.java
+17
−2
h2_storage/src/test/java/io/moquette/persistence/h2/H2PersistentQueueTest.java
+2
−1
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+1
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBMessagesStore.java
+1
−0
SortedIndex<
String
,
List<
StoredPublishEvent
>
>
m_persistentMessageStore;
private
SortedIndex<
String
,
StoredMessage
>
m_retainedStore;
//
bind clientID+MsgID -> evt message published
private
new
BatchEventProcessor<
ValueEvent
>
(m_ringBuffer, barrier,
this
);
//
TODO in a presentation is said to don't do the followinf line!!
m_ringBuffer
.
setGatingSequences(m_eventProcessor
.
getSequence());
m_executor
.
submit(m_eventProcessor);
disruptorPublish(
IAuthenticator
authenticator
) {
//
m_clientIDs = clientIDs;
this
.
subscriptions
=
subscriptions;
m_authenticator
=
authenticator;
m_storageService
=
storageService;
//
init the output ringbuffer
m_executor
get(raw);
m_retainedStore
.
put(topic,
new
HawtDBStorageService
.
StoredMessage
(raw, qos, topic));
}
}
public
Collection<
HawtDBStorageService
.
StoredMessage
>
searchMatching
(
equals(channel));
}
public
boolean
close
() {
LOG
.
info(
"
Closing connection descriptor. MqttClientId = {}.
"
, clientID);
final
boolean
success
=
assignState(
ConnectionState
h2_storage/src/main/java/io/moquette/persistence/h2/H2SessionsStore.java
+17
−2
h2_storage/src/test/java/io/moquette/persistence/h2/H2PersistentQueueTest.java
+2
−1
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+1
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBMessagesStore.java
+1
−0
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBPersistentStore.java
+8
−6
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBSessionsStore.java
+3
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.
init(ks);
contextBuilder
.
clientAuth(
ClientAuth
.
REQUIRE
);
contextBuilder
.
trustManager(tmf);
}
private
SslProvider
"
>
Contributors may not remove or alter any
copyright notices contained within the Program.
</
span
>
</
p
>
<
p
>
extends
ChannelDuplexHandler
{
@@ -37,7 +39,7 @@ public void userEventTriggered(ChannelHandlerContext ctx, Object evt) throws Exc
LOG
.
info(
"
Firing channel inactive event. MqttClientId = {}.
"
,
NettyUtils
.
clientID(ctx
.
channel()));
//
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
5
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
Show comments
View file
Edit file
Delete file
@@ -54,6 +54,7 @@
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
//
skip it's a black line
continue
;
}
//
split till the first space
int
delimiterIdx
=
line
.
indexOf(
'
'
);
String
key
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
ISubscriptionsStore
subscriptionStore
() {
return
this
;
}
@Override
public
void
addNewSubscription
(
Subscription
newSubscription
) {
final
String
clientID
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
sessionsStore
.
queue(clientID)
.
poll();
if
(msg
==
null
) {
return
null
;
}
int
messageId
=
this
.
useFineMetrics
=
Boolean
.
parseBoolean(props
.
getProperty(
METRICS_ENABLE_PROPERTY_NAME
,
"
false
"
));
if
(useFineMetrics) {
DropWizardMetricsHandler
metricsHandler
=
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBPersistentStore.java
+8
−6
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBSessionsStore.java
+3
−1
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBPersistentStoreTest.java
+2
−1
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBSessionsStoreTest.java
+17
−6
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
+14
−1
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
+9
SortedIndex<
String
,
StoredPublishEvent
>
m_inflightStore;
//
bind clientID+MsgID -> evt message published
private
SortedIndex<
String
,
StoredPublishEvent
>
m_qos2Store;
//
new
InitEvent
(configProps));
}
private
void
disruptorPublish
(
MessagingEvent
msgEvent
) {
LOG
.
debug(
"
disruptorPublish publishing event {}
"
, msgEvent);
=
Executors
.
newFixedThreadPool(
1
);
m_ringBuffer
=
new
RingBuffer<
ValueEvent
>
(
ValueEvent
.
EVENT_FACTORY
,
1024
IMatchingCondition
condition
) {
LOG
.
debug(
"
searchMatching scanning all retained messages, presents are {}
"
, m_retainedStore
.
size());
List<
HawtDBStorageService
.
StoredMessage
>
.
INTERCEPTORS_NOTIFIED
,
ConnectionState
.
DISCONNECTED
);
if
(
!
success) {
return
false
;
}
this
.
channel
−1
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBPersistentStoreTest.java
+2
−1
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBSessionsStoreTest.java
+17
−6
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
+14
−1
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
+9
−8
perf/src/main/java/io/moquette/parser/netty/performance/LoopMQTTHandler.java
+6
−3
perf/src/main/java/io/moquette/parser/netty/performance/NettyPublishReceiverHandler.java
getSSLProvider
() {
String
providerName
=
props
.
getProperty(
BrokerConstants
.
SSL_PROVIDER
,
SslProvider
.
JDK
.
name());
try
{
<
span
style
="
font-size: 10pt;
"
>
Each Contributor must identify itself as the
originator of its Contribution, if any, in a manner that reasonably allows
subsequent Recipients to identify the originator of the Contribution.
</
span
>
</
p
>
<
p
fire a channelInactive to trigger publish of Will
ctx
.
fireChannelInactive();
ctx
.
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
}
else
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
queueRepository;
@Before
public
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/ProtocolEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
=
line
.
substring(
0
, delimiterIdx)
.
trim();
String
value
=
line
.
substring(delimiterIdx)
.
trim();
m_properties
=
newSubscription
.
getClientId();
Session
session
=
sessions
.
get(clientID);
if
(session
==
null
) {
LOG
.
error(
"
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
inFlightAckWaiting(msg);
return
new
EnqueuedMessage
(msg, messageId);
}
@Override
public
void
enqueue
(
IMessagesStore
.
StoredMessage
message
) {
this
new
DropWizardMetricsHandler
();
metricsHandler
.
init(props);
this
.
metrics
=
Optional
.
of(metricsHandler);
}
else
{
this
.
−8
perf/src/main/java/io/moquette/parser/netty/performance/LoopMQTTHandler.java
+6
−3
perf/src/main/java/io/moquette/parser/netty/performance/NettyPublishReceiverHandler.java
+10
−5
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolDecodingServer.java
+8
−3
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolPublishDecodingServer.java
+10
−4
perf/src/main/java/io/moquette/parser/netty/performance/PublishBomber.java
+4
−3
perf/src/main/java/io/moquette/parser/netty/performance/PublishReceiverHandler.java
persistent Map of clientID, set of Subscriptions
private
SortedIndex<
String
,
Set<
Subscription
>
>
m_persistentSubscriptions;
public
HawtDBStorageService
() {
String
storeFile
=
Server
.
long
sequence
=
m_ringBuffer
.
next();
ValueEvent
event
=
m_ringBuffer
.
get(sequence);
event
.
setEvent(msgEvent);
m_ringBuffer
.
publish(sequence);
*
32
);
SequenceBarrier
barrier
=
m_ringBuffer
.
newBarrier();
m_eventProcessor
=
new
BatchEventProcessor<
ValueEvent
>
(m_ringBuffer, barrier,
this
);
results
=
new
ArrayList<
HawtDBStorageService
.
StoredMessage
>();
for
(
Map
.
Entry<
String
,
HawtDBStorageService
.
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
return
true
;
}
public
String
getUsername
() {
return
NettyUtils
.
+10
−5
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolDecodingServer.java
+8
−3
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolPublishDecodingServer.java
+10
−4
perf/src/main/java/io/moquette/parser/netty/performance/PublishBomber.java
+4
−3
perf/src/main/java/io/moquette/parser/netty/performance/PublishReceiverHandler.java
+1
−2
tools_scripts/integration/bunch_publish_issue12.groovy
4
broker/src/main/java/io/moquette/interception/HazelcastInterceptHandler.java
return
SslProvider
.
valueOf(providerName);
}
catch
(
IllegalArgumentException
e) {
LOG
.
warn(
"
unknown SSL Provider {}, falling back on JDK provider
"
, providerName);
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
4. COMMERCIAL DISTRIBUTION
</
span
>
</
{
if
(
LOG
.
isDebugEnabled()) {
8
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
Show comments
View file
Edit file
Delete file
@@ -44,6 +44,7 @@
import
io.netty.handler.ssl.SslHandler
;
import
void
setUp
() {
@@ -82,9 +83,9 @@ private SessionRegistry initPostOfficeAndSubsystems() {
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
retainedRepository
=
new
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.Utils
;
15
.
put(key, value);
}
}
}
catch
(
IOException
ex) {
throw
new
ParseException
(
"
Failed to read
"
,
1
Can't find the session for client <{}>
"
, clientID);
return
;
}
session
.
subscriptions
.
put(newSubscription
.
getTopicFilter(), newSubscription);
}
@Override
public
void
wipeSubscriptions
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
sessionsStore
.
queue(
this
.
clientID)
.
add(message);
}
@Override
public
IMessagesStore
.
StoredMessage
completeReleasedPublish
(
metrics
=
Optional
.
empty();
}
final
boolean
useBugSnag
=
Boolean
.
parseBoolean(props
.
getProperty(
BUGSNAG_ENABLE_PROPERTY_NAME
,
"
false
+1
−2
tools_scripts/integration/bunch_publish_issue12.groovy
4
broker/src/main/java/io/moquette/interception/HazelcastInterceptHandler.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,7 @@
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import static
STORAGE_FILE_PATH
;
pageFactory
=
new
PageFileFactory
();
File
tmpFile;
try
{
tmpFile
=
new
File
(storeFile);
tmpFile
}
public
void
disconnect
(
ServerChannel
session
) {
disruptorPublish(
new
DisconnectEvent
(session));
}
public
void
lostConnection
(
String
//
TODO in a presentation is said to don't do the followinf line!!
m_ringBuffer
.
setGatingSequences(m_eventProcessor
.
getSequence());
m_executor
.
submit(m_eventProcessor);
}
void
processConnect
(
ServerChannel
session
,
ConnectMessage
StoredMessage
>
entry
:
m_retainedStore
.
entrySet()) {
HawtDBStorageService
.
StoredMessage
storedMsg
=
entry
.
getValue();
if
(condition
.
userName(
this
.
channel);
}
public
void
abort
() {
LOG
.
info(
"
Closing connection descriptor. MqttClientId = {}.
"
, clientID);
//
try {
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,7 @@
import
org.slf4j.Logger
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
org.slf4j.LoggerFactory
;
import static
return
SslProvider
.
JDK
;
}
}
@@ -124,7 +182,6 @@ private InputStream jksDatastore(String jksPath) throws FileNotFoundException {
LOG
.
info(
"
Loading external keystore. Url = {}.
"
, jksFile
.
getAbsolutePath());
b
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
Commercial distributors of software may
accept certain responsibilities with respect to end users, business partners
and the like. While this license is intended to facilitate the commercial use
of the Program, the Contributor who includes the Program in a commercial
io.netty.handler.timeout.IdleStateHandler
;
import
io.netty.util.concurrent.Future
;
import
io.netty.util.concurrent.GenericFutureListener
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
javax.net.ssl.SSLContext
;
@@ -53,6 +54,7 @@
MemoryRetainedRepository
();
queueRepository
=
new
MemoryQueueRepository
();
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
SessionRegistry
sessionRegistry
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PubAckEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
);
}
finally
{
try
{
reader
.
close();
}
catch
(
IOException
e) {
//
ignore
}
(
String
clientID
) {
if
(
!
sessions
.
containsKey(clientID)) {
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
return
int
messageID
) {
return
this
.
sessionsStore
.
completeReleasedPublish(clientID, messageID);
}
@Override
public
int
getPendingPublishMessagesNo
() {
return
this
.
"
));
if
(useBugSnag) {
BugSnagErrorsHandler
bugSnagHandler
=
new
BugSnagErrorsHandler
();
bugSnagHandler
.
init(props);
this
.
errorsCather
=
Optional
io.moquette.spi.impl.Utils.readBytesAndRewind
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
public
class
HazelcastInterceptHandler
extends
AbstractInterceptHandler
{
@@ -45,7 +46,8 @@ public void onPublish(InterceptPublishMessage msg) {
ByteBuf
payload
=
msg
.
getPayload();
.
createNewFile();
}
catch
(
IOException
ex) {
LOG
.
error(
null
, ex);
throw
new
MQTTException
(
"
Can't create temp file for subscriptions storage [
clientID
) {
disruptorPublish(
new
LostConnectionEvent
(clientID));
}
public
void
handleProtocolMessage
(
ServerChannel
session
,
AbstractMessage
msg
) {
msg
) {
LOG
.
debug(
"
processConnect for client {}
"
, msg
.
getClientID());
if
(msg
.
getProcotolVersion()
!=
0x03
) {
ConnAckMessage
match(entry
.
getKey())) {
results
.
add(storedMsg);
}
}
return
results;
}
public
void
storePublishForFuture
(
PublishEvent
evt
) {
//
this.channel.disconnect().sync();
this
.
channel
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
//
.sync();
//
} catch (InterruptedException e) {
//
e.printStackTrace();
//
io.moquette.spi.impl.Utils.readBytesAndRewind
;
import static
io.moquette.spi.impl.Utils.readBytesAndRewind
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
public
class
HazelcastInterceptHandler
extends
AbstractInterceptHandler
{
public
class
HazelcastInterceptHandler
extends
return
new
FileInputStream
(jksFile);
}
LOG
.
warn(
"
The keystore file does not exist. Url = {}.
"
, jksFile
.
getAbsolutePath());
return
null
;
throw
product offering should do so in a manner which does not create potential
liability for other Contributors. Therefore, if a Contributor includes the
Program in a commercial product offering, such Contributor ("Commercial
Contributor") hereby agrees to defend and indemnify every other
Contributor ("Indemnified Contributor") against any losses, damages and
costs (collectively "Losses") arising from claims, lawsuits and other
legal actions brought by a third party against the Indemnified Contributor to
the extent caused by the acts or omissions of such Commercial Contributor in
connection with its distribution of the Program in a commercial product
offering. The obligations in this section do not apply to any claims or Losses
relating to any actual or alleged intellectual property infringement. In order
to qualify, an Indemnified Contributor must: a) promptly notify the Commercial
Contributor in writing of such claim, and b) allow the Commercial Contributor
import
java.util.Optional
;
import
java.util.concurrent.TimeUnit
;
import static
io.moquette.BrokerConstants.*
;
import static
=
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PublishEvent.java
Show comments
View file
}
}
Properties
getProperties
() {
return
m_properties;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
;
}
sessions
.
get(clientID)
.
subscriptions
.
clear();
}
@Override
public
boolean
contains
(
String
clientID
) {
sessionsStore
.
queue(clientID)
.
size();
}
@Override
public
int
countPubReleaseWaitingPubComplete
() {
return
this
.
sessionsStore
.
countPubReleaseWaitingPubComplete(clientID);
}
@Override
.
of(bugSnagHandler);
}
else
{
this
.
errorsCather
=
Optional
.
empty();
}
initializePlainTCPTransport(mqttHandler, props);
initializeWebSocketTransport(mqttHandler, props);
String
sslTcpPortProp
byte
[] payloadContent
=
readBytesAndRewind(payload);
LOG
.
info(
"
"
, msg
.
getClientID(), msg
.
getTopicName(),
new
String
(payloadContent));
"
+
storeFile
+
"
]
"
, ex);
}
pageFactory
.
setFile(tmpFile);
pageFactory
.
open();
PageFile
pageFile
disruptorPublish(
new
ProtocolEvent
(session, msg));
}
public
void
stop
() {
m_stopLatch
=
new
CountDownLatch
(
1
);
disruptorPublish(
new
badProto
=
new
ConnAckMessage
();
badProto
.
setReturnCode(
ConnAckMessage
.
UNNACEPTABLE_PROTOCOL_VERSION
);
LOG
.
warn(
"
processConnect sent bad proto ConnAck
"
);
LOG
.
debug(
"
storePublishForFuture store evt {}
"
, evt);
List<
PublishEvent
>
storedEvents;
String
clientID
=
evt
.
getClientID();
if
}
}
public
boolean
assignState
(
ConnectionState
expected
,
ConnectionState
newState
) {
LOG
.
debug(
"
"
AbstractInterceptHandler
{
@@ -45,7 +46,8 @@ public void onPublish(InterceptPublishMessage msg) {
ByteBuf
payload
=
msg
.
getPayload();
ByteBuf
payload
=
msg
.
getPayload();
byte
[] payloadContent
=
new
FileNotFoundException
(
"
The keystore file does not exist. Url =
"
+
jksFile
.
getAbsolutePath());
}
}
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
d50a291
Please
to control, and cooperate with the Commercial Contributor in, the defense and
any related settlement negotiations. The Indemnified Contributor may participate
in any such claim at its own expense.
</
span
>
</
p
>
<
p
>
<
span
style
="
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
public
class
NettyAcceptor
implements
ServerAcceptor
{
@@ -85,7 +87,7 @@ protected void encode(ChannelHandlerContext chc, ByteBuf bb, List<Object> out) t
}
}
abstract
class
PipelineInitializer
{
abstract
static
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
sessionRegistry;
5
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
Show comments
View file
Edit file
Delete file
@@ -64,6 +64,7 @@
static
final
BrokerConfiguration
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
return
sessions
.
containsKey(clientID);
}
@Override
public
void
createNewDurableSession
(
String
clientID
) {
Session
innerSession
=
new
Session
public
int
getInflightMessagesNo
() {
return
this
.
sessionsStore
.
getInflightMessagesNo(clientID);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
=
props
.
getProperty(
BrokerConstants
.
SSL_PORT_PROPERTY_NAME
);
String
wssPortProp
=
props
.
getProperty(
BrokerConstants
.
WSS_PORT_PROPERTY_NAME
);
if
LOG
.
info(
"
"
, msg
.
getClientID(), msg
.
getTopicName(),
new
String
(payloadContent,
UTF_8
));
ITopic<
HazelcastMsg
>
=
pageFactory
.
getPageFile();
m_multiIndexFactory
=
new
MultiIndexFactory
(pageFile);
}
public
void
initStore
() {
initRetainedStore();
//
init the message store for QoS 1/2 messages in clean sessions
initPersistentMessageStore();
StopEvent
());
try
{
//
wait the callback notification from the protocol processor thread
boolean
elapsed
=
!
m_stopLatch
.
await(
10
,
TimeUnit
.
SECONDS
session
.
write(badProto);
session
.
close(
false
);
return
;
}
if
(msg
.
getClientID()
==
null
(
!
m_persistentMessageStore
.
containsKey(clientID)) {
storedEvents
=
new
ArrayList<
PublishEvent
>
();
}
else
{
storedEvents
=
m_persistentMessageStore
,
clientID,
expected,
newState);
boolean
retval
=
channelState
.
compareAndSet(expected, newState);
if
(
!
retval) {
LOG
.
error(
"
readBytesAndRewind(payload);
byte
[] payloadContent
=
readBytesAndRewind(payload);
LOG
.
info(
"
"
, msg
.
getClientID(), msg
.
getTopicName(),
new
String
(payloadContent));
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
font-size: 10pt;
"
>
For example, a Contributor might include the
Program in a commercial product offering, Product X. That Contributor is then a
Commercial Contributor. If that Commercial Contributor then makes performance
claims, or offers warranties related to Product X, those performance claims and
warranties are such Commercial Contributor's responsibility alone. Under this
section, the Commercial Contributor would have to defend claims against the
other Contributors related to those performance claims and warranties, and if a
court requires any other Contributor to pay any damages as a result, the
Commercial Contributor must pay those damages.
</
span
>
</
class
PipelineInitializer
{
abstract
void
init
(
ChannelPipeline
pipeline
)
throws
Exception
;
}
@@ -197,7 +199,7 @@ public void initChannel(SocketChannel ch) throws Exception {
//
Bind and start to accept incoming connections.
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
queueRepository;
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage.QOSType
;
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
666cc29
Please
sign in
to comment.
© 2020 GitHub, Inc.
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
(clientID,
false
);
sessions
.
put(clientID, innerSession);
}
@Override
public
void
removeDurableSession
(
String
clientId
) {
this
.
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
(sslTcpPortProp
!=
null
||
wssPortProp
!=
null
) {
SSLContext
sslContext
=
sslCtxCreator
.
initSSLContext();
if
(sslContext
==
null
topic
=
hz
.
getTopic(
"
moquette
"
);
HazelcastMsg
hazelcastMsg
=
new
HazelcastMsg
(msg);
topic
.
initInflightMessageStore();
initPersistentSubscriptions();
initPersistentQoS2MessageStore();
}
private
void
initRetainedStore
() {
BTreeIndexFactory<
String
,
StoredMessage
>
indexFactory
=
new
BTreeIndexFactory<
String
);
if
(elapsed) {
LOG
.
error(
"
Can't stop the server in 10 seconds
"
);
}
}
catch
(
InterruptedException
ex) {
LOG
.
||
msg
.
getClientID()
.
length()
>
23
) {
ConnAckMessage
okResp
=
new
ConnAckMessage
();
okResp
.
.
get(clientID);
}
storedEvents
.
add(evt);
m_persistentMessageStore
.
put(clientID, storedEvents);
}
@Override
public
List<
PublishEvent
>
retrievePersistedPublishes
Unable to update state of connection descriptor.
"
+
"
"
,
clientID,
expected,
newState);
}
return
retval;
}
@Override
public
String
toString
LOG
.
info(
"
"
, msg
.
getClientID(), msg
.
getTopicName(),
new
String
(payloadContent,
UTF_8
));
ITopic<
HazelcastMsg
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
5. NO WARRANTY
</
span
ChannelFuture
f
=
b
.
bind(host, port);
LOG
.
info(
"
"
, host, port);
f
.
sync();
f
.
sync()
@Before
public
void
setUp
() {
@@ -89,9 +90,9 @@ private SessionRegistry initPostOfficeAndSubsystems() {
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
retainedRepository
=
new
MemoryRetainedRepository
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
sessions
.
remove(clientId);
this
.
wipeSubscriptions(clientId);
}
@Override
public
void
updateCleanStatus
(
String
clientId
,
boolean
newCleanStatus
) {
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
) {
LOG
.
error(
"
Can't initialize SSLHandler layer! Exiting, check your configuration of jks
"
);
return
;
}
initializeSSLTCPTransport(mqttHandler, props, sslContext);
initializeWSSTransport(mqttHandler, props, sslContext);
}
}
private
void
initFactory
publish(hazelcastMsg);
6
broker/src/main/java/io/moquette/interception/messages/InterceptConnectMessage.java
Show comments
View file
Edit file
Delete file
@@ -18,6 +18,8 @@
import
io.netty.handler.codec.mqtt.MqttConnectMessage
;
import
java.nio.charset.StandardCharsets
;
public
class
InterceptConnectMessage
extends
,
StoredMessage
>
();
indexFactory
.
setKeyCodec(
StringCodec
.
INSTANCE
);
m_retainedStore
=
(
SortedIndex<
String
,
error(
null
, ex);
}
}
public
void
onEvent
(
ValueEvent
t
,
long
l
,
boolean
bln
)
setReturnCode(
ConnAckMessage
.
IDENTIFIER_REJECTED
);
session
.
write(okResp);
return
;
}
//
if an old client with the same ID already exists close its session.
if
(m_clientIDs
.
containsKey(msg
.
getClientID())) {
(
String
clientID
) {
return
m_persistentMessageStore
.
get(clientID);
}
public
void
cleanPersistedPublishMessage
(
String
clientID
,
int
messageID
() {
return
"
ConnectionDescriptor{
"
+
"
clientID=
"
+
clientID
+
"
, removeTemporaryQoS2=
"
+
cleanSession
>
topic
=
hz
.
getTopic(
"
moquette
"
);
ITopic<
HazelcastMsg
>
topic
=
hz
.
getTopic(
"
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
>
</
b
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
EXCEPT AS EXPRESSLY SET FORTH IN THIS
AGREEMENT, THE PROGRAM IS PROVIDED ON AN "AS IS" BASIS, WITHOUT
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
)
;
}
catch
(
InterruptedException
ex) {
LOG
.
error(
"
An interruptedException was caught while initializing server. Protocol={}
"
, protocol, ex);
}
@@ -349,6 +351,8 @@ void init(ChannelPipeline pipeline) throws Exception {
();
queueRepository
=
new
MemoryQueueRepository
();
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
SessionRegistry
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
sessions
.
get(clientId)
.
cleanSession
=
newCleanStatus;
}
@Override
public
PersistentSession
loadSessionByKey
(
String
clientID
) {
return
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
(
String
host
,
int
port
,
String
protocol
,
final
PipelineInitializer
pipeliner
) {
LOG
.
info(
"
Initializing server. Protocol={}
InterceptAbstractMessage
{
private
final
MqttConnectMessage
msg;
@@ -72,14 +74,14 @@ public String getUsername() {
}
public
byte
[]
getPassword
() {
return
msg
.
StoredMessage
>
) m_multiIndexFactory
.
openOrCreate(
"
retained
"
, indexFactory);
}
private
void
initPersistentMessageStore
() {
BTreeIndexFactory<
String
,
throws
Exception
{
MessagingEvent
evt
=
t
.
getEvent();
LOG
.
info(
"
onEvent processing messaging event from input ringbuffer {}
"
, evt);
if
(evt
//
clean the subscriptions if the old used a cleanSession = true
ServerChannel
oldSession
=
m_clientIDs
.
get(msg
.
getClientID())
.
getSession();
boolean
cleanSession
=
(
Boolean
) oldSession
) {
List<
PublishEvent
>
events
=
m_persistentMessageStore
.
get(clientID);
PublishEvent
toRemoveEvt
=
null
;
for
(
PublishEvent
evt
:
+
"
, state=
"
+
channelState
.
get()
+
'
}
'
;
}
@Override
public
boolean
equals
(
moquette
"
);
HazelcastMsg
hazelcastMsg
=
new
HazelcastMsg
(msg);
HazelcastMsg
hazelcastMsg
=
new
HazelcastMsg
(msg);
topic
.
publish(hazelcastMsg);
topic
WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING,
WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT,
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely
responsible for determining the appropriateness of using and distributing the
Program and assumes all risks associated with its exercise of rights under this
Agreement , including but not limited to the risks and costs of program errors,
compliance with applicable laws, damage to or loss of data, programs or
equipment, and unavailability or interruption of operations.
</
span
>
</
p
>
<
p
>
});
}
@SuppressWarnings
(
"
FutureReturnValueIgnored
"
)
@Override
public
void
close
() {
LOG
.
info(
"
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
new
PersistentSession
(clientID, sessions
.
get(clientID)
.
cleanSession);
}
@Override
public
Collection<
PersistentSession
>
listAllSessions
() {
Collection<
PersistentSession
"
, protocol);
ServerBootstrap
b
=
new
ServerBootstrap
();
b
.
group(m_bossGroup, m_workerGroup)
.
channel(channelClass)
.childHandler(
new
ChannelInitializer<
SocketChannel
>
() {
payload()
.
password()
.
getBytes();
return
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
public
List<
StoredPublishEvent
>
>
indexFactory
=
new
BTreeIndexFactory<
String
,
List<
StoredPublishEvent
>
>
();
indexFactory
.
setKeyCodec(
StringCodec
instanceof
PublishEvent
) {
m_processor
.
processPublish((
PublishEvent
) evt);
}
else
if
(evt
instanceof
StopEvent
) {
processStop();
}
else
.
getAttribute(
Constants
.
CLEAN_SESSION
);
if
(cleanSession) {
//
cleanup topic subscriptions
processRemoveAllSubscriptions(msg
.
getClientID());
}
m_clientIDs
.
get(msg
.
events) {
if
(evt
.
getMessageID()
==
messageID) {
toRemoveEvt
=
evt;
}
}
events
.
remove(toRemoveEvt);
m_persistentMessageStore
.
put(clientID, events);
Object
o
) {
if
(
this
==
o)
return
true
;
if
(o
==
null
||
getClass()
.
publish(hazelcastMsg);
6
broker/src/main/java/io/moquette/interception/messages/InterceptConnectMessage.java
Show comments
View file
Edit file
Delete file
@@ -18,6 +18,8 @@
import
io.netty.handler.codec.mqtt.MqttConnectMessage
;
import
io.netty.handler.codec.mqtt.MqttConnectMessage
;
import
java.nio.charset.StandardCharsets
<
b
>
<
span
style
="
font-size: 10pt;
"
>
6. DISCLAIMER OF LIABILITY
</
span
>
</
b
>
Closing Netty acceptor...
"
);
if
(m_workerGroup
==
null
||
m_bossGroup
==
null
) {
14
broker/src/main/java/io/moquette/server/netty/NettyMQTTHandler.java
Show comments
View file
Edit file
sessionRegistry;
4
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
Show comments
View file
Edit file
Delete file
@@ -65,6 +65,7 @@
private
IAuthenticator
mockAuthenticator;
private
SessionRegistry
sessionRegistry;
public
static
final
BrokerConfiguration
>
result
=
new
ArrayList<>
();
for
(
Session
entry
:
sessions
.
values()) {
result
.
add(
new
@Override
public
void
initChannel
(
SocketChannel
ch
)
throws
Exception
{
ChannelPipeline
pipeline
=
ch
.
pipeline();
String
getWillTopic
() {
return
msg
.
payload()
.
willTopic();
}
public
byte
[]
getWillMessage
() {
return
msg
.
payload()
.
INSTANCE
);
m_persistentMessageStore
=
(
SortedIndex<
String
,
List<
StoredPublishEvent
>
>
) m_multiIndexFactory
.
openOrCreate(
"
persistedMessages
if
(evt
instanceof
DisconnectEvent
) {
DisconnectEvent
disEvt
=
(
DisconnectEvent
) evt;
String
clientID
=
(
String
) disEvt
.
getClientID())
.
getSession()
.
close(
false
);
}
ConnectionDescriptor
connDescr
=
new
ConnectionDescriptor
(msg
.
getClientID(), session, msg
.
isCleanSession());
m_clientIDs
}
public
void
cleanPersistedPublishes
(
String
clientID
) {
m_persistentMessageStore
.
remove(clientID);
}
public
void
cleanInFlight
(
String
msgID
!=
o
.
getClass())
return
false
;
ConnectionDescriptor
that
=
(
ConnectionDescriptor
) o;
if
(clientID
!=
null
?
;
public
class
InterceptConnectMessage
extends
InterceptAbstractMessage
{
public
class
InterceptConnectMessage
extends
InterceptAbstractMessage
{
private
final
MqttConnectMessage
msg;
private
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
EXCEPT AS EXPRESSLY SET FORTH IN THIS
AGREEMENT, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
Delete file
@@ -24,6 +24,8 @@
import
io.netty.util.ReferenceCountUtil
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_MOST_ONCE
;
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
public
void
PersistentSession
(entry
.
clientID, entry
.
cleanSession));
}
return
result;
}
@Override
public
List<
Subscription
>
listAllSubscriptions
() {
List<
Subscription
try
{
pipeliner
.
init(pipeline);
}
catch
(
Throwable
th) {
LOG
.
error(
"
Severe error during pipeline creation
"
, th);
throw
.
willMessage()
.
getBytes();
return
msg
.
payload()
.
willMessage()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
}
2
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
"
, indexFactory);
}
private
void
initPersistentSubscriptions
() {
BTreeIndexFactory<
String
,
Set<
Subscription
>
>
indexFactory
=
new
getSession()
.
getAttribute(
Constants
.
ATTR_CLIENTID
);
m_processor
.
processDisconnect(disEvt
.
getSession(), clientID,
false
);
}
else
if
(evt
.
put(msg
.
getClientID(), connDescr);
int
keepAlive
=
msg
.
getKeepAlive();
LOG
.
debug(
"
Connect with keepAlive {} s
"
, keepAlive);
session
.
) {
m_inflightStore
.
remove(msgID);
}
public
void
addInFlight
(
PublishEvent
evt
,
String
publishKey
) {
m_inflightStore
.
put(publishKey, evt);
!
clientID
.
equals(that
.
clientID)
:
that
.
clientID
!=
null
)
return
false
;
return
!
final
MqttConnectMessage
msg;
@@ -72,14 +74,14 @@ public String getUsername() {
}
}
public
byte
[]
getPassword
() {
public
byte
[]
getPassword
() {
return
msg
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF
THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF
THE POSSIBILITY OF SUCH DAMAGES.
</
span
>
</
p
>
<
p
>
<
b
>
<
span
style
@Sharable
@@ -78,16 +80,16 @@ public void channelRead(ChannelHandlerContext ctx, Object message) {
false
,
0
);
MqttMessage
pingResp
=
new
MqttMessage
(pingHeader);
ctx
.
writeAndFlush(pingResp);
ctx
.
setUp
() {
@@ -87,8 +88,9 @@ private void prepareSUT() {
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
>
allSubscriptions
=
new
ArrayList<>
();
for
(
Session
entry
:
sessions
.
values()) {
allSubscriptions
.
addAll(entry
.
th;
}
}
})
.
option(
ChannelOption
.
SO_BACKLOG
, nettySoBacklog)
.
option(
ChannelOption
.
SO_REUSEADDR
, nettySoReuseaddr)
.option(
ChannelOption
Show comments
View file
Edit file
Delete file
@@ -41,7 +41,7 @@ public void initStore() {
public
void
storeRetained
(
Topic
topic
,
StoredMessage
storedMessage
) {
LOG
.
BTreeIndexFactory<
String
,
Set<
Subscription
>
>
();
indexFactory
.
setKeyCodec(
StringCodec
.
INSTANCE
);
m_persistentSubscriptions
=
(
instanceof
ProtocolEvent
) {
ServerChannel
session
=
((
ProtocolEvent
) evt)
.
getSession();
AbstractMessage
message
=
((
ProtocolEvent
) evt)
.
getMessage();
setAttribute(
Constants
.
KEEP_ALIVE
, keepAlive);
session
.
setAttribute(
Constants
.
CLEAN_SESSION
, msg
.
isCleanSession());
//
used to track the client in the subscription and publishing phases.
session
.
setAttribute(
}
public
void
addNewSubscription
(
Subscription
newSubscription
,
String
clientID
) {
if
(
!
m_persistentSubscriptions
.
containsKey(clientID)) {
m_persistentSubscriptions
(channel
!=
null
?
!
channel
.
equals(that
.
channel)
:
that
.
channel
!=
null
);
}
public
.
payload()
.
password()
.
getBytes();
return
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
="
font-size: 10pt;
"
>
7. GENERAL
</
span
>
</
b
>
</
p
>
<
p
>
<
span
writeAndFlush(pingResp)
.
addListener(
CLOSE_ON_FAILURE
)
;
break
;
default
:
LOG
.
error(
"
Unkonwn MessageType:{}
"
, messageType);
break
;
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
subscriptions
.
values());
}
return
allSubscriptions;
}
@Override
public
Collection<
Subscription
>
listClientSubscriptions
(
String
clientID
) {
final
.
TCP_NODELAY
, nettyTcpNodelay)
.childOption(
ChannelOption
.
SO_KEEPALIVE
, nettySoKeepalive);
try
{
LOG
.
info(
"
"
, host, port);
//
debug(
"
"
, topic, storedMessage
.
getClientID());
if
(storedMessage
.
getClientID()
==
null
) {
throw
new
SortedIndex<
String
,
Set<
Subscription
>
>
) m_multiIndexFactory
.
openOrCreate(
"
subscriptions
"
, indexFactory);
if
(message
instanceof
ConnectMessage
) {
m_processor
.
processConnect(session, (
ConnectMessage
) message);
}
else
Constants
.
ATTR_CLIENTID
, msg
.
getClientID());
session
.
setIdleTime(
Math
.
put(clientID,
new
HashSet<
Subscription
>
());
}
Set<
Subscription
>
subs
BytesMetrics
getBytesMetrics
() {
return
BytesMetricsHandler
.
getBytesMetrics(channel);
}
public
MessageMetrics
}
}
public
String
getWillTopic
() {
public
String
getWillTopic
style
="
font-size: 10pt;
"
>
If any provision of this Agreement is invalid
or unenforceable under applicable law, it shall not affect the validity or
enforceability of the remainder of the terms of this Agreement, and without
further action by the parties hereto, such provision shall be reformed to the
minimum extent necessary to make such provision valid and enforceable.
</
span
}
}
catch
(
Throwable
ex) {
LOG
.
error(
"
Exception was caught while processing MQTT message,
);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
Session
session
=
sessions
.
get(clientID);
if
(session
==
null
) {
throw
Bind and start to accept incoming connections.
ChannelFuture
f
=
b
.
bind(host, port);
LOG
.
info(
"
"
, host, port);
f
.
sync()
.
IllegalArgumentException
(
"
Message to be persisted must have a not null client ID
"
);
throw
new
IllegalArgumentException
(
"
Message to be persisted must have a not null client ID
"
);
}
m_retainedStore
.
put(topic, storedMessage);
}
/**
* Initialize the message store used to handle the temporary storage of QoS 1,2
* messages in flight.
*/
private
void
initInflightMessageStore
() {
BTreeIndexFactory<
String
,
StoredPublishEvent
>
indexFactory
=
new
moquette/DebugUtils.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
if
(message
instanceof
PublishMessage
) {
PublishEvent
pubEvt;
String
clientID
=
(
String
) session
.
getAttribute(
Constants
.
ATTR_CLIENTID
);
.
round(keepAlive
*
1.5f
));
//
Handle will flag
if
(msg
.
isWillFlag()) {
AbstractMessage
.
QOSType
willQos
=
AbstractMessage
.
=
m_persistentSubscriptions
.
get(clientID);
if
(
!
subs
.
contains(newSubscription)) {
subs
.
add(newSubscription);
m_persistentSubscriptions
.
put(clientID, subs);
}
}
getMessageMetrics
() {
return
MessageMetricsHandler
.
getMessageMetrics(channel);
}
@Override
public
int
hashCode
() {
int
result
=
clientID
!=
moquette/about.html at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
() {
return
msg
.
payload()
.
willTopic();
return
msg
.
payload()
.
willTopic();
}
}
public
byte
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
If Recipient institutes patent litigation
against any entity (including a cross-claim or counterclaim in a lawsuit)
alleging that the Program itself (excluding combinations of the Program with
"
+
ex
.
getCause(), ex);
LOG
.
error(
"
Exception was caught while processing MQTT message,
{}
"
,
ex
.
getCause(), ex);
ctx
.
moquette/IPersistentSubscriptionStore.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
}
4
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
Show comments
View file
Edit file
Delete file
@@ -56,6 +56,7 @@
new
IllegalStateException
(
"
Asking for subscriptions of not persisted client:
"
+
clientID);
}
return
session
.
subscriptions
.
values();
}
@Override
public
moquette/IMatchingCondition.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
catch
(
InterruptedException
ex) {
LOG
.
error(
"
An interruptedException was caught while initializing server. Protocol={}
"
, protocol, ex);
}
}
private
}
3
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
Show comments
View file
Edit file
Delete file
@@ -33,7 +33,7 @@
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
BTreeIndexFactory<
String
,
StoredPublishEvent
>
();
indexFactory
.
setKeyCodec(
StringCodec
.
INSTANCE
);
m_inflightStore
=
(
SortedIndex<
String
,
moquette/FileAuthenticator.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
pubEvt
=
new
PublishEvent
((
PublishMessage
) message, clientID, session);
//
if (message.getQos() == QOSType.MOST_ONE) {
//
pubEvt = new PublishEvent(pubMsg.getTopicName(), pubMsg.getQos(), pubMsg.getPayload(), pubMsg.isRetainFlag(), clientID, session);
//
//
} else {
//
pubEvt = new PublishEvent(pubMsg.getTopicName(), pubMsg.getQos(), pubMsg.getPayload(), pubMsg.isRetainFlag(), clientID, pubMsg.getMessageID(), session);
//
}
m_processor
QOSType
.
values()[msg
.
getWillQos()];
byte
[] willPayload
=
msg
.
getWillMessage()
.
getBytes();
ByteBuffer
bb
=
(
ByteBuffer
public
void
removeAllSubscriptions
(
String
clientID
) {
m_persistentSubscriptions
.
remove(clientID);
}
public
List<
Subscription
>
retrieveAllSubscriptions
() {
List<
Subscription
moquette/IStorageService.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
null
?
clientID
.
hashCode()
:
0
;
result
=
31
*
result
+
(channel
!=
null
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
[]
getWillMessage
() {
public
byte
[]
getWillMessage
() {
return
msg
.
payload()
.
willMessage()
.
getBytes();
return
msg
.
other software or hardware) infringes such Recipient's patent(s), then such
Recipient's rights granted under Section 2(b) shall terminate as of the date
such litigation is filed.
</
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
moquette/IMessaging.java at 666cc29d47f57fc00798856e335e5270c0075a10 · moquette-io/moquette · GitHub
fireExceptionCaught(ex);
ctx
.
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
finally
{
ReferenceCountUtil
.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
private
IAuthenticator
mockAuthenticator;
private
SessionRegistry
sessionRegistry;
public
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
Subscription
reload
(
Subscription
subcription
) {
String
clientID
=
subcription
.
getClientId();
if
(
!
sessions
.
containsKey(clientID)) {
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
void
initializePlainTCPTransport
(
final
NettyMQTTHandler
handler
,
IConfig
props
)
throws
IOException
{
LOG
.
info(
"
Configuring TCP MQTT transport
MemorySessionStore
.
class);
class
Session
{
static
class
Session
{
final
String
clientID;
final
Map<
Topic
,
Subscription
StoredPublishEvent
>
) m_multiIndexFactory
.
openOrCreate(
"
inflight
"
, indexFactory);
}
private
void
initPersistentQoS2MessageStore
() {
BTreeIndexFactory<
String
,
StoredPublishEvent
>
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
.
processPublish(pubEvt);
}
else
if
(message
instanceof
DisconnectMessage
) {
String
clientID
=
(
String
) session
.
getAttribute(
Constants
)
ByteBuffer
.
allocate(willPayload
.
length)
.
put(willPayload)
.
flip();
PublishEvent
pubEvt
=
new
PublishEvent
(msg
.
getWillTopic(), willQos,
>
allSubscriptions
=
new
ArrayList<
Subscription
>
();
for
(
Map
.
Entry<
String
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
?
channel
.
hashCode()
:
0
);
return
result;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Added copyright and license notice to every source file, added about.… · moquette-io/moquette@666cc29 · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
payload()
.
willMessage()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
}
}
}
2
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
Show comments
View file
Edit file
>
All Recipient's rights under this Agreement
shall terminate if it fails to comply with any of the material terms or
conditions of this Agreement and does not cure such failure in a reasonable
period of time after becoming aware of such noncompliance. If all Recipient's
rights under this Agreement terminate, Recipient agrees to cease use and
distribution of the Program as soon as reasonably practicable. However,
Recipient's obligations under this Agreement and any licenses granted by
Recipient relating to the Program shall continue and survive.
</
span
>
</
p
>
<
p
>
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
release(msg);
}
@@ -97,17 +99,17 @@ public void channelRead(ChannelHandlerContext ctx, Object message) {
public
void
channelInactive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
String
clientID
=
NettyUtils
.
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
false
);
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
@@ -78,8 +79,9 @@ private void prepareSUT() {
subscriptions
=
new
CTrieSubscriptionDirectory
();
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
return
null
;
}
Map<
Topic
,
Subscription
>
subscriptions
=
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
"
);
final
MoquetteIdleTimeoutHandler
timeoutHandler
=
new
MoquetteIdleTimeoutHandler
();
String
host
=
props
.
getProperty(
BrokerConstants
.
HOST_PROPERTY_NAME
>
subscriptions
=
new
ConcurrentHashMap<>
();
boolean
cleanSession;
@@ -170,7 +170,6 @@ public Subscription reload(Subscription subcription) {
return
subscriptions
.
get(subcription
.
getTopicFilter());
}
@Override
indexFactory
=
new
BTreeIndexFactory<
String
,
StoredPublishEvent
>
();
indexFactory
.
setKeyCodec(
StringCodec
.
INSTANCE
);
m_qos2Store
=
moquette/build.gradle at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
.
ATTR_CLIENTID
);
boolean
cleanSession
=
(
Boolean
) session
.
getAttribute(
Constants
.
CLEAN_SESSION
);
//
bb, msg
.
isWillRetain(), msg
.
getClientID(), session);
processPublish(pubEvt);
}
//
handle user authentication
if
(msg
.
isUserFlag()) {
String
pwd
=
null
moquette/H2MessagesStoreTest.java at 1141e9f7a13f816cb46e57e47999a2de3d7ae1c8 · moquette-io/moquette · GitHub
,
Set<
Subscription
>
>
entry
:
m_persistentSubscriptions
.
entrySet()) {
allSubscriptions
.
addAll(entry
.
getValue());
}
return
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Delete file
@@ -41,7 +41,7 @@ public void initStore() {
public
void
storeRetained
(
Topic
topic
,
StoredMessage
storedMessage
) {
public
void
storeRetained
(
Topic
topic
<
span
style
="
font-size: 10pt;
"
>
Everyone is permitted to copy and distribute
copies of this Agreement, but in order to avoid inconsistency the Agreement is
copyrighted and may only be modified in the following manner. The Agreement
Steward reserves the right to publish new versions (including revisions) of
this Agreement from time to time. No one other than the Agreement Steward has
the right to modify this Agreement. The Eclipse Foundation is the initial
Agreement Steward. The Eclipse Foundation may assign the responsibility to
serve as the Agreement Steward to a suitable separate entity. Each new version
of the Agreement will be given a distinguishing version number. The Program
(including Contributions) may always be distributed subject to the version of
the Agreement under which it was received. In addition, after a new version of
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
clientID(ctx
.
channel());
if
(clientID
!=
null
&&
!
clientID
.
isEmpty()) {
LOG
.
info(
"
Notifying connection lost event. MqttClientId = {}
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
sessions
.
get(clientID)
.
subscriptions;
if
(subscriptions
==
null
||
subscriptions
.
isEmpty()) {
return
null
;
}
return
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
);
String
tcpPortProp
=
props
.
getProperty(
PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
if
(
DISABLED_PORT_BIND
.
equals(tcpPortProp)) {
LOG
public
StoredMessage
inFlightAck
(
String
clientID
,
int
messageID
) {
return
getSession(clientID)
.
outboundFlightMessages
.
remove(messageID);
10
broker/src/main/java/io/moquette/server/ConnectionDescriptor.java
moquette/gradlew.bat at 7267264503b8926699bb00c855b35bd31f95c5e8 · moquette-io/moquette · GitHub
(
SortedIndex<
String
,
StoredPublishEvent
>
) m_multiIndexFactory
.
openOrCreate(
"
qos2Store
"
, indexFactory);
}
@Override
public
void
storeRetained
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
moquette/build.gradle at 1141e9f7a13f816cb46e57e47999a2de3d7ae1c8 · moquette-io/moquette · GitHub
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
close the TCP connection
//
session.close(true);
m_processor
.
processDisconnect(session, clientID, cleanSession);
}
else
if
(message
instanceof
UnsubscribeMessage
) {
UnsubscribeMessage
unsubMsg
=
(
UnsubscribeMessage
) message;
;
if
(msg
.
isPasswordFlag()) {
pwd
=
msg
.
getPassword();
}
if
(
!
m_authenticator
.
checkValid(msg
.
getUsername(), pwd)) {
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
allSubscriptions;
}
public
void
close
() {
//
To change body of implemented methods use File | Settings | File Templates.
}
public
void
persistQoS2Message
(
String
publishKey
,
PublishEvent
moquette/H2PersistentQueueTest.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Added copyright and license notice to every source file, added about.… · moquette-io/moquette@666cc29 · GitHub
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
,
StoredMessage
storedMessage
) {
LOG
.
debug(
"
"
, topic, storedMessage
.
getClientID());
LOG
.
debug(
"
"
, topic, storedMessage
the Agreement is published, Contributor may elect to distribute the Program
(including its Contributions) under the new version. Except as expressly stated
in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to
the intellectual property of any Contributor under this Agreement, whether
expressly, by implication, estoppel or otherwise. All rights in the Program not
expressly granted under this Agreement are reserved.
</
span
>
</
p
>
<
p
>
<
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
.
"
, clientID);
LOG
.
info(
"
Notifying connection lost event. MqttClientId = {}
"
, clientID);
m_processor
.
processConnectionLost(clientID, ctx
.
channel());
}
ctx
.
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
);
sut
=
new
subscriptions
.
get(subcription
.
getTopicFilter());
}
@Override
public
StoredMessage
inFlightAck
(
String
clientID
,
int
messageID
) {
return
getSession(clientID)
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
.
info(
"
"
,
BrokerConstants
.
PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
}
int
port
=
Integer
.
Show comments
View file
Edit file
Delete file
@@ -29,6 +29,10 @@
import
io.moquette.server.netty.metrics.MessageMetricsHandler
;
import
io.netty.channel.Channel
;
import static
io.netty.channel.ChannelFutureListener.CLOSE
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
(
String
topic
,
ByteBuffer
message
,
AbstractMessage
.
QOSType
qos
) {
if
(
!
message
.
hasRemaining()) {
//
moquette/gradle-wrapper.properties at 7267264503b8926699bb00c855b35bd31f95c5e8 · moquette-io/moquette · GitHub
moquette/gradle-wrapper.jar at 7267264503b8926699bb00c855b35bd31f95c5e8 · moquette-io/moquette · GitHub
moquette/lint.gradle at 7267264503b8926699bb00c855b35bd31f95c5e8 · moquette-io/moquette · GitHub
moquette/gradlew at 7267264503b8926699bb00c855b35bd31f95c5e8 · moquette-io/moquette · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
String
clientID
=
(
String
) session
.
getAttribute(
Constants
.
ATTR_CLIENTID
);
m_processor
.
processUnsubscribe(session, clientID, unsubMsg
.
topics(), unsubMsg
.
ConnAckMessage
okResp
=
new
ConnAckMessage
();
okResp
.
setReturnCode(
ConnAckMessage
.
BAD_USERNAME_OR_PASSWORD
);
session
.
write(okResp);
return
;
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
evt
) {
LOG
.
debug(
"
"
, publishKey, evt);
m_qos2Store
.
put(publishKey, evt);
}
public
void
removeQoS2Message
(
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
.
getClientID());
if
(storedMessage
.
getClientID()
==
null
) {
if
(storedMessage
.
getClientID()
==
null
) {
throw
new
span
style
="
font-size: 10pt;
"
>
This Agreement is governed by the laws of the
State of New York and the intellectual property laws of the United States of
America. No party to this Agreement will bring a legal action under this
Agreement more than one year after the cause of action arose. Each party waives
its rights to a jury trial in any resulting litigation.
</
span
>
</
p
>
<
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
@Override
public
void
exceptionCaught
(
ChannelHandlerContext
ctx
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
}
4
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
.
outboundFlightMessages
.
remove(messageID);
}
@Override
public
void
inFlight
(
String
clientID
,
int
messageID
,
StoredMessage
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
parseInt(tcpPortProp);
initFactory(host, port,
"
TCP MQTT
"
,
new
PipelineInitializer
() {
@Override
void
init
(
ChannelPipeline
pipeline
) {
pipeline
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
/**
* Value object to maintain the information of single connection, like ClientID, Channel, and clean
* session flag.
@@ -62,7 +66,7 @@ public ConnectionDescriptor(String clientID, Channel session, boolean cleanSessi
}
public
void
writeAndFlush
(
Object
payload
) {
this
.
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
clean the message from topic
m_retainedStore
.
remove(topic);
}
else
{
//
store the message to the topic
byte
[] raw
=
new
byte
[message
.
remaining()];
message
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
moquette/build.gradle at 7267264503b8926699bb00c855b35bd31f95c5e8 · moquette-io/moquette · GitHub
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
getMessageID());
}
else
if
(message
instanceof
SubscribeMessage
) {
String
clientID
=
(
String
) session
.
getAttribute(
Constants
.
ATTR_CLIENTID
}
}
subscriptions
.
activate(msg
.
getClientID());
//
handle clean session flag
if
(msg
.
isCleanSession()) {
//
remove all prev subscriptions
//
cleanup topic subscriptions
processRemoveAllSubscriptions(msg
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
String
publishKey
) {
m_qos2Store
.
remove(publishKey);
}
public
PublishEvent
retrieveQoS2Message
(
String
publishKey
) {
return
m_qos2Store
.
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
about.html
Go to file
Go to file
T
IllegalArgumentException
(
"
Message to be persisted must have a not null client ID
"
);
throw
new
IllegalArgumentException
(
"
Message to be persisted must have a not null client ID
"
);
}
}
m_retainedStore
p
class
="
MsoNormal
"
>
<!--[if !supportEmptyParas]-->
&nbsp;
<!--[endif]-->
<
o:p
>
</
o:p
>
</
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
,
Throwable
cause
)
throws
Exception
{
LOG
.
error(
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
Show comments
View file
Edit file
Delete file
@@ -47,6 +47,7 @@
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZEROBYTE_CLIENT_ID
=
new
BrokerConfiguration
msg
) {
Session
session
=
sessions
.
get(clientID);
if
(session
==
null
) {
LOG
.
error(
"
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
));
pipeline
.
addAfter(
"
idleStateHandler
channel
.
writeAndFlush(payload);
this
.
channel
.
writeAndFlush(payload)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
)
;
}
public
void
setupAutoFlusher
(
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
.
get(raw);
m_retainedStore
.
put(topic,
new
StoredMessage
(raw, qos, topic));
}
}
@Override
public
Collection<
StoredMessage
>
searchMatching
(
IMatchingCondition
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Build tools update. · moquette-io/moquette@7267264 · GitHub
Build tools update. · moquette-io/moquette@7267264 · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
main
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
);
boolean
cleanSession
=
(
Boolean
) session
.
getAttribute(
Constants
.
CLEAN_SESSION
);
m_processor
.
processSubscribe(session, (
SubscribeMessage
.
getClientID());
}
ConnAckMessage
okResp
=
new
ConnAckMessage
();
okResp
.
setReturnCode(
ConnAckMessage
.
CONNECTION_ACCEPTED
);
LOG
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
get(publishKey);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Go to line
L
Copy path
Cannot retrieve contributors at this time
28 lines (24 sloc)
1.41 KB
Raw
Blame
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
>
<
html
xmlns
="
http://www.w3.org/1999/xhtml
"
>
.
put(topic, storedMessage);
m_retainedStore
.
put(topic, storedMessage);
}
}
3
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
Show comments
View file
Edit file
Delete file
@@ -33,7 +33,7 @@
private
static
final
Logger
p
>
</
div
>
<
div
class
="
Section2
"
>
<
p
style
="
text-align: center;
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
"
An unexpected exception was caught while processing MQTT message. Closing Netty channel. CId={},
"
+
"
"
,
NettyUtils
.
clientID(ctx
.
channel()), cause
.
getCause(), cause
.
getMessage());
ctx
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
666cc29d47
moquette
/
broker
/
src
/
main
/
java
/
org
/
dna
/
mqtt
/
(
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
@@ -67,8 +68,9 @@ private MQTTConnection createMQTTConnection(BrokerConfiguration config, Channel
ISubscriptionsDirectory
Can't find the session for client <{}>
"
, clientID);
return
;
}
session
.
outboundFlightMessages
.
put(messageID, msg);
}
/**
* Return the next valid packetIdentifier for the given client session.
*/
@Override
public
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
IMatchingCondition.java
/
Jump to
"
,
"
idleEventHandler
"
, timeoutHandler);
//
pipeline.addLast("logger", new LoggingHandler("Netty", LogLevel.ERROR));
if
(errorsCather
.
isPresent()) {
pipeline
.
addLast(
"
int
flushIntervalMs
) {
@@ -88,7 +92,7 @@ public boolean close() {
if
(
!
success) {
return
false
;
}
this
.
channel
.
close();
this
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
condition
) {
LOG
.
debug(
"
searchMatching scanning all retained messages, presents are {}
"
, m_retainedStore
.
size());
List<
StoredMessage
>
results
=
new
ArrayList<
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
/
main
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
impl
/
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
/
DebugUtils.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
32 lines (30 sloc)
) message, clientID, cleanSession);
}
else
if
(message
instanceof
PubRelMessage
) {
String
clientID
=
(
String
) session
.
getAttribute(
Constants
.
.
debug(
"
processConnect sent OK ConnAck
"
);
session
.
write(okResp);
LOG
.
info(
"
"
, msg
.
getClientID(), msg
.
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
/
main
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
spi
/
IStorageService.java
/
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Projects
Wiki
Security
Insights
Permalink
Browse files
Added copyright and license notice to every source file, added about.…
Loading branch information
andsel
committed
Jun 11, 2014
1 parent
0bbe719
<
head
>
<
meta
http-equiv
="
Content-Type
"
content
="
text/html; charset=ISO-8859-1
"/>
<
title
>
About
LOG
=
LoggerFactory
.
getLogger(
MemorySessionStore
.
class);
private
static
final
Logger
LOG
=
LoggerFactory
.
"
align
="
center
"
>
<
b
>
Apache License
</
b
>
</
br
>
Version 2.0, January 2004
broker
/
src
/
main
/
java
/
org
/
dna
/
mqtt
/
moquette
/
messaging
/
.
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
@Override
4
broker/src/main/java/io/moquette/server/netty/metrics/BytesMetricsHandler.java
Show comments
moquette
/
messaging
/
spi
/
IPersistentSubscriptionStore.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
int
nextPacketID
(
String
clientID
) {
if
(
!
sessions
.
containsKey(clientID)) {
LOG
.
error(
"
Can't find the session for client <{}>
"
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
23 lines (21 sloc)
724 Bytes
Raw
Blame
bugsnagCatcher
"
, errorsCather
.
get());
}
pipeline
.
addFirst(
"
bytemetrics
"
,
new
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
.
channel
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
return
true
;
}
@@ -100,7 +104,7 @@ public void abort() {
LOG
.
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
StoredMessage
>
();
for
(
Map
.
Entry<
String
,
StoredMessage
>
entry
:
m_retainedStore) {
StoredMessage
storedMsg
=
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
distribution
/
build.gradle
Go to file
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
FileAuthenticator.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
105 lines (92 sloc)
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
941 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
ATTR_CLIENTID
);
int
messageID
=
((
PubRelMessage
) message)
.
getMessageID();
m_processor
.
processPubRel(clientID, messageID);
}
else
if
(message
instanceof
isCleanSession());
if
(
!
msg
.
isCleanSession()) {
//
force the republish of stored QoS1 and QoS2
republishStored(msg
.
getClientID());
}
}
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
71 lines (55 sloc)
2.33 KB
Raw
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
commit
666cc29d47f57fc00798856e335e5270c0075a10
Unified
Split
Showing
133 changed files
with
2,569 additions
and
13 deletions
.
+28
−0
about.html
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMatchingCondition.java
</
title
>
</
head
>
<
body
lang
="
EN-US
"
>
<
h2
>
About Moquette MQT broker
</
getLogger(
MemorySessionStore
.
class);
class
Session
{
static
class
Session
{
final
String
clientID;
final
String
clientID;
<
br
/>
http://www.apache.org/licenses/
<
br
/>
</
p
>
<
p
>
<
span
style
spi
/
IMessaging.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
io.netty.util.Attribute
;
import
io.netty.util.AttributeKey
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
public
class
BytesMetricsHandler
extends
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
33 lines (28 sloc)
1.04 KB
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
();
sut
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sut
=
new
SessionRegistry
(subscriptions,
queueRepository
);
final
, clientID);
return
-
1
;
}
Map<
Integer
,
StoredMessage
>
m
=
sessions
.
get(clientID)
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
decoder
"
,
new
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
"
,
MqttEncoder
.
INSTANCE
);
info(
"
Closing connection descriptor. MqttClientId = {}.
"
, clientID);
//
try {
//
this.channel.disconnect().sync();
this
.
channel
.
close();
//
.sync();
this
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7267264503
entry
.
getValue();
if
(condition
.
match(entry
.
getKey())) {
results
.
add(storedMsg);
}
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
61 lines (47 sloc)
1.35 KB
Raw
Blame
apply
plugin
:
'
application
'
//
adds task shadowJar - Create a combined JAR of project and runtime dependencies
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
3.51 KB
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1141e9f7a1
moquette
/
h2_storage
/
build.gradle
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.nio.ByteBuffer
;
/**
*
*
@author
andrea
*/
class
DebugUtils
{
static
PubRecMessage
) {
String
clientID
=
(
String
) session
.
getAttribute(
Constants
.
ATTR_CLIENTID
);
int
messageID
=
private
void
republishStored
(
String
clientID
) {
LOG
.
trace(
"
republishStored invoked
"
);
List<
PublishEvent
>
publishedEvents
Sign up
1141e9f7a1
moquette
/
h2_storage
/
src
/
test
/
java
/
io
/
moquette
/
persistence
/
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
Wiki
Security
Insights
Permalink
Browse files
Added copyright and license notice to every source file, added about.…
Loading branch information
andsel
committed
Jun 11, 2014
1 parent
0bbe719
commit
666cc29d47f57fc00798856e335e5270c0075a10
Unified
Split
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMessaging.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IPersistentSubscriptionStore.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/DebugUtils.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticator.java
+15
h2
>
<
p
>
June 11, 2014
</
p
>
<
h3
>
License
</
h3
>
<
p
final
Map<
Topic
,
Subscription
>
subscriptions
=
new
ConcurrentHashMap<>
();
final
Map<
Topic
,
Subscription
>
subscriptions
=
="
font-size: 10pt;
"
>
TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
</
spam
>
</
p
>
<
p
>
<
b
>
<
span
35 lines (29 sloc)
1.06 KB
Raw
Blame
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
ChannelDuplexHandler
{
private
static
final
AttributeKey<
BytesMetrics
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
"
BytesMetrics
"
);
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
import
java.util.List
;
import
org.dna.mqtt.moquette.messaging.spi.impl.subscriptions.Subscription
PostOffice
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(), sut,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
2
.
outboundFlightMessages;
int
maxId
=
m
.
keySet()
.
isEmpty()
?
0
:
Collections
.
max(m
.
keySet());
int
org.dna.mqtt.moquette.messaging.spi
;
/**
*/
public
interface
IMatchingCondition
{
boolean
match
(
String
key
);
}
Copy lines
Copy permalink
pipeline
.
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
"
,
new
.
channel
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
//
.sync();
//
} catch (InterruptedException e) {
//
e.printStackTrace();
//
}
4
moquette
/
gradlew.bat
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
84 lines (61 sloc)
2.21 KB
Raw
Blame
@
if
"
%DEBUG%
}
return
results;
}
public
void
storePublishForFuture
(
PublishEvent
evt
) {
List<
StoredPublishEvent
>
storedEvents;
String
clientID
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7267264503
moquette
/
gradle
/
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7267264503
moquette
/
gradle
/
wrapper
/
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7267264503
moquette
/
gradle
/
lint.gradle
Go to file
Go to file
T
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7267264503
moquette
/
gradlew
description
=
'
Moquette - distribution
'
apply
plugin
:
'
com.github.johnrengelman.shadow
'
mainClassName
=
"
io.moquette.integration.Server
"
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.io.BufferedReader
;
import
java.io.File
;
import
java.io.FileNotFoundException
;
import
java.io.FileReader
;
import
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
9 lines (6 sloc)
244 Bytes
Raw
Blame
description
=
'
Moquette - H2 storage
'
dependencies
String
payload2Str
(
ByteBuffer
content
) {
byte
[] b
=
new
byte
[content
.
remaining()];
content
.
mark();
content
((
PubRecMessage
) message)
.
getMessageID();
m_processor
.
processPubRec(clientID, messageID);
}
else
if
(message
instanceof
PubCompMessage
) {
String
clientID
=
(
=
m_storageService
.
retrievePersistedPublishes(clientID);
if
(publishedEvents
==
null
) {
LOG
.
info(
"
No stored messages for client <{}>
"
, clientID);
return
;
h2
/
H2MessagesStoreTest.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
/
src
/
test
/
java
/
io
/
moquette
/
persistence
/
H2PersistentQueueTest.java
/
Jump to
Code definitions
No definitions found in this file.
org.dna.mqtt.moquette.messaging.spi
;
import
java.nio.ByteBuffer
;
import
org.dna.mqtt.moquette.messaging.spi.impl.events.PublishEvent
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import static
org.dna.mqtt.moquette.messaging.spi.impl.HawtDBStorageService.StoredMessage
;
import
java.util.Collection
;
Showing
133 changed files
with
2,569 additions
and
13 deletions
.
+28
−0
about.html
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMatchingCondition.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMessaging.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/MemoryStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/SimpleMessaging.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ValueEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/DisconnectEvent.java
>
The Eclipse Foundation makes available all content in this plug-in (&quot;Moquette MQTT&quot;). Unless otherwise
indicated below, the Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
new
ConcurrentHashMap<>
();
boolean
cleanSession;
boolean
cleanSession;
@@ -170,7 +170,6 @@ public Subscription reload(Subscription subcription) {
return
subscriptions
.
get(subcription
.
getTopicFilter());
return
subscriptions
.
style
="
font-size: 10pt;
"
>
1. Definitions.
</
span
>
</
b
>
</
p
>
<
p
>
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
/**
* Interface to the underling messaging system used to publish, subscribe.
*
*
@author
@@ -53,7 +55,7 @@ public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
BytesMetrics
;
/**
* Store used to handle the persistence of the subscriptions tree.
*
*
@author
andrea
*/
public
interface
IPersistentSubscriptionStore
{
void
addNewSubscription
(
Subscription
newSubscription
,
String
...persistence/h2/H2PersistentQueueTest.java → ...te/persistence/H2PersistentQueueTest.java
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.persistence
.h2
;
package
io.moquette.persistence
;
import
nextPacketId
=
(maxId
+
1
)
%
0xFFFF
;
m
.
put(nextPacketId,
null
);
return
nextPacketId;
}
@Override
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
MQTTMessageLogger
());
if
(metrics
.
isPresent()) {
pipeline
.
addLast(
"
wizardMetrics
"
, metrics
.
get());
}
pipeline
.
broker/src/main/java/io/moquette/server/config/ClasspathResourceLoader.java
Show comments
View file
Edit file
Delete file
@@ -19,6 +19,8 @@
import
java.io.InputStream
;
import
java.io.InputStreamReader
;
import
java.io.Reader
;
import
java.nio.charset.StandardCharsets
;
import
"
==
"
"
@
echo
off
@
rem
##########################################################################
@
rem
@
rem
Gradle startup script for Windows
@
rem
@
=
evt
.
getClientID();
if
(
!
m_persistentMessageStore
.
containsKey(clientID)) {
storedEvents
=
new
ArrayList<
StoredPublishEvent
>
();
}
else
wrapper
/
gradle-wrapper.properties
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
5 lines (5 sloc)
200 Bytes
Raw
Blame
distributionBase
=GRADLE_USER_HOME
distributionPath
=wrapper/dists
distributionUrl
gradle-wrapper.jar
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
53.1 KB
Download
View raw
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Go to line
L
Copy path
Cannot retrieve contributors at this time
20 lines (17 sloc)
455 Bytes
Raw
Blame
apply
plugin
:
'
checkstyle
'
apply
plugin
:
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
executable file
172 lines (151 sloc)
5.17 KB
Raw
Blame
#!
/usr/bin/env sh
#
#############################################################################
#
dependencies
{
compile project(
'
:moquette-broker
'
)
compile
group
:
'
org.slf4j
'
,
name
:
'
slf4j-log4j12
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7267264503
moquette
/
build.gradle
Go to file
Go to file
T
Go to line
java.io.IOException
;
import
java.io.Reader
;
import
java.text.ParseException
;
import
java.util.HashMap
;
import
java.util.Map
;
import
org.dna.mqtt.moquette.server.IAuthenticator
{
compile project(
'
:moquette-broker
'
)
compile
group
:
'
com.h2database
'
,
name
:
'
h2-mvstore
'
.
get(b);
content
.
reset();
return
new
String
(b);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
String
) session
.
getAttribute(
Constants
.
ATTR_CLIENTID
);
int
messageID
=
((
PubCompMessage
) message)
.
getMessageID();
m_processor
.
}
LOG
.
info(
"
republishing stored messages to client <{}>
"
, clientID);
for
(
PublishEvent
pubEvt
:
publishedEvents) {
sendPublish(pubEvt
.
getClientID(), pubEvt
58 lines (55 sloc)
2 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
113 lines (93 sloc)
3.27 KB
Raw
import
java.util.List
;
/**
* Defines the SPI to be implemented by a StorageService that handle persistence of messages and subscriptions.
*/
public
interface
IStorageService
extends
IPersistentSubscriptionStore
{
/**
* Used to initialize all persistent store structures
*
*/
void
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IPersistentSubscriptionStore.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/DebugUtils.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticator.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/InitEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/LostConnectionEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/MessagingEvent.java
+15
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
<
p
>
If you did not receive this Content directly from the Eclipse Foundation, the Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
indicated below, the terms and conditions of the EPL still apply to any source code in the Content
get(subcription
.
getTopicFilter());
}
}
@Override
@Override
public
StoredMessage
inFlightAck
(
String
clientID
,
int
<
span
style
="
font-size: 10pt;
"
>
"License" shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.
</
span
>
</
p
>
<
p
>
andrea
*/
public
interface
IMessaging
{
void
stop
();
void
disconnect
(
ServerChannel
session
);
void
lostConnection
(
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
get();
metrics
.
incrementWrote(((
ByteBuf
) msg)
.
clientID
);
void
removeAllSubscriptions
(
String
clientID
);
List<
Subscription
>
retrieveAllSubscriptions
();
}
Copy lines
Copy permalink
View git blame
Reference in new issue
io.moquette.BrokerConstants
;
import
org.h2.mvstore.MVStore
;
2
distribution/build.gradle
Show comments
View file
Edit file
Delete file
@@ -8,8 +8,6 @@ mainClassName = "io.moquette.integration.Server"
dependencies
{
compile project(
'
:moquette-broker
public
BlockingQueue<
StoredMessage
>
queue
(
String
clientID
) {
if
(
!
sessions
.
containsKey(clientID)) {
LOG
.
error(
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
addLast(
"
handler
"
, handler);
}
});
}
private
void
initializeWebSocketTransport
(
final
NettyMQTTHandler
handler
,
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
@@ -51,7 +53,7 @@ public Reader loadDefaultResource() {
public
Reader
loadResource
(
String
relativePath
) {
LOG
.
info(
"
rem
##########################################################################
@
rem
Set local scope for the variables with windows NT shell
if
"
%OS%
"
==
"
Windows_NT
"
setlocal
set
DIRNAME
=
%
{
storedEvents
=
m_persistentMessageStore
.
get(clientID);
}
storedEvents
.
add(convertToStored(evt));
m_persistentMessageStore
.
put(clientID, storedEvents);
//
NB rewind the evt message content
LOG
.
=https\://services.gradle.org/distributions/gradle-4.6-bin.zip
zipStoreBase
=GRADLE_USER_HOME
zipStorePath
=wrapper/dists
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Build tools update.
Loading branch information
AndreasMager
committed
Mar 12, 2018
1 parent
2fb475a
commit
7267264503b8926699bb00c855b35bd31f95c5e8
Unified
Split
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Build tools update.
Loading branch information
AndreasMager
committed
Mar 12, 2018
1 parent
2fb475a
'
com.github.spotbugs
'
apply
plugin
:
'
net.ltgt.errorprone
'
dependencies
{
errorprone
"
com.google.errorprone:error_prone_core:2.2.0
"
}
checkstyle
{
configProperties
#
#
# Gradle start up script for UN*X
#
#
#
#############################################################################
#
Attempt to set APP_HOME
#
Resolve links: $0 may be a link
PRG=
"
$0
"
#
Need this for relative symlinks.
while
[
'
,
version
:
'
1.7.5
'
}
def
packageSet
=
project
.
copySpec {
from
'
src/main/resources/README.txt
L
Copy path
Cannot retrieve contributors at this time
86 lines (72 sloc)
2.32 KB
Raw
Blame
allprojects
{
apply
plugin
:
'
maven
'
group
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
/**
*
*
@author
andrea
*/
public
class
FileAuthenticator
implements
,
version
:
'
1.4.192
'
testCompile project(
path
:
'
:moquette-broker
'
,
configuration
:
'
archives
'
)
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
processPubComp(clientID, messageID);
}
else
if
(message
instanceof
PubAckMessage
) {
String
clientID
=
(
String
) session
.
getAttribute(
Constants
.
.
getTopic(), pubEvt
.
getQos(),
pubEvt
.
getMessage(),
false
, pubEvt
.
getMessageID());
}
}
void
processPubAck
(
String
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.persistence.h2
;
import static
org.junit.Assert.assertFalse
;
public
class
H2MessagesStoreTest
/*
extends MessageStoreTCK
*/
{
//
H2PersistentStore storageService;
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.persistence
initStore
();
/**
* Persist the message.
* If the message is empty then the topic is cleaned, else it's stored.
*/
void
storeRetained
(
String
topic
,
ByteBuffer
message
,
AbstractMessage
.
QOSType
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/MemoryStorageService.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/SimpleMessaging.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ValueEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/DisconnectEvent.java
+15
−0
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/OutputMessagingEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/ProtocolEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PubAckEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PublishEvent.java
and such source code may be obtained at
<
a
href
="
http://www.eclipse.org/
"
>
http://www.eclipse.org
</
a
>
.
</
p
>
</
messageID
) {
public
StoredMessage
inFlightAck
(
String
clientID
,
int
messageID
) {
return
getSession(clientID)
.
outboundFlightMessages
.
remove(messageID);
<
span
style
="
font-size: 10pt;
"
>
"Licensor" shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.
</
span
>
</
p
>
<
p
String
clientID
);
void
handleProtocolMessage
(
ServerChannel
session
,
AbstractMessage
msg
);
}
Copy lines
Copy permalink
View git blame
Reference in new issue
writableBytes());
ctx
.
write(msg, promise);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
)
;
}
@Override
3
broker/src/main/java/io/moquette/server/netty/metrics/MQTTMessageLogger.java
Show comments
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
'
)
compile project(
'
:moquette-h2-storage
'
)
//
compile project(':moquette-mapdb-storage')
compile
group
:
'
org.slf4j
'
,
name
"
Can't find the session for client <{}>
"
, clientID);
return
null
;
}
return
sessions
.
get(clientID)
.
queue;
}
@Override
public
void
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
IConfig
props
)
throws
IOException
{
LOG
.
info(
"
Configuring Websocket MQTT transport
"
);
String
webSocketPortProp
=
props
.
Loading resource. RelativePath = {}.
"
, relativePath);
InputStream
is
=
this
.
classLoader
.
getResourceAsStream(relativePath);
return
is
!=
null
?
new
InputStreamReader
(is)
~dp0
if
"
%DIRNAME%
"
==
"
"
set
DIRNAME
=
.
set
APP_BASE_NAME
=
%
~n0
set
debug(
"
"
, clientID, evt
.
getTopic());
}
@Override
public
List<
PublishEvent
>
retrievePersistedPublishes
(
String
clientID
) {
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Showing
6 changed files
with
30 additions
and
31 deletions
.
+4
−7
build.gradle
+8
−7
gradle/lint.gradle
BIN
gradle/wrapper/gradle-wrapper.jar
+1
−2
gradle/wrapper/gradle-wrapper.properties
commit
7267264503b8926699bb00c855b35bd31f95c5e8
Unified
Split
Showing
6 changed files
with
30 additions
and
31 deletions
.
+4
−7
build.gradle
+8
−7
gradle/lint.gradle
BIN
.
checkstyleConfigDir
=
"
.
"
configFile
=
new
File
(rootDir,
'
checkstyle.xml
'
)
ignoreFailures false
toolVersion
=
'
-h
"
$PRG
"
]
;
do
ls=
`
ls -ld
"
$PRG
"
`
link=
`
expr
'
into (
'
bin
'
) {
from
'
src/main/scripts/
'
fileMode
=
0755
}
into (
'
=
'
io.moquette
'
version
=
'
0.11-SNAPSHOT
'
}
buildscript
{
repositories {
maven {
url
"
https://plugins.gradle.org/m2/
"
IAuthenticator
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
FileAuthenticator
.
class);
private
Map<
String
,
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
ATTR_CLIENTID
);
int
messageID
=
((
PubAckMessage
) message)
.
getMessageID();
m_processor
.
processPubAck(clientID, messageID);
}
else
{
throw
new
clientID
,
int
messageID
) {
//
Remove the message from message store
m_storageService
.
cleanPersistedPublishMessage(clientID, messageID);
}
private
void
processRemoveAllSubscriptions
(
String
clientID
) {
//
//
private ScheduledExecutorService scheduler;
//
//
@Before
//
public void setUp() throws Exception {
//
scheduler = Executors.newScheduledThreadPool(1);
//
//
cleanPersistenceFile(BrokerConstants.DEFAULT_PERSISTENT_PATH);
//
Properties props = new Properties();
//
props.setProperty(BrokerConstants.PERSISTENT_STORE_PROPERTY_NAME, BrokerConstants.DEFAULT_PERSISTENT_PATH);
;
import
io.moquette.BrokerConstants
;
import
org.h2.mvstore.MVStore
;
import
org.junit.After
;
import
org.junit.Before
;
import
org.junit.Ignore
;
import
org.junit.Test
qos
);
/**
* Return a list of retained messages that satisfy the condition.
*/
Collection<
StoredMessage
>
searchMatching
(
IMatchingCondition
condition
);
void
storePublishForFuture
(
PublishEvent
evt
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/InitEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/LostConnectionEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/MessagingEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/OutputMessagingEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/ProtocolEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PubAckEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/RepublishEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/StopEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/SubscribeEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/storage/StoredPublishEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/Subscription.java
+15
−0
body
>
</
html
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
return
getSession(clientID)
.
outboundFlightMessages
.
remove(messageID);
10
broker/src/main/java/io/moquette/server/ConnectionDescriptor.java
Show comments
View file
Edit file
Delete file
@@ -29,6 +29,10 @@
import
io.moquette.server.netty.metrics.MessageMetricsHandler
;
import
>
<
span
style
="
font-size: 10pt;
"
>
"Legal Entity" shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
control with that entity. For the purposes of this definition,
"control" means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.
</
span
>
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
View file
Edit file
Delete file
@@ -28,6 +28,7 @@
import
java.util.List
;
import static
io.moquette.spi.impl.Utils.messageId
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
/**
*
@@ -100,6 +101,6 @@ public void channelInactive(ChannelHandlerContext ctx) throws Exception {
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
:
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
}
9
h2_storage/build.gradle
Show comments
View file
Edit file
Delete file
dropQueue
(
String
clientID
) {
final
Session
session
=
sessions
.
get(clientID);
session
.
queue
.
clear();
session
getProperty(
WEB_SOCKET_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
if
(
DISABLED_PORT_BIND
.
equals(webSocketPortProp)) {
//
Do nothing no WebSocket configured
LOG
.
info(
"
"
:
null
;
return
is
!=
null
?
new
InputStreamReader
(is
,
StandardCharsets
.
UTF_8
)
:
null
APP_HOME
=
%DIRNAME%
@
rem
Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
set
DEFAULT_JVM_OPTS
=
@
rem
Find java.exe
if
defined
JAVA_HOME
goto
findJavaFromJavaHome
set
List<
StoredPublishEvent
>
storedEvts
=
m_persistentMessageStore
.
get(clientID);
if
(storedEvts
==
null
) {
return
null
;
}
List<
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
+17
−9
gradlew
+0
−6
gradlew.bat
11
build.gradle
Show comments
View file
Edit file
Delete file
@@ -12,7 +12,8 @@ buildscript {
}
}
dependencies {
classpath
gradle/wrapper/gradle-wrapper.jar
+1
−2
gradle/wrapper/gradle-wrapper.properties
+17
−9
gradlew
+0
−6
gradlew.bat
11
build.gradle
Show comments
View file
Edit file
Delete file
@@ -12,7 +12,8 @@ buildscript {
6.7
'
}
spotbugs
{
toolVersion
=
'
3.1.1
'
ignoreFailures true
omitVisitors
=
[
'
RuntimeExceptionCapture
'
]
"
$ls
"
:
'
.*-> \(.*\)$
'
`
if
expr
"
$link
"
:
'
/.*
'
>
/dev/null
lib
'
) {
from
"
build/libs/
${
project.name
}
-
${
version
}
.jar
"
rename {
"
}
}
dependencies {
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.13
'
classpath
'
gradle.plugin.com.github.spotbugs:gradlePlugin:1.6.0
'
classpath
'
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
'
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
String
>
m_identities
=
new
HashMap<
String
,
String
>
();
FileAuthenticator
(
String
parent
,
String
filePath
) {
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
RuntimeException
(
"
Illegal message received
"
+
message);
}
}
else
if
(evt
instanceof
InitEvent
) {
processInit(((
InitEvent
LOG
.
info(
"
cleaning old saved subscriptions for client <{}>
"
, clientID);
subscriptions
.
removeForClient(clientID);
//
remove also the messages stored of type QoS1/2
m_storageService
.
cleanPersistedPublishes(clientID);
}
protected
void
//
IConfig conf = new MemoryConfig(props);
//
storageService = new H2PersistentStore(conf, scheduler);
//
storageService.initStore();
//
messagesStore = storageService.messagesStore();
//
sessionsStore = storageService.sessionsStore();
//
this.sessionsRepository = new SessionsRepository(sessionsStore, null);
//
}
//
//
@After
//
;
import
java.io.File
;
import static
org.junit.Assert.*
;
public
class
H2PersistentQueueTest
{
private
MVStore
mvStore;
@Before
public
void
setUp
);
/**
* Return the list of persisted publishes for the given clientID.
* For QoS1 and QoS2 with clean session flag, this method return the list of
* missed publish events while the client was disconnected.
*/
List<
PublishEvent
>
retrievePersistedPublishes
(
String
clientID
);
void
cleanPersistedPublishMessage
(
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PublishEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/RepublishEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/StopEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/SubscribeEvent.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/storage/StoredPublishEvent.java
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/SubscriptionsStore.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/Token.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/TreeNode.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ConfigurationParser.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ConnectionDescriptor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/Constants.java
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
io.moquette.server.netty.metrics.MessageMetricsHandler
;
import
io.netty.channel.Channel
;
import
io.netty.channel.Channel
;
import static
io.netty.channel.ChannelFutureListener.CLOSE
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"You" (or "Your") shall mean an individual or Legal Entity
exercising permissions granted by this License.
</
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
@Override
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
logMQTTMessage(ctx, msg,
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Load diff
This file was deleted.
Oops, something went wrong.
Retry
58
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
.
outboundFlightMessages
.
clear();
session
.
inboundFlightMessages
.
clear();
}
,
BrokerConstants
.
WEB_SOCKET_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
}
int
;
}
@Override
13
broker/src/main/java/io/moquette/server/config/ConfigurationParser.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
java.io.FileReader
;
JAVA_EXE
=
java.exe
%JAVA_EXE%
-version
>
NUL
2
>&
1
if
"
%ERRORLEVEL%
"
==
"
0
"
goto
PublishEvent
>
liveEvts
=
new
ArrayList<
PublishEvent
>
();
for
(
StoredPublishEvent
storedEvt
:
storedEvts) {
liveEvts
.
add(convertFromStored(storedEvt));
}
Reject
Save preferences
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.8
'
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.13
'
classpath
'
gradle.plugin.com.github.spotbugs:gradlePlugin:1.6.0
'
classpath
'
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
'
}
}
}
}
dependencies {
dependencies {
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.8
'
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.13
'
classpath
'
gradle.plugin.com.github.spotbugs:gradlePlugin:1.6.0
'
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
;
then
PRG=
"
$link
"
else
PRG=
`
dirname
"
$PRG
"
`
"
/
$link
moquette-
${
version
}
.jar
"
}
}
into (
'
lib
'
) {
from configurations
.
compile
}
into (
'
}
}
subprojects
{
repositories {
mavenLocal()
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
}
maven { url
File
file
=
new
File
(parent, filePath);
LOG
.
info(
"
Loading password file:
"
+
file);
if
(file
.
isDirectory()) {
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
) evt)
.
getConfig());
}
else
if
(evt
instanceof
LostConnectionEvent
) {
LostConnectionEvent
lostEvt
=
(
LostConnectionEvent
) evt;
processPublish
(
PublishEvent
evt
) {
LOG
.
trace(
"
PUB --PUBLISH--> SRV processPublish invoked with {}
"
, evt);
final
String
topic
=
evt
.
public void tearDown() {
//
if (storageService != null) {
//
storageService.close();
//
}
//
//
scheduler.shutdown();
//
cleanPersistenceFile(BrokerConstants.DEFAULT_PERSISTENT_PATH);
//
}
//
//
public static void cleanPersistenceFile(String fileName) {
//
() {
this
.
mvStore
=
new
MVStore
.
Builder
()
.fileName(
BrokerConstants
.
DEFAULT_PERSISTENT_PATH
)
.autoCommitDisabled()
.open();
}
String
clientID
,
int
messageID
);
void
cleanPersistedPublishes
(
String
clientID
);
void
cleanInFlight
(
String
msgID
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/Subscription.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/SubscriptionsStore.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/Token.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/TreeNode.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ConfigurationParser.java
+15
−0
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/IAuthenticator.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/Server.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ServerAcceptor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ServerChannel.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/MoquetteIdleTimoutHandler.java
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
/**
/**
* Value object to maintain the information of single connection, like ClientID, Channel, and clean
* Value object to maintain the information of single connection, like ClientID, Channel, and clean
* session flag.
* session flag.
@@ -62,7 +66,7 @@ public ConnectionDescriptor(String clientID, Channel session, boolean cleanSessi
}
}
public
void
writeAndFlush
(
Object
payload
) {
public
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"Source" form shall mean the preferred form for making modifications,
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
C<-B
"
);
ctx
.
write(msg, promise);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
)
;
}
}
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
c4d928b
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
@Override
public
void
moveInFlightToSecondPhaseAckWaiting
(
String
clientID
,
int
messageID
,
StoredMessage
msg
) {
LOG
.
info(
"
port
=
Integer
.
parseInt(webSocketPortProp);
final
MoquetteIdleTimeoutHandler
timeoutHandler
=
new
MoquetteIdleTimeoutHandler
();
String
host
=
props
.
import
java.io.IOException
;
import
java.io.Reader
;
import
java.nio.charset.StandardCharsets
;
import
java.nio.file.Files
;
import
java.text.ParseException
;
import
java.util.Properties
init
echo
.
echo
ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.
echo
.
echo
Please set the JAVA_HOME variable in your environment to match the
echo
location of your Java installation.
goto
fail
:
findJavaFromJavaHome
set
JAVA_HOME
return
liveEvts;
}
public
void
cleanPersistedPublishMessage
(
String
clientID
,
int
messageID
) {
List<
StoredPublishEvent
>
events
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
'
}
@@ -25,18 +26,14 @@ subprojects {
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
}
maven { url
"
http
://repo.maven.apache.org/maven2
classpath
'
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
'
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
'
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
'
classpath
'
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
'
}
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
"
fi
done
SAVED=
"
`
pwd
`
"
cd
"
`
dirname
\"
$PRG
\"
`
/
"
'
config
'
) {
from
'
src/main/resources/moquette.conf
'
from
'
src/main/resources/password_file.conf
'
from
'
src/main/resources/hazelcast.xml
'
//
"
https://repo.maven.apache.org/maven2
"
}
}
apply
from
:
new
File
(rootDir,
'
gradle/java.gradle
'
)
apply
from
:
LOG
.
warn(
String
.
format(
"
Bad file reference %s is a directory
"
, file));
return
;
}
try
{
FileReader
reader
m_processor
.
proccessConnectionLost(lostEvt
.
getClientID());
}
}
private
void
processInit
(
Properties
props
) {
m_storageService
=
new
HawtDBStorageService
getTopic();
final
AbstractMessage
.
QOSType
qos
=
evt
.
getQos();
final
ByteBuffer
message
=
evt
.
getMessage();
boolean
File dbFile = new File(fileName);
//
if (dbFile.exists()) {
//
dbFile.delete();
//
}
//
assertFalse(dbFile.exists());
//
}
}
Copy lines
Copy permalink
@After
public
void
tearDown
() {
File
dbFile
=
new
File
(
BrokerConstants
.
DEFAULT_PERSISTENT_PATH
);
if
(dbFile
.
);
void
addInFlight
(
PublishEvent
evt
,
String
publishKey
);
void
close
();
void
persistQoS2Message
(
String
publishKey
broker/src/main/java/org/dna/mqtt/moquette/server/ConnectionDescriptor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/Constants.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/IAuthenticator.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/Server.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ServerAcceptor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/ServerChannel.java
+15
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyAcceptor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyChannel.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyMQTTHandler.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetrics.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetricsCollector.java
+15
Learn more
Accept
Reject
Save preferences
void
writeAndFlush
(
Object
payload
) {
this
.
channel
.
writeAndFlush(payload);
this
.
channel
.
writeAndFlush(payload)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
including but not limited to software source code, documentation
source, and configuration files.
</
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
4
broker/src/main/java/io/moquette/server/netty/metrics/MessageMetricsHandler.java
Show comments
View file
Edit file
Delete file
@@ -23,6 +23,8 @@
import
io.netty.util.Attribute
;
import
io.netty.util.AttributeKey
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
public
class
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
"
, clientID, messageID);
Session
session
=
sessions
.
get(clientID);
if
(session
==
null
) {
LOG
.
error(
"
Can't find the session for client <{}>
getProperty(
BrokerConstants
.
HOST_PROPERTY_NAME
);
initFactory(host, port,
"
Websocket MQTT
"
,
new
PipelineInitializer
() {
@Override
void
init
(
ChannelPipeline
pipeline
;
@@ -55,15 +57,10 @@ void parse(File file) throws ParseException {
return
;
}
try
{
FileReader
reader
=
new
FileReader
(file);
Reader
reader
=
Files
.
=
%JAVA_HOME:
"
=%
set
JAVA_EXE
=
%JAVA_HOME%
/bin/java.exe
if
exist
"
%JAVA_EXE%
"
goto
init
echo
.
echo
=
m_persistentMessageStore
.
get(clientID);
if
(events
==
null
) {
return
;
}
StoredPublishEvent
toRemoveEvt
=
null
;
for
(
"
}
maven { url
"
https
://repo.maven.apache.org/maven2
"
}
}
apply
from
:
new
File
(rootDir,
'
gradle/java.gradle
}
@@ -25,18 +26,14 @@ subprojects {
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
>
/dev/null
APP_HOME=
"
`
pwd -P
`
"
cd
"
$SAVED
"
>
/dev/null
APP_NAME=
"
Gradle
"
APP_BASE_NAME=
from 'src/main/resources/acl.conf'
}
into (
'
config
'
) {
from
'
src/main/resources/log4j.properties
'
rename {
'
moquette-log.properties
'
}
}
}
task
new
File
(rootDir,
'
gradle/test.gradle
'
)
apply
from
:
new
File
(rootDir,
'
gradle/lint.gradle
'
)
apply
=
new
FileReader
(file);
parse(reader);
}
catch
(
FileNotFoundException
fex) {
LOG
.
warn(
String
.
format(
"
Parsing not existing file %s
"
();
m_storageService
.
initStore();
subscriptions
.
init(m_storageService);
String
passwdPath
=
props
.
getProperty(
"
password_file
"
);
retain
=
evt
.
isRetain();
LOG
.
info(
"
"
,
evt
.
getClientID(), evt
.
getTopic(), evt
.
getQos());
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
exists()) {
dbFile
.
delete();
}
assertFalse(dbFile
.
exists());
}
@Test
public
void
testAdd
() {
H2PersistentQueue<
String
>
sut
,
PublishEvent
evt
);
void
removeQoS2Message
(
String
publishKey
);
PublishEvent
retrieveQoS2Message
(
String
publishKey
);
}
Copy lines
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/MoquetteIdleTimoutHandler.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyAcceptor.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyChannel.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/NettyMQTTHandler.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetrics.java
+15
−0
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetricsHandler.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetrics.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetricsCollector.java
+15
−1
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetricsHandler.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticatorTest.java
+15
−0
)
;
}
}
public
void
setupAutoFlusher
(
int
flushIntervalMs
) {
public
void
setupAutoFlusher
(
int
flushIntervalMs
) {
"Object" form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
not limited to compiled object code, generated documentation,
and conversions to other media types.
</
span
>
</
p
>
<
p
>
<
span
style
="
MessageMetricsHandler
extends
ChannelDuplexHandler
{
private
static
final
AttributeKey<
MessageMetrics
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
"
MessageMetrics
"
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
"
, clientID);
return
;
}
session
.
secondPhaseStore
.
put(messageID, msg);
session
.
outboundFlightMessages
.
put(messageID, msg);
}
@Override
) {
pipeline
.
addLast(
new
HttpServerCodec
());
pipeline
.
addLast(
"
aggregator
"
,
new
HttpObjectAggregator
(
65536
newBufferedReader
(file
.
toPath(),
StandardCharsets
.
UTF_8
);
parse(reader);
}
catch
(
FileNotFoundException
fex) {
LOG
.
warn(
String
.
ERROR: JAVA_HOME is set to an invalid directory:
%JAVA_HOME%
echo
.
echo
Please set the JAVA_HOME variable in your environment to match the
echo
location of your Java installation.
goto
fail
:
init
@
rem
Get command-line arguments, handling Windows variants
if
not
"
StoredPublishEvent
evt
:
events) {
if
(evt
.
getMessageID()
==
messageID) {
toRemoveEvt
=
evt;
}
}
events
.
remove(toRemoveEvt);
'
)
apply
from
:
new
File
(rootDir,
'
gradle/test.gradle
'
)
apply
from
:
new
File
(rootDir,
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
}
maven { url
"
http
://repo.maven.apache.org/maven2
"
}
maven { url
"
`
basename
"
$0
"
`
#
Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
DEFAULT_JVM_OPTS=
"
"
#
Use the maximum available, or set MAX_FD != -1 to use that value.
MAX_FD=
"
maximum
"
warn
distMoquetteTar
(
type
:
Tar
) {
archiveName
=
"
moquette-
${
version
}
.tar.gz
"
destinationDir file(
'
plugin
:
'
com.jfrog.bintray
'
apply
plugin
:
'
eclipse
'
ext {
nettyVersion
=
'
4.1.12.Final
'
, file), fex);
}
catch
(
ParseException
pex) {
LOG
.
warn(
String
.
format(
"
Fromat ero in parsing password file %s
"
, file), pex);
}
String
configPath
=
System
.
getProperty(
"
moquette.path
"
,
null
);
IAuthenticator
authenticator
=
new
FileAuthenticator
String
publishKey
=
null
;
if
(qos
==
AbstractMessage
.
QOSType
.
LEAST_ONE
) {
//
store the temporary message
publishKey
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
=
new
H2PersistentQueue<>
(
this
.
mvStore,
"
test
"
);
sut
.
add(
"
Hello
"
);
sut
.
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetricsCollector.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/BytesMetricsHandler.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetrics.java
+15
−0
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetricsCollector.java
+15
−1
broker/src/main/java/org/dna/mqtt/moquette/server/netty/metrics/MessageMetricsHandler.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticatorTest.java
+15
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageServiceTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/MockAuthenticator.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessorTest.java
+15
−0
.../src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/SubscriptionsStoreTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ConfigurationParserTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/MQTTWebSocket.java
+15
@@ -88,7 +92,7 @@ public boolean close() {
if
(
!
success) {
if
(
!
success) {
return
false
;
return
false
;
}
}
this
.
font-size: 10pt;
"
>
"Work" shall mean the work of authorship, whether in Source or
Object form, made available under the License, as indicated by a
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).
</
span
>
</
p
>
<
p
>
<
span
style
);
@@ -52,7 +54,7 @@ public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Learn more
Accept
Reject
Save preferences
public
StoredMessage
completeReleasedPublish
(
String
clientID
,
int
messageID
) {
LOG
.
info(
"
"
, clientID, messageID);
return
getSession(clientID)
));
pipeline
.
addLast(
"
webSocketHandler
"
,
new
WebSocketServerProtocolHandler
(
"
/mqtt
"
,
MQTT_SUBPROTOCOL_CSV_LIST
));
pipeline
format(
"
parsing not existing file %s, so fallback on default configuration!
"
,
file
.
getAbsolutePath()),
fex);
return
;
}
catch
(
IOException
fex) {
LOG
.
%OS%
"
==
"
Windows_NT
"
goto
win9xME_args
:
win9xME_args
@
rem
Slurp the command line arguments.
set
CMD_LINE_ARGS
m_persistentMessageStore
.
put(clientID, events);
}
public
void
cleanPersistedPublishes
(
String
clientID
) {
'
gradle/lint.gradle
'
)
apply
plugin
:
'
com.jfrog.bintray
'
apply
plugin
:
'
eclipse
'
https
://repo.maven.apache.org/maven2
"
}
}
}
apply
from
:
new
File
(rootDir,
'
gradle/java.gradle
'
() {
echo
"
$*
"
}
die
() {
echo
echo
"
$*
"
echo
exit
1
}
#
build
'
)
extension
'
tar
'
compression
=
Compression
.
GZIP
with packageSet
}
distMoquetteTar
.
dependsOn jar
task
}
task packageTests(
type
:
Jar
) {
from sourceSets
.
test
.
output
from sourceSets
.
test
.
allSource
from sourceSets
.
test
}
private
void
parse
(
Reader
reader
)
throws
ParseException
{
if
(reader
==
null
) {
return
;
(configPath, passwdPath);
m_processor
.
init(subscriptions, m_storageService, authenticator);
}
private
void
processStop
() {
LOG
.
debug(
"
processStop invoked
"
);
m_storageService
.
=
String
.
format(
"
%s%d
"
, evt
.
getClientID(), evt
.
getMessageID());
m_storageService
.
addInFlight(evt, publishKey);
}
else
if
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
add(
"
world
"
);
assertEquals(
"
Hello
"
, sut
.
peek());
assertEquals(
"
Hello
"
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageServiceTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/MockAuthenticator.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessorTest.java
+15
−0
.../src/test/java/org/dna/mqtt/moquette/messaging/spi/impl/subscriptions/SubscriptionsStoreTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ConfigurationParserTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/MQTTWebSocket.java
−1
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationFuseTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationPahoTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationQoSValidationTest.java
+15
−3
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationSSLTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationWebSocketTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerLowlevelMessagesIntegrationTests.java
channel
.
close();
this
.
channel
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
return
true
;
return
true
="
font-size: 10pt;
"
>
"Derivative Works" shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.
</
span
>
</
p
>
<
Exception
{
MessageMetrics
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
get();
metrics
.
incrementWrote(
1
);
.
secondPhaseStore
.
remove(messageID);
}
@Override
public
int
getInflightMessagesNo
(
String
clientID
) {
Session
session
=
.
addLast(
"
ws2bytebufDecoder
"
,
new
WebSocketFrameToByteBufDecoder
());
pipeline
.
addLast(
"
bytebuf2wsEncoder
"
,
new
ByteBufToWebSocketFrameEncoder
());
warn(
"
parsing not existing file {}, fallback on default configuration!
"
, file
.
getAbsolutePath(), fex);
}
}
9
broker/src/main/java/io/moquette/server/config/FileResourceLoader.java
Show comments
View file
Edit file
=
set
_SKIP
=
2
:
win9xME_args_slurp
if
"
x%
~1
"
==
"
x
"
goto
execute
m_persistentMessageStore
.
remove(clientID);
}
public
void
cleanInFlight
(
String
msgID
) {
m_inflightStore
.
remove(msgID);
}
public
void
addInFlight
apply
plugin
:
'
net.ltgt.errorprone
'
configurations
.
errorprone {
resolutionStrategy
.
force
'
com.google.errorprone:error_prone_core:2.0.14
'
}
ext {
)
apply
from
:
new
File
(rootDir,
'
gradle/java.gradle
'
)
apply
from
:
new
File
(rootDir,
'
OS specific support (must be 'true' or 'false').
cygwin=false
msys=false
darwin=false
nonstop=false
case
"
`
uname
`
"
in
CYGWIN
*
)
cygwin=true
;;
Darwin
distMoquetteZip
(
type
:
Zip
) {
archiveName
=
"
moquette-
${
version
}
.zip
"
destinationDir file(
'
.
resources
classifier
=
'
tests
'
}
artifacts
.
archives packageTests
dependencies {
compile
group
:
'
org.slf4j
'
,
}
BufferedReader
br
=
new
BufferedReader
(reader);
String
line;
try
{
while
((line
=
br
.
readLine())
!=
null
close();
//
m_eventProcessor.halt();
m_executor
.
shutdown();
subscriptions
=
null
;
m_stopLatch
.
countDown();
}
}
Copy lines
Copy permalink
View git blame
(qos
==
AbstractMessage
.
QOSType
.
EXACTLY_ONCE
) {
publishKey
=
String
.
format(
"
%s%d
"
, evt
.
getClientID(), evt
, sut
.
peek());
assertEquals(
"
peek just return elements, doesn't remove them
"
,
2
, sut
.
size());
}
@Test
public
void
testPoll
() {
H2PersistentQueue<
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
+15
−1
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationFuseTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationPahoTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationQoSValidationTest.java
+15
−3
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationSSLTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerIntegrationWebSocketTest.java
+15
−0
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerRestartIntegrationTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/TestCallback.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/testclient/Client.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/testclient/ClientNettyMQTTHandler.java
+15
−0
bundle/src/main/java/org/dna/mqtt/moquette/bundle/Activator.java
+576
−0
;
}
}
@@ -100,7 +104,7 @@ public void abort() {
LOG
.
info(
"
Closing connection descriptor. MqttClientId = {}.
"
, clientID);
LOG
.
info(
"
Closing connection descriptor. MqttClientId = {}.
p
>
<
span
style
="
font-size: 10pt;
"
>
"Contribution" shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
or by an individual or Legal Entity authorized to submit on behalf of
the copyright owner. For the purposes of this definition, "submitted"
means any form of electronic, verbal, or written communication sent
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
ctx
.
write(msg, promise);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
)
;
}
@Override
16
broker/src/main/java/io/moquette/spi/DurableSession.java
sessions
.
get(clientID);
if
(session
==
null
) {
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
return
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
));
pipeline
.
Delete file
@@ -19,10 +19,15 @@
import
java.io.File
;
import
java.io.FileNotFoundException
;
import
java.io.FileReader
;
import
java.io.IOException
;
set
CMD_LINE_ARGS
=
%
*
:
execute
@
rem
Setup the command line
set
CLASSPATH
=
%APP_HOME%
\gradle\wrapper\gradle-wrapper.jar
@
(
PublishEvent
evt
,
String
publishKey
) {
StoredPublishEvent
storedEvt
=
convertToStored(evt);
m_inflightStore
.
put(publishKey, storedEvt);
}
public
void
addNewSubscription
nettyVersion
=
'
4.1.12.Final
'
@@ -85,5 +82,5 @@ subprojects {
}
task
wrapper
(
type
:
Wrapper
) {
gradleVersion
=
'
gradle/test.gradle
'
)
apply
from
:
new
File
(rootDir,
'
gradle/test.gradle
'
)
apply
from
:
*
)
darwin=true
;;
MINGW
*
)
msys=true
;;
NONSTOP
*
)
nonstop=true
;;
esac
CLASSPATH=
build
'
)
with packageSet
}
distMoquetteZip
.
dependsOn jar
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
name
:
'
slf4j-api
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
junit
'
) {
int
commentMarker
=
line
.
indexOf(
'
#
'
);
if
(commentMarker
!=
-
1
) {
if
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
.
getMessageID());
//
store the message in temp store
m_storageService
.
persistQoS2Message(publishKey, evt);
sendPubRec(evt
.
getClientID(), evt
.
getMessageID());
}
//
NB publish to subscribers for QoS 2 happen upon PUBREL from publisher
if
(qos
String
>
sut
=
new
H2PersistentQueue<>
(
this
.
mvStore,
"
test
"
);
sut
.
add(
broker/src/test/java/org/dna/mqtt/moquette/server/ServerLowlevelMessagesIntegrationTests.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/ServerRestartIntegrationTest.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/server/TestCallback.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/testclient/Client.java
+15
−0
broker/src/test/java/org/dna/mqtt/moquette/testclient/ClientNettyMQTTHandler.java
+15
−0
bundle/src/main/java/org/dna/mqtt/moquette/bundle/Activator.java
license-eplv10-aslv20.html
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnectDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnectEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DemuxDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DemuxEncoder.java
"
, clientID);
//
try {
//
try {
//
this.channel.disconnect().sync();
//
this.channel.disconnect().sync();
this
.
channel
.
close();
//
.sync();
this
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
designated in writing by the copyright owner as "Not a Contribution."
</
span
>
</
p
>
<
p
>
<
span
style
="
Show comments
View file
Edit file
Delete file
@@ -22,9 +22,7 @@
import
java.util.Collection
;
import
java.util.HashSet
;
import
java.util.Map
;
import
java.util.Set
0
;
}
return
session
.
inboundFlightMessages
.
size()
+
//
countPubReleaseWaitingPubComplete(clientID) +
session
.
outboundFlightMessages
.
addAfter(
"
idleStateHandler
"
,
"
idleEventHandler
"
, timeoutHandler);
pipeline
.
addFirst(
"
bytemetrics
"
,
new
BytesMetricsHandler
import
java.io.Reader
;
import
java.nio.file.Files
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
public
class
rem
Execute Gradle
"
%JAVA_EXE%
"
%DEFAULT_JVM_OPTS%
%JAVA_OPTS%
%GRADLE_OPTS%
"
-Dorg.gradle.appname=
%APP_BASE_NAME%
"
-classpath
"
%CLASSPATH%
"
org.gradle.wrapper.GradleWrapperMain
%CMD_LINE_ARGS%
(
Subscription
newSubscription
,
String
clientID
) {
LOG
.
debug(
"
"
, newSubscription, clientID);
if
(
!
m_persistentSubscriptions
.
3.3
'
gradleVersion
=
'
4.6
'
}
15
gradle/lint.gradle
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,10 @@
apply
plugin
new
File
(rootDir,
'
gradle/lint.gradle
'
)
apply
from
:
new
File
(rootDir,
$APP_HOME
/gradle/wrapper/gradle-wrapper.jar
#
Determine the Java command to use to start the JVM.
if
[
-n
"
$JAVA_HOME
"
]
;
then
if
[
-x
"
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
,
name
:
'
junit
'
,
version
:
'
4.8.2
'
testCompile
group
:
'
org.slf4j
'
,
(commentMarker
==
0
) {
//
skip its a comment
continue
;
}
else
{
//
it's a malformed comment
throw
new
ParseException
(line, commentMarker);
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
!=
AbstractMessage
.
QOSType
.
EXACTLY_ONCE
) {
publish2Subscribers(topic, qos, message, retain, evt
.
getMessageID());
}
if
(qos
==
AbstractMessage
.
QOSType
"
Hello
"
);
sut
.
add(
"
world
"
);
assertEquals(
"
Hello
"
, sut
.
+576
−0
license-eplv10-aslv20.html
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnectDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/ConnectEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DemuxDecoder.java
+15
−0
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DisconnectDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DisconnectEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MQTTDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MQTTEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MessageIDDecoder.java
+15
−1
.
channel
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
//
.sync();
//
} catch (InterruptedException e) {
//
} catch (InterruptedException e) {
//
e.printStackTrace();
font-size: 10pt;
"
>
"Contributor" shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
subsequently incorporated within the Work.
</
span
>
</
p
>
<
p
>
<
;
import
java.util.concurrent.ConcurrentHashMap
;
public
class
DurableSession
extends
ClientSession
{
@@ -51,20 +49,6 @@ void waitingAck(int messageID, IMessagesStore.StoredMessage msg) {
}
}
class
InboundFlightZone
size();
}
@Override
public
int
countPubReleaseWaitingPubComplete
(
String
clientID
) {
if
(
!
sessions
.
containsKey(clientID)) {
LOG
.
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
"
,
FileResourceLoader
implements
IResourceLoader
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
FileResourceLoader
.
class);
@@ -68,8 +73,8 @@ public Reader loadResource(File f) {
:
end
@
rem
End local scope for the variables with windows NT shell
if
"
%ERRORLEVEL%
"
==
"
0
"
goto
mainEnd
:
fail
rem
Set variable GRADLE_EXIT_CONSOLE if you need the _script_ return code instead of
containsKey(clientID)) {
LOG
.
debug(
"
clientID {} is a newcome, creating it's subscriptions set
"
, clientID);
m_persistentSubscriptions
.
put(clientID,
new
HashSet<
Subscription
>
());
}
Set<
Subscription
:
'
checkstyle
'
apply
plugin
:
'
findbugs
'
apply
plugin
:
'
com.github.spotbugs
'
apply
plugin
'
gradle/lint.gradle
'
)
apply
plugin
:
'
com.jfrog.bintray
'
apply
plugin
:
'
com.jfrog.bintray
'
apply
plugin
$JAVA_HOME
/jre/sh/java
"
]
;
then
#
IBM's JDK on AIX uses strange locations for the executables
JAVACMD=
"
$JAVA_HOME
/jre/sh/java
"
else
JAVACMD=
"
$JAVA_HOME
/bin/java
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
name
:
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
org.assertj
'
,
}
}
else
{
if
(line
.
isEmpty()
||
line
.
matches(
"
^
\\
s*$
"
)) {
//
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
LEAST_ONE
) {
if
(publishKey
==
null
) {
throw
new
RuntimeException
(
"
Found a publish key null for QoS
"
+
qos
poll());
assertEquals(
"
world
"
, sut
.
poll());
assertTrue(
"
after poll 2 elements inserted before, should be empty
"
, sut
.
isEmpty());
}
@Ignore
@Test
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DemuxEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DisconnectDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/DisconnectEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MQTTDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MQTTEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/MessageIDDecoder.java
+15
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingReqDecoder.java
+15
−1
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingReqEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingRespDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingRespEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubAckEncoder.java
+15
//
e.printStackTrace();
//
}
//
}
4
broker/src/main/java/io/moquette/server/config/ClasspathResourceLoader.java
Show comments
View file
Edit file
Delete file
@@ -19,6 +19,8 @@
import
java.io.InputStream
;
import
java.io.InputStream
b
>
<
span
style
="
font-size: 10pt;
"
>
2. Grant of Copyright License.
</
span
>
</
b
>
</
p
{
final
Map<
Integer
,
IMessagesStore
.
StoredMessage
>
inboundFlightMessages
=
new
ConcurrentHashMap<>
();
IMessagesStore
.
StoredMessage
lookup
error(
"
Can't find the session for client <{}>
"
, clientID);
return
0
;
}
return
sessions
.
get(clientID)
.
secondPhaseStore
.
size();
}
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
throw
new
ResourceIsDirectoryException
(
"
File
\"
"
+
f
+
"
\"
is a directory!
"
);
}
try
{
rem
the _cmd.exe /c_ return code!
if
not
"
"
==
"
%GRADLE_EXIT_CONSOLE%
"
exit
1
exit
/b
1
:
mainEnd
if
"
>
subs
=
m_persistentSubscriptions
.
get(clientID);
if
(
!
subs
.
contains(newSubscription)) {
LOG
.
debug(
"
:
'
net.ltgt.errorprone
'
dependencies
{
errorprone
"
com.google.errorprone:error_prone_core:2.2.0
"
:
'
eclipse
'
apply
plugin
:
'
eclipse
'
apply
plugin
:
"
fi
if
[
!
-x
"
$JAVACMD
"
]
;
then
die
"
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
name
:
'
assertj-core
'
,
version
:
'
2.6.0
'
testCompile
group
:
'
org.mockito
'
,
name
skip it's a black line
continue
;
}
//
split till the first space
int
deilimiterIdx
=
line
.
indexOf(
'
:
'
);
String
+
"
for message
"
+
evt);
}
m_storageService
.
cleanInFlight(publishKey);
sendPubAck(
new
PubAckEvent
public
void
testPerformance
() {
H2PersistentQueue<
String
>
sut
=
new
H2PersistentQueue<>
(
this
.
mvStore,
"
test
"
−1
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingReqDecoder.java
+15
−1
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingReqEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingRespDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PingRespEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubCompDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubCompEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRecDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRecEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRelDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRelEncoder.java
;
import
java.io.InputStreamReader
;
import
java.io.InputStreamReader
;
import
java.io.Reader
;
import
java.io.Reader
;
import
java.nio.charset.StandardCharsets
;
import
org.slf4j.Logger
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
(
int
messageID
) {
return
inboundFlightMessages
.
get(messageID);
}
void
waitingRel
(
int
messageID
,
IMessagesStore
.
StoredMessage
@Override
public
void
removeTemporaryQoS2
(
String
clientID
) {
LOG
.
debug(
"
Session cleanup for client <{}>
"
, clientID);
Session
session
=
sessions
messageLogger
"
,
new
MQTTMessageLogger
());
pipeline
.
addLast(
"
handler
"
, handler);
}
});
}
private
void
initializeSSLTCPTransport
return
new
FileReader
(f
);
}
catch
(
FileNotFoundException
e) {
return
Files
.
newBufferedReader(f
.
toPath(),
UTF_8
);
%OS%
"
==
"
Windows_NT
"
endlocal
:
omega
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
updating clientID {} subscriptions set with new subscription
"
, clientID);
//
TODO check the subs doesn't contain another subscription to the same topic with different
Subscription
existingSubscription
=
null
;
for
(
Subscription
scanSub
:
subs) {
if
}
checkstyle
{
configProperties
.
checkstyleConfigDir
=
"
.
"
@@ -8,12 +13,8 @@ checkstyle {
toolVersion
=
'
6.7
'
}
findbugs
{
'
net.ltgt.errorprone
'
configurations
.
errorprone {
resolutionStrategy
.
force
'
com.google.errorprone:error_prone_core:2.0.14
'
}
ext {
ext {
nettyVersion
=
'
ERROR: JAVA_HOME is set to an invalid directory:
$JAVA_HOME
Please set the JAVA_HOME variable in your environment to match the
location of your Java installation.
"
fi
else
JAVACMD=
"
java
"
which java
>
/dev/null
2>&1
||
die
"
ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.
:
'
mockito-core
'
,
version
:
'
1.9.0
'
testCompile
group
:
'
org.awaitility
'
,
name
username
=
line
.
substring(
0
, deilimiterIdx)
.
trim();
String
password
=
line
.
substring(deilimiterIdx
+
1
)
(evt
.
getMessageID(), evt
.
getClientID()));
LOG
.
debug(
"
replying with PubAck to MSG ID {}
"
, evt
.
getMessageID());
}
if
(retain) {
m_storageService
);
int
numIterations
=
10000000
;
for
(
int
i
=
0
; i
<
numIterations; i
++
) {
sut
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubCompDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubCompEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRecDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRecEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRelDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PubRelEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PublishDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PublishEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubscribeDecoder.java
+15
−0
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
org.slf4j.LoggerFactory
;
@@ -51,7 +53,7 @@ public Reader loadDefaultResource() {
public
Reader
loadResource
(
String
relativePath
) {
Work and such Derivative Works in Source or Object form.
</
span
>
</
p
>
<
p
>
<
b
>
<
span
style
="
msg
) {
inboundFlightMessages
.
put(messageID, msg);
}
}
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DurableSession
.
get(clientID);
if
(session
==
null
) {
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
return
;
}
LOG
(
final
NettyMQTTHandler
handler
,
IConfig
props
,
final
SSLContext
sslContext
)
throws
IOException
{
LOG
.
info(
}
catch
(
IOException
e) {
LOG
.
error(
"
The file does not exist. Path = {}.
"
, f
.
getAbsolutePath());
return
null
;
}
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
(newSubscription
.
getTopic()
.
equals(scanSub
.
getTopic())) {
existingSubscription
=
scanSub;
break
;
}
}
if
(existingSubscription
!=
toolVersion
=
'
3.
0
.1
'
spotbugs
{
toolVersion
=
'
3.
1
.1
'
ignoreFailures true
omitVisitors
4.1.12.Final
'
nettyVersion
=
'
4.1.12.Final
'
@@ -85,5 +82,5 @@ subprojects {
}
}
task
wrapper
(
type
:
Wrapper
) {
task
Please set the JAVA_HOME variable in your environment to match the
location of your Java installation.
"
fi
#
Increase the maximum file descriptors if we can.
if
[
"
$cygwin
"
=
"
false
"
-a
"
$darwin
:
'
awaitility
'
,
version
:
'
3.0.0
'
}
test {
systemProperties
.
put
"
moquette.path
.
trim();
m_identities
.
put(username, password);
}
}
}
catch
(
IOException
ex) {
throw
new
ParseException
(
"
.
storeRetained(topic, message, qos);
}
}
/**
* Flood the subscribers with the message to notify. MessageID is optional and should only used for QoS 1 and 2
*
*/
private
void
publish2Subscribers
(
String
topic
,
AbstractMessage
.
.
add(
"
Hello
"
);
}
mvStore
.
commit();
for
(
int
i
=
0
; i
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PublishDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/PublishEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubscribeDecoder.java
+15
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubscribeEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/Utils.java
public
Reader
loadResource
(
String
relativePath
) {
LOG
.
info(
"
Loading resource. RelativePath = {}.
"
, relativePath);
LOG
.
info(
"
font-size: 10pt;
"
>
3. Grant of Patent License.
</
span
>
</
b
>
<
p
>
<
p
>
<
span
style
.
class);
private
final
ISessionsStore
sessionsStore;
16
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,19 @@
.
info(
"
Removing stored messages with QoS 2. ClientId={}
"
, clientID);
session
.
secondPhaseStore
.
clear();
//
TODO this missing last step breaks the junit test
//
sessions.remove(clientID);
}
@Override
public
"
Configuring SSL MQTT transport
"
);
String
sslPortProp
=
props
.
getProperty(
SSL_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
if
(
DISABLED_PORT_BIND
.
4
broker/src/main/java/io/moquette/server/netty/MoquetteIdleTimeoutHandler.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
io.netty.handler.timeout.IdleState
;
import
io.netty.handler.timeout.IdleStateEvent
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
@Sharable
class
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
null
) {
subs
.
remove(existingSubscription);
}
subs
.
add(newSubscription);
m_persistentSubscriptions
.
put(clientID, subs);
LOG
.
debug(
"
=
[
'
RuntimeExceptionCapture
'
]
}
tasks
.
withType(
FindBugs
) {
maxHeapSize
=
'
2g
'
}
wrapper
(
type
:
Wrapper
) {
gradleVersion
=
'
3.3
'
gradleVersion
=
'
4.6
'
}
}
"
=
"
false
"
-a
"
$nonstop
"
=
"
false
"
]
;
then
MAX_FD_LIMIT=
`
ulimit -H -n
"
,
"
build/resources/test/
"
systemProperties
.
put
"
io.netty.leakDetectionLevel
"
,
"
paranoid
"
testLogging {
exceptionFormat
Failed to read
"
,
1
);
}
}
public
boolean
checkValid
(
String
username
,
String
password
) {
QOSType
qos
,
ByteBuffer
origMessage
,
boolean
retain
,
Integer
messageID
) {
LOG
.
debug(
"
<
numIterations; i
++
) {
assertEquals(
"
Hello
"
, sut
.
poll());
}
assertTrue(
"
should be empty
"
, sut
.
isEmpty());
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/SubscribeEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubAckDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubAckEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeDecoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeEncoder.java
+15
−0
netty_parser/src/main/java/org/dna/mqtt/moquette/parser/netty/Utils.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnAckDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnAckEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnectDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnectEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PubAckDecoderTest.java
+15
−0
Loading resource. RelativePath = {}.
"
, relativePath);
InputStream
is
=
this
.
classLoader
.
getResourceAsStream(relativePath);
InputStream
is
=
this
.
classLoader
.
="
font-size: 10pt;
"
>
Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
synchronized
void
trackSessionClose
(
LocalDateTime
when
,
String
clientID
) {
this
.
sessionsClosingTimes
.
putIfAbsent(when,
new
HashSet<>
equals(sslPortProp)) {
//
Do nothing no SSL configured
LOG
.
info(
"
"
,
BrokerConstants
.
SSL_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
MoquetteIdleTimeoutHandler
extends
ChannelDuplexHandler
{
@@ -37,7 +39,7 @@ public void userEventTriggered(ChannelHandlerContext ctx, Object evt) throws Exc
LOG
.
info(
"
Firing channel inactive event. MqttClientId = {}.
"
,
NettyUtils
.
clientID(ctx
.
channel()));
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
, clientID, subs);
}
}
public
void
removeAllSubscriptions
(
String
clientID
) {
m_persistentSubscriptions
.
remove(clientID);
}
public
List<
BIN
+1005 Bytes (100%)
gradle/wrapper/gradle-wrapper.jar
Show comments
View file
Edit file
Delete file
Binary file not shown.
3
gradle/wrapper/gradle-wrapper.properties
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,5 @@
#
15
gradle/lint.gradle
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,10 @@
apply
plugin
:
'
checkstyle
'
apply
plugin
:
'
`
if
[
$?
-eq
0 ]
;
then
if
[
"
$MAX_FD
"
=
"
maximum
"
-o
'
full
'
events
"
passed
"
,
"
skipped
"
,
"
failed
"
}
}
//
Deploy set environment variables and run ./gradlew bintrayUpload
String
foundPwq
=
m_identities
.
get(username);
if
(foundPwq
==
null
) {
return
false
;
}
return
foundPwq
.
equals(password);
publish2Subscribers republishing to existing subscribers that matches the topic {}
"
, topic);
if
(
LOG
.
isDebugEnabled()) {
LOG
.
debug(
"
content <{}>
"
,
DebugUtils
.
}
@Test
public
void
testReloadFromPersistedState
() {
H2PersistentQueue<
String
>
before
=
new
H2PersistentQueue<>
(
this
.
mvStore,
"
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnAckDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnAckEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnectDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/ConnectEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PubAckDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PubAckEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PublishDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PublishEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubAckDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubAckEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubscribeDecoderTest.java
+15
getResourceAsStream(relativePath);
return
is
!=
null
?
new
InputStreamReader
(is)
:
null
;
return
is
!=
null
?
new
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.
</
span
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
io.moquette.spi
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
033a428
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
());
this
.
sessionsClosingTimes
.
computeIfPresent(when, (key, oldSet)
-
>
{
oldSet
.
add(clientID);
return
oldSet;
});
}
int
sslPort
=
Integer
.
parseInt(sslPortProp);
LOG
.
info(
"
Starting SSL on port {}
"
, sslPort);
final
MoquetteIdleTimeoutHandler
timeoutHandler
//
fire a channelInactive to trigger publish of Will
ctx
.
fireChannelInactive();
ctx
.
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
Subscription
>
retrieveAllSubscriptions
() {
List<
Subscription
>
allSubscriptions
=
new
ArrayList<
Subscription
>
();
for
(
Map
.
Entry<
String
Thu Aug 10 18:13:58 CEST 2017
distributionBase
=GRADLE_USER_HOME
distributionPath
=wrapper/dists
distributionUrl
=https\://services.gradle.org/distributions/gradle-4.6-bin.zip
zipStoreBase
=GRADLE_USER_HOME
zipStorePath
=wrapper/dists
distributionUrl
=
https\://services.gradle.org/distributions/gradle-3.3-bin.zip
26
gradlew
Show comments
checkstyle
'
apply
plugin
:
'
findbugs
'
apply
plugin
:
'
com.github.spotbugs
'
apply
plugin
:
'
"
$MAX_FD
"
=
"
max
"
]
;
then
MAX_FD=
"
$MAX_FD_LIMIT
"
fi
ulimit
-n
$MAX_FD
bintray {
user
=
System
.
getenv(
'
BINTRAY_USER
'
)
key
=
System
.
getenv(
'
BINTRAY_KEY
'
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
payload2Str(origMessage));
LOG
.
debug(
"
subscription tree {}
"
, subscriptions
.
dumpTree());
}
for
(
final
Subscription
sub
:
subscriptions
test
"
);
before
.
add(
"
Hello
"
);
before
.
add(
"
crazy
"
);
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PubAckEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PublishDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/PublishEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubAckDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubAckEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubscribeDecoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubscribeEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/TestUtils.java
+15
−1
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeDecoderTest.java
+15
−1
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UtilsTest.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/commons/Constants.java
InputStreamReader
(is
,
StandardCharsets
.
UTF_8
)
:
null
;
}
}
@Override
@Override
13
broker/src/main/java/io/moquette/server/config/ConfigurationParser.java
Show comments
View file
"
>
4. Redistribution.
</
span
>
</
b
>
</
p
>
<
p
>
<
span
style
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
}
@Override
public
Set<
String
>
sessionOlderThan
(
LocalDateTime
queryPin
) {
final
Set<
String
>
results
=
new
=
new
MoquetteIdleTimeoutHandler
();
String
host
=
props
.
getProperty(
BrokerConstants
.
HOST_PROPERTY_NAME
);
String
sNeedsClientAuth
=
props
}
else
{
if
(
LOG
.
isDebugEnabled()) {
8
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
Show comments
View file
Edit file
Delete file
@@ -44,6 +44,7 @@
import
,
Set<
Subscription
>
>
entry
:
m_persistentSubscriptions) {
allSubscriptions
.
addAll(entry
View file
Edit file
Delete file
@@ -1,4 +1,4 @@
#!
/usr/bin/env
bash
#!
/usr/bin/env
sh
#
net.ltgt.errorprone
'
dependencies
{
errorprone
"
com.google.errorprone:error_prone_core:2.2.0
"
}
checkstyle
{
checkstyle
{
configProperties
.
if
[
$?
-ne
0 ]
;
then
warn
"
Could not set maximum file descriptor limit:
$MAX_FD
"
fi
else
warn
"
Could not query maximum file descriptor limit:
$MAX_FD_LIMIT
)
pkg {
repo
=
'
'
name
=
"
${
project.name
}
"
userOrg
=
'
andsel
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
.
matches(topic)) {
if
(qos
.
ordinal()
>
sub
.
getRequestedQos()
.
ordinal()) {
qos
=
sub
.
getRequestedQos();
}
before
.
add(
"
world
"
);
assertEquals(
"
Hello
"
, before
.
poll());
this
.
mvStore
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/SubscribeEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/TestUtils.java
+15
−1
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeDecoderTest.java
+15
−1
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UnsubscribeEncoderTest.java
+15
−0
netty_parser/src/test/java/org/dna/mqtt/moquette/parser/netty/UtilsTest.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/commons/Constants.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/MQTTException.java
+15
−4
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/Utils.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/AbstractMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ConnAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ConnectMessage.java
+15
−0
Edit file
Delete file
@@ -24,6 +24,8 @@
import
java.io.FileReader
;
import
java.io.FileReader
;
import
java.io.IOException
;
import
java.io.IOException
;
import
java.io.Reader
="
font-size: 10pt;
"
>
You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You
meet the following conditions:
</
span
>
<
p
>
<
ul
>
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
HashSet<>
();
LocalDateTime
keyBefore
=
this
.
sessionsClosingTimes
.
lowerKey(queryPin);
while
(keyBefore
!=
null
) {
results
.
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
final
boolean
needsClientAuth
=
Boolean
.
valueOf(sNeedsClientAuth);
initFactory(host, sslPort,
io.netty.handler.ssl.SslHandler
;
import
io.netty.handler.timeout.IdleStateHandler
;
import
io.netty.util.concurrent.Future
;
import
io.netty.util.concurrent.GenericFutureListener
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
.
getValue());
}
LOG
.
debug(
"
retrieveAllSubscriptions returning subs {}
"
, allSubscriptions);
return
allSubscriptions;
}
public
void
close
() {
LOG
#############################################################################
#
#
@@ -33,11 +33,11 @@ DEFAULT_JVM_OPTS=""
#
Use the maximum available, or set MAX_FD != -1 to use that value.
MAX_FD=
"
maximum
"
warn (
) {
warn
() {
echo
"
$*
"
checkstyleConfigDir
=
"
.
"
configProperties
.
checkstyleConfigDir
=
"
.
"
@@ -8,12 +13,8 @@ checkstyle {
toolVersion
=
'
6.7
'
"
fi
fi
#
For Darwin, add options to specify how the application appears in the dock
if
$darwin
;
then
GRADLE_OPTS=
"
$GRADLE_OPTS
\"
-Xdock:name=
$APP_NAME
\"
'
licenses
=
[
'
Apache-2.0
'
]
vcsUrl
=
"
https://api.bintray.com/maven/andsel/maven/
${
project.group
}
.
${
project.name
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
ByteBuffer
message
=
origMessage
.
duplicate();
LOG
.
debug(
"
"
,
sub
.
getClientId(), sub
.
getTopic(), qos, sub
.
.
commit();
this
.
mvStore
.
close();
this
.
mvStore
=
new
MVStore
.
Builder
()
.fileName(
BrokerConstants
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/MQTTException.java
+15
−4
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/Utils.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/AbstractMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ConnAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ConnectMessage.java
+15
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/DisconnectMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/MessageIDMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PingReqMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PingRespMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubCompMessage.java
;
import
java.io.Reader
;
import
java.nio.charset.StandardCharsets
;
import
java.nio.file.Files
;
import
java.text.ParseException
;
import
java.text.ParseException
;
import
java.util.Properties
<
li
>
<
span
style
="
font-size: 10pt;
"
>
(a) You must give any other recipients of the Work or
Derivative Works a copy of this License; and
</
span
>
<
p
>
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
addAll(
this
.
sessionsClosingTimes
.
get(keyBefore));
keyBefore
=
this
.
sessionsClosingTimes
.
lowerKey(keyBefore);
}
return
results;
}
"
SSL MQTT
"
,
new
PipelineInitializer
() {
@Override
void
init
(
ChannelPipeline
pipeline
)
throws
Exception
{
pipeline
javax.net.ssl.SSLContext
;
@@ -53,6 +54,7 @@
import
java.util.Optional
;
import
java.util.concurrent.TimeUnit
;
import static
io.moquette.BrokerConstants.*
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
public
class
NettyAcceptor
.
debug(
"
closing disk storage
"
);
try
{
pageFactory
.
close();
}
catch
(
IOException
ex) {
LOG
.
}
die (
) {
die
() {
echo
echo
"
$*
"
echo
@@ -154,11 +154,19 @@ if $cygwin ; then
esac
fi
#
Split up the JVM_OPTS And GRADLE_OPTS values into an array, following the shell quoting and substitution rules
toolVersion
=
'
6.7
'
}
}
findbugs
{
spotbugs
{
toolVersion
=
'
3.
0
.1
\"
-Xdock:icon=
$APP_HOME
/media/gradle.icns
\"
"
fi
#
For Cygwin, switch paths to Windows format before running java
if
$cygwin
;
then
APP_HOME=
`
cygpath --path --mixed
"
$APP_HOME
"
}
"
}
}
}
task
wrapper
(
type
:
Wrapper
) {
gradleVersion
=
'
4.6
'
}
Accept
Reject
Save preferences
isActive());
if
(qos
==
AbstractMessage
.
QOSType
.
MOST_ONE
&&
sub
.
isActive()) {
//
QoS 0
sendPublish(sub
.
getClientId(), topic, qos, message,
.
DEFAULT_PERSISTENT_PATH
)
.autoCommitDisabled()
.open();
//
now reload the persisted state
H2PersistentQueue<
String
>
after
=
new
H2PersistentQueue<>
(
this
.
mvStore,
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/DisconnectMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/MessageIDMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PingReqMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PingRespMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubCompMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubRecMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubRelMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PublishMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/SubAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/SubscribeMessage.java
+15
−0
;
import
java.util.Properties
;
@@ -55,15 +57,10 @@ void parse(File file) throws ParseException {
return
;
return
;
}
}
try
{
try
{
FileReader
reader
=
</
li
>
<
li
>
<
span
style
="
font-size: 10pt;
"
>
(b) You must cause any modified files to carry prominent notices
stating that You changed the files; and
</
span
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
.
addLast(
"
ssl
"
, createSslHandler(sslContext, needsClientAuth));
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
implements
ServerAcceptor
{
@@ -85,7 +87,7 @@ protected void encode(ChannelHandlerContext chc, ByteBuf bb, List<Object> out) t
}
}
abstract
class
PipelineInitializer
{
abstract
static
class
PipelineInitializer
{
abstract
void
init
error(
null
, ex);
}
}
/*
-------- QoS 2 storage management --------------
*/
public
void
persistQoS2Message
(
String
publishKey
,
PublishEvent
evt
) {
LOG
splitJvmOpts()
{
JVM_OPTS=(
"
$@
"
)
#
Escape application args
save
() {
for
i
do
printf
%s
\\
n
"
'
toolVersion
=
'
3.
1
.1
'
ignoreFailures true
ignoreFailures true
omitVisitors
=
[
'
RuntimeExceptionCapture
'
]
omitVisitors
`
CLASSPATH=
`
cygpath --path --mixed
"
$CLASSPATH
"
`
JAVACMD=
`
cygpath --unix
"
$JAVACMD
"
`
#
We build the pattern for arguments to be converted via cygpath
ROOTDIRSRAW=
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
false
);
}
else
{
//
QoS 1 or 2
//
if the target subscription is not clean session and is not connected => store it
if
(
!
sub
.
isCleanSession()
&&
!
"
test
"
);
assertEquals(
"
crazy
"
, after
.
poll());
assertEquals(
"
world
"
, after
.
poll());
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubRecMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PubRelMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/PublishMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/SubAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/SubscribeMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/UnsubAckMessage.java
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/UnsubAckMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/UnsubscribeMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ZeroLengthMessage.java
28
about.html
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,28 @@
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
new
FileReader
(file);
Reader
reader
=
Files
.
newBufferedReader
(file
.
toPath(),
StandardCharsets
.
UTF_8
);
parse(reader);
parse(reader);
>
<
p
>
</
li
>
</
li
>
<
span
style
="
font-size: 10pt;
"
>
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
0
));
pipeline
.
addAfter(
"
idleStateHandler
"
,
"
idleEventHandler
"
, timeoutHandler);
//
pipeline.addLast("logger", new LoggingHandler("Netty", LogLevel.ERROR));
(
ChannelPipeline
pipeline
)
throws
Exception
;
}
@@ -197,7 +199,7 @@ public void initChannel(SocketChannel ch) throws Exception {
//
Bind and start to accept incoming connections.
ChannelFuture
f
=
b
.
bind(host, port);
.
debug(
"
"
, publishKey, evt);
m_qos2Store
.
put(publishKey, convertToStored(evt));
}
public
void
removeQoS2Message
(
String
publishKey
) {
m_qos2Store
.
$i
"
|
sed
"
s/'/'
\\\\
''/g;1s/^/'/;
\$
s/
\$
/'
\\\\
/
"
;
done
echo
"
=
[
'
RuntimeExceptionCapture
'
]
}
}
tasks
.
withType(
FindBugs
) {
maxHeapSize
=
'
2g
`
find -L / -maxdepth 1 -mindepth 1 -type d
2>
/dev/null
`
SEP=
"
"
for
dir
in
$ROOTDIRSRAW
;
do
ROOTDIRS=
"
$ROOTDIRS$SEP$dir
"
SEP=
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
sub
.
isActive()) {
//
clone the event with matching clientID
PublishEvent
newPublishEvt
=
new
PublishEvent
(topic, qos, message, retain, sub
.
getClientId(), messageID,
null
);
m_storageService
.
storePublishForFuture(newPublishEvt);
}
assertTrue(
"
should be empty
"
, after
.
isEmpty());
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/UnsubscribeMessage.java
+15
−0
parser_commons/src/main/java/org/dna/mqtt/moquette/proto/messages/ZeroLengthMessage.java
28
about.html
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,28 @@
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
>
>
<
html
xmlns
="
http://www.w3.org/1999/xhtml
"
>
<
head
>
<
meta
http-equiv
="
Content-Type
"
content
}
catch
(
FileNotFoundException
fex) {
}
catch
(
IOException
fex) {
LOG
.
warn(
LOG
.
warn(
"
(c) You must retain, in the Source form of any Derivative Works
that You distribute, all copyright, patent, trademark, and
attribution notices from the Source form of the Work,
excluding those notices that do not pertain to any part of
the Derivative Works; and
</
span
>
<
p
>
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
pipeline
.
addFirst(
"
bytemetrics
"
,
new
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
decoder
"
,
new
LOG
.
info(
"
"
, host, port);
f
.
sync();
f
.
sync()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
)
;
}
remove(publishKey);
}
public
PublishEvent
retrieveQoS2Message
(
String
publishKey
) {
StoredPublishEvent
storedEvt
=
m_qos2Store
.
get(publishKey);
return
convertFromStored(storedEvt);
}
private
"
}
eval
splitJvmOpts
$DEFAULT_JVM_OPTS
$JAVA_OPTS
$GRADLE_OPTS
JVM_OPTS[
${
#
JVM_OPTS[*]}
]=
"
-Dorg.gradle.appname=
$APP_BASE_NAME
"
APP_ARGS=
$(
'
}
BIN
+1005 Bytes (100%)
gradle/wrapper/gradle-wrapper.jar
Show comments
View file
Edit file
Delete file
Binary file not shown.
3
gradle/wrapper/gradle-wrapper.properties
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,5 @@
#
"
|
"
done
OURCYGPATTERN=
"
(^(
$ROOTDIRS
))
"
#
Add a user-defined pattern to the cygpath arguments
if
[
"
$GRADLE_CYGPATTERN
"
!=
"
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
else
{
//
if QoS 2 then store it in temp memory
if
(qos
==
AbstractMessage
.
QOSType
.
EXACTLY_ONCE
) {
String
publishKey
=
String
.
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
<
html
xmlns
="
http://www.w3.org/1999/xhtml
"
>
<
head
>
<
meta
http-equiv
="
Content-Type
"
content
="
text/html; charset=ISO-8859-1
="
text/html; charset=ISO-8859-1
"/>
<
title
>
About
</
title
>
</
head
>
<
body
lang
="
EN-US
parsing not existing file {}, fallback on default configuration!
"
, file
.
getAbsolutePath(), fex);
String
.
format(
"
parsing not existing file %s, so fallback on default configuration!
"
,
file
.
getAbsolutePath()),
fex);
return
;
</
li
>
<
li
>
<
span
style
="
font-size: 10pt;
"
>
(d) If the Work includes a "NOTICE" text file as part of its
distribution, then any Derivative Works that You distribute must
include a readable copy of the attribution notices contained
within such NOTICE file, excluding those notices that do not
pertain to any part of the Derivative Works, in at least one
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
"
,
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
catch
(
InterruptedException
ex) {
LOG
.
error(
"
An interruptedException was caught while initializing server. Protocol={}
"
, protocol, ex);
}
@@ -349,6 +351,8 @@ void init(ChannelPipeline pipeline) throws Exception {
});
}
@SuppressWarnings
(
"
StoredPublishEvent
convertToStored
(
PublishEvent
evt
) {
StoredPublishEvent
storedEvt
=
new
StoredPublishEvent
(evt);
return
storedEvt;
}
private
PublishEvent
convertFromStored
save
"
$@
"
)
exec
"
$JAVACMD
"
"
"
-classpath
"
$CLASSPATH
"
org.gradle.wrapper.GradleWrapperMain
"
$@
"
Thu Aug 10 18:13:58 CEST 2017
distributionBase
=GRADLE_USER_HOME
distributionBase
=GRADLE_USER_HOME
distributionPath
=wrapper/dists
distributionPath
=wrapper/dists
distributionUrl
=https\://services.gradle.org/distributions/gradle-4.6-bin.zip
zipStoreBase
=GRADLE_USER_HOME
zipStoreBase
=GRADLE_USER_HOME
zipStorePath
=wrapper/dists
zipStorePath
"
]
;
then
OURCYGPATTERN=
"
$OURCYGPATTERN
|(
$GRADLE_CYGPATTERN
)
"
fi
#
Now convert the arguments - kludge to limit ourselves to /bin/sh
i=0
for
arg
in
"
format(
"
%s%d
"
, sub
.
getClientId(), messageID);
PublishEvent
newPublishEvt
=
new
PublishEvent
(topic, qos, message, retain, sub
.
getClientId(), messageID,
null
);
m_storageService
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
"/>
<
title
>
About
</
title
>
</
head
>
<
body
lang
="
EN-US
"
>
"
>
<
h2
>
About Moquette MQT broker
</
h2
>
<
p
>
June 11, 2014
</
p
>
<
h3
}
}
}
}
9
broker/src/main/java/io/moquette/server/config/FileResourceLoader.java
Show comments
View file
Edit file
Delete file
@@ -19,10 +19,15 @@
import
java.io.File
;
import
java.io.File
;
of the following places: within a NOTICE text file distributed
as part of the Derivative Works; within the Source form or
documentation, if provided along with the Derivative Works; or,
within a display generated by the Derivative Works, if and
wherever such third-party notices normally appear. The contents
of the NOTICE file are for informational purposes only and
do not modify the License. You may add Your own attribution
notices within Derivative Works that You distribute, alongside
or as an addendum to the NOTICE text from the Work, provided
that such additional attribution notices cannot be construed
as modifying the License.
</
span
moquette/PostOfficePublishTest.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
"
,
new
MQTTMessageLogger
());
pipeline
.
addLast(
FutureReturnValueIgnored
"
)
@Override
public
void
close
() {
LOG
.
info(
"
Closing Netty acceptor...
"
);
if
(m_workerGroup
==
null
(
StoredPublishEvent
evt
) {
byte
[] message
=
evt
.
getMessage();
ByteBuffer
bbmessage
=
ByteBuffer
.
wrap(message);
//
bbmessage.flip();
moquette/PostOfficeUnsubscribeTest.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
#
Collect all arguments for the java command, following the shell quoting and substitution rules
eval
set
--
$DEFAULT_JVM_OPTS
$JAVA_OPTS
$GRADLE_OPTS
"
\"
-Dorg.gradle.appname=
$APP_BASE_NAME
=wrapper/dists
distributionUrl
=
https\://services.gradle.org/distributions/gradle-3.3-bin.zip
26
gradlew
Show comments
View file
Edit file
Delete file
@@ -1,4 +1,4 @@
#!
/usr/bin/env
bash
#!
/usr/bin/env
sh
$@
"
;
do
CHECK=
`
echo
"
$arg
"
|
egrep -c
"
$OURCYGPATTERN
"
-
`
CHECK2=
moquette/MQTTConnectionPublishTest.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
.
addInFlight(newPublishEvt, publishKey);
}
//
publish
if
(sub
.
isActive()) {
sendPublish(sub
.
getClientId(), topic, qos, message,
false
);
}
}
}
}
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
<
h2
>
About Moquette MQT broker
</
h2
>
<
p
>
June 11, 2014
</
p
>
<
h3
>
License
</
moquette/PostOfficeInternalPublishTest.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
>
License
</
h3
>
<
p
>
The Eclipse Foundation makes available all content in this plug-in (&quot;Moquette MQTT&quot;). Unless otherwise
indicated below, the Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
import
java.io.FileNotFoundException
;
import
java.io.FileNotFoundException
;
import
java.io.FileReader
;
import
java.io.FileReader
;
import
java.io.IOException
;
import
java.io.Reader
>
<
p
>
</
li
>
</
ul
>
</
span
>
</
p
>
<
p
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
moquette/SessionRegistryTest.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
"
handler
"
, handler);
}
});
}
private
void
initializeWSSTransport
(
final
NettyMQTTHandler
handler
,
IConfig
props
,
||
m_bossGroup
==
null
) {
14
broker/src/main/java/io/moquette/server/netty/NettyMQTTHandler.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
io.netty.util.ReferenceCountUtil
;
import
org.slf4j.Logger
;
PublishEvent
liveEvt
=
new
PublishEvent
(evt
.
getTopic(), evt
.
getQos(),
bbmessage, evt
.
isRetain(), evt
.
getClientID(), evt
.
getMessageID(),
null
);
return
moquette/PostOfficeSubscribeTest.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
\"
"
-classpath
"
\"
$CLASSPATH
\"
"
org.gradle.wrapper.GradleWrapperMain
"
$APP_ARGS
"
#
by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
if
[
"
$(
uname
#
#############################################################################
#
#############################################################################
#
#
#
#
@@ -33,11 +33,11 @@ DEFAULT_JVM_OPTS=""
#
Use the maximum available, or set MAX_FD != -1 to use that value.
#
Use the maximum available, or set MAX_FD != -1 to use that value.
MAX_FD=
"
maximum
"
MAX_FD=
`
echo
"
$arg
"
|
egrep -c
"
^-
"
`
#
## Determine if an option
if
[
$CHECK
-ne
0 ]
&&
Updated the pax-runner to fix issue #40 · moquette-io/moquette@0bbe719 · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
}
private
void
sendPublish
(
String
clientId
,
String
topic
,
AbstractMessage
.
QOSType
qos
,
ByteBuffer
message
,
h3
>
<
p
>
The Eclipse Foundation makes available all content in this plug-in (&quot;Moquette MQTT&quot;). Unless otherwise
indicated below, the Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
Merge pull request #389 from MBOIX/fix/issue_375 · moquette-io/moquette@2fb475a · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
<
p
>
If you did not receive this Content directly from the Eclipse Foundation, the Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
;
import
java.io.Reader
;
import
java.nio.file.Files
;
import
org.slf4j.Logger
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
org.slf4j.LoggerFactory
>
<
span
style
="
font-size: 10pt;
"
>
You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
for any such Derivative Works as a whole, provided Your use,
reproduction, and distribution of the Work otherwise complies with
the conditions stated in this License.
</
span
>
</
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
final
SSLContext
sslContext
)
throws
IOException
{
LOG
.
info(
"
import
org.slf4j.LoggerFactory
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_MOST_ONCE
;
@Sharable
@@ -78,16 +80,16 @@ public void channelRead(ChannelHandlerContext ctx, Object message) {
liveEvt;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
moquette/MQTTConnectionConnectTest.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
moquette/H2QueueRepository.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
moquette/H2PersistentQueue.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
moquette/H2Builder.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
)
"
=
"
Darwin
"
]
&&
[
"
$HOME
"
=
"
$PWD
"
]
;
then
"
maximum
"
warn (
) {
warn
() {
echo
"
$*
"
echo
"
$*
"
}
}
[
$CHECK2
-eq
0 ]
;
then
#
## Added a condition
eval
`
echo args
Skip to content
Sign up
Why GitHub?
Features
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
boolean
retained
) {
//
TODO pay attention to the message ID can't be 0 and it's the message sent to subscriber
int
messageID
=
1
;
sendPublish(clientId, topic, qos, message, retained, messageID);
}
private
void
sendPublish
(
String
>
.
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
<
p
>
If you did not receive this Content directly from the Eclipse Foundation, the Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
indicated below, the terms and conditions of the EPL still apply to any source code in the Content
and such source code may be obtained at
<
a
href
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
indicated below, the terms and conditions of the EPL still apply to any source code in the Content
and such source code may be obtained at
<
a
href
="
http://www.eclipse.org/
"
>
http://www.eclipse.org
</
a
>
.
</
p
>
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
public
class
FileResourceLoader
implements
IResourceLoader
{
public
class
FileResourceLoader
implements
IResourceLoader
{
private
static
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
5. Submission of Contributions.
</
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Configuring secure websocket MQTT transport
"
);
String
sslPortProp
=
props
.
getProperty(
WSS_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
if
(
DISABLED_PORT_BIND
.
false
,
0
);
MqttMessage
pingResp
=
new
MqttMessage
(pingHeader);
ctx
.
writeAndFlush(pingResp);
ctx
.
writeAndFlush(pingResp)
.
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
moquette/SessionRegistry.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
moquette/Server.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
moquette/MemoryQueueRepository.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
cd
"
$(
dirname
"
$0
"
)
"
fi
exec
"
$JAVACMD
"
"
$@
"
6
die (
) {
die
() {
echo
echo
echo
"
$*
"
echo
"
$*
"
echo
echo
@@ -154,11 +154,19 @@ if $cygwin ; then
$i
`
=
`
cygpath --path --ignore --mixed
"
$arg
"
`
else
eval
`
echo args
$i
`
=
"
\"
$arg
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
clientId
,
String
topic
,
AbstractMessage
.
QOSType
qos
,
ByteBuffer
message
,
boolean
retained
,
int
messageID
) {
="
http://www.eclipse.org/
"
>
http://www.eclipse.org
</
a
>
.
</
p
>
</
body
>
</
html
>
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
</
body
>
</
html
>
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMatchingCondition.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
final
Logger
LOG
=
LoggerFactory
.
getLogger(
FileResourceLoader
.
class);
private
static
final
Logger
LOG
=
LoggerFactory
.
span
>
</
b
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
equals(sslPortProp)) {
//
Do nothing no SSL configured
LOG
.
info(
"
"
,
BrokerConstants
.
WSS_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
addListener(
CLOSE_ON_FAILURE
)
;
break
;
default
:
LOG
.
error(
"
Unkonwn MessageType:{}
"
, messageType);
break
;
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
moquette/Session.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
gradlew.bat
Show comments
View file
Edit file
Delete file
@@ -49,7 +49,6 @@ goto fail
@
rem
Get command-line arguments, handling Windows variants
if
not
"
%OS%
"
==
"
Windows_NT
esac
esac
fi
fi
#
Split up the JVM_OPTS And GRADLE_OPTS values into an array, following the shell quoting and substitution rules
#
Escape application args
splitJvmOpts()
{
save
() {
JVM_OPTS=(
"
$@
\"
"
fi
i=
$((
i
+
1
))
done
case
$i
in
(0)
set
-- ;;
(1)
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
LOG
.
debug(
"
"
, clientId, topic, qos, retained, messageID);
PublishMessage
pubMessage
=
new
PublishMessage
();
pubMessage
.
setRetainFlag(retained);
pubMessage
.
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMatchingCondition.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
package
getLogger(
FileResourceLoader
.
class);
@@ -68,8 +73,8 @@ public Reader loadResource(File f) {
throw
new
ResourceIsDirectoryException
(
"
File
\"
"
+
f
+
"
\"
Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.
</
span
>
</
p
>
<
p
>
<
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
}
int
sslPort
=
Integer
.
parseInt(sslPortProp);
final
MoquetteIdleTimeoutHandler
timeoutHandler
=
new
}
}
catch
(
Throwable
ex) {
LOG
.
error(
"
Exception was caught while processing MQTT message,
"
+
ex
.
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
"
goto
win9xME_args
if
"
%@eval[2+2]
"
==
"
4
"
goto
4NT_args
:
win9xME_args
@
"
)
for
i
do
printf
%s
\\
n
"
$i
"
|
sed
"
s/'/'
\\\\
''/g;1s/^/'/;
\$
set
--
"
$args0
"
;;
(2)
set
--
"
$args0
"
"
$args1
"
;;
(3)
set
--
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
setTopicName(topic);
pubMessage
.
setQos(qos);
pubMessage
.
setPayload(message);
LOG
.
info(
"
"
, clientId, topic);
if
(
LOG
.
isDebugEnabled()) {
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
/**
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMessaging.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
org.dna.mqtt.moquette.messaging.spi
;
/**
/**
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IMessaging.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
is a directory!
"
);
throw
new
ResourceIsDirectoryException
(
"
File
\"
"
+
f
+
"
\"
is a directory!
b
>
<
span
style
="
font-size: 10pt;
"
>
6. Trademarks.
</
span
>
</
b
>
</
p
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
MoquetteIdleTimeoutHandler
();
String
host
=
props
.
getProperty(
BrokerConstants
.
HOST_PROPERTY_NAME
);
String
sNeedsClientAuth
=
props
.
getCause(), ex);
LOG
.
error(
"
Exception was caught while processing MQTT message,
{}
"
,
ex
.
getCause(), ex);
ctx
.
fireExceptionCaught(ex);
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
/
test
/
rem
Slurp the command line arguments.
@@ -60,11 +59,6 @@ set _SKIP=2
if
"
x%
~1
"
==
"
x
"
goto
execute
set
CMD_LINE_ARGS
=
%
s/
\$
/'
\\\\
/
"
;
done
echo
"
"
}
}
eval
splitJvmOpts
$DEFAULT_JVM_OPTS
$JAVA_OPTS
$GRADLE_OPTS
"
$args0
"
"
$args1
"
"
$args2
"
;;
(4)
set
--
"
$args0
"
"
$args1
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
LOG
.
debug(
"
content <{}>
"
,
DebugUtils
.
payload2Str(message));
}
if
(pubMessage
.
getQos()
!=
AbstractMessage
.
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
package
org.dna.mqtt.moquette.messaging.spi
;
import
"
);
}
}
try
{
try
{
return
new
FileReader
(f
);
return
Files
.
newBufferedReader(f
.
toPath(),
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
origin of the Work and reproducing the content of the NOTICE file.
</
span
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
/
test
/
java
/
io
/
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
final
boolean
needsClientAuth
=
Boolean
.
valueOf(sNeedsClientAuth);
initFactory(host, sslPort,
"
ctx
.
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
finally
{
ReferenceCountUtil
.
release(msg);
}
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
java
/
io
/
moquette
/
broker
/
PostOfficeUnsubscribeTest.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
*
goto
execute
:
4NT_args
@
rem
Get arguments from the 4NT Shell from JP Software
set
CMD_LINE_ARGS
=
%$
:
execute
@
rem
Setup the command line
Toggle all file notes
0 comments on commit
APP_ARGS=
$(
save
"
$@
"
)
JVM_OPTS[
${
#
JVM_OPTS[*]}
]=
"
-Dorg.gradle.appname=
$APP_BASE_NAME
"
exec
"
"
"
$args2
"
"
$args3
"
;;
(5)
set
--
"
$args0
"
"
$args1
"
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
src
/
test
/
java
/
io
/
moquette
/
broker
/
MQTTConnectionPublishTest.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
QOSType
.
MOST_ONE
) {
pubMessage
.
setMessageID(messageID);
}
if
(m_clientIDs
==
null
) {
throw
new
RuntimeException
(
"
org.dna.mqtt.moquette.messaging.spi
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IPersistentSubscriptionStore.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Merge pull request
#389
from MBOIX/fix/issue_375
Loading branch information
andsel
committed
broker
/
src
/
test
/
java
/
io
/
moquette
/
broker
/
PostOfficeInternalPublishTest.java
/
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IPersistentSubscriptionStore.java
Show comments
View file
Edit file
Delete file
UTF_8
);
}
catch
(
FileNotFoundException
e) {
}
catch
(
IOException
e) {
LOG
.
error(
"
The file does not exist. Path = {}.
"
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
7. Disclaimer of Warranty.
moquette
/
broker
/
PostOfficePublishTest.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
/
Secure websocket
"
,
new
PipelineInitializer
() {
@Override
void
init
(
ChannelPipeline
pipeline
)
throws
Exception
{
pipeline
@@ -97,17 +99,17 @@ public void channelRead(ChannelHandlerContext ctx, Object message) {
public
void
channelInactive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
String
clientID
=
NettyUtils
.
clientID(ctx
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Sign up
c4d928bbd7
moquette
/
broker
/
src
/
test
/
java
/
io
/
moquette
/
broker
/
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
/
main
/
java
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
395 lines (322 sloc)
17.3 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
7267264
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
$JAVACMD
"
"
"
-classpath
"
$CLASSPATH
"
org.gradle.wrapper.GradleWrapperMain
"
$@
"
#
Collect all arguments for the java command, following the shell quoting and substitution rules
eval
set
--
$DEFAULT_JVM_OPTS
$JAVA_OPTS
"
$args2
"
"
$args3
"
"
$args4
"
;;
(6)
set
--
"
$args0
"
"
$args1
"
Insights
Permalink
Browse files
Updated the pax-runner to fix issue
#40
Loading branch information
andsel
committed
Jun 11, 2014
1 parent
c231471
commit
0bbe719f16eb9e8c1d5a93dc5515945703150580
Unified
Split
Showing
1 changed file
with
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
95 lines (79 sloc)
3.91 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
Internal bad error, found m_clientIDs to null while it should be initialized, somewhere it's overwritten!!
"
);
}
LOG
.
debug(
"
clientIDs are {}
"
, m_clientIDs);
if
(m_clientIDs
.
get(clientId)
==
null
) {
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
import
java.util.List
;
15
Feb 11, 2018
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
2 parents
5d02ecd
+
b780b71
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
, f
.
getAbsolutePath());
LOG
.
error(
"
The file does not exist. Path = {}.
"
, f
.
getAbsolutePath());
return
null
;
return
null
;
}
</
span
>
</
b
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
Copy path
Cannot retrieve contributors at this time
413 lines (348 sloc)
18.7 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
test
/
java
/
io
/
moquette
/
broker
/
SessionRegistryTest.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
.
addLast(
"
ssl
"
, createSslHandler(sslContext, needsClientAuth));
pipeline
.
addLast(
"
httpEncoder
"
,
new
HttpResponseEncoder
());
pipeline
.
.
channel());
if
(clientID
!=
null
&&
!
clientID
.
isEmpty()) {
LOG
.
info(
"
Notifying connection lost event. MqttClientId = {}
.
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
/
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
PostOfficeSubscribeTest.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
329 lines (275 sloc)
14.6 KB
Raw
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
/
test
/
java
/
io
/
moquette
/
broker
/
MQTTConnectionConnectTest.java
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
persistence
/
H2QueueRepository.java
/
Jump to
Code definitions
/
main
/
java
/
io
/
moquette
/
persistence
/
H2PersistentQueue.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
/
io
/
moquette
/
persistence
/
H2Builder.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.security.PermitAllAuthorizatorPolicy
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
$GRADLE_OPTS
"
\"
-Dorg.gradle.appname=
$APP_BASE_NAME
\"
"
-classpath
"
\"
$CLASSPATH
\"
"
org.gradle.wrapper.GradleWrapperMain
"
$APP_ARGS
"
#
"
$args2
"
"
$args3
"
"
$args4
"
"
$args5
"
;;
(7)
set
--
"
3 additions
and
2 deletions
.
+3
−2
bundle/pom.xml
5
bundle/pom.xml
Show comments
View file
Edit file
Delete file
@@ -212,12 +212,13 @@
<!--
Pax Runner Maven plugin
-->
<
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.security.PermitAllAuthorizatorPolicy
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
throw
new
RuntimeException
(
String
.
format(
"
Can't find a ConnectionDescriptor for client <%s> in cache <%s>
"
, clientId, m_clientIDs));
}
LOG
.
debug(
"
"
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
commit
2fb475ae95989e7abc418dffbdd9104c818302bb
Unified
Split
Showing
4 changed files
with
17 additions
and
5 deletions
.
+2
−0
broker/src/main/java/io/moquette/BrokerConstants.java
+2
−0
broker/src/main/java/io/moquette/server/config/IConfig.java
R
Copy path
Cannot retrieve contributors at this time
309 lines (245 sloc)
11 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
package
org.dna.mqtt.moquette.messaging.spi
;
import
java.util.List
;
import
java.util.List
}
4
broker/src/main/java/io/moquette/server/netty/MoquetteIdleTimeoutHandler.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
io.netty.handler.timeout.IdleState
;
import
io.netty.handler.timeout.IdleState
;
import
io.netty.handler.timeout.IdleStateEvent
;
Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
Contributor provides its Contributions) on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.
</
span
>
</
p
>
<
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.security.PermitAllAuthorizatorPolicy
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
128 lines (109 sloc)
5.62 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
addLast(
"
httpDecoder
"
,
new
HttpRequestDecoder
());
pipeline
.
addLast(
"
aggregator
"
,
new
HttpObjectAggregator
"
, clientID);
LOG
.
info(
"
Notifying connection lost event. MqttClientId = {}
"
, clientID);
m_processor
.
processConnectionLost(clientID, ctx
.
channel());
}
ctx
.
close();
/
main
/
java
/
io
/
moquette
/
broker
/
SessionRegistry.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
main
/
java
/
io
/
moquette
/
broker
/
Server.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
/
main
/
java
/
io
/
moquette
/
broker
/
MemoryQueueRepository.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
/
main
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
320 lines (261 sloc)
12.6 KB
Raw
Blame
/*
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
25 lines (19 sloc)
657 Bytes
Raw
Blame
package
io.moquette.persistence
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
104 lines (90 sloc)
3.07 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
R
Copy path
Cannot retrieve contributors at this time
60 lines (49 sloc)
1.98 KB
Raw
Blame
package
io.moquette.persistence
;
import
io.moquette.BrokerConstants
;
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.netty.buffer.ByteBuf
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
if
[
"
$(
uname
)
"
=
"
Darwin
"
]
&&
[
"
$HOME
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
"
"
$args5
"
"
$args6
groupId
>org.ops4j</
groupId
>
<
artifactId
>maven-pax-plugin</
artifactId
>
<
version
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.netty.buffer.Unpooled
;
import
io.netty.channel.Channel
;
import
, clientId, m_clientIDs
.
get(clientId)
.
getSession());
//
m_clientIDs.get(clientId).getSession().write(pubMessage);
disruptorPublish(
new
OutputMessagingEvent
(m_clientIDs
.
get(clientId)
.
getSession(), pubMessage));
}
private
void
sendPubRec
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
import
java.nio.ByteBuffer
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/DebugUtils.java
Show comments
View file
+8
−4
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
+5
−1
distribution/src/main/resources/moquette.conf
2
broker/src/main/java/io/moquette/BrokerConstants.java
Show comments
View file
Edit file
Delete file
@@ -57,6 +57,8 @@
public
static
final
String
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.security.PermitAllAuthorizatorPolicy
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/IStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
import
io.netty.handler.timeout.IdleStateEvent
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
@Sharable
@Sharable
class
MoquetteIdleTimeoutHandler
extends
ChannelDuplexHandler
{
class
MoquetteIdleTimeoutHandler
extends
ChannelDuplexHandler
{
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
8. Limitation of Liability.
</
span
>
</
b
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.ByteBufUtil
;
import
io.netty.buffer.Unpooled
;
import
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.security.PermitAllAuthorizatorPolicy
;
import
(
65536
));
pipeline
.
addLast(
"
webSocketHandler
"
,
new
WebSocketServerProtocolHandler
(
"
/mqtt
"
,
MQTT_SUBPROTOCOL_CSV_LIST
));
pipeline
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
@Override
public
void
exceptionCaught
(
ChannelHandlerContext
ctx
,
Throwable
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
238 lines (205 sloc)
9.69 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
383 lines (344 sloc)
17.2 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
12 lines (9 sloc)
330 Bytes
Raw
Blame
package
io.moquette.broker
;
import
java.util.Queue
;
io.moquette.broker
;
import
io.moquette.broker.security.PermitAllAuthorizatorPolicy
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
/
java
/
io
/
moquette
/
broker
/
Session.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.SessionRegistry
;
import
org.h2.mvstore.MVStore
;
import
java.util.Queue
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
public
class
H2QueueRepository
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.persistence
;
import
org.h2.mvstore.MVMap
;
import
org.h2.mvstore.MVStore
;
import
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.config.IConfig
;
import
org.h2.mvstore.MVStore
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
;
import
io.netty.buffer.Unpooled
;
import
io.netty.channel.Channel
;
import
io.netty.channel.embedded.EmbeddedChannel
;
import
io.netty.handler.codec.mqtt.*
;
import
org.junit.Before
"
=
"
$PWD
"
]
;
then
cd
"
$(
dirname
"
$0
"
)
"
fi
exec
"
;;
(8)
set
--
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
>1.
4
</
version
>
<
version
>1.
5
</
version
>
<
configuration
>
<!--
io.netty.channel.embedded.EmbeddedChannel
;
import
io.netty.handler.codec.mqtt.MqttMessageBuilders
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
(
String
clientID
,
int
messageID
) {
LOG
.
trace(
"
"
, clientID, messageID);
PubRecMessage
pubRecMessage
=
new
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
NETTY_SO_KEEPALIVE_PROPERTY_NAME
=
"
netty.so_keepalive
"
;
public
static
final
String
NETTY_CHANNEL_TIMEOUT_SECONDS_PROPERTY_NAME
=
"
netty.channel_timeout.seconds
"
;
public
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.netty.buffer.Unpooled
;
import
io.netty.channel.Channel
;
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi
;
package
org.dna.mqtt.moquette.messaging.spi
;
import
java.nio.ByteBuffer
;
import
java.nio.ByteBuffer
@@ -37,7 +39,7 @@ public void userEventTriggered(ChannelHandlerContext ctx, Object evt) throws Exc
LOG
.
info(
"
Firing channel inactive event. MqttClientId = {}.
"
,
NettyUtils
.
clientID(ctx
.
channel()));
LOG
.
info(
"
Firing channel inactive event. MqttClientId = {}.
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
io.netty.buffer.UnpooledByteBufAllocator
;
import
io.netty.channel.Channel
;
import
io.netty.channel.embedded.EmbeddedChannel
;
import
io.netty.handler.codec.mqtt.*
;
import
org.junit.Before
;
import
org.junit.Test
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.netty.channel.Channel
;
import
io.netty.channel.embedded.EmbeddedChannel
;
.
addLast(
"
ws2bytebufDecoder
"
,
new
WebSocketFrameToByteBufDecoder
());
pipeline
.
addLast(
"
bytebuf2wsEncoder
"
,
new
ByteBufToWebSocketFrameEncoder
());
cause
)
throws
Exception
{
LOG
.
error(
"
An unexpected exception was caught while processing MQTT message. Closing Netty channel. CId={},
"
+
"
"
,
NettyUtils
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.Session.SessionStatus
;
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.BrokerConstants
;
import
io.moquette.broker.config.*
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
public
class
MemoryQueueRepository
implements
IQueueRepository
{
@Override
public
Queue<
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
io.moquette.broker.security.IAuthenticator
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.Unpooled
;
import
io.netty.channel.Channel
;
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
374 lines (316 sloc)
13.4 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
io.moquette.broker.security.PermitAllAuthorizatorPolicy
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.netty.channel.Channel
;
implements
IQueueRepository
{
private
MVStore
mvStore;
public
H2QueueRepository
(
MVStore
mvStore
) {
this
.
mvStore
=
mvStore;
}
java.util.AbstractQueue
;
import
java.util.Iterator
;
import
java.util.concurrent.atomic.AtomicLong
;
class
H2PersistentQueue
<T>
extends
AbstractQueue<
T
>
{
private
final
MVMap<
java.util.concurrent.ScheduledExecutorService
;
import
java.util.concurrent.TimeUnit
;
public
class
H2Builder
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
;
import
org.junit.Test
;
import
java.nio.charset.Charset
;
import
java.util.Collections
;
import
java.util.Set
;
import static
io.moquette.broker.PostOfficePublishTest.PUBLISHER_ID
;
import static
io.netty.handler.codec.mqtt.MqttQoS.*
"
$JAVACMD
"
"
$@
"
6
gradlew.bat
Show comments
View file
Edit file
Delete file
@@ -49,7 +49,6 @@ goto fail
@
rem
Get command-line arguments, handling Windows variants
"
$args4
"
"
$args5
"
"
$args6
"
"
$args7
"
;;
(9)
set
--
"
$args0
"
Pax Runner version
-->
<
runner
>1.
4.0
</
runner
>
<
runner
>1.
8.5
</
runner
>
import
io.netty.handler.codec.mqtt.MqttVersion
;
import
org.junit.Before
;
import
org.junit.Test
;
import static
PubRecMessage
();
pubRecMessage
.
setMessageID(messageID);
//
m_clientIDs.get(clientID).getSession().write(pubRecMessage);
disruptorPublish(
new
OutputMessagingEvent
(m_clientIDs
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.nio.ByteBuffer
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticator.java
Show comments
View file
Edit file
static
final
String
NETTY_EPOLL_PROPERTY_NAME
=
"
netty.epoll
"
;
public
static
final
String
NETTY_MAX_BYTES_PROPERTY_NAME
=
"
netty.mqtt.message_size
import
io.netty.channel.embedded.EmbeddedChannel
;
import
io.netty.handler.codec.mqtt.*
;
import
org.junit.Before
;
import
org.junit.Test
;
import
java.util.Set
;
import static
io.moquette.broker.PostOfficeUnsubscribeTest.CONFIG
;
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/DebugUtils.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
"
,
NettyUtils
.
clientID(ctx
.
channel()));
//
fire a channelInactive to trigger publish of Will
//
fire a channelInactive to trigger publish of Will
ctx
.
fireChannelInactive();
ctx
.
negligent acts) or agreed to in writing, shall any Contributor be
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.
</
span
>
</
p
>
<
p
>
;
import
java.nio.charset.Charset
;
import
java.util.*
;
import static
io.moquette.broker.PostOfficeUnsubscribeTest.CONFIG
;
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_LEAST_ONCE
;
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_MOST_ONCE
import
io.netty.handler.codec.mqtt.MqttConnectMessage
;
import
io.netty.handler.codec.mqtt.MqttMessageBuilders
;
import
io.netty.handler.codec.mqtt.MqttVersion
;
import
org.junit.Before
;
import
org.junit.Test
;
import static
io.moquette.broker.NettyChannelAssertions.assertEqualsConnAck
;
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
));
pipeline
.
addAfter(
.
clientID(ctx
.
channel()), cause
.
getCause(), cause
.
getMessage());
ctx
.
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.Unpooled
;
import
io.netty.handler.codec.mqtt.MqttConnectMessage
import
io.moquette.interception.InterceptHandler
;
import
io.moquette.persistence.H2Builder
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.moquette.interception.BrokerInterceptor
;
import
io.moquette.broker.security.*
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
String
cli
,
boolean
clean
) {
return
new
ConcurrentLinkedQueue<>
();
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
import
io.netty.channel.embedded.EmbeddedChannel
;
import
io.netty.handler.codec.mqtt.*
;
import
org.junit.Before
;
import
org.junit.Test
;
import
java.nio.charset.Charset
;
import
java.util.List
;
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Subscription
;
import
import
io.netty.channel.embedded.EmbeddedChannel
;
import
io.netty.handler.codec.mqtt.MqttConnectMessage
;
import
io.netty.handler.codec.mqtt.MqttMessageBuilders
;
import
io.netty.handler.codec.mqtt.MqttVersion
;
import
org.junit.Before
;
import
org.junit.Test
@Override
public
Queue<
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
String
cli
,
boolean
clean
) {
if
(
!
clean) {
Long
,
T
>
queueMap;
private
final
MVMap<
String
,
Long
>
metadataMap;
private
final
AtomicLong
head;
H2Builder
.
class);
private
final
String
storePath;
private
final
int
autosaveInterval;
//
in seconds
private
final
ScheduledExecutorService
scheduler;
private
MVStore
;
import static
java.util.Collections.*
;
import static
org.junit.Assert.assertEquals
;
import static
org.junit.Assert.assertFalse
;
public
class
PostOfficeUnsubscribeTest
{
private
static
final
String
@
rem
Get command-line arguments, handling Windows variants
if
not
"
%OS%
"
==
"
Windows_NT
"
goto
win9xME_args
if
not
"
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
"
"
$args5
"
"
<!--
OSGi framework type (equinox, felix, knopflerfish)
-->
<
framework
>equinox</
framework
>
<!--
<framework>felix</framework>
-->
<
provision
>
<!--
<param> - -log=debug</param>
<param> - -workingDirectory=target/runner</param>
-->
java.nio.charset.StandardCharsets.UTF_8
;
import static
java.util.Collections.singleton
;
import static
java.util.Collections.singletonMap
;
import static
org.junit.Assert.assertFalse
;
public
class
MQTTConnectionPublishTest
{
private
static
.
get(clientID)
.
getSession(), pubRecMessage));
}
private
void
sendPubAck
(
PubAckEvent
evt
) {
LOG
.
trace(
"
sendPubAck invoked
"
);
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
"
;
public
static
final
int
DEFAULT_NETTY_MAX_BYTES_IN_MESSAGE
=
8092
;
public
static
final
String
METRICS_ENABLE_PROPERTY_NAME
=
"
use_metrics
import static
io.netty.handler.codec.mqtt.MqttQoS.*
;
import static
java.nio.charset.StandardCharsets.UTF_8
;
import static
java.util.Collections.singleton
;
import static
java.util.Collections.singletonMap
;
import static
org.junit.Assert.*
;
public
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.nio.ByteBuffer
;
import
java.nio.ByteBuffer
fireChannelInactive();
ctx
.
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
}
}
else
{
}
else
<
b
>
<
span
style
="
font-size: 10pt;
"
>
9. Accepting Warranty or Additional Liability.
</
span
>
</
b
>
</
;
import static
io.netty.handler.codec.mqtt.MqttQoS.EXACTLY_ONCE
;
import static
java.util.Collections.singleton
;
import static
java.util.Collections.singletonMap
;
import static
org.junit.Assert.*
;
public
class
PostOfficePublishTest
{
private
import static
io.netty.handler.codec.mqtt.MqttConnectReturnCode.CONNECTION_ACCEPTED
;
import static
java.util.Collections.singleton
;
import static
java.util.Collections.singletonMap
;
import static
org.junit.Assert.assertFalse
;
import static
org.junit.Assert.assertTrue
;
public
class
"
idleStateHandler
"
,
"
idleEventHandler
"
, timeoutHandler);
pipeline
.
addFirst(
"
bytemetrics
"
,
new
BytesMetricsHandler
;
}
@Override
4
broker/src/main/java/io/moquette/server/netty/metrics/BytesMetricsHandler.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
io.netty.util.Attribute
;
import
io.netty.util.AttributeKey
;
import static
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.Queue
;
import
java.util.concurrent.ConcurrentHashMap
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
import
java.util.Set
;
import static
io.moquette.broker.PostOfficePublishTest.ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
;
import static
io.moquette.broker.PostOfficePublishTest.SUBSCRIBER_ID
;
import static
io.netty.handler.codec.mqtt.MqttConnectReturnCode.CONNECTION_ACCEPTED
;
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_MOST_ONCE
;
import static
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.*
;
import
io.netty.util.ReferenceCountUtil
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
;
import static
io.moquette.broker.NettyChannelAssertions.assertEqualsConnAck
;
import static
io.netty.handler.codec.mqtt.MqttConnectReturnCode.*
;
import static
java.util.Collections.singleton
;
import static
java.util.Collections.singletonMap
;
import static
org.junit.Assert.*
;
import static
return
new
H2PersistentQueue<>
(mvStore, cli);
}
return
new
ConcurrentLinkedQueue<>
();
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
private
final
AtomicLong
tail;
H2PersistentQueue
(
MVStore
store
,
String
queueName
) {
if
(queueName
==
null
||
queueName
mvStore;
public
H2Builder
(
IConfig
props
,
ScheduledExecutorService
scheduler
) {
this
.
storePath
=
props
.
getProperty(
FAKE_CLIENT_ID
=
"
FAKE_123
"
;
private
static
final
String
TEST_USER
=
"
fakeuser
%OS%
"
==
"
Windows_NT
"
goto
win9xME_args
if
"
%@eval[2+2]
"
==
"
4
"
goto
4NT_args
$args6
"
"
$args7
"
"
$args8
"
;;
esac
fi
#
Escape application args
save
() {
for
i
do
printf
Toggle all file notes
0 comments on commit
0bbe719
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
final
String
FAKE_CLIENT_ID
=
"
FAKE_123
"
;
private
static
final
String
TEST_USER
=
"
fakeuser
"
;
private
String
clientId
=
evt
.
getClientID();
PubAckMessage
pubAckMessage
=
new
PubAckMessage
();
pubAckMessage
.
setMessageID(evt
.
getMessageId());
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.io.BufferedReader
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
"
;
public
static
final
String
METRICS_LIBRATO_EMAIL_PROPERTY_NAME
=
"
metrics.librato.email
"
;
public
static
final
String
class
PostOfficeInternalPublishTest
{
private
static
final
String
FAKE_CLIENT_ID
=
"
FAKE_123
"
;
private
static
final
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/FileAuthenticator.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
{
if
(
LOG
.
isDebugEnabled()) {
if
(
LOG
.
isDebugEnabled()) {
8
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
Show comments
View file
Edit file
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
While redistributing
the Work or Derivative Works thereof, You may choose to offer,
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
static
final
String
FAKE_CLIENT_ID
=
"
FAKE_123
"
;
private
static
final
String
FAKE_CLIENT_ID2
=
"
FAKE_456
"
SessionRegistryTest
{
static
final
String
FAKE_CLIENT_ID
=
"
FAKE_123
"
;
static
final
String
TEST_USER
=
"
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
"
,
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
public
class
BytesMetricsHandler
extends
ChannelDuplexHandler
{
private
static
final
AttributeKey<
BytesMetrics
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
import
java.util.concurrent.ConcurrentMap
;
public
class
SessionRegistry
{
public
abstract
static
class
EnqueuedMessage
{
}
static
class
PublishedMessage
extends
EnqueuedMessage
;
import
java.io.File
;
import
java.io.IOException
;
import
java.lang.reflect.InvocationTargetException
;
import
java.text.ParseException
;
import
java.util.ArrayList
;
import
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
io.netty.handler.codec.mqtt.MqttQoS.EXACTLY_ONCE
;
import static
java.util.Collections.singleton
;
import static
java.util.Collections.singletonMap
;
import static
org.junit.Assert.assertEquals
;
import static
org.junit.Assert.assertTrue
;
import static
org.mockito.Matchers.eq
;
java.util.*
;
import
java.util.concurrent.DelayQueue
;
import
java.util.concurrent.Delayed
;
import
java.util.concurrent.TimeUnit
;
import
java.util.concurrent.atomic.AtomicInteger
;
import
java.util.concurrent.atomic.AtomicReference
;
class
org.mockito.Matchers.any
;
import static
org.mockito.Mockito.mock
;
import static
org.mockito.Mockito.verify
;
public
class
MQTTConnectionConnectTest
{
private
static
final
String
FAKE_CLIENT_ID
=
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
.
isEmpty()) {
throw
new
IllegalArgumentException
(
"
queueName parameter can't be empty or null
"
);
}
this
.
queueMap
=
store
.
openMap(
"
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
,
"
"
);
final
String
autosaveProp
=
props
.
getProperty(
BrokerConstants
.
AUTOSAVE_INTERVAL_PROPERTY_NAME
"
;
private
static
final
String
TEST_PWD
=
"
fakepwd
"
;
static
final
String
NEWS_TOPIC
:
win9xME_args
:
win9xME_args
@
rem
Slurp the command line arguments.
@
rem
Slurp the command line arguments.
@@ -60,11 +59,6 @@ set _SKIP=2
if
"
x%
~1
"
==
"
%s
\\
n
"
$i
"
|
sed
"
s/'/'
\\\\
''/g;1s/^/'/;
\$
s/
\$
/'
\\\\
/
"
;
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
static
final
String
TEST_PWD
=
"
fakepwd
"
;
private
MQTTConnection
sut;
private
EmbeddedChannel
channel;
private
SessionRegistry
sessionRegistry;
private
try
{
if
(m_clientIDs
==
null
) {
throw
new
RuntimeException
(
"
Internal bad error, found m_clientIDs to null while it should be initialized, somewhere it's overwritten!!
"
);
}
LOG
.
debug(
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
METRICS_LIBRATO_TOKEN_PROPERTY_NAME
=
"
metrics.librato.token
"
;
2
broker/src/main/java/io/moquette/server/config/IConfig.java
Show comments
View file
Edit file
Delete file
@@ -42,6 +42,8 @@ void assignDefaults() {
setProperty(
BrokerConstants
.
ALLOW_ANONYMOUS_PROPERTY_NAME
,
String
TEST_USER
=
"
fakeuser
"
;
private
static
final
String
TEST_PWD
=
"
fakepwd
"
;
private
static
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.io.BufferedReader
;
import
java.io.BufferedReader
;
Delete file
@@ -44,6 +44,7 @@
import
io.netty.handler.ssl.SslHandler
;
import
io.netty.handler.ssl.SslHandler
;
import
io.netty.handler.timeout.IdleStateHandler
;
import
io.netty.handler.timeout.IdleStateHandler
;
import
io.netty.util.concurrent.Future
;
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.
</
span
>
</
p
>
<
p
>
<
span
style
="
;
static
final
String
SUBSCRIBER_ID
=
"
Subscriber
"
;
static
final
String
PUBLISHER_ID
=
"
Publisher
fakeuser
"
;
static
final
String
TEST_PWD
=
"
fakepwd
"
;
private
MQTTConnection
connection;
private
EmbeddedChannel
channel;
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
"
BytesMetrics
"
);
@@ -53,7 +55,7 @@ public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
{
final
Topic
topic;
final
MqttQoS
publishingQos;
final
ByteBuf
payload;
PublishedMessage
(
Topic
topic
,
MqttQoS
publishingQos
java.util.Collections
;
import
java.util.List
;
import
java.util.Properties
;
import
java.util.concurrent.Executors
;
import
java.util.concurrent.ScheduledExecutorService
;
import static
io.moquette.logging.LoggingUtils.getInterceptorIds
;
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
import static
org.mockito.Mockito.mock
;
import static
org.mockito.Mockito.when
;
public
class
PostOfficeSubscribeTest
{
private
static
final
String
FAKE_CLIENT_ID
=
"
FAKE_123
Session
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
Session
.
class);
private
static
final
int
"
FAKE_123
"
;
private
static
final
String
TEST_USER
=
"
fakeuser
"
;
private
static
final
String
TEST_PWD
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
queue_
"
+
queueName);
this
.
metadataMap
=
store
.
openMap(
"
queue_
"
+
queueName
+
"
_meta
,
"
30
"
);
this
.
autosaveInterval
=
Integer
.
parseInt(autosaveProp);
this
.
scheduler
=
scheduler;
}
=
"
/news
"
;
private
static
final
String
BAD_FORMATTED_TOPIC
=
"
#MQTTClient
"
;
private
MQTTConnection
connection;
private
x
"
goto
execute
if
"
x%
~1
"
==
"
x
"
goto
execute
set
CMD_LINE_ARGS
=
%
*
done
echo
"
"
}
APP_ARGS=
$(
save
"
$@
"
)
#
Collect all arguments for the java command, following the shell quoting and substitution rules
eval
set
--
$DEFAULT_JVM_OPTS
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
"
clientIDs are {}
"
, m_clientIDs);
if
(m_clientIDs
.
get(clientId)
==
null
) {
throw
new
import
java.io.File
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/MemoryStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
Boolean
.
TRUE
.
toString());
setProperty(
BrokerConstants
.
AUTHENTICATOR_CLASS_NAME
,
"
"
);
setProperty(
BrokerConstants
.
AUTHORIZATOR_CLASS_NAME
,
"
final
String
PAYLOAD
=
"
Hello MQTT World
"
;
private
MQTTConnection
connection;
private
EmbeddedChannel
channel;
private
PostOffice
sut;
private
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/HawtDBStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
import
io.netty.util.concurrent.Future
;
import
io.netty.util.concurrent.GenericFutureListener
;
import
org.slf4j.Logger
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
org.slf4j.LoggerFactory
;
import
font-size: 10pt;
"
>
END OF TERMS AND CONDITIONS
</
span
>
</
p
>
<
p
>
<
span
style
"
;
private
static
final
String
TEST_USER
=
"
fakeuser
"
;
private
static
final
String
TEST_PWD
private
SessionRegistry
sut;
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZEROBYTE_CLIENT_ID
=
new
BrokerConfiguration
(
addLast(
"
messageLogger
"
,
new
MQTTMessageLogger
());
pipeline
.
addLast(
"
handler
"
, handler);
}
});
}
@SuppressWarnings
promise
)
throws
Exception
{
BytesMetrics
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
get();
,
ByteBuf
payload
) {
this
.
topic
=
topic;
this
.
publishingQos
=
publishingQos;
this
.
payload
=
public
class
Server
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
io.moquette.broker
.
Server
.
"
;
private
static
final
String
TEST_USER
=
"
fakeuser
"
;
private
static
final
String
TEST_PWD
=
"
FLIGHT_BEFORE_RESEND_MS
=
5_000
;
private
static
final
int
INFLIGHT_WINDOW_SIZE
=
10
;
static
class
InFlightPacket
implements
Delayed
=
"
fakepwd
"
;
private
static
final
String
EVIL_TEST_USER
=
"
eviluser
"
;
private
static
final
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
);
//
setup head index
long
headIdx
=
0L
;
if
(
this
.
metadataMap
.
containsKey(
"
@SuppressWarnings
(
"
FutureReturnValueIgnored
"
)
public
H2Builder
initStore
() {
LOG
.
info(
"
Initializing H2 store
"
);
if
EmbeddedChannel
channel;
private
PostOffice
sut;
private
ISubscriptionsDirectory
subscriptions;
private
MqttConnectMessage
connectMessage;
private
IAuthenticator
mockAuthenticator;
private
SessionRegistry
sessionRegistry;
public
set
CMD_LINE_ARGS
=
%
*
goto
execute
:
4NT_args
@
rem
Get arguments from the 4NT Shell from JP Software
set
CMD_LINE_ARGS
=
%$
:
$JAVA_OPTS
$GRADLE_OPTS
"
\"
-Dorg.gradle.appname=
$APP_BASE_NAME
\"
"
-classpath
"
\"
$CLASSPATH
\"
"
org.gradle.wrapper.GradleWrapperMain
"
$APP_ARGS
"
Accept
Reject
Save preferences
connMsg
=
MqttMessageBuilders
.
connect()
.
protocolVersion(
MqttVersion
.
MQTT_3_1
)
.
cleanSession(
true
);
BrokerConfiguration
config
=
RuntimeException
(
String
.
format(
"
Can't find a ConnectionDEwcriptor for client %s in cache %s
"
, clientId, m_clientIDs));
}
//
LOG.debug("Session for clientId " + clientId + " is " + m_clientIDs.get(clientId).getSession());
//
m_clientIDs.get(clientId).getSession().write(pubAckMessage);
disruptorPublish(
new
OutputMessagingEvent
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.nio.ByteBuffer
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessor.java
Show comments
View file
"
);
setProperty(
BrokerConstants
.
NETTY_MAX_BYTES_PROPERTY_NAME
,
String
.
valueOf(
BrokerConstants
.
DEFAULT_NETTY_MAX_BYTES_IN_MESSAGE
));
}
public
abstract
IResourceLoader
ISubscriptionsDirectory
subscriptions;
private
MqttConnectMessage
connectMessage;
private
SessionRegistry
sessionRegistry;
private
MockAuthenticator
mockAuthenticator;
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
java.io.File
;
javax.net.ssl.SSLContext
;
import
javax.net.ssl.SSLContext
;
@@ -53,6 +54,7 @@
import
java.util.Optional
;
import
java.util.Optional
;
import
java.util.concurrent.TimeUnit
;
import
java.util.concurrent.TimeUnit
;
="
font-size: 10pt;
"
>
APPENDIX: How to apply the Apache License to your work.
</
span
>
</
p
>
<
p
>
<
span
style
=
"
fakepwd
"
;
private
static
final
String
NEWS_TOPIC
=
"
/news
"
;
private
static
final
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
connMsg
=
MqttMessageBuilders
.
(
"
FutureReturnValueIgnored
"
)
@Override
public
void
close
() {
LOG
.
info(
"
Closing Netty acceptor...
"
);
if
metrics
.
incrementWrote(((
ByteBuf
) msg)
.
writableBytes());
ctx
.
write(msg, promise);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
)
;
}
@Override
payload;
}
}
static
final
class
PubRelMarker
extends
EnqueuedMessage
{
}
private
enum
PostConnectAction
{
NONE
,
SEND_STORED_MESSAGES
}
class);
private
ScheduledExecutorService
scheduler;
private
NewNettyAcceptor
acceptor;
private
volatile
boolean
initialized;
private
PostOffice
dispatcher;
private
BrokerInterceptor
interceptor;
fakepwd
"
;
private
static
final
String
NEWS_TOPIC
=
"
/news
"
;
private
static
final
String
BAD_FORMATTED_TOPIC
{
final
int
packetId;
private
long
startTime;
InFlightPacket
(
int
packetId
,
long
delayInMilliseconds
) {
this
.
String
EVIL_TEST_PWD
=
"
unsecret
"
;
private
MQTTConnection
sut;
private
EmbeddedChannel
channel;
private
SessionRegistry
sessionRegistry;
private
MqttMessageBuilders
head
"
)) {
headIdx
=
this
.
metadataMap
.
get(
"
head
"
);
}
else
{
this
(storePath
==
null
||
storePath
.
isEmpty()) {
throw
new
IllegalArgumentException
(
"
H2 store path can't be null or empty
"
);
}
mvStore
=
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
execute
:
execute
@
rem
Setup the command line
@
rem
Setup the command line
Toggle all file notes
0 comments on commit
7267264
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
#
by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
if
[
"
$(
uname
)
"
=
"
Darwin
"
]
&&
[
"
new
BrokerConfiguration
(
true
,
true
,
false
);
createMQTTConnection(config);
}
private
void
createMQTTConnection
(
BrokerConfiguration
config
(m_clientIDs
.
get(clientId)
.
getSession(), pubAckMessage));
}
catch
(
Throwable
t) {
LOG
.
error(
null
, t);
}
}
/**
* Second phase of a publish QoS2 protocol, sent by publisher to the broker. Search the stored message and publish
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
getResourceLoader
();
12
broker/src/main/java/io/moquette/server/netty/NettyAcceptor.java
Show comments
View file
Edit file
Delete file
@@ -104,6 +104,7 @@ protected void encode(ChannelHandlerContext chc, ByteBuf bb, List<Object> out) t
private
boolean
nettyTcpNodelay;
private
boolean
nettySoKeepalive;
private
int
nettyChannelTimeoutSeconds;
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
import
java.io.File
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/MemoryStorageService.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
import static
io.moquette.BrokerConstants.*
;
import static
io.moquette.BrokerConstants.*
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
public
class
NettyAcceptor
implements
ServerAcceptor
{
public
class
="
font-size: 10pt;
"
>
To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets "[]"
replaced with your own identifying information. (Don't include
the brackets!) The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
file or class name and description of purpose be included on the
same "printed page" as the copyright notice for easier
identification within third-party archives.
</
span
>
</
p
>
String
BAD_FORMATTED_TOPIC
=
"
#MQTTClient
"
;
private
MQTTConnection
connection;
private
EmbeddedChannel
channel;
private
PostOffice
sut;
private
ISubscriptionsDirectory
subscriptions;
connect()
.
protocolVersion(
MqttVersion
.
MQTT_3_1
)
.
cleanSession(
true
);
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZEROBYTE_CLIENT_ID
);
}
private
void
createMQTTConnection
(m_workerGroup
==
null
||
m_bossGroup
==
null
) {
LOG
.
error(
"
Netty acceptor is not initialized
"
);
throw
new
IllegalStateException
3
broker/src/main/java/io/moquette/server/netty/metrics/MQTTMessageLogger.java
Show comments
View file
Edit file
Delete file
@@ -28,6 +28,7 @@
import
java.util.List
;
import static
io.moquette.spi.impl.Utils.messageId
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
SessionRegistry
.
class);
private
final
ConcurrentMap<
String
,
Session
private
H2Builder
h2Builder;
public
static
void
main
(
String
[]
args
)
throws
IOException
{
final
Server
server
=
=
"
#MQTTClient
"
;
private
MQTTConnection
connection;
private
EmbeddedChannel
channel;
private
PostOffice
sut;
private
ISubscriptionsDirectory
subscriptions;
public
packetId
=
packetId;
this
.
startTime
=
System
.
currentTimeMillis()
+
delayInMilliseconds;
}
@Override
public
long
getDelay
(
TimeUnit
.
ConnectBuilder
connMsg;
private
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
.
metadataMap
.
put(
"
head
"
, headIdx);
}
this
.
head
=
new
AtomicLong
(headIdx);
//
setup tail index
new
MVStore
.
Builder
()
.fileName(storePath)
.autoCommitDisabled()
.open();
LOG
.
trace(
"
Scheduling H2 commit task
"
);
scheduler
.
scheduleWithFixedDelay(()
-
public
void
setUp
() {
connectMessage
=
MqttMessageBuilders
.
connect()
.clientId(
FAKE_CLIENT_ID
)
.build();
prepareSUT();
createMQTTConnection(
CONFIG
);
}
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
$HOME
"
=
"
$PWD
"
]
;
then
cd
"
$(
dirname
"
$0
"
)
"
) {
channel
=
new
EmbeddedChannel
();
sut
=
createMQTTConnection(config, channel);
}
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
,
* to all interested subscribers.
*
*/
void
processPubRel
(
String
clientID
,
int
messageID
) {
LOG
.
debug(
"
"
, clientID, messageID);
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
com.lmax.disruptor.BatchEventProcessor
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/SimpleMessaging.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
private
int
maxBytesInMessage;
private
Class<? extends
ServerSocketChannel
>
channelClass;
@@ -121,6 +122,9 @@ public void initialize(ProtocolProcessor processor, IConfig props, ISslContextCr
.parseBoolean(props
.
getProperty(
BrokerConstants
.
setUp
() {
sessionRegistry
=
initPostOfficeAndSubsystems();
mockAuthenticator
=
new
MockAuthenticator
(singleton(
FAKE_CLIENT_ID
), singletonMap(
TEST_USER
,
TEST_PWD
));
connection
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
NettyAcceptor
implements
ServerAcceptor
{
@@ -85,7 +87,7 @@ protected void encode(ChannelHandlerContext chc, ByteBuf bb, List<Object> out) t
}
}
}
}
abstract
class
PipelineInitializer
{
abstract
static
class
PipelineInitializer
<
p
>
<
span
style
="
font-size: 10pt;
"
>
Copyright [yyyy] [name of copyright owner]
</
span
>
</
p
>
<
public
static
final
String
FAKE_USER_NAME
=
"
UnAuthUser
"
;
private
MqttConnectMessage
connectMessage;
private
SessionRegistry
sessionRegistry;
private
(
BrokerConfiguration
config
) {
channel
=
new
EmbeddedChannel
();
connection
=
createMQTTConnection(config, channel);
}
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
(
"
Invoked close on an Acceptor that wasn't initialized
"
);
}
Future<?>
workerWaiter
=
m_workerGroup
.
shutdownGracefully();
Future<?>
bossWaiter
=
m_bossGroup
.
shutdownGracefully();
/**
*
@@ -100,6 +101,6 @@ public void channelInactive(ChannelHandlerContext ctx) throws Exception {
@Override
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
>
pool
=
new
ConcurrentHashMap<>
();
private
final
ISubscriptionsDirectory
subscriptionsDirectory;
private
final
IQueueRepository
queueRepository;
private
final
ConcurrentMap<
String
new
Server
();
server
.
startServer();
System
.
out
.
println(
"
Server started, version 0.12-SNAPSHOT
"
);
//
Bind a shutdown hook
static
final
String
FAKE_USER_NAME
=
"
UnAuthUser
"
;
private
MqttConnectMessage
connectMessage;
private
IAuthenticator
mockAuthenticator;
private
SessionRegistry
sessionRegistry;
unit
) {
long
diff
=
startTime
-
System
.
currentTimeMillis();
return
unit
.
convert(diff,
TimeUnit
.
MILLISECONDS
);
}
);
private
IAuthenticator
mockAuthenticator;
private
PostOffice
postOffice;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
connMsg
=
MqttMessageBuilders
long
tailIdx
=
0L
;
if
(
this
.
metadataMap
.
containsKey(
"
tail
"
)) {
>
{
LOG
.
trace(
"
Committing to H2
"
);
mvStore
.
commit();
}, autosaveInterval, autosaveInterval,
TimeUnit
.
SECONDS
);
return
private
void
createMQTTConnection
(
BrokerConfiguration
config
) {
channel
=
new
EmbeddedChannel
();
connection
=
createMQTTConnection(config, channel);
}
private
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
fi
exec
"
$JAVACMD
"
"
$@
"
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Channel
channel
) {
IAuthenticator
mockAuthenticator
=
new
MockAuthenticator
(singleton(
FAKE_CLIENT_ID
),
singletonMap(
TEST_USER
,
TEST_PWD
));
ISubscriptionsDirectory
subscriptions
String
publishKey
=
String
.
format(
"
%s%d
"
, clientID, messageID);
PublishEvent
evt
=
m_storageService
.
retrieveQoS2Message(publishKey);
final
String
topic
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
NETTY_SO_KEEPALIVE_PROPERTY_NAME
,
"
true
"
));
nettyChannelTimeoutSeconds
=
Integer
.parseInt(props
.
getProperty(
BrokerConstants
.
NETTY_CHANNEL_TIMEOUT_SECONDS_PROPERTY_NAME
,
"
10
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
);
connectMessage
=
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID
);
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
}
java.nio.ByteBuffer
;
import
java.nio.ByteBuffer
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ProtocolProcessor.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
{
abstract
void
init
(
ChannelPipeline
pipeline
)
throws
Exception
;
abstract
void
init
(
ChannelPipeline
pipeline
)
p
>
<
span
style
="
font-size: 10pt;
"
>
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
</
span
>
</
p
>
MockAuthenticator
mockAuthenticator;
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
config
,
Channel
channel
) {
IAuthenticator
mockAuthenticator
=
new
MockAuthenticator
(singleton(
FAKE_CLIENT_ID
),
singletonMap(
/*
* We shouldn't raise an IllegalStateException if we are interrupted. If we did so, the
* broker is not shut down properly.
*/
LOG
.
info(
"
Waiting for worker and boss event loop groups to terminate...
"
throws
Exception
{
logMQTTMessage(ctx, msg,
"
C<-B
"
);
ctx
.
write(msg, promise);
ctx
.
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
>
queues
=
new
ConcurrentHashMap<>
();
SessionRegistry
(
ISubscriptionsDirectory
subscriptionsDirectory
,
IQueueRepository
Runtime
.
getRuntime()
.
addShutdownHook(
new
Thread
(server
::
stopServer));
}
/**
* Starts Moquette bringing the configuration from the file located at m_config/moquette.conf
*
*
@throws
IOException in case of any IO error.
public
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Override
public
int
compareTo
(
Delayed
o
) {
if
((
this
.
startTime
-
((
InFlightPacket
) o)
.
.
connect()
.
protocolVersion(
MqttVersion
.
MQTT_3_1
)
.
cleanSession(
true
);
mockAuthenticator
=
new
MockAuthenticator
(singleton(
tailIdx
=
this
.
metadataMap
.
get(
"
tail
"
);
}
else
{
this
.
metadataMap
.
this
;
}
public
ISubscriptionsRepository
subscriptionsRepository
() {
return
new
H2SubscriptionsRepository
(mvStore);
}
public
void
closeStore
() {
mvStore
void
prepareSUT
() {
mockAuthenticator
=
new
MockAuthenticator
(singleton(
FAKE_CLIENT_ID
), singletonMap(
TEST_USER
,
TEST_PWD
));
subscriptions
=
new
CTrieSubscriptionDirectory
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
=
evt
.
getTopic();
final
AbstractMessage
.
QOSType
qos
=
evt
.
getQos();
publish2Subscribers(topic, qos, evt
.
getMessage(), evt
com.lmax.disruptor.BatchEventProcessor
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ValueEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
"
));
maxBytesInMessage
=
Integer
.parseInt(props
.
getProperty(
BrokerConstants
.
NETTY_MAX_BYTES_PROPERTY_NAME
,
String
.
valueOf(
BrokerConstants
.
DEFAULT_NETTY_MAX_BYTES_IN_MESSAGE
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
) {
channel
=
new
EmbeddedChannel
();
return
createMQTTConnection(config, channel);
}
private
MQTTConnection
createMQTTConnection
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
throws
Exception
;
}
}
@@ -197,7 +199,7 @@ public void initChannel(SocketChannel ch) throws Exception {
//
Bind and start to accept incoming connections.
//
Bind and start to accept incoming connections.
ChannelFuture
f
=
b
.
bind(host, port);
<
p
>
<
span
style
="
font-size: 10pt;
"
>
http://www.apache.org/licenses/LICENSE-2.0
</
span
>
</
p
>
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
sessionRegistry
=
initPostOfficeAndSubsystems();
mockAuthenticator
=
new
MockAuthenticator
(singleton(
TEST_USER
,
TEST_PWD
));
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
);
try
{
workerWaiter
.
await(
10
,
TimeUnit
.
SECONDS
);
bossWaiter
.
await(
10
,
TimeUnit
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
)
;
}
}
4
broker/src/main/java/io/moquette/server/netty/metrics/MessageMetricsHandler.java
Show comments
View file
Edit file
Delete file
@@ -23,6 +23,8 @@
import
io.netty.util.Attribute
queueRepository
) {
this
.
subscriptionsDirectory
=
subscriptionsDirectory;
this
.
queueRepository
=
queueRepository;
}
void
bindToSession
(
MQTTConnection
mqttConnection
*/
public
void
startServer
()
throws
IOException
{
File
defaultConfigurationFile
=
defaultConfigFile();
LOG
.
info(
"
Starting Moquette integration. Configuration file path={}
"
@Before
public
void
setUp
() {
connectMessage
=
MqttMessageBuilders
.
connect()
.clientId(
FAKE_CLIENT_ID
)
.build();
prepareSUT();
createMQTTConnection(
CONFIG
);
startTime)
==
0
) {
return
0
;
}
if
((
this
.
startTime
-
((
InFlightPacket
) o)
FAKE_CLIENT_ID
), singletonMap(
TEST_USER
,
TEST_PWD
));
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
put(
"
tail
"
, tailIdx);
}
this
.
tail
=
new
AtomicLong
(tailIdx);
}
static
void
dropQueue
(
.
close();
}
public
IQueueRepository
queueRepository
() {
return
new
H2QueueRepository
(mvStore);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
final
PostOffice
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(), sessionRegistry,
ConnectionTestUtils
.
isRetain(), evt
.
getMessageID());
m_storageService
.
removeQoS2Message(publishKey);
if
(evt
.
isRetain()) {
m_storageService
.
storeRetained(topic, evt
.
getMessage(), qos);
}
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
com.lmax.disruptor.EventFactory
;
15
)));
boolean
epoll
=
Boolean
.
parseBoolean(props
.
getProperty(
BrokerConstants
.
NETTY_EPOLL_PROPERTY_NAME
,
"
false
"
));
if
(epoll) {
(
BrokerConfiguration
config
,
Channel
channel
) {
return
new
MQTTConnection
(channel, config, mockAuthenticator, sessionRegistry, sut);
}
private
SessionRegistry
initPostOfficeAndSubsystems
() {
subscriptions
=
com.lmax.disruptor.BatchEventProcessor
;
import
com.lmax.disruptor.BatchEventProcessor
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/SimpleMessaging.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
ChannelFuture
f
=
b
.
bind(host, port);
LOG
.
info(
"
"
, host, port);
LOG
.
info(
"
"
, host, port);
f
<
p
>
<
span
style
="
font-size: 10pt;
"
>
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</
span
>
FAKE_CLIENT_ID
), singletonMap(
TEST_USER
,
TEST_PWD
));
connection
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
);
connectMessage
=
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID
queueRepository
=
new
MemoryQueueRepository
();
sut
=
new
SessionRegistry
(subscriptions, queueRepository);
final
PostOffice
postOffice
=
new
PostOffice
.
SECONDS
);
}
catch
(
InterruptedException
iex) {
LOG
.
warn(
"
An InterruptedException was caught while waiting for event loops to terminate...
"
);
}
if
(
;
import
io.netty.util.AttributeKey
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
public
class
MessageMetricsHandler
extends
ChannelDuplexHandler
{
private
static
final
,
MqttConnectMessage
msg
,
String
clientId
) {
boolean
isSessionAlreadyStored
=
false
;
PostConnectAction
postConnectAction
=
PostConnectAction
.
NONE
;
, defaultConfigurationFile
.
getAbsolutePath());
IResourceLoader
filesystemLoader
=
new
FileResourceLoader
(defaultConfigurationFile);
final
IConfig
config
=
new
ResourceLoaderConfig
(filesystemLoader);
startServer(config);
}
}
private
void
createMQTTConnection
(
BrokerConfiguration
config
) {
channel
=
new
EmbeddedChannel
();
connection
=
createMQTTConnection(config, channel);
}
.
startTime)
>
0
) {
return
1
;
}
else
{
return
-
1
;
}
}
}
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
postOffice
=
new
PostOffice
(subscriptions,
MVStore
store
,
String
queueName
) {
store
.
removeMap(store
.
openMap(
"
queue_
"
+
queueName));
store
.
removeMap(store
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
Learn more
Accept
Reject
Save preferences
.
NO_OBSERVERS_INTERCEPTOR
);
return
new
MQTTConnection
(channel, config, mockAuthenticator, sessionRegistry, postOffice);
}
@Test
public
void
dropConnectionOnPublishWithInvalidTopicFormat
() {
//
Connect message with clean session set to true and client id is null.
MqttPublishMessage
publish
=
sendPubComp(clientID, messageID);
}
private
void
sendPubComp
(
String
clientID
,
int
messageID
) {
LOG
.
debug(
"
"
, clientID, messageID);
PubCompMessage
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/DisconnectEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
@@ -222,7 +226,7 @@ void init(ChannelPipeline pipeline) {
pipeline
.
addLast(
"
bugsnagCatcher
"
, errorsCather
.
get());
}
pipeline
.
addFirst(
"
bytemetrics
"
,
new
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
retainedRepository
=
new
MemoryRetainedRepository
();
queueRepository
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
package
org.dna.mqtt.moquette.messaging.spi.impl
;
.
sync();
f
.
sync()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
)
;
}
catch
(
InterruptedException
ex) {
}
catch
(
InterruptedException
</
p
>
</
div
>
</
body
>
</
html
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
);
}
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
) {
channel
=
new
EmbeddedChannel
();
return
createMQTTConnection(config, channel);
}
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(), sut,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
new
MQTTConnection
(channel, config, mockAuthenticator, sut, postOffice);
}
!
m_workerGroup
.
isTerminated()) {
LOG
.
warn(
"
Forcing shutdown of worker event loop...
"
);
m_workerGroup
.
shutdownGracefully(
0L
,
0L
,
AttributeKey<
MessageMetrics
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
"
MessageMetrics
"
);
@@ -52,7 +54,7 @@ public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception
public
void
write
(
ChannelHandlerContext
if
(
!
pool
.
containsKey(clientId)) {
//
case 1
final
Session
newSession
=
createNewSession(mqttConnection, msg, clientId);
//
publish the session
final
private
static
File
defaultConfigFile
() {
String
configPath
=
System
.
getProperty(
"
moquette.path
"
,
null
);
return
private
void
prepareSUT
() {
mockAuthenticator
=
new
MockAuthenticator
(singleton(
FAKE_CLIENT_ID
), singletonMap(
TEST_USER
,
TEST_PWD
));
enum
SessionStatus
{
CONNECTED
,
CONNECTING
,
DISCONNECTING
,
DISCONNECTED
}
static
final
class
Will
{
final
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sut
=
createMQTTConnection(
CONFIG
);
channel
=
(
.
openMap(
"
queue_
"
+
queueName
+
"
_meta
"
));
}
@Override
public
Iterator<
T
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
}
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
,
Channel
channel
) {
return
new
MQTTConnection
(channel, config, mockAuthenticator, sessionRegistry, sut);
}
protected
void
connect
MqttMessageBuilders
.
publish()
.topicName(
"
"
)
.retained(
false
)
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.payload(
Unpooled
.
pubCompMessage
=
new
PubCompMessage
();
pubCompMessage
.
setMessageID(messageID);
//
m_clientIDs.get(clientID).getSession().write(pubCompMessage);
disruptorPublish(
new
OutputMessagingEvent
(m_clientIDs
.
get(clientID)
.
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/InitEvent.java
Show comments
View file
Edit file
Delete file
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
());
pipeline
.
addLast(
"
decoder
"
,
=
new
MemoryQueueRepository
();
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
import
com.lmax.disruptor.BatchEventProcessor
;
import
com.lmax.disruptor.BatchEventProcessor
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/ValueEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
ex) {
LOG
.
error(
"
An interruptedException was caught while initializing server. Protocol={}
"
, protocol, ex);
LOG
.
error(
"
An interruptedException was caught while initializing server. Protocol={}
"
, protocol, ex);
}
}
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
,
Channel
channel
) {
return
new
MQTTConnection
(channel, config, mockAuthenticator, sessionRegistry, sut);
}
private
SessionRegistry
initPostOfficeAndSubsystems
@Test
public
void
testConnAckContainsSessionPresentFlag
() {
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.protocolVersion(
MqttVersion
.
MQTT_3_1_1
TimeUnit
.
MILLISECONDS
);
}
if
(
!
m_bossGroup
.
isTerminated()) {
LOG
.
warn(
"
Forcing shutdown of boss event loop...
"
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
MessageMetrics
metrics
=
ctx
.
channel()
.
Session
previous
=
pool
.
putIfAbsent(clientId, newSession);
final
boolean
success
=
previous
==
null
;
if
(success) {
LOG
new
File
(configPath,
IConfig
.
DEFAULT_CONFIG
);
}
/**
* Starts Moquette bringing the configuration from the given file
*
*
@param
configFile text file that contains the configuration.
*
@throws
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
String
topic;
final
ByteBuf
payload;
final
MqttQoS
qos;
final
boolean
retained;
Will
(
String
topic
,
ByteBuf
EmbeddedChannel
) sut
.
channel;
}
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
) {
EmbeddedChannel
channel
=
new
EmbeddedChannel
();
>
iterator
() {
return
null
;
}
@Override
public
int
size
() {
return
this
.
head
.
intValue()
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
(
MQTTConnection
connection
,
String
clientId
) {
MqttConnectMessage
connectMessage
=
ConnectionTestUtils
.
buildConnect(clientId);
connect(connection, connectMessage);
}
protected
void
connect
copiedBuffer(
"
Hello MQTT world!
"
.
getBytes(
UTF_8
)))
.
build();
sut
.
processPublish(publish);
//
Verify
assertFalse(
"
Connection should be closed by the broker
"
getSession(), pubCompMessage));
}
void
processPubRec
(
String
clientID
,
int
messageID
) {
//
once received a PUBREC reply with a PUBREL(messageID)
LOG
.
debug(
"
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
new
MqttDecoder
(
maxBytesInMessage
));
pipeline
.
addLast(
"
encoder
"
,
MqttEncoder
.
INSTANCE
);
pipeline
.
(), retainedRepository, sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
sessionRegistry;
}
private
void
internalPublishNotRetainedTo
(
String
topic
) {
internalPublishTo(topic,
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
@@ -349,6 +351,8 @@ void init(ChannelPipeline pipeline) throws Exception {
});
});
}
}
@SuppressWarnings
(
"
FutureReturnValueIgnored
"
)
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
() {
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
)
.build();
NettyUtils
.
clientID(channel,
FAKE_CLIENT_ID
);
NettyUtils
.
cleanSession(channel,
false
);
//
Connect a first time
sut
.
bindToSession(connection, msg,
);
m_bossGroup
.
shutdownGracefully(
0L
,
0L
,
TimeUnit
.
MILLISECONDS
);
}
LOG
.
info(
"
attr(
ATTR_KEY_METRICS
)
.
get();
metrics
.
incrementWrote(
1
);
ctx
.
write(msg, promise);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
.
trace(
"
case 1, not existing session with CId {}
"
, clientId);
}
else
{
postConnectAction
=
bindToExistingSession(mqttConnection, msg, clientId, newSession);
isSessionAlreadyStored
=
true
;
IOException in case of any IO Error.
*/
public
void
startServer
(
File
configFile
)
throws
IOException
{
LOG
.
info(
"
Starting Moquette integration. Configuration file path: {}
"
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
payload
,
MqttQoS
qos
,
boolean
retained
) {
this
.
topic
=
topic;
this
.
payload
=
return
createMQTTConnection(config, channel, postOffice);
}
private
MQTTConnection
createMQTTConnectionWithPostOffice
(
BrokerConfiguration
config
,
PostOffice
postOffice
) {
EmbeddedChannel
channel
=
-
this
.
tail
.
intValue();
}
@Override
public
boolean
offer
(
T
t
) {
if
(t
==
Reject
Save preferences
(
MQTTConnection
connection
,
MqttConnectMessage
connectMessage
) {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted((
EmbeddedChannel
) connection
.
channel);
}
protected
, channel
.
isOpen());
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
\t\t
"
, clientID, messageID);
PubRelMessage
pubRelMessage
=
new
PubRelMessage
();
pubRelMessage
.
setMessageID(messageID);
pubRelMessage
.
setQos(
AbstractMessage
.
QOSType
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
java.util.Properties
;
15
...er/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/LostConnectionEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
"
,
new
MQTTMessageLogger
());
@@ -261,7 +265,7 @@ void init(ChannelPipeline pipeline) {
AT_MOST_ONCE
,
false
);
}
private
void
internalPublishRetainedTo
(
String
topic
) {
internalPublishTo(topic,
AT_MOST_ONCE
,
true
);
}
private
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl
;
package
org.dna.mqtt.moquette.messaging.spi.impl
;
import
com.lmax.disruptor.EventFactory
;
import
com.lmax.disruptor.EventFactory
;
15
@Override
public
void
close
() {
public
void
close
() {
LOG
.
info(
"
Closing Netty acceptor...
"
);
LOG
.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
retainedRepository
=
new
MemoryRetainedRepository
();
queueRepository
=
new
MemoryQueueRepository
();
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
FAKE_CLIENT_ID
);
//
disconnect
sut
.
disconnect(
FAKE_CLIENT_ID
);
//
Exercise, reconnect
EmbeddedChannel
anotherChannel
=
new
EmbeddedChannel
();
MQTTConnection
Collecting message metrics...
"
);
MessageMetrics
metrics
=
m_metricsCollector
.
computeMetrics();
LOG
.
info(
"
"
, metrics
.
messagesRead(),
metrics
)
;
}
@Override
16
broker/src/main/java/io/moquette/spi/DurableSession.java
Show comments
View file
Edit file
Delete file
@@ -22,9 +22,7 @@
import
java.util.Collection
;
import
java.util.HashSet
}
}
else
{
final
Session
newSession
=
createNewSession(mqttConnection, msg, clientId);
postConnectAction
=
bindToExistingSession(mqttConnection, msg, clientId, newSession);
isSessionAlreadyStored
=
true
;
}
, configFile
.
getAbsolutePath());
IResourceLoader
filesystemLoader
=
new
FileResourceLoader
(configFile);
final
IConfig
config
=
new
ResourceLoaderConfig
(filesystemLoader);
startServer(config);
}
/**
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
}
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
,
Channel
channel
) {
return
payload;
this
.
qos
=
qos;
this
.
retained
=
retained;
}
}
private
final
String
clientId;
private
new
EmbeddedChannel
();
return
createMQTTConnection(config, channel, postOffice);
}
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
,
Channel
channel
,
PostOffice
postOffice
null
) {
throw
new
NullPointerException
(
"
Inserted element can't be null
"
);
}
final
long
nextHead
=
head
.
getAndIncrement();
void
subscribe
(
MQTTConnection
connection
,
String
topic
,
MqttQoS
desiredQos
) {
EmbeddedChannel
channel
=
(
EmbeddedChannel
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
.
LEAST_ONE
);
//
m_clientIDs.get(clientID).getSession().write(pubRelMessage);
disruptorPublish(
new
OutputMessagingEvent
(m_clientIDs
.
get(clientID)
.
getSession(), pubRelMessage));
}
void
processPubComp
(
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
15
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
));
pipeline
.
addAfter(
"
idleStateHandler
void
internalPublishTo
(
String
topic
,
MqttQoS
qos
,
boolean
retained
) {
MqttPublishMessage
publish
=
MqttMessageBuilders
.
publish()
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/DisconnectEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
info(
"
Closing Netty acceptor...
"
);
if
(m_workerGroup
==
null
||
m_bossGroup
==
null
) {
if
(m_workerGroup
==
null
Save preferences
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
sessionRegistry;
}
@Test
public
void
testPublishQoS0ToItself
anotherConnection
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZEROBYTE_CLIENT_ID
, anotherChannel);
sut
.
bindToSession(anotherConnection, msg,
FAKE_CLIENT_ID
);
//
Verify
assertEqualsConnAck(
CONNECTION_ACCEPTED
, anotherChannel
.
readOutbound());
.
messagesWrote());
LOG
.
info(
"
Collecting bytes metrics...
"
);
BytesMetrics
bytesMetrics
=
m_bytesMetricsCollector
.
computeMetrics();
LOG
.
info(
"
;
import
java.util.Map
;
import
java.util.Set
;
import
java.util.concurrent.ConcurrentHashMap
;
public
class
DurableSession
extends
ClientSession
{
@@ -51,20 +49,6 @@ void waitingAck(int messageID, IMessagesStore.StoredMessage msg) {
final
boolean
msgCleanSessionFlag
=
msg
.
variableHeader()
.
isCleanSession();
boolean
isSessionAlreadyPresent
=
!
msgCleanSessionFlag
&&
isSessionAlreadyStored;
mqttConnection
* Starts the integration with the given properties.
* <
p
>
* Its suggested to at least have the following properties:
* <
ul
>
* <
li
>port</li>
* <
li
>password_file</li>
* </ul>
*
*
new
MQTTConnection
(channel, config, mockAuthenticator, sessionRegistry, sut);
}
protected
void
connect
() {
MqttConnectMessage
connectMessage
=
MqttMessageBuilders
.
connect()
.clientId(
FAKE_CLIENT_ID
)
boolean
clean;
private
Will
will;
private
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue;
private
final
AtomicReference<
SessionStatus
>
) {
return
new
MQTTConnection
(channel, config, mockAuthenticator, sessionRegistry, postOffice);
}
@Test
public
void
testZeroByteClientIdWithCleanSession
() {
//
Connect message with clean session set to true and client id is null.
MqttConnectMessage
msg
=
MqttMessageBuilders
this
.
queueMap
.
put(nextHead, t);
this
.
metadataMap
.
put(
"
head
"
, nextHead
+
1
);
return
) connection
.
channel;
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(desiredQos, topic)
.messageId(
1
)
.build();
sut
.
subscribeClientToTopics(subscribe, connection
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
String
clientID
,
int
messageID
) {
LOG
.
debug(
"
\t\t
"
, clientID, messageID);
//
once received the PUBCOMP then remove the message from the temp memory
String
publishKey
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/MessagingEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
"
,
"
idleEventHandler
"
, timeoutHandler);
pipeline
.
addFirst(
"
bytemetrics
"
,
new
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
.topicName(topic)
.retained(retained)
.qos(qos)
.payload(
Unpooled
.
copiedBuffer(
PAYLOAD
.
getBytes(
UTF_8
)))
.
build();
sut
.
internalPublish(publish);
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
import
org.dna.mqtt.moquette.server.ServerChannel
;
15
||
m_bossGroup
==
null
) {
14
broker/src/main/java/io/moquette/server/netty/NettyMQTTHandler.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
io.netty.util.ReferenceCountUtil
;
import
io.netty.util.ReferenceCountUtil
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
//
subscribe
subscribe(
AT_MOST_ONCE
,
NEWS_TOPIC
, connection);
//
Exercise
final
assertTrue(
"
Connection is accepted and therefore should remain open
"
, anotherChannel
.
isOpen());
}
@Test
public
void
connectWithCleanSessionUpdateClientSession
() {
//
first connect with clean session true
MqttConnectMessage
msg
"
, bytesMetrics
.
readBytes(),
bytesMetrics
.
wroteBytes());
}
private
ChannelHandler
createSslHandler
(
SSLContext
sslContext
,
boolean
needsClientAuth
}
}
class
InboundFlightZone
{
final
Map<
Integer
,
IMessagesStore
.
StoredMessage
>
inboundFlightMessages
=
new
ConcurrentHashMap<>
.
sendConnAck(isSessionAlreadyPresent);
if
(postConnectAction
==
PostConnectAction
.
SEND_STORED_MESSAGES
) {
final
Session
session
=
pool
.
get(clientId);
session
.
sendQueuedMessagesWhileOffline();
@param
configProps the properties map to use as configuration.
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
(
Properties
configProps
)
throws
IOException
{
.build();
connection
.
processConnect(connectMessage);
MqttConnAckMessage
connAck
=
channel
.
readOutbound();
assertEquals(
"
Connect must be accepted
"
,
CONNECTION_ACCEPTED
, connAck
.
variableHeader()
status
=
new
AtomicReference<>
(
SessionStatus
.
DISCONNECTED
);
private
MQTTConnection
mqttConnection;
private
List<
Subscription
>
subscriptions
=
new
.
connect()
.protocolVersion(
MqttVersion
.
MQTT_3_1_1
)
.clientId(
null
)
.cleanSession(
true
)
.build();
sut
.
processConnect(msg);
true
;
}
@Override
public
T
poll
() {
if
(head
.
equals(tail)) {
return
null
;
}
final
long
nextTail
.
getClientId(),
null
, connection);
MqttSubAckMessage
subAck
=
channel
.
readOutbound();
assertEquals(desiredQos
.
value(), (
int
) subAck
.
payload()
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
=
String
.
format(
"
%s%d
"
, clientID, messageID);
m_storageService
.
cleanInFlight(publishKey);
}
void
processDisconnect
(
ServerChannel
session
,
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
15
...r/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/OutputMessagingEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
addLast(
"
decoder
"
,
new
MqttDecoder
());
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
(
}
@Test
public
void
testClientSubscribeAfterNotRetainedQoS0IsSent
() {
//
connection.processConnect(connectMessage);
//
ConnectionTestUtils.assertConnectAccepted(channel);
//
Exercise
final
String
topic
=
"
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/InitEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
;
import
org.slf4j.Logger
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
org.slf4j.LoggerFactory
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
ByteBuf
payload
=
Unpooled
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.
cleanSession(
true
)
.
build();
connection
.
processConnect(msg);
assertEqualsConnAck(
CONNECTION_ACCEPTED
) {
SSLEngine
sslEngine
=
sslContext
.
createSSLEngine();
sslEngine
.
setUseClientMode(
false
);
if
(needsClientAuth) {
sslEngine
.
setNeedClientAuth(
();
IMessagesStore
.
StoredMessage
lookup
(
int
messageID
) {
return
inboundFlightMessages
.
get(messageID);
}
void
waitingRel
}
}
private
PostConnectAction
bindToExistingSession
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
msg
,
String
clientId
,
Session
newSession
LOG
.
debug(
"
Starting Moquette integration using properties object
"
);
final
IConfig
config
=
new
MemoryConfig
(configProps);
startServer(config);
}
/**
* Starts Moquette bringing the configuration files from the given Config implementation.
.
connectReturnCode());
}
@Test
public
void
testSubscribe
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
//
Exercise & verify
subscribe(channel,
NEWS_TOPIC
ArrayList<>
();
private
final
Map<
Integer
,
SessionRegistry
.
EnqueuedMessage
>
inflightWindow
=
new
HashMap<>
();
private
final
assertEqualsConnAck(
"
Connection must be accepted
"
,
CONNECTION_ACCEPTED
, channel
.
readOutbound());
assertNotNull(
"
unique clientid must be generated
"
, sut
.
getClientId());
assertTrue(
=
tail
.
getAndIncrement();
final
T
tail
=
this
.
queueMap
.
get(nextTail);
queueMap
.
remove(nextTail);
this
.
.
grantedQoSLevels()
.
get(
0
));
final
String
clientId
=
connection
.
getClientId();
Subscription
expectedSubscription
=
new
Subscription
String
clientID
,
boolean
cleanSession
)
throws
InterruptedException
{
if
(cleanSession) {
//
cleanup topic subscriptions
processRemoveAllSubscriptions(clientID);
}
//
m_notifier.disconnect(evt.getSession());
m_clientIDs
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
maxBytesInMessage
));
pipeline
.
addLast(
"
encoder
"
,
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
/topic
"
;
internalPublishNotRetainedTo(topic);
subscribe(
AT_MOST_ONCE
, topic, connection);
//
Verify
verifyNoPublishIsReceived(channel);
}
@Test
public
void
testClientSubscribeAfterRetainedQoS0IsSent
() {
//
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
java.util.Properties
;
import
java.util.Properties
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_MOST_ONCE
;
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_MOST_ONCE
;
@Sharable
@Sharable
@@ -78,16 +80,16 @@ public void channelRead(ChannelHandlerContext ctx, Object message) {
false
,
false
,
0
);
0
);
NEWS_TOPIC
),
TEST_USER
,
FAKE_CLIENT_ID
, payload,
false
,
MqttMessageBuilders
.
publish()
.payload(payload
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_MOST_ONCE
, channel
.
readOutbound());
connection
.
processDisconnect(
null
);
assertFalse(channel
.
isOpen());
//
second connect with clean session false
EmbeddedChannel
anotherChannel
=
new
true
);
}
return
new
SslHandler
(sslEngine);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
(
int
messageID
,
IMessagesStore
.
StoredMessage
msg
) {
inboundFlightMessages
.
put(messageID, msg);
}
}
private
static
final
) {
PostConnectAction
postConnectAction
=
PostConnectAction
.
NONE
;
final
boolean
newIsClean
=
msg
.
variableHeader()
.
isCleanSession();
final
*
*
@param
config the configuration to use to start the broker.
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
,
AT_MOST_ONCE
);
}
protected
void
subscribe
(
EmbeddedChannel
channel
,
String
DelayQueue<
InFlightPacket
>
inflightTimeouts
=
new
DelayQueue<>
();
private
final
Map<
Integer
,
"
clean session flag must be true
"
, sessionRegistry
.
retrieve(sut
.
getClientId())
.
isClean());
assertTrue(
"
Connection must be open
"
, channel
.
isOpen());
}
metadataMap
.
put(
"
tail
"
, nextTail
+
1
);
return
tail;
}
@Override
public
T
peek
() {
if
(head
(clientId,
new
Topic
(topic), desiredQos);
final
Set<
Subscription
>
matchedSubscriptions
=
subscriptions
.
matchQosSharpening(
new
Topic
(topic));
assertEquals(
1
.
remove(clientID);
session
.
close(
true
);
//
de-activate the subscriptions for this ClientID
//
String clientID = (String) evt.getSession().getAttribute(Constants.ATTR_CLIENTID);
subscriptions
.
deactivate(clientID);
LOG
.
info(
"
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/ProtocolEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
"
,
new
MQTTMessageLogger
());
@@ -297,7 +301,7 @@ void init(ChannelPipeline pipeline) throws Exception {
pipeline
.
Exercise
final
String
topic
=
"
/topic
"
;
internalPublishRetainedTo(topic);
subscribe(
AT_MOST_ONCE
, topic, connection);
//
Verify
verifyNoPublishIsReceived(channel);
}
@Test
public
;
15
...er/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/LostConnectionEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
MqttMessage
pingResp
=
new
MqttMessage
(pingHeader);
MqttMessage
pingResp
=
new
MqttMessage
(pingHeader);
ctx
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify
ConnectionTestUtils
.
verifyReceivePublish(channel,
NEWS_TOPIC
,
EmbeddedChannel
();
MQTTConnection
anotherConnection
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZEROBYTE_CLIENT_ID
,
anotherChannel);
MqttConnectMessage
secondConnMsg
=
MqttMessageBuilders
.
connect()
.clientId(
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Logger
LOG
=
LoggerFactory
.
getLogger(
DurableSession
.
class);
private
final
ISessionsStore
sessionsStore;
16
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
Show comments
Session
oldSession
=
pool
.
get(clientId);
if
(newIsClean
&&
oldSession
.
disconnected()) {
//
case 2
dropQueuesForClient(clientId);
unsubscribe(oldSession);
(
IConfig
config
)
throws
IOException
{
LOG
.
debug(
"
Starting Moquette integration using IConfig instance
"
);
startServer(config,
topic
,
MqttQoS
desiredQos
) {
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(desiredQos, topic)
.messageId(
1
)
.build();
MqttPublishMessage
>
qos2Receiving
=
new
HashMap<>
();
private
final
AtomicInteger
inflightSlots
=
new
AtomicInteger
(
@Test
public
void
invalidAuthentication
() {
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.username(
TEST_USER
+
"
.
equals(tail)) {
return
null
;
}
return
this
.
queueMap
.
get(tail
.
get());
}
}
Copy lines
, matchedSubscriptions
.
size());
//
assertTrue(matchedSubscriptions.size() >=1);
final
Subscription
onlyMatchedSubscription
=
matchedSubscriptions
.
iterator()
.
next();
assertEquals(expectedSubscription, onlyMatchedSubscription);
//
assertTrue(matchedSubscriptions.contains(expectedSubscription));
"
, clientID, cleanSession);
}
void
proccessConnectionLost
(
String
clientID
) {
//
If already removed a disconnect message was already processed for this clientID
if
(m_clientIDs
.
remove(clientID)
!=
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.Utils
;
addAfter(
"
idleStateHandler
"
,
"
idleEventHandler
"
, timeoutHandler);
//
pipeline.addLast("logger", new LoggingHandler("Netty", LogLevel.ERROR));
pipeline
.
addFirst(
"
bytemetrics
void
testClientSubscribeBeforeNotRetainedQoS0IsSent
() {
subscribe(
AT_MOST_ONCE
,
"
/topic
"
, connection);
//
Exercise
internalPublishNotRetainedTo(
"
/topic
"
);
//
Verify
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
/**
15
.
writeAndFlush(pingResp);
ctx
.
writeAndFlush(pingResp)
.
addListener(
CLOSE_ON_FAILURE
)
;
break
;
break
;
default
:
default
:
LOG
"
Hello world!
"
);
}
@Test
public
void
testForceClientDisconnection_issue116
() {
final
MQTTConnection
clientXA
=
connectAs(
FAKE_CLIENT_ID
)
.protocolVersion(
MqttVersion
.
MQTT_3_1
)
.build();
anotherConnection
.
processConnect(secondConnMsg);
assertEqualsConnAck(
CONNECTION_ACCEPTED
, anotherChannel
.
readOutbound());
//
Verify client session is clean false
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
View file
Edit file
Delete file
@@ -1,3 +1,19 @@
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
//
publish new session
boolean
result
=
oldSession
.
assignState(
SessionStatus
.
DISCONNECTED
,
SessionStatus
.
CONNECTING
);
if
(
!
null
);
}
/**
* Starts Moquette with config provided by an implementation of IConfig class and with the set
* of InterceptHandler.
*
*
@param
config the configuration to use to start the broker.
*
@param
handlers the handlers to install in the broker.
*
@throws
IOException in case of any IO Error.
*/
public
sut
.
subscribeClientToTopics(subscribe,
FAKE_CLIENT_ID
,
null
, connection);
MqttSubAckMessage
subAck
=
channel
.
readOutbound();
assertEquals(desiredQos
.
value(), (
int
) subAck
.
INFLIGHT_WINDOW_SIZE
);
//
this should be configurable
Session
(
String
clientId
,
boolean
clean
,
Will
will
,
Queue<
SessionRegistry
_fake
"
)
.password(
TEST_PWD
)
.build();
//
Exercise
sut
.
processConnect(msg);
//
Verify
assertEqualsConnAck(
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
}
@Test
public
void
testUnsubscribeWithBadFormattedTopic
() {
connect(
this
.
connection,
FAKE_CLIENT_ID
);
//
Exercise
sut
.
unsubscribe(singletonList(
null
) {
//
de-activate the subscriptions for this ClientID
subscriptions
.
deactivate(clientID);
LOG
.
info(
"
Lost connection with client <{}>
"
, clientID);
}
}
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PubAckEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
"
,
new
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
());
pipeline
.
addLast(
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_MOST_ONCE
,
PAYLOAD
);
}
@Test
public
void
testClientSubscribeBeforeRetainedQoS0IsSent
() {
subscribe(
AT_MOST_ONCE
,
"
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/MessagingEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
.
error(
"
Unkonwn MessageType:{}
"
, messageType);
LOG
.
error(
"
Unkonwn MessageType:{}
"
, messageType);
break
;
break
;
}
"
subscriber
"
);
subscribe(clientXA,
NEWS_TOPIC
,
AT_MOST_ONCE
);
final
MQTTConnection
clientXB
=
connectAs(
"
publisher
"
Session
session
=
sut
.
retrieve(
FAKE_CLIENT_ID
);
assertFalse(session
.
isClean());
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.spi
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
033a428
Please
sign in
result) {
throw
new
SessionCorruptedException
(
"
old session was already changed state
"
);
}
copySessionConfig(msg, oldSession);
oldSession
.
bind(mqttConnection);
result
=
oldSession
void
startServer
(
IConfig
config
,
List<? extends
InterceptHandler
>
handlers
)
throws
IOException
{
LOG
.
debug(
"
payload()
.
grantedQoSLevels()
.
get(
0
));
final
String
clientId
=
NettyUtils
.
clientID(channel);
Subscription
expectedSubscription
=
new
Subscription
.
EnqueuedMessage
>
sessionQueue
) {
this
(clean, clientId, sessionQueue);
this
.
will
=
will;
}
Session
(
boolean
clean
CONNECTION_REFUSED_BAD_USER_NAME_OR_PASSWORD
, channel
.
readOutbound());
assertFalse(
"
Connection should be closed by the broker.
"
, channel
.
isOpen());
}
@Test
public
void
testConnect_badClientID
() {
connMsg
.
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
BAD_FORMATTED_TOPIC
), connection,
1
);
//
Verify
assertFalse(
"
Unsubscribe with bad topic MUST close drop the connection, (issue 68)
"
, channel
.
isOpen());
}
@Test
public
void
testDontNotifyClientSubscribedToTopicAfterDisconnectedAndReconnectOnSameChannel
/**
* Remove the clientID from topic subscription, if not previously subscribed,
* doesn't reply any error
*/
void
processUnsubscribe
(
ServerChannel
session
,
String
clientID
,
List<
String
>
topics
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PublishEvent.java
Show comments
View file
Edit file
"
decoder
"
,
new
MqttDecoder
(
maxBytesInMessage
));
pipeline
.
addLast(
"
encoder
"
,
MqttEncoder
.
INSTANCE
/topic
"
, connection);
//
Exercise
internalPublishRetainedTo(
"
/topic
"
);
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_MOST_ONCE
,
PAYLOAD
);
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
/**
15
...r/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/OutputMessagingEvent.java
}
}
catch
(
Throwable
ex) {
}
catch
(
Throwable
ex) {
LOG
.
error(
"
Exception was caught while processing MQTT message,
"
+
ex
);
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Hello
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos2(clientXB,
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
.
assignState(
SessionStatus
.
CONNECTING
,
SessionStatus
.
CONNECTED
);
if
(
!
result) {
throw
new
SessionCorruptedException
(
Starting moquette integration using IConfig instance and intercept handlers
"
);
startServer(config, handlers,
null
,
null
,
null
);
}
public
void
startServer
(
IConfig
config
,
(clientId,
new
Topic
(topic), desiredQos);
final
Set<
Subscription
>
matchedSubscriptions
=
subscriptions
.
matchWithoutQosSharpening(
new
Topic
(topic));
assertEquals(
,
String
clientId
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
) {
this
.
clientId
=
clientId;
clientId(
"
extremely_long_clientID_greater_than_23
"
)
.
build();
//
Exercise
sut
.
processConnect(connMsg
.
clientId(
"
extremely_long_clientID_greater_than_23
"
)
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
() {
connect(
this
.
connection,
FAKE_CLIENT_ID
);
subscribe(connection,
NEWS_TOPIC
,
AT_MOST_ONCE
);
//
publish on /news
final
ByteBuf
payload
=
Unpooled
,
int
messageID
) {
LOG
.
debug(
"
"
, topics, clientID);
for
(
String
topic
:
topics) {
subscriptions
.
removeSubscription(topic, clientID);
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
);
pipeline
.
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
}
@Test
public
void
testClientSubscribeBeforeNotRetainedQoS1IsSent
() {
subscribe(
AT_LEAST_ONCE
,
"
/topic
"
, connection);
//
Exercise
internalPublishTo(
"
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
.
getCause(), ex);
LOG
.
error(
"
Exception was caught while processing MQTT message,
{}
"
,
ex
.
getCause(), ex);
ctx
.
fireExceptionCaught(ex);
ctx
.
fireExceptionCaught(ex);
MqttMessageBuilders
.
publish()
.payload(anyPayload)
.qos(
MqttQoS
.
EXACTLY_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build(),
"
username
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
"
old session moved in connected state by other thread
"
);
}
final
boolean
published
=
pool
.
replace(clientId, oldSession, oldSession);
if
(
!
published) {
throw
new
List<? extends
InterceptHandler
>
handlers
,
ISslContextCreator
sslCtxCreator
,
IAuthenticator
authenticator
,
IAuthorizatorPolicy
authorizatorPolicy
)
throws
1
, matchedSubscriptions
.
size());
final
Subscription
onlyMatchedSubscription
=
matchedSubscriptions
.
iterator()
.
next();
assertEquals(expectedSubscription, onlyMatchedSubscription);
}
protected
void
subscribe
this
.
clean
=
clean;
this
.
sessionQueue
=
sessionQueue;
}
void
update
(
boolean
clean
,
Will
will
.
build());
//
Verify
assertEqualsConnAck(
CONNECTION_ACCEPTED
, channel
.
readOutbound());
}
@Test
public
void
testWillIsAccepted
() {
MqttConnectMessage
msg
=
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
}
//
ack the client
UnsubAckMessage
ackMessage
=
new
UnsubAckMessage
();
ackMessage
.
setMessageID(messageID);
LOG
.
info(
"
replying with UnsubAck to MSG ID {}
"
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage.QOSType
;
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
666cc29
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
"
,
new
MQTTMessageLogger
());
@@ -336,7 +340,7 @@ void init(ChannelPipeline pipeline) throws Exception {
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
/topic
"
,
AT_LEAST_ONCE
,
false
);
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
PAYLOAD
);
}
@Test
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage
;
ctx
.
close();
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
)
;
}
finally
{
}
finally
{
ReferenceCountUtil
"
);
final
MQTTConnection
clientYA
=
connectAs(
"
subscriber
"
);
subscribe(clientYA,
NEWS_TOPIC
,
AT_MOST_ONCE
);
final
MQTTConnection
clientYB
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
SessionCorruptedException
(
"
old session was already removed
"
);
}
LOG
.
trace(
"
case 2, oldSession with same CId {} disconnected
"
, clientId);
}
else
if
(
IOException
{
final
long
start
=
System
.
currentTimeMillis();
if
(handlers
==
null
) {
handlers
=
Collections
(
MQTTConnection
connection
,
String
topic
,
MqttQoS
desiredQos
) {
EmbeddedChannel
channel
=
(
EmbeddedChannel
) connection
.
channel;
MqttSubscribeMessage
) {
this
.
clean
=
clean;
this
.
will
=
will;
}
void
markConnected
() {
assignState(
SessionStatus
.
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.
willFlag(
true
)
.willTopic(
"
topic
"
)
.
willMessage(
"
Topic message
"
,
TEST_PWD
, payload,
false
,
MqttMessageBuilders
.
publish()
.payload(payload
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
, messageID);
session
.
write(ackMessage);
}
void
processSubscribe
(
ServerChannel
session
,
SubscribeMessage
msg
,
String
clientID
,
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
));
pipeline
.
addAfter(
"
idleStateHandler
"
,
"
idleEventHandler
"
, timeoutHandler);
pipeline
.
addFirst(
"
bytemetrics
"
,
public
void
testClientSubscribeAfterNotRetainedQoS1IsSent
() {
//
Exercise
internalPublishTo(
"
/topic
"
,
AT_LEAST_ONCE
,
false
);
subscribe(
AT_LEAST_ONCE
,
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/ProtocolEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
.
release(msg);
ReferenceCountUtil
.
release(msg);
}
}
@@ -97,17 +99,17 @@ public void channelRead(ChannelHandlerContext ctx, Object message) {
public
void
channelInactive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
public
=
connectAs(
"
publisher
"
);
final
ByteBuf
anyPayload2
=
Unpooled
.
copiedBuffer(
"
Hello 2
"
,
Charset
!
newIsClean
&&
oldSession
.
disconnected()) {
//
case 3
reactivateSubscriptions(oldSession);
//
mark as connected
final
boolean
connecting
=
oldSession
.
emptyList();
}
LOG
.
trace(
"
Starting Moquette Server. MQTT message interceptors={}
"
, getInterceptorIds(handlers));
scheduler
=
Executors
.
newScheduledThreadPool(
1
);
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(desiredQos, topic)
.messageId(
1
)
.build();
sut
.
subscribeClientToTopics(subscribe, connection
.
getClientId(),
null
, connection);
MqttSubAckMessage
DISCONNECTED
,
SessionStatus
.
CONNECTED
);
}
void
bind
(
MQTTConnection
mqttConnection
) {
this
.
mqttConnection
=
mqttConnection;
)
.
build();
//
Exercise
//
m_handler.setMessaging(mockedMessaging);
sut
.
processConnect(msg);
//
Verify
assertEqualsConnAck(
CONNECTION_ACCEPTED
, channel
.
readOutbound());
assertTrue(
.topicName(
NEWS_TOPIC
)
.
build());
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_MOST_ONCE
,
"
Hello world!
"
);
unsubscribeAndVerifyAck(
NEWS_TOPIC
);
//
boolean
cleanSession
) {
LOG
.
debug(
"
"
, clientID, msg
.
getMessageID());
for
(
SubscribeMessage
.
Couple
req
:
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
new
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
());
pipeline
.
addLast(
"
"
/topic
"
, connection);
//
Verify
verifyNoPublishIsReceived(channel);
}
@Test
public
void
testClientSubscribeBeforeRetainedQoS1IsSent
() {
subscribe(
AT_LEAST_ONCE
,
"
/topic
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.Utils
;
import
org.dna.mqtt.moquette.proto.Utils
void
channelInactive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
String
clientID
=
NettyUtils
.
clientID(ctx
.
channel());
String
clientID
.
defaultCharset());
sut
.
receivedPublishQos2(clientYB,
MqttMessageBuilders
.
publish()
.payload(anyPayload2)
.qos(
MqttQoS
.
EXACTLY_ONCE
)
.retained(
true
)
.topicName(
NEWS_TOPIC
.
assignState(
SessionStatus
.
DISCONNECTED
,
SessionStatus
.
CONNECTING
);
if
(
!
connecting) {
throw
new
SessionCorruptedException
(
final
String
handlerProp
=
System
.
getProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
);
if
(handlerProp
!=
null
) {
config
.
subAck
=
channel
.
readOutbound();
assertEquals(desiredQos
.
value(), (
int
) subAck
.
payload()
.
grantedQoSLevels()
.
get(
0
));
}
public
boolean
disconnected
() {
return
status
.
get()
==
SessionStatus
.
DISCONNECTED
;
}
public
"
Connection is accepted and therefore should remain open
"
, channel
.
isOpen());
}
@Test
public
void
testWillIsFired
() {
final
PostOffice
postOfficeMock
=
mock(
PostOffice
publish on /news
final
ByteBuf
payload2
=
Unpooled
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
msg
.
subscriptions()) {
AbstractMessage
.
QOSType
qos
=
AbstractMessage
.
QOSType
.
values()[req
.
getQos()];
Subscription
newSubscription
=
new
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
decoder
"
,
new
MqttDecoder
(
maxBytesInMessage
));
pipeline
.
addLast(
"
encoder
"
,
MqttEncoder
.
INSTANCE
"
, connection);
//
Exercise
internalPublishTo(
"
/topic
"
,
AT_LEAST_ONCE
,
true
);
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
;
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PubAckEvent.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
=
NettyUtils
.
clientID(ctx
.
channel());
if
(clientID
!=
null
&&
!
clientID
.
isEmpty()) {
if
(clientID
!=
null
)
.
build(),
"
username
"
);
//
Verify
assertFalse(
"
First 'subscriber' channel MUST be closed by the broker
"
, clientXA
.
channel
.
isOpen());
ConnectionTestUtils
"
old session moved in connected state by other thread
"
);
}
oldSession
.
bind(mqttConnection);
final
boolean
connected
=
oldSession
.
assignState(
SessionStatus
.
CONNECTING
setProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
, handlerProp);
}
final
String
persistencePath
=
config
.
getProperty(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
);
LOG
.
final
String
clientId
=
connection
.
getClientId();
Subscription
expectedSubscription
=
new
Subscription
(clientId,
new
Topic
(topic), desiredQos);
final
Set<
Subscription
boolean
connected
() {
return
status
.
get()
==
SessionStatus
.
CONNECTED
;
}
public
String
getClientID
() {
return
clientId;
.
class);
sut
=
createMQTTConnectionWithPostOffice(
CONFIG
, postOfficeMock);
channel
=
(
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
,
TEST_PWD
, payload2,
false
,
MqttMessageBuilders
Subscription
(clientID, req
.
getTopic(), qos, cleanSession);
subscribeSingleTopic(newSubscription, req
.
getTopic());
}
//
ack the client
SubAckMessage
ackMessage
=
new
);
pipeline
.
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
"
,
AT_LEAST_ONCE
,
PAYLOAD
);
}
@Test
public
void
testClientSubscribeAfterRetainedQoS1IsSent
() {
//
Exercise
internalPublishTo(
"
/topic
"
,
AT_LEAST_ONCE
Sign in to GitHub · GitHub
Skip to content
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
/**
/**
15
broker/src/main/java/org/dna/mqtt/moquette/messaging/spi/impl/events/PublishEvent.java
&&
!
clientID
.
isEmpty()) {
LOG
.
info(
"
Notifying connection lost event. MqttClientId = {}
.
"
, clientID);
LOG
.
info(
"
Notifying connection lost event. MqttClientId = {}
"
.
verifyPublishIsReceived((
EmbeddedChannel
) clientYA
.
channel,
AT_MOST_ONCE
,
"
Hello 2
"
);
}
private
MQTTConnection
connectAs
(
String
,
SessionStatus
.
CONNECTED
);
if
(
!
connected) {
throw
new
SessionCorruptedException
(
"
old session moved in other state state by other thread
"
);
}
debug(
"
Configuring Using persistent store file, path: {}
"
, persistencePath);
initInterceptors(config, handlers);
LOG
.
debug(
"
Initialized MQTT protocol processor
"
);
if
(sslCtxCreator
==
null
) {
>
matchedSubscriptions
=
subscriptions
.
matchWithoutQosSharpening(
new
Topic
(topic));
assertEquals(
1
, matchedSubscriptions
.
size());
final
Subscription
onlyMatchedSubscription
=
moquette/build.gradle at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
}
public
List<
Subscription
>
getSubscriptions
() {
return
new
ArrayList<>
(subscriptions);
}
public
void
addSubscriptions
(
List<
EmbeddedChannel
) sut
.
channel;
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.
willFlag(
true
)
.willTopic(
.
publish()
.payload(payload)
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
ConnectionTestUtils
.
verifyNoPublishIsReceived(channel);
moquette/IQueueRepository.java at c4d928bbd71e34dd22690edc054aa528bf618cbf · moquette-io/moquette · GitHub
SubAckMessage
();
ackMessage
.
setMessageID(msg
.
getMessageID());
//
reply with requested qos
for
(
SubscribeMessage
.
Couple
req
:
msg
.
subscriptions()) {
new
MQTTMessageLogger
());
6
distribution/src/main/resources/moquette.conf
Show comments
View file
Edit file
Delete file
@@ -106,11 +106,15 @@ password_file config/password_file.conf
#*********************************************************************
# Netty Configuration
#
# Linux systems can use epoll instead of nio. To get a performance
#
netty.epoll:
Linux systems can use epoll instead of nio. To get a performance
# gain and reduced GC.
moquette/gradlew at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
,
true
);
subscribe(
AT_LEAST_ONCE
,
"
/topic
"
, connection);
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,18 @@
/*
* Copyright (c) 2012-2014 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
, clientID);
m_processor
.
processConnectionLost(clientID, ctx
.
channel());
m_processor
.
processConnectionLost(clientID, ctx
.
channel());
}
}
ctx
.
close();
ctx
.
close()
.
clientId
) {
EmbeddedChannel
channel
=
new
EmbeddedChannel
();
MQTTConnection
connection
=
createMQTTConnection(
CONFIG
, channel);
connection
.
processConnect(
ConnectionTestUtils
.
buildConnect(clientId));
//
publish new session
final
boolean
published
=
pool
.
replace(clientId, oldSession, oldSession);
if
(
!
published) {
throw
new
SessionCorruptedException
(
LOG
.
info(
"
Using default SSL context creator
"
);
sslCtxCreator
=
new
DefaultMoquetteSslContextCreator
(config);
}
authenticator
=
initializeAuthenticator(authenticator, config);
authorizatorPolicy
=
moquette/settings.gradle at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
matchedSubscriptions
.
iterator()
.
next();
assertEquals(expectedSubscription, onlyMatchedSubscription);
}
@Test
public
void
testSubscribedToNotAuthorizedTopic
() {
NettyUtils
.
userName(channel,
FAKE_USER_NAME
);
IAuthorizatorPolicy
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Subscription
>
newSubscriptions
) {
subscriptions
.
addAll(newSubscriptions);
}
public
boolean
hasWill
() {
return
"
topic
"
)
.
willMessage(
"
Topic message
"
)
.
build();
sut
.
processConnect(msg);
//
Exercise
sut
}
protected
void
unsubscribeAndVerifyAck
(
String
topic
) {
final
int
messageId
=
1
;
sut
.
unsubscribe(
Collections
moquette/license-eplv10-aslv20.html at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
AbstractMessage
.
QOSType
qos
=
AbstractMessage
.
QOSType
.
values()[req
.
getQos()];
ackMessage
.
addType(qos);
}
LOG
.
debug(
# http://netty.io/wiki/native-transports.html for more information
# netty.mqtt.message_size : by default the max size of message is set at 8092 bytes
# http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/errata01/os/mqtt-v3.1.1-errata01-os-complete.html#_Toc442180836
# Fore more information about payload size specs.
#*********************************************************************
# netty.epoll true
# netty.mqtt.message_size 8092
#*********************************************************************
# Metrics Configuration
Toggle all file notes
0 comments on commit
2fb475a
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
PAYLOAD
);
}
@Test
public
void
testClientSubscribeBeforeNotRetainedQoS2IsSent
() {
subscribe(
EXACTLY_ONCE
,
"
/topic
"
, connection);
//
Exercise
internalPublishTo(
"
Added QueueRepository implemented in memory and on H2 · moquette-io/moquette@c4d928b · GitHub
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
* You may elect to redistribute this code under either of these licenses.
*/
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
package
org.dna.mqtt.moquette.messaging.spi.impl.events
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage.QOSType
;
import
org.dna.mqtt.moquette.proto.messages.AbstractMessage.QOSType
;
Oops, something went wrong.
Retry
Toggle all file notes
addListener(
CLOSE_ON_FAILURE
)
;
}
}
@Override
@Override
public
void
exceptionCaught
(
ChannelHandlerContext
ConnectionTestUtils
.
assertConnectAccepted(channel);
return
connection;
}
private
Sign in to GitHub · GitHub
"
old session was already removed
"
);
}
postConnectAction
initializeAuthorizatorPolicy(authorizatorPolicy, config);
final
ISubscriptionsRepository
subscriptionsRepository;
final
IQueueRepository
queueRepository;
if
(persistencePath
!=
null
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
prohibitReadOnNewsTopic
=
mock(
IAuthorizatorPolicy
.
class);
when(prohibitReadOnNewsTopic
.
canRead(eq(
new
Topic
(
NEWS_TOPIC
)), eq(
FAKE_USER_NAME
), eq(
FAKE_CLIENT_ID
)))
.thenReturn(
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
will
!=
null
;
}
public
Will
getWill
() {
return
will;
}
boolean
assignState
(
SessionStatus
expected
,
.
handleConnectionLost();
//
Verify
verify(postOfficeMock)
.
fireWill(any(
Session
.
Will
.
class));
assertFalse(
"
Connection MUST be disconnected
"
, sut
.
isConnected());
.
singletonList(topic), connection, messageId);
MqttUnsubAckMessage
unsubAckMessageAck
=
channel
.
readOutbound();
assertEquals(
"
Unsubscribe must be accepted
"
, messageId, unsubAckMessageAck
.
variableHeader()
.
messageId());
}
Fixed failing tests after moving to H2 as default store · moquette-io/moquette@1141e9f · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
"
replying with SubAck to MSG ID {}
"
, msg
.
getMessageID());
session
.
write(ackMessage);
}
private
void
subscribeSingleTopic
(
Subscription
newSubscription
,
final
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
/topic
"
,
EXACTLY_ONCE
,
false
);
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
EXACTLY_ONCE
,
PAYLOAD
);
}
@Test
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
0 comments on commit
666cc29
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
ctx
,
Throwable
cause
)
throws
Exception
{
public
void
exceptionCaught
(
ChannelHandlerContext
ctx
,
void
subscribe
(
MqttQoS
topic
,
String
newsTopic
,
MQTTConnection
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
=
PostConnectAction
.
SEND_STORED_MESSAGES
;
LOG
.
trace(
"
case 3, oldSession with same CId {} disconnected
&&
!
persistencePath
.
isEmpty()) {
LOG
.
trace(
"
Configuring H2 subscriptions store to {}
"
Sign in to GitHub · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
false
);
sut
=
new
PostOffice
(subscriptions, prohibitReadOnNewsTopic,
new
MemoryRetainedRepository
(), sessionRegistry,
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Sign in to GitHub · GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
SessionStatus
newState
) {
return
status
.
compareAndSet(expected, newState);
}
public
void
closeImmediately
() {
mqttConnection
.
dropConnection();
}
public
void
}
@Test
public
void
acceptAnonymousClient
() {
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.
build();
//
Exercise
@Test
public
void
testDontNotifyClientSubscribedToTopicAfterDisconnectedAndReconnectOnNewChannel
() {
connect(
this
.
connection,
FAKE_CLIENT_ID
);
subscribe(connection,
NEWS_TOPIC
,
AT_MOST_ONCE
);
//
publish on /news
Added QueueRepository implemented in memory and on H2 · moquette-io/moquette@c4d928b · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
String
topic
) {
LOG
.
info(
"
"
,
newSubscription
.
getClientId(), topic,
AbstractMessage
.
QOSType
.
formatQoS(newSubscription
.
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
public
void
testClientSubscribeAfterNotRetainedQoS2IsSent
() {
//
Exercise
internalPublishTo(
"
/topic
"
,
EXACTLY_ONCE
,
false
);
subscribe(
EXACTLY_ONCE
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
Throwable
cause
)
throws
Exception
{
LOG
.
error(
"
An unexpected exception was caught while processing MQTT message. Closing Netty channel. CId={},
"
+
LOG
.
error(
"
connection
) {
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(topic, newsTopic)
.messageId(
1
)
.build();
sut
.
subscribeClientToTopics(subscribe, connection
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
"
, clientId);
}
else
if
(oldSession
.
connected()) {
//
case 4
LOG
.
trace(
"
case 4, oldSession with same CId {} still connected, force to close
"
, clientId);
, persistencePath);
h2Builder
=
new
H2Builder
(config, scheduler)
.
initStore();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
queueRepository
=
h2Builder
.
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
//
Exercise
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
moquette/BrokerConstants.java at d50a291366f1b5a16011266dbf770c020d241eee · moquette-io/moquette · GitHub
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
moquette/build.gradle at d50a291366f1b5a16011266dbf770c020d241eee · moquette-io/moquette · GitHub
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
disconnect
() {
final
boolean
res
=
assignState(
SessionStatus
.
CONNECTED
,
SessionStatus
.
DISCONNECTING
);
if
(
!
res) {
sut
.
processConnect(msg);
//
Verify
assertEqualsConnAck(
CONNECTION_ACCEPTED
, channel
.
readOutbound());
assertTrue(
"
Connection is accepted and therefore must remain open
"
, channel
.
isOpen());
}
@Test
Removed perf module to be move in separate project, and disabled leak… · moquette-io/moquette@8f7b7df · GitHub
final
ByteBuf
payload
=
Unpooled
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
getRequestedQos()));
subscriptions
.
add(newSubscription);
//
scans retained messages to be published to the new subscription
Collection<
HawtDBStorageService
.
StoredMessage
>
messages
=
m_storageService
.
searchMatching(
new
IMatchingCondition
() {
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
,
"
/topic
"
, connection);
//
Verify
verifyNoPublishIsReceived(channel);
}
@Test
public
void
testClientSubscribeBeforeRetainedQoS2IsSent
() {
subscribe(
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
An unexpected exception was caught while processing MQTT message. Closing Netty channel. CId={},
"
+
"
"
,
NettyUtils
.
clientID(ctx
.
channel()), cause
.
getCause(), cause
.
getMessage());
"
getClientId(),
null
,
this
.
connection);
MqttSubAckMessage
subAck
=
((
EmbeddedChannel
)
this
.
connection
.
channel)
.
readOutbound();
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
oldSession
.
closeImmediately();
//
remove(clientId);
//
publish new session
final
boolean
published
=
pool
.
replace(clientId, oldSession, newSession);
if
(
!
queueRepository();
}
else
{
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
);
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
queueRepository
=
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
.
subscribe()
.addSubscription(
AT_MOST_ONCE
,
NEWS_TOPIC
)
.messageId(
1
)
.build();
sut
.
subscribeClientToTopics(subscribe,
FAKE_CLIENT_ID
,
FAKE_USER_NAME
, connection);
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
//
someone already moved away from CONNECTED
//
TODO what to do?
return
;
}
mqttConnection
=
null
;
will
=
null
;
assignState(
SessionStatus
.
DISCONNECTING
public
void
validAuthentication
() {
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.username(
TEST_USER
)
.
password(
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Topic
(
NEWS_TOPIC
),
TEST_USER
,
TEST_PWD
, payload,
false
,
MqttMessageBuilders
.
publish()
.payload(payload
.
retainedDuplicate())
.qos(
MqttQoS
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
public
boolean
match
(
String
key
) {
return
SubscriptionsStore
.
matchTopics(key, topic);
}
});
for
(
HawtDBStorageService
.
StoredMessage
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
EXACTLY_ONCE
,
"
/topic
"
, connection);
//
Exercise
internalPublishTo(
"
/topic
"
,
EXACTLY_ONCE
,
true
);
//
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
"
,
NettyUtils
.
clientID(ctx
.
channel()), cause
.
getCause(), cause
.
getMessage());
ctx
.
close();
ctx
.
close()
.
addListener(
assertEquals(topic
.
value(), (
int
) subAck
.
payload()
.
grantedQoSLevels()
.
get(
0
));
}
protected
void
subscribe
Accept
Reject
Save preferences
published) {
throw
new
SessionCorruptedException
(
"
old session was already removed
"
);
}
}
//
case not covered new session is clean true/false and old session not in CONNECTED/DISCONNECTED
return
postConnectAction;
}
private
void
new
MemoryQueueRepository
();
}
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
.
init(subscriptionsRepository);
SessionRegistry
sessions
=
new
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
//
Verify
MqttSubAckMessage
subAckMsg
=
channel
.
readOutbound();
verifyFailureQos(subAckMsg);
}
private
Minor, changed header by andsel · Pull Request #536 · moquette-io/moquette · GitHub
Minor, changed header by andsel · Pull Request #536 · moquette-io/moquette · GitHub
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
,
SessionStatus
.
DISCONNECTED
);
}
boolean
isClean
() {
return
clean;
}
public
void
processPubRec
(
int
packetId
) {
TEST_PWD
)
.
build();
//
Exercise
sut
.
processConnect(msg);
//
Verify
assertEqualsConnAck(
CONNECTION_ACCEPTED
, channel
.
readOutbound());
assertTrue(
"
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_MOST_ONCE
,
"
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
c4d928bbd7
moquette
/
broker
/
src
/
main
storedMsg
:
messages) {
//
fire the as retained the message
LOG
.
debug(
"
send publish message for topic {}
"
, topic);
sendPublish(newSubscription
.
getClientId(), storedMsg
.
getTopic(), storedMsg
.
getQos(), storedMsg
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
gradlew
Go to file
Go to file
T
Go to line
L
Copy path
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
EXACTLY_ONCE
,
PAYLOAD
);
}
@Test
public
void
testClientSubscribeAfterRetainedQoS2IsSent
() {
//
Exercise
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
CLOSE_ON_FAILURE
)
;
}
}
@Override
@Override
4
broker/src/main/java/io/moquette/server/netty/metrics/BytesMetricsHandler.java
Show comments
View file
Edit file
Delete file
@@ -24,6 +24,8 @@
import
io.netty.util.Attribute
;
(
MQTTConnection
connection
,
String
topic
,
MqttQoS
desiredQos
) {
EmbeddedChannel
channel
=
(
EmbeddedChannel
) connection
.
channel;
reactivateSubscriptions
(
Session
session
) {
for
(
Subscription
existingSub
:
session
.
getSubscriptions()) {
//
TODO
//
subscriptionsDirectory.reactivate(existingSub.getTopicFilter(), session.getClientID());
SessionRegistry
(subscriptions, queueRepository);
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
new
MemoryRetainedRepository
(), sessions,
interceptor);
final
BrokerConfiguration
brokerConfig
=
new
BrokerConfiguration
(config);
MQTTConnectionFactory
connectionFactory
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
void
verifyFailureQos
(
MqttSubAckMessage
subAckMsg
) {
List<
Integer
>
grantedQoSes
=
subAckMsg
.
payload()
.
grantedQoSLevels();
assertEquals(
1
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
/
build.gradle
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
39 lines (28 sloc)
2.06 KB
Raw
Blame
description
=
'
Moquette - broker
'
moquette/checkstyle.xml at master · moquette-io/moquette · GitHub
inflightWindow
.
remove(packetId);
inflightSlots
.
incrementAndGet();
if
(canSkipQueue()) {
inflightSlots
.
decrementAndGet();
int
pubRelPacketId
=
packetId
/*
mqttConnection.nextPacketId()
*/
checkstyle: resource folders excluded form check · moquette-io/moquette@e2aa30d · GitHub
Connection is accepted and therefore must remain open
"
, channel
.
isOpen());
}
@Test
public
void
noPasswdAuthentication
() {
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Hello world!
"
);
unsubscribeAndVerifyAck(
NEWS_TOPIC
);
connection
.
processDisconnect(
null
);
//
connect on another channel
EmbeddedChannel
anotherChannel
=
new
EmbeddedChannel
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
license-eplv10-aslv20.html
Go to file
Go to file
T
Go to line
L
Copy path
/
java
/
io
/
moquette
/
broker
/
IQueueRepository.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
.
getPayload(),
true
);
}
}
private
void
disruptorPublish
(
OutputMessagingEvent
msgEvent
) {
LOG
.
debug(
"
disruptorPublish publishing event on output {}
"
Cannot retrieve contributors at this time
executable file
172 lines (151 sloc)
5.17 KB
Raw
Blame
#!
/usr/bin/env sh
#
#############################################################################
#
#
#
# Gradle start up script for UN*X
#
internalPublishTo(
"
/topic
"
,
EXACTLY_ONCE
,
true
);
subscribe(
EXACTLY_ONCE
,
"
/topic
"
, connection);
//
Verify
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Added QueueRepository implemented in memory and on H2
Loading branch information
andsel
committed
Nov 22, 2018
1 parent
1141e9f
commit
import
io.netty.util.Attribute
;
import
io.netty.util.AttributeKey
;
import
io.netty.util.AttributeKey
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
public
class
BytesMetricsHandler
extends
ChannelDuplexHandler
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(desiredQos, topic)
.messageId(
1
)
.build();
sut
.
subscribeClientToTopics(subscribe, connection
.
getClientId(),
null
, connection);
}
}
private
void
unsubscribe
(
Session
session
) {
for
(
Subscription
existingSub
:
session
.
getSubscriptions()) {
subscriptionsDirectory
.
=
new
MQTTConnectionFactory
(brokerConfig, authenticator, sessions,
dispatcher);
final
NewNettyMQTTHandler
mqttHandler
=
new
NewNettyMQTTHandler
(connectionFactory);
acceptor
=
new
NewNettyAcceptor
();
acceptor
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
settings.gradle
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
8 lines (7 sloc)
364 Bytes
Raw
, grantedQoSes
.
size());
assertTrue(grantedQoSes
.
contains(
MqttQoS
.
FAILURE
.
value()));
}
@Test
public
void
testDoubleSubscribe
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
dependencies
{
compile
group
:
'
io.netty
'
,
name
:
'
netty-common
'
,
version
: nettyVersion
compile
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
;
inflightWindow
.
put(pubRelPacketId,
new
SessionRegistry
.
PubRelMarker
());
inflightTimeouts
.
add(
new
InFlightPacket
(pubRelPacketId,
FLIGHT_BEFORE_RESEND_MS
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
)
.username(
TEST_USER
)
.build();
//
Exercise
sut
.
processConnect(msg);
//
Verify
assertEqualsConnAck(
CONNECTION_REFUSED_BAD_USER_NAME_OR_PASSWORD
, channel
.
readOutbound());
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
();
MQTTConnection
anotherConnection
=
createMQTTConnection(
CONFIG
, anotherChannel);
anotherConnection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(anotherChannel);
//
publish on /news
final
ByteBuf
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Fixed failing tests after moving to H2 as default store
Loading branch information
andsel
committed
Nov 18, 2018
1 parent
cfa4780
commit
1141e9f7a13f816cb46e57e47999a2de3d7ae1c8
Cannot retrieve contributors at this time
576 lines (508 sloc)
29.3 KB
Raw
Blame
<
html
xmlns:o
="
urn:schemas-microsoft-com:office:office
"
xmlns:w
="
urn:schemas-microsoft-com:office:word
"
xmlns
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
8 lines (5 sloc)
176 Bytes
Raw
Blame
package
io.moquette.broker
;
import
java.util.Queue
;
public
, msgEvent);
long
sequence
=
m_ringBuffer
.
next();
ValueEvent
event
=
m_ringBuffer
.
get(sequence);
event
.
setEvent(msgEvent);
m_ringBuffer
.
#
#
#############################################################################
#
Attempt to set APP_HOME
#
Resolve links: $0 may be a link
PRG=
"
$0
"
#
Need this for relative symlinks.
while
[
-h
"
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
EXACTLY_ONCE
,
PAYLOAD
);
}
@Test
public
void
testClientSubscribeAfterDisconnected
() {
subscribe(
AT_MOST_ONCE
c4d928bbd71e34dd22690edc054aa528bf618cbf
Unified
Split
Showing
22 changed files
with
89 additions
and
214 deletions
.
+1
−1
broker/build.gradle
+8
−0
broker/src/main/java/io/moquette/broker/IQueueRepository.java
+12
{
public
class
BytesMetricsHandler
extends
ChannelDuplexHandler
{
private
static
final
AttributeKey<
BytesMetrics
>
ATTR_KEY_METRICS
=
AttributeKey
.
MqttSubAckMessage
subAck
=
channel
.
readOutbound();
assertEquals(desiredQos
.
value(), (
int
) subAck
.
payload()
.
grantedQoSLevels()
.
get(
0
removeSubscription(existingSub
.
getTopicFilter(), session
.
getClientID());
}
}
private
Session
createNewSession
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
msg
,
.
initialize(mqttHandler, config, sslCtxCreator);
final
long
startTime
=
System
.
currentTimeMillis()
-
start;
LOG
.
info(
"
Moquette integration has been started successfully in {} ms
"
Blame
rootProject
.
name
=
'
moquette-parent
'
include
'
:moquette-broker
'
include
'
:moquette-distribution
'
include
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
assertEquals(
"
After CONNECT subscription MUST be empty
"
,
0
, subscriptions
.
moquette/checkstyle-suppressions.xml at master · moquette-io/moquette · GitHub
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
group
:
'
io.netty
'
,
name
:
'
netty-buffer
'
,
version
: nettyVersion
compile
group
:
'
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
));
MqttMessage
pubRel
=
MQTTConnection
.
pubrel(pubRelPacketId);
mqttConnection
.
sendIfWritableElseDrop(pubRel);
drainQueueToConnection();
}
else
{
sessionQueue
.
add(
new
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
assertFalse(
"
Connection must be closed by the broker
"
, channel
.
isOpen());
}
@Test
public
void
prohibitAnonymousClient
() {
MqttConnectMessage
msg
=
connMsg
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
payload2
=
Unpooled
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
Projects
Wiki
Security
Insights
Permalink
Browse files
Added QueueRepository implemented in memory and on H2
Loading branch information
andsel
committed
Nov 22, 2018
1 parent
1141e9f
commit
c4d928bbd71e34dd22690edc054aa528bf618cbf
Unified
Split
Unified
Split
Showing
20 changed files
with
43 additions
and
819 deletions
.
+1
−0
broker/build.gradle
+2
−2
broker/src/main/java/io/moquette/BrokerConstants.java
+8
−1
="
http://www.w3.org/TR/REC-html40
"
>
<
head
>
<
meta
http-equiv
="
Content-Type
"
content
="
text/html; charset=windows-1252
"
>
interface
IQueueRepository
{
Queue<
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
String
cli
,
boolean
clean
);
}
Copy lines
Copy permalink
publish(sequence);
}
public
void
onEvent
(
ValueEvent
t
,
long
l
,
boolean
bln
)
throws
Exception
$PRG
"
]
;
do
ls=
`
ls -ld
"
$PRG
"
`
link=
`
expr
"
,
"
foo
"
, connection);
connection
.
processDisconnect(
null
);
internalPublishTo(
"
foo
"
,
AT_MOST_ONCE
,
−0
broker/src/main/java/io/moquette/broker/MemoryQueueRepository.java
+6
−3
broker/src/main/java/io/moquette/broker/Server.java
+1
−3
broker/src/main/java/io/moquette/broker/Session.java
+7
−6
broker/src/main/java/io/moquette/broker/SessionRegistry.java
+5
−0
broker/src/main/java/io/moquette/persistence/H2Builder.java
+2
−1
...io/moquette/persistence/h2 → broker/src/main/java/io/moquette/persistence}/H2PersistentQueue.java
+25
valueOf(
"
BytesMetrics
"
);
private
static
final
AttributeKey<
BytesMetrics
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
"
BytesMetrics
"
));
final
String
clientId
=
connection
.
getClientId();
Subscription
expectedSubscription
=
new
Subscription
(clientId,
new
Topic
(topic), desiredQos);
final
Set<
String
clientId
) {
final
boolean
clean
=
msg
.
variableHeader()
.
isCleanSession();
final
Queue<
SessionRegistry
.
EnqueuedMessage
>
, startTime);
initialized
=
true
;
}
private
IAuthorizatorPolicy
initializeAuthorizatorPolicy
(
IAuthorizatorPolicy
authorizatorPolicy
,
IConfig
props
) {
//
'
:moquette-embedded-test
'
project(
'
:moquette-broker
'
)
.
projectDir
=
"
$r
ootDir
/broker
"
as
File
size());
subscribe(channel,
NEWS_TOPIC
,
AT_MOST_ONCE
);
assertEquals(
"
After /news subscribe, subscription MUST contain it
"
,
1
, subscriptions
.
size());
//
Exercise & verify
subscribe(channel,
NEWS_TOPIC
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
d50a291366
moquette
/
broker
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
d50a291366
moquette
/
broker
/
build.gradle
Go to file
Go to file
T
Go to line
Update about.html · moquette-io/moquette@1a6dd8a · GitHub
io.netty
'
,
name
:
'
netty-transport
'
,
version
: nettyVersion
compile
group
:
'
io.netty
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
SessionRegistry
.
PubRelMarker
());
}
}
public
void
processPubComp
(
int
messageID
) {
inflightWindow
.
remove(messageID);
inflightSlots
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
.
clientId(
FAKE_CLIENT_ID
)
.
build();
BrokerConfiguration
config
=
new
BrokerConfiguration
(
false
,
true
,
false
);
sut
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Removed perf module to be move in separate project, and disabled leak…
Loading branch information
andsel
committed
Nov 11, 2018
1 parent
8e17e99
commit
8f7b7df1240f569b5baa4feb0219b1936f66e062
NEWS_TOPIC
),
TEST_USER
,
TEST_PWD
, payload2,
false
,
MqttMessageBuilders
.
publish()
.payload(payload2)
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
Showing
22 changed files
with
89 additions
and
214 deletions
.
+1
−1
broker/build.gradle
+8
−0
broker/src/main/java/io/moquette/broker/IQueueRepository.java
+12
−0
broker/src/main/java/io/moquette/broker/MemoryQueueRepository.java
+6
broker/src/main/java/io/moquette/broker/Server.java
+1
−1
broker/src/main/java/io/moquette/interception/BrokerInterceptor.java
+4
−0
broker/src/main/java/io/moquette/persistence/H2Builder.java
+9
−26
broker/src/test/java/io/moquette/integration/IntegrationUtils.java
+4
−0
broker/src/test/java/io/moquette/integration/ServerIntegrationDBAuthenticatorTest.java
+2
−0
broker/src/test/java/io/moquette/integration/ServerIntegrationFuseTest.java
<
meta
name
="
ProgId
"
content
="
Word.Document
"
>
<
meta
name
="
Generator
"
content
="
Microsoft Word 9
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
{
MessagingEvent
evt
=
t
.
getEvent();
//
It's always of type OutputMessagingEvent
OutputMessagingEvent
outEvent
=
(
OutputMessagingEvent
) evt;
outEvent
.
getChannel()
$ls
"
:
'
.*-> \(.*\)$
'
`
if
expr
"
$link
"
:
'
/.*
'
>
/dev/null
;
false
);
verifyNoPublishIsReceived(channel);
}
@Test
public
void
testClientSubscribeWithoutCleanSession
() {
subscribe(
AT_MOST_ONCE
,
"
foo
"
, connection);
connection
.
−0
broker/src/main/java/io/moquette/persistence/H2QueueRepository.java
+3
−1
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
+3
−1
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
+3
−2
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
+3
−2
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
+3
−1
);
@@ -53,7 +55,7 @@ public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
Subscription
>
matchedSubscriptions
=
subscriptions
.
matchWithoutQosSharpening(
new
Topic
(topic));
assertEquals(
1
, matchedSubscriptions
.
size());
final
Subscription
onlyMatchedSubscription
=
sessionQueue
=
queues
.
computeIfAbsent(clientId, (
String
cli)
-
>
queueRepository
.
createQueue(cli, clean));
final
Session
newSession;
if
(msg
.
if (authorizatorPolicy == null) {
//
authorizatorPolicy = new PermitAllAuthorizatorPolicy();
//
}
//
return authorizatorPolicy;
LOG
.
debug(
"
Configuring MQTT authorizator policy
"
);
String
authorizatorClassName
=
props
.
project(
'
:moquette-distribution
'
)
.
projectDir
=
"
$r
ootDir
/distribution
"
as
File
project(
'
:moquette-embedded-test
,
AT_MOST_ONCE
);
}
@Test
public
void
testSubscribeWithBadFormattedTopic
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
assertEquals(
"
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
/
src
/
main
/
java
/
io
/
moquette
/
BrokerConstants.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
L
Copy path
Cannot retrieve contributors at this time
38 lines (28 sloc)
2.04 KB
Raw
Blame
description
=
'
Moquette - broker
'
dependencies
{
compile
group
:
'
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
'
,
name
:
'
netty-handler
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
.
incrementAndGet();
drainQueueToConnection();
//
TODO notify the interceptor
//
final InterceptAcknowledgedMessage interceptAckMsg = new InterceptAcknowledgedMessage(inflightMsg,
//
topic, username, messageID);
//
m_interceptor.notifyMessageAcknowledged(interceptAckMsg);
}
public
void
sendPublishOnSessionAtQos
(
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
=
createMQTTConnection(config);
channel
=
(
EmbeddedChannel
) sut
.
channel;
//
Exercise
sut
.
processConnect(msg);
//
Verify
assertEqualsConnAck(
Unified
Split
Showing
15 changed files
with
12 additions
and
1,476 deletions
.
+12
−11
gradle/test.gradle
+0
−17
perf/build.gradle
+0
−150
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
false
)
.topicName(
NEWS_TOPIC
)
.
build());
ConnectionTestUtils
.
verifyNoPublishIsReceived(anotherChannel);
}
@Test
public
void
avoidMultipleNotificationsAfterMultipleReconnection_cleanSessionFalseQoS1
() {
final
−3
broker/src/main/java/io/moquette/broker/Server.java
+1
−3
broker/src/main/java/io/moquette/broker/Session.java
+7
−6
broker/src/main/java/io/moquette/broker/SessionRegistry.java
+5
−0
broker/src/main/java/io/moquette/persistence/H2Builder.java
+2
−1
...io/moquette/persistence/h2 → broker/src/main/java/io/moquette/persistence}/H2PersistentQueue.java
+25
−0
+1
−1
broker/src/test/java/io/moquette/integration/ServerIntegrationOpenSSLTest.java
+2
−0
broker/src/test/java/io/moquette/integration/ServerIntegrationPahoTest.java
+2
−0
broker/src/test/java/io/moquette/integration/ServerIntegrationRestartTest.java
+3
−8
broker/src/test/java/io/moquette/integration/ServerIntegrationSSLClientAuthTest.java
+3
−8
broker/src/test/java/io/moquette/integration/ServerIntegrationSSLTest.java
+1
−1
"
>
<
meta
name
="
Originator
"
content
="
Microsoft Word 9
"
>
<
link
rel
="
File-List
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
.
write(outEvent
.
getMessage());
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
then
PRG=
"
$link
"
else
PRG=
`
dirname
"
$PRG
"
`
"
/
$link
"
fi
done
processDisconnect(
null
);
assertEquals(
1
, subscriptions
.
size());
MQTTConnection
anotherConn
=
createMQTTConnection(
CONFIG
);
MqttConnectMessage
connectMessage
=
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
+3
−1
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
+3
−1
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
+1
−1
...oquette/persistence/h2 → broker/src/test/java/io/moquette/persistence}/H2PersistentQueueTest.java
+0
−2
distribution/build.gradle
+0
−9
h2_storage/build.gradle
+0
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
BytesMetrics
metrics
matchedSubscriptions
.
iterator()
.
next();
assertEquals(expectedSubscription, onlyMatchedSubscription);
}
@Test
public
void
testPublishToMultipleSubscribers
() {
final
Set<
String
>
clientIds
variableHeader()
.
isWillFlag()) {
final
Session
.
Will
will
=
createWill(msg);
newSession
=
new
Session
(clientId, clean, will, sessionQueue);
}
else
{
newSession
=
getProperty(
BrokerConstants
.
AUTHORIZATOR_CLASS_NAME
,
"
"
);
if
(authorizatorPolicy
==
null
&&
!
authorizatorClassName
.
isEmpty()) {
authorizatorPolicy
'
)
.
projectDir
=
"
$r
ootDir
/embedding_moquette
"
as
File
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
After CONNECT subscription MUST be empty
"
,
0
, subscriptions
.
size());
//
Exercise
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(
AT_MOST_ONCE
,
BAD_FORMATTED_TOPIC
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Pull requests
Actions
Projects
Wiki
Security
Insights
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
83 lines (74 sloc)
4.63 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
io.netty
'
,
name
:
'
netty-common
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
:
'
netty-codec
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Topic
topic
,
MqttQoS
qos
,
ByteBuf
payload
) {
switch
(qos) {
case
AT_MOST_ONCE
:
if
(connected()) {
mqttConnection
.
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
CONNECTION_REFUSED_BAD_USER_NAME_OR_PASSWORD
, channel
.
readOutbound());
assertFalse(
"
Connection must be closed by the broker
"
, channel
.
+0
−169
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
+0
−210
perf/src/main/java/io/moquette/parser/netty/performance/LoopMQTTHandler.java
+0
−94
perf/src/main/java/io/moquette/parser/netty/performance/NettyPublishReceiverHandler.java
MqttConnectMessage
notCleanConnect
=
ConnectionTestUtils
.
buildConnectNotClean(
FAKE_CLIENT_ID
);
connect(connection, notCleanConnect);
subscribe(connection,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
connection
broker/src/main/java/io/moquette/persistence/H2QueueRepository.java
+3
−1
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
+3
−1
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
+3
−2
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
+3
−2
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
+3
−1
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
distribution/build.gradle
+0
−10
mapdb_storage/build.gradle
+0
−85
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBMessagesStore.java
+0
−126
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBPersistentStore.java
+0
−321
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBSessionsStore.java
+0
−108
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBPersistentStoreTest.java
+0
−121
"
href
="
http://www.eclipse.org/legal/Eclipse%20EPL%202003_11_10%20Final_files/filelist.xml
"
>
<
title
>
Eclipse Public License - Version 1.0 / Apache License - Version 2.0
</
title
>
<!--[if gte mso 9]><xml>
<o:DocumentProperties>
<o:Revision>2</o:Revision>
<o:TotalTime>3</o:TotalTime>
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
SAVED=
"
`
pwd
`
"
cd
"
`
dirname
\"
$PRG
\"
`
/
"
MqttMessageBuilders
.
connect()
.clientId(
FAKE_CLIENT_ID
)
.cleanSession(
false
)
.build();
anotherConn
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted((
−58
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
+0
−119
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+0
−2
settings.gradle
2
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -33,7 +33,7 @@ dependencies {
testCompile
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
get();
BytesMetrics
metrics
=
ctx
.
channel()
.
=
new
HashSet<>
(
Arrays
.
asList(
FAKE_CLIENT_ID
,
FAKE_CLIENT_ID2
));
mockAuthenticator
=
new
MockAuthenticator
(clientIds, singletonMap(
TEST_USER
,
new
Session
(clean, clientId, sessionQueue);
}
newSession
.
markConnected();
newSession
.
bind(mqttConnection);
return
newSession;
}
private
void
copySessionConfig
=
loadClass(authorizatorClassName,
IAuthorizatorPolicy
.
class,
IConfig
.
class, props);
}
if
(authorizatorPolicy
==
null
) {
String
aclFilePath
=
props
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
)
.messageId(
1
)
.build();
this
.
sut
.
subscribeClientToTopics(subscribe,
FAKE_CLIENT_ID
,
FAKE_USER_NAME
, connection);
MqttSubAckMessage
subAckMsg
=
channel
.
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Already on GitHub?
Sign in
to your account
Jump to bottom
Minor, changed header
#536
Merged
andsel
merged 1 commit into
moquette-io
:
master
from
andsel
:
fix/minor_desciption_change
Oct 1, 2020
+1
−1
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
Minor, changed header
#536
Merged
andsel
merged 1 commit into
moquette-io
:
master
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette
;
import
java.io.File
;
public
final
class
'
netty-buffer
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-transport
'
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
netty-codec-http
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-codec-mqtt
'
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
checkstyle.xml
Go to file
Go to file
T
sendPublishNotRetainedQos0(topic, qos, payload);
}
break
;
case
AT_LEAST_ONCE
:
sendPublishQos1(topic, qos, payload);
break
;
case
EXACTLY_ONCE
:
sendPublishQos2(topic, qos, payload);
break
;
case
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
checkstyle: resource folders excluded form check
Loading branch information
Andreas Mager
committed
Feb 1, 2017
1 parent
99fea68
commit
e2aa30d13975441966c1319dcc316266f5121eec
Unified
isOpen());
}
@Test
public
void
prohibitAnonymousClient_providingUsername
() {
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.username(
TEST_USER
+
+0
−187
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolDecodingServer.java
+0
−123
perf/src/main/java/io/moquette/parser/netty/performance/ProtocolPublishDecodingServer.java
+0
−108
perf/src/main/java/io/moquette/parser/netty/performance/PublishBomber.java
+0
−81
perf/src/main/java/io/moquette/parser/netty/performance/PublishReceiverHandler.java
+0
−100
perf/src/main/java/io/moquette/performance/clients/mqttbee/BeeBenchmarker.java
+0
−56
.
processDisconnect(
null
);
//
connect on another channel
final
String
firstPayload
=
"
Hello MQTT 1
"
;
connectPublishDisconnectFromAnotherClient(firstPayload,
NEWS_TOPIC
+3
−1
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
+3
−1
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
+1
−1
...oquette/persistence/h2 → broker/src/test/java/io/moquette/persistence}/H2PersistentQueueTest.java
+0
−2
distribution/build.gradle
+0
−9
h2_storage/build.gradle
+0
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBSessionsStoreTest.java
1
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -33,6 +33,7 @@ dependencies {
testCompile
group
:
'
org.fusesource.mqtt-client
'
,
name
:
'
<o:Created>2004-03-05T23:03:00Z</o:Created>
<o:LastSaved>2004-03-05T23:03:00Z</o:LastSaved>
<o:Pages>4</o:Pages>
<o:Words>1626</o:Words>
<o:Characters>9270</o:Characters>
<o:Lines>77</o:Lines>
<o:Paragraphs>18</o:Paragraphs>
<o:CharactersWithSpaces>11384</o:CharactersWithSpaces>
<o:Version>9.4402</o:Version>
</o:DocumentProperties>
</xml><![endif]-->
<!--[if gte mso 9]><xml>
<w:WordDocument>
<w:TrackRevisions/>
</w:WordDocument>
</xml><![endif]-->
<
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
>
/dev/null
APP_HOME=
"
`
pwd -P
`
"
cd
"
$SAVED
"
>
/dev/null
APP_NAME=
"
Gradle
"
EmbeddedChannel
) anotherConn
.
channel);
assertEquals(
1
, subscriptions
.
size());
internalPublishTo(
"
foo
"
,
MqttQoS
.
AT_MOST_ONCE
,
false
group
:
'
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
'
,
version
:
'
1.12
'
attr(
ATTR_KEY_METRICS
)
.
get();
metrics
.
incrementWrote(((
ByteBuf
) msg)
.
writableBytes());
metrics
.
incrementWrote(((
ByteBuf
) msg)
.
TEST_PWD
));
EmbeddedChannel
channel1
=
new
EmbeddedChannel
();
MQTTConnection
connection1
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, channel1);
connection1
.
processConnect(
ConnectionTestUtils
(
MqttConnectMessage
msg
,
Session
session
) {
final
boolean
clean
=
msg
.
variableHeader()
.
isCleanSession();
final
Session
.
.
getProperty(
BrokerConstants
.
ACL_FILE_PROPERTY_NAME
,
"
"
);
if
(aclFilePath
!=
null
&&
!
aclFilePath
.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
readOutbound();
assertEquals(
"
Bad topic CAN'T add any subscription
"
,
0
, subscriptions
.
size());
verifyFailureQos(subAckMsg);
}
@Test
public
void
testCleanSession_maintainClientSubscriptions
() {
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Conversation
0
Commits
1
Checks
0
Files changed
1
Merged
Minor, changed header
#536
Changes from
all commits
Commits
Show all changes
1 commit
Select commit
b6e5fa7
from
andsel
:
fix/minor_desciption_change
Oct 1, 2020
Merged
Minor, changed header
#536
andsel
merged 1 commit into
moquette-io
:
master
from
andsel
:
fix/minor_desciption_change
Oct 1, 2020
BrokerConstants
{
public
static
final
String
INTERCEPT_HANDLER_PROPERTY_NAME
=
"
intercept.handler
"
;
public
static
final
String
BROKER_INTERCEPTOR_THREAD_POOL_SIZE
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-handler
'
,
version
: nettyVersion
compile
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-transport-native-epoll
'
,
version
: nettyVersion,
Go to line
L
Copy path
Cannot retrieve contributors at this time
154 lines (151 sloc)
6.01 KB
Raw
Blame
<?
xml
version
=
"
1.0
"
encoding
=
FAILURE
:
LOG
.
error(
"
Not admissible
"
);
}
}
private
void
sendPublishQos1
(
Topic
topic
Split
Showing
3 changed files
with
10 additions
and
1 deletion
.
+8
−0
checkstyle-suppressions.xml
+1
−1
checkstyle.xml
+1
−0
pom.xml
8
"
_fake
"
)
.build();
BrokerConfiguration
config
=
new
BrokerConfiguration
(
false
,
true
,
false
);
createMQTTConnection(config);
perf/src/main/java/io/moquette/performance/clients/paho/PahoBenchmarker.java
+0
−63
perf/src/main/java/io/moquette/performance/clients/paho/SubscriberCallback.java
+0
−104
perf/src/main/java/io/moquette/spi/impl/subscriptions/PerformanceTest.java
+0
−3
settings.gradle
23
gradle/test.gradle
Show comments
View file
Edit file
Delete file
);
//
reconnect FAKE_CLIENT on another channel
EmbeddedChannel
anotherChannel2
=
new
EmbeddedChannel
();
MQTTConnection
anotherConnection2
=
createMQTTConnection(
CONFIG
, anotherChannel2);
anotherConnection2
−58
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
+0
−119
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+0
−2
settings.gradle
2
broker/build.gradle
Show comments
View file
Edit file
Delete file
@@ -33,7 +33,7 @@ dependencies {
testCompile
group
mqtt-client
'
,
version
:
'
1.12
'
testCompile
group
:
'
style
>
<!
-
-
/* Font Definitions */
@font-face
{
font-family
:Tahoma;
panose-1
:
2
11
6
4
3
5
Learn more
Accept
Reject
Save preferences
APP_BASE_NAME=
`
basename
"
$0
"
`
#
Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
DEFAULT_JVM_OPTS=
"
"
#
Use the maximum available, or set MAX_FD != -1 to use that value.
MAX_FD=
"
maximum
);
ConnectionTestUtils
.
verifyPublishIsReceived((
EmbeddedChannel
) anotherConn
.
channel,
AT_MOST_ONCE
,
PAYLOAD
);
}
private
void
subscribe
(
testCompile
group
:
'
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
'
,
version
:
'
1.12
writableBytes());
ctx
.
write(msg, promise);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
)
;
}
}
@Override
@Override
3
broker/src/main/java/io/moquette/server/netty/metrics/MQTTMessageLogger.java
.
buildConnect(
FAKE_CLIENT_ID
));
ConnectionTestUtils
.
assertConnectAccepted(channel1);
EmbeddedChannel
channel2
=
new
EmbeddedChannel
();
MQTTConnection
connection2
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
Will
will;
if
(msg
.
variableHeader()
.
isWillFlag()) {
will
=
createWill(msg);
}
else
{
will
=
null
isEmpty()) {
authorizatorPolicy
=
new
DenyAllAuthorizatorPolicy
();
try
{
LOG
.
info(
"
Parsing ACL file. Path = {}
"
, aclFilePath);
IResourceLoader
resourceLoader
=
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
assertEquals(
"
After CONNECT subscription MUST be empty
"
,
0
, subscriptions
.
size());
subscribe(channel,
NEWS_TOPIC
,
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
checkstyle-suppressions.xml
Go to file
Minor, changed header
andsel
Oct 1, 2020
File filter...
Filter file types
.md
(1)
All 1 file type selected
Filter viewed files
Hide viewed files
Clear filters
Jump to…
Jump to file
Failed to load files.
Retry
Always
Unified
Conversation
0
Commits
1
Checks
0
Files changed
Commits on Oct 1, 2020
Minor, changed header
andsel
committed
Oct 1, 2020
Loading status checks…
b6e5fa7
Add this suggestion to a batch that can be applied as a single commit.
=
"
intercept.thread_pool.size
"
;
public
static
final
String
PERSISTENT_STORE_PROPERTY_NAME
=
"
persistent_store
"
;
public
static
group
:
'
io.netty
'
,
name
:
'
netty-codec
'
,
version
: nettyVersion
compile
group
:
'
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
classifier
:
'
linux-x86_64
'
//
compile
group
:
'
com.h2database
'
,
name
:
'
h2-mvstore
'
"
UTF-8
"
?>
<!--
~ Copyright 2012 The Netty Project
~
~ The Netty Project licenses this file to you under the Apache License,
~ version 2.0 (the "License"); you may not use this file except in compliance
~ with the License. You may obtain a copy of the License at:
~
~ http://www.apache.org/licenses/LICENSE-2.0
~
~ Unless required by applicable law or agreed to in writing, software
~ distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
~ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
~ License for the specific language governing permissions and limitations
,
MqttQoS
qos
,
ByteBuf
payload
) {
if
(
!
connected()
&&
isClean()) {
//
pushing messages to disconnected not clean session
return
;
}
if
checkstyle-suppressions.xml
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,8 @@
<?
xml
version
=
"
1.0
"
?>
<!
DOCTYPE
suppressions
//
Exercise
sut
.
processConnect(msg);
//
Verify
assertEqualsConnAck(
CONNECTION_REFUSED_BAD_USER_NAME_OR_PASSWORD
, channel
.
readOutbound());
assertFalse(
"
Connection should be closed by the broker.
"
, channel
.
@@ -6,8 +6,8 @@ test {
class
OutputReporter
implements
TestListener
,
TestOutputListener
{
private
StringBuilder
stdout
=
new
StringBuilder
()
;
private
StringBuilder
stderr
.
processConnect(notCleanConnect);
ConnectionTestUtils
.
assertConnectAccepted(anotherChannel2);
ConnectionTestUtils
.
verifyPublishIsReceived(anotherChannel2,
MqttQoS
.
AT_LEAST_ONCE
, firstPayload);
anotherConnection2
.
processDisconnect(
null
);
:
'
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
'
,
version
:
'
1.12
'
testCompile
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.2.0
'
testCompile
group
:
'
org.eclipse.jetty.websocket
4
4
2
4
;
mso-font-charset
:
0
;
mso-generic-font-family
:swiss;
mso-font-pitch
:variable;
mso-font-signature
:
553679495
-2147483648
8
0
"
warn
() {
echo
"
$*
"
}
die
() {
echo
echo
"
$*
"
echo
exit
1
MqttQoS
topic
,
String
newsTopic
,
MQTTConnection
connection
) {
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(topic, newsTopic)
.messageId(
1
'
testCompile
group
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.2.0
Show comments
View file
Edit file
Delete file
@@ -28,6 +28,7 @@
import
java.util.List
;
import
java.util.List
;
import static
io.moquette.spi.impl.Utils.messageId
;
import static
io.moquette.spi.impl.Utils.messageId
;
, channel2);
connection2
.
processConnect(
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID2
));
ConnectionTestUtils
.
assertConnectAccepted(channel2);
//
subscribe
final
MqttQoS
qos
;
}
session
.
update(clean, will);
}
private
Session
.
Will
createWill
(
MqttConnectMessage
msg
) {
final
ByteBuf
props
.
getResourceLoader();
authorizatorPolicy
=
ACLFileParser
.
parse(resourceLoader
.
loadResource(aclFilePath));
}
catch
(
ParseException
pex) {
LOG
.
AT_MOST_ONCE
);
assertEquals(
"
Subscribe MUST contain one subscription
"
,
1
, subscriptions
.
size());
connection
.
processDisconnect(
null
);
assertEquals(
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
8 lines (7 sloc)
260 Bytes
Raw
Blame
<?
xml
version
=
"
1.0
"
Split
Just for now
Hide whitespace changes
Apply and reload
2
README.md
Show comments
View file
Edit file
Delete file
Open in desktop
@@ -1,5 +1,5 @@
##
What is
Moquette
?
##
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
final
String
AUTOSAVE_INTERVAL_PROPERTY_NAME
=
"
autosave_interval
"
;
public
static
final
String
PASSWORD_FILE_PROPERTY_NAME
=
"
password_file
"
;
public
io.netty
'
,
name
:
'
netty-codec-http
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Update about.html
Loading branch information
andsel
committed
Apr 16, 2018
,
version
:
'
1.4.192
'
compile
group
:
'
~ under the License.
-->
<!
DOCTYPE
module
PUBLIC
"-//Puppy Crawl//DTD Check Configuration 1.2//EN"
"http://www.puppycrawl.com/dtds/configuration_1_2.dtd">
<
module
name
=
(canSkipQueue()) {
inflightSlots
.
decrementAndGet();
int
packetId
=
mqttConnection
.
nextPacketId();
inflightWindow
.
put(packetId,
new
SessionRegistry
PUBLIC
"-//Puppy Crawl//DTD Suppressions 1.0//EN"
"http://www.puppycrawl.com/dtds/suppressions_1_0.dtd">
<
suppressions
>
<
suppress
checks
=
"
[a-zA-Z0-9]*
"
files
=
"
.*/resources/.*
"
isOpen());
}
@Test
public
void
testZeroByteClientIdNotAllowed
() {
BrokerConfiguration
config
=
new
BrokerConfiguration
=
new
StringBuilder
()
;
private
StringBuilder
stdout
=
new
StringBuilder
()
private
StringBuilder
stderr
=
new
StringBuilder
final
String
secondPayload
=
"
Hello MQTT 2
"
;
connectPublishDisconnectFromAnotherClient(secondPayload,
NEWS_TOPIC
);
EmbeddedChannel
anotherChannel3
=
new
EmbeddedChannel
();
group
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.2.0
'
testCompile
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
com.h2database
'
66047
0
;}
/* Style Definitions */
p
.
MsoNormal
,
li
.
MsoNormal
,
div
.
MsoNormal
{
mso-style-parent
}
#
OS specific support (must be 'true' or 'false').
cygwin=false
msys=false
darwin=false
nonstop=false
case
"
`
uname
`
"
in
CYGWIN
*
)
cygwin=true
)
.build();
sut
.
subscribeClientToTopics(subscribe, connection
.
getClientId(),
null
,
this
.
connection);
MqttSubAckMessage
subAck
=
((
EmbeddedChannel
'
testCompile
group
:
'
org.eclipse.paho
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.2.0
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
/**
/**
*
*
@@ -100,6 +101,6 @@ public void channelInactive(ChannelHandlerContext ctx) throws Exception {
@Override
@Override
public
void
write
(
ChannelHandlerContext
ctx
,
=
AT_MOST_ONCE
;
final
String
newsTopic
=
NEWS_TOPIC
;
subscribe(qos, newsTopic, connection1);
subscribe(qos, newsTopic, connection2);
//
Exercise
final
ByteBuf
payload
=
Unpooled
.
willPayload
=
Unpooled
.
copiedBuffer(msg
.
payload()
.
willMessageInBytes());
final
String
willTopic
=
msg
.
payload()
.
willTopic();
error(
"
Unable to parse ACL file. path=
"
+
aclFilePath, pex);
}
}
else
{
authorizatorPolicy
=
new
PermitAllAuthorizatorPolicy
();
}
LOG
.
"
Disconnection MUSTN'T clear subscriptions
"
,
1
, subscriptions
.
size());
EmbeddedChannel
anotherChannel
=
new
EmbeddedChannel
();
MQTTConnection
anotherConn
=
createMQTTConnection(
?>
<!
DOCTYPE
suppressions
PUBLIC
"-//Puppy Crawl//DTD Suppressions 1.0//EN"
"http://www.puppycrawl.com/dtds/suppressions_1_0.dtd">
<
suppressions
>
<
suppress
checks
=
"
[a-zA-Z0-9]*
"
files
Moquette
Project
[![
Build Status
](https://api.travis-ci.org/moquette-io/moquette.svg?branch=master)](https://travis-ci.org/moquette-io/moquette)
Toggle all file notes
ProTip!
Use
n
and
p
to navigate between commits in a pull request.
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
static
final
String
PORT_PROPERTY_NAME
=
"
port
"
;
public
static
final
String
HOST_PROPERTY_NAME
=
"
host
:
'
netty-codec-mqtt
'
,
version
: nettyVersion
compile
group
:
'
io.netty
'
,
name
:
'
netty-transport-native-epoll
'
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
4307a90
commit
1a6dd8a259e64b4153b35e458dca642df634ca8b
Unified
Split
Showing
1 changed file
with
2 additions
and
com.zaxxer
'
,
name
:
'
HikariCP
'
,
version
:
'
2.4.7
'
compile
group
:
'
"
Checker
"
>
<
property
name
=
"
severity
"
value
=
"
warning
"
/>
<!--
.
PublishedMessage
(topic, qos, payload));
inflightTimeouts
.
add(
new
InFlightPacket
(packetId,
FLIGHT_BEFORE_RESEND_MS
));
MqttPublishMessage
publishMsg
=
MQTTConnection
.
notRetainedPublishWithMessageId(topic
.
/>
</
suppressions
>
2
checkstyle.xml
Show comments
View file
Edit file
Delete file
@@ -22,7 +22,7 @@
<!--
<module name="SuppressionFilter">
<property name="file" value="
/io/netty/
suppressions.xml" />
(
false
,
false
,
false
);
sut
=
createMQTTConnection(config);
channel
=
(
EmbeddedChannel
) sut
.
channel;
//
Connect message with clean session set to true and client id is null.
MqttConnectMessage
()
@Override
void
beforeSuite
(
TestDescriptor
suite
) {
@@ -22,8 +22,8 @@ class OutputReporter implements TestListener, TestOutputListener {
@Override
void
beforeTest
(
TestDescriptor
testDescriptor
) {
if
(
!
MQTTConnection
anotherConnection3
=
createMQTTConnection(
CONFIG
, anotherChannel3);
anotherConnection3
.
processConnect(notCleanConnect);
ConnectionTestUtils
.
assertConnectAccepted(anotherChannel3);
ConnectionTestUtils
.
verifyPublishIsReceived(anotherChannel3,
MqttQoS
.
AT_LEAST_ONCE
, secondPayload);
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
,
name
:
'
h2
'
,
version
:
'
1.4.191
'
testRuntime
group
:
'
io.netty
'
:
""
;
margin
:
0
in
;
margin-bottom
:
.0001
pt
;
mso-pagination
:widow-orphan;
font-size
:
12.0
pt
;
;;
Darwin
*
)
darwin=true
;;
MINGW
*
)
msys=true
;;
NONSTOP
*
)
nonstop=true
;;
esac
CLASSPATH=
$APP_HOME
)
this
.
connection
.
channel)
.
readOutbound();
assertEquals(topic
.
value(), (
int
) subAck
.
payload()
.
grantedQoSLevels()
.
get(
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
,
FAKE_CLIENT_ID
final
boolean
retained
=
msg
.
variableHeader()
.
isWillRetain();
final
MqttQoS
qos
=
MqttQoS
.
valueOf(msg
.
variableHeader()
.
info(
"
Authorizator policy {} instance will be used
"
, authorizatorPolicy
.
getClass()
.
getName());
}
return
authorizatorPolicy;
}
private
IAuthenticator
initializeAuthenticator
(
IAuthenticator
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, anotherChannel);
anotherConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID
));
ConnectionTestUtils
.
assertConnectAccepted(anotherChannel);
assertEquals(
"
After a reconnect, subscription MUST be still present
"
,
1
=
"
.*/resources/.*
"
/>
</
suppressions
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
"
;
public
static
final
String
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
=
"
moquette_store.mapdb
"
;
public
static
final
String
DEFAULT_PERSISTENT_PATH
,
version
: nettyVersion,
classifier
:
'
linux-x86_64
'
//
compile
group
:
'
com.zaxxer
'
,
name
:
3 deletions
.
+2
−3
about.html
5
about.html
Show comments
View file
Edit file
Delete file
@@ -11,13 +11,12 @@ <h2>About Moquette MQT broker</h2>
<
p
>
June 11, 2014
io.dropwizard.metrics
'
,
name
:
'
metrics-core
'
,
version
:
'
3.2.2
'
compile
group
:
'
io.dropwizard.metrics
<module name="SuppressionFilter">
<property name="file" value="checkstyle-suppressions.xml" />
</module>
<module name="io.netty.build.checkstyle.SuppressionFilter">
<property name="pattern" value="((LocalTime|WorldClock)Protocol|LinkedTransferQueue|Version|jzlib/.*|chmv8/.*|com/sun/nio/sctp/.*)\.java" />
</module>
-->
<
module
name
=
"
toString(), qos,
payload, packetId);
mqttConnection
.
sendPublish(publishMsg);
//
TODO drainQueueToConnection();?
}
else
{
final
SessionRegistry
.
PublishedMessage
msg
=
new
SessionRegistry
.
PublishedMessage
<property name="file" value="
checkstyle-
suppressions.xml" />
</module>
<module name="io.netty.build.checkstyle.SuppressionFilter">
<property name="pattern" value="((LocalTime|WorldClock)Protocol|LinkedTransferQueue|Version|jzlib/.*|chmv8/.*|com/sun/nio/sctp/.*)\.java" />
1
pom.xml
Show comments
View file
Edit file
Delete file
@@ -138,6 +138,7 @@
<
version
>2.17</
version
msg
=
connMsg
.
clientId(
null
)
.protocolVersion(
MqttVersion
.
MQTT_3_1_1
)
.cleanSession(
true
)
.build();
sut
.
testDescriptor
.
isComposite()) {
stdout
.
setLength(
0
)
;
stderr
.
setLength(
0
)
;
stdout
.
setLength(
}
private
void
connectPublishDisconnectFromAnotherClient
(
String
firstPayload
,
String
topic
) {
MQTTConnection
anotherConnection
=
connectNotCleanAs(
PUBLISHER_ID
);
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
1.4.
191
'
testCompile
,
name
:
'
netty-tcnative
'
,
version
:
'
2.0.10.Final
'
,
classifier
:
'
linux-x86_64
'
font-family
:
"Times New Roman"
;
mso-fareast-font-family
:
"Times New Roman"
;}
p
{
margin-right
:
0
in
;
mso-margin-top-alt
:auto;
/gradle/wrapper/gradle-wrapper.jar
#
Determine the Java command to use to start the JVM.
if
[
-n
"
$JAVA_HOME
"
]
;
then
if
[
-x
"
$JAVA_HOME
/jre/sh/java
0
));
}
protected
void
subscribe
(
MQTTConnection
connection
,
String
topic
,
MqttQoS
desiredQos
) {
EmbeddedChannel
channel
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
,
ChannelPromise
promise
)
throws
Exception
{
logMQTTMessage(ctx, msg,
"
C<-B
"
);
logMQTTMessage(ctx, msg,
"
C<-B
"
);
ctx
.
, payload,
false
,
MqttMessageBuilders
.
publish()
.payload(payload
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
willQos());
return
new
Session
.
Will
(willTopic, willPayload, qos, retained);
}
Session
retrieve
(
String
clientID
) {
return
pool
.
get(clientID);
authenticator
,
IConfig
props
) {
//
if (authenticator == null) {
//
authenticator = new AcceptAllAuthenticator();
//
}
//
return authenticator;
LOG
.
debug(
, subscriptions
.
size());
final
ByteBuf
payload
=
Unpooled
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
=
System
.
getProperty(
"
user.dir
"
)
+
File
.
separator
+
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
;
public
static
final
'
HikariCP
'
,
version
:
'
2.4.7
'
compile
group
:
'
io.dropwizard.metrics
'
,
name
</
p
>
<
h3
>
License
</
h3
>
<
p
>
The Eclipse Foundation makes available all content in this plug-in (&quot;Moquette MQTT&quot;). Unless otherwise
indicated below, the Content is provided to you under the terms and conditions of the
<
'
,
name
:
'
metrics-jvm
'
,
version
:
'
3.2.2
'
compile
group
:
'
com.librato.metrics
FileTabCharacter
"
/>
<!--
<module name="JavadocPackage"/>
-->
<
module
name
=
"
NewlineAtEndOfFile
"
>
<
property
name
=
(topic, qos, payload);
sessionQueue
.
add(msg);
}
}
private
void
sendPublishQos2
(
Topic
topic
,
MqttQoS
qos
,
ByteBuf
payload
>
<
configuration
>
<
configLocation
>checkstyle.xml</
configLocation
>
<
suppressionsLocation
>checkstyle-suppressions.xml</
suppressionsLocation
>
<!--
<configLocation>/google_checks.xml</configLocation>
-->
Toggle all file notes
processConnect(msg);
assertEqualsConnAck(
"
Zero byte client identifiers are not allowed
"
,
CONNECTION_REFUSED_IDENTIFIER_REJECTED
, channel
.
readOutbound());
assertFalse(
"
Connection must closed
"
, channel
.
isOpen());
}
0
)
stderr
.
setLength(
0
)
}
}
@@ -50,13 +50,14 @@ class OutputReporter implements TestListener, TestOutputListener {
@Override
void
onOutput
(
TestDescriptor
testDescriptor
//
publish from another channel
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(firstPayload,
Charset
.
defaultCharset());
sut
.
receivedPublishQos1(anotherConnection,
new
Topic
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
1.4.
192
'
testRuntime
group
}
4
broker/src/main/java/io/moquette/BrokerConstants.java
Show comments
View file
Edit file
Delete file
@@ -27,9 +27,9 @@
public
static
final
String
PASSWORD_FILE_PROPERTY_NAME
=
"
password_file
"
mso-margin-bottom-alt
:auto;
margin-left
:
0
in
;
mso-pagination
:widow-orphan;
font-size
:
12.0
pt
;
font-family
:
"Times New Roman"
;
"
]
;
then
#
IBM's JDK on AIX uses strange locations for the executables
JAVACMD=
"
$JAVA_HOME
/jre/sh/java
"
else
JAVACMD=
"
$JAVA_HOME
/bin/java
"
=
(
EmbeddedChannel
) connection
.
channel;
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(desiredQos, topic)
.messageId(
1
)
.build();
9.2.0.M1
'
testCompile
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
1.4.
write(msg, promise);
ctx
.
write(msg, promise)
.
addListener(
CLOSE_ON_FAILURE
)
;
}
}
}
}
4
broker/src/main/java/io/moquette/server/netty/metrics/MessageMetricsHandler.java
Show comments
View file
NEWS_TOPIC
)
.
build());
//
Verify
ConnectionTestUtils
.
verifyReceivePublish(channel1,
NEWS_TOPIC
,
"
Hello world!
"
);
ConnectionTestUtils
.
verifyReceivePublish(channel2,
}
public
void
remove
(
String
clientID
) {
pool
.
remove(clientID);
}
public
void
disconnect
(
String
clientID
"
Configuring MQTT authenticator
"
);
String
authenticatorClassName
=
props
.
getProperty(
BrokerConstants
.
AUTHENTICATOR_CLASS_NAME
,
"
"
);
if
(authenticator
==
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
,
TEST_PWD
, payload,
false
,
MqttMessageBuilders
.
publish()
.payload(payload
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
String
WEB_SOCKET_PORT_PROPERTY_NAME
=
"
websocket_port
"
;
public
static
final
String
WSS_PORT_PROPERTY_NAME
=
"
secure_websocket_port
"
;
/**
:
'
metrics-core
'
,
version
:
'
3.2.2
'
compile
group
:
'
io.dropwizard.metrics
'
,
name
p
>
The Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
'
,
name
:
'
metrics-librato
'
,
version
:
'
5.1.0
'
compile
group
:
'
com.librato.metrics
'
"
lineSeparator
"
value
=
"
lf
"
/>
</
module
>
<!--
Copyright headers
) {
if
(canSkipQueue()) {
inflightSlots
.
decrementAndGet();
int
packetId
=
mqttConnection
.
nextPacketId();
inflightWindow
.
put(packetId,
new
SessionRegistry
.
0 comments on commit
e2aa30d
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
@Test
public
void
testZeroByteClientIdWithoutCleanSession
() {
//
Allow zero byte client ids
//
Connect message without clean session set to true but client id is still null
MqttConnectMessage
msg
=
MqttMessageBuilders
.
connect()
,
TestOutputEvent
outputEvent
) {
if
(
!
testDescriptor
.
isComposite()) {
def
(topic),
TEST_USER
, anyPayload,
1
,
false
,
MqttMessageBuilders
.
publish()
.payload(
Unpooled
.
:
'
io.netty
'
,
name
:
'
netty-tcnative
'
,
version
:
'
2.0.10.Final
'
;
public
static
final
String
PORT_PROPERTY_NAME
=
"
port
"
;
public
static
final
String
HOST_PROPERTY_NAME
=
"
mso-fareast-font-family
:
"Times New Roman"
;}
p
.
BalloonText
,
li
.
BalloonText
,
div
.
BalloonText
{
mso-style-name
:
"Balloon Text"
fi
if
[
!
-x
"
$JAVACMD
"
]
;
then
die
"
ERROR: JAVA_HOME is set to an invalid directory:
$JAVA_HOME
Please set the JAVA_HOME variable in your environment to match the
location of your Java installation.
"
sut
.
subscribeClientToTopics(subscribe, connection
.
getClientId(),
null
, connection);
MqttSubAckMessage
subAck
=
channel
.
readOutbound();
assertEquals(desiredQos
.
191
'
testCompile
group
:
'
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
Edit file
Delete file
@@ -23,6 +23,8 @@
import
io.netty.util.Attribute
;
import
io.netty.util.Attribute
;
import
io.netty.util.AttributeKey
;
import
io.netty.util.AttributeKey
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
NEWS_TOPIC
,
"
Hello world!
"
);
}
@Test
public
void
testPublishWithEmptyPayloadClearRetainedStore
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
) {
final
Session
session
=
retrieve(clientID);
if
(session
==
null
) {
LOG
.
debug(
"
Some other thread already removed the session CId={}
"
, clientID);
return
null
&&
!
authenticatorClassName
.
isEmpty()) {
authenticator
=
loadClass(authenticatorClassName,
IAuthenticator
.
class,
IConfig
.
class, props);
}
IResourceLoader
resourceLoader
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
ConnectionTestUtils
.
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
* Defines the SSL implementation to use, default to "JDK".
*
@see
io.netty.handler.ssl.SslProvider#name()
*/
public
static
final
String
SSL_PROVIDER
=
"
ssl_provider
"
;
public
static
:
'
metrics-jvm
'
,
version
:
'
3.2.2
'
compile
group
:
'
com.librato.metrics
'
,
name
:
p
>
<
p
>
If you did not receive this Content directly from the Eclipse Foundation, the
Content is
<
p
>
The
Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
Toggle all file notes
0 comments on commit
,
name
:
'
librato-java
'
,
version
:
'
2.1.0
'
compile
group
:
'
com.bugsnag
-->
<
module
name
=
"
RegexpSingleline
"
>
<
property
name
=
"
format
"
PublishedMessage
(topic, qos, payload));
inflightTimeouts
.
add(
new
InFlightPacket
(packetId,
FLIGHT_BEFORE_RESEND_MS
));
MqttPublishMessage
publishMsg
=
MQTTConnection
.
notRetainedPublishWithMessageId(topic
.
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
.
clientId(
null
)
.
protocolVersion(
MqttVersion
.
MQTT_3_1_1
)
.build();
sut
.
processConnect(msg);
assertEqualsConnAck(
"
Identifier must be rejected due to having clean session set to false
"
buffer
=
(outputEvent
.
getDestination()
==
TestOutputEvent.Destination.StdOut
)
?
stdout
:
stderr;
buffer
.
append(outputEvent
.
getMessage());
if
copiedBuffer(firstPayload,
Charset
.
defaultCharset()))
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
.retained(
false
)
.topicName(topic)
.
build());
//
disconnect the other channel
,
classifier
:
'
linux-x86_64
'
}
8
broker/src/main/java/io/moquette/broker/IQueueRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,8 @@
package
io.moquette.broker
;
host
"
;
public
static
final
String
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
=
"
moquette_store.
mapdb
"
;
public
static
final
String
DEFAULT_MOQUETTE_STORE_H2_DB_FILENAME
;
margin
:
0
in
;
margin-bottom
:
.0001
pt
;
mso-pagination
:widow-orphan;
font-size
:
8.0
pt
;
fi
else
JAVACMD=
"
java
"
which java
>
/dev/null
2>&1
||
die
"
ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.
Please set the JAVA_HOME variable in your environment to match the
location of your Java installation.
"
fi
#
value(), (
int
) subAck
.
payload()
.
grantedQoSLevels()
.
get(
0
));
final
String
clientId
=
connection
.
getClientId();
1.4.
192
'
testRuntime
group
:
'
io.netty
'
,
name
:
'
netty-tcnative
'
,
version
;
public
class
MessageMetricsHandler
extends
ChannelDuplexHandler
{
public
class
MessageMetricsHandler
extends
ChannelDuplexHandler
{
private
static
final
this
.
retainedRepository
.
retain(
new
Topic
(
NEWS_TOPIC
),
MqttMessageBuilders
.
publish()
.payload(
ByteBufUtil
.
writeAscii(
;
}
session
.
disconnect();
}
private
void
dropQueuesForClient
(
String
clientId
) {
queues
.
remove(clientId);
}
}
=
props
.
getResourceLoader();
if
(authenticator
==
null
) {
String
passwdPath
=
props
.
getProperty(
BrokerConstants
.
PASSWORD_FILE_PROPERTY_NAME
,
verifyPublishIsReceived(anotherChannel,
AT_MOST_ONCE
,
"
Hello world!
"
);
}
/**
* Check that after a client has connected with clean session false, subscribed to some topic
* and exited, if it reconnects with clean session true, the broker correctly cleanup every
* previous subscription
*/
@Test
public
void
testCleanSession_correctlyClientSubscriptions
() {
final
String
SSL_PORT_PROPERTY_NAME
=
"
ssl_port
"
;
public
static
final
String
JKS_PATH_PROPERTY_NAME
=
"
jks_path
"
'
metrics-librato
'
,
version
:
'
5.1.0
'
compile
group
:
'
com.librato.metrics
'
,
name
:
1a6dd8a
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
'
,
name
:
'
bugsnag
'
,
version
:
'
[3.0,4.0)
'
compile
group
:
'
commons-codec
value
=
"
^(\s|\*)*Copyright\s.*$
"
/>
<
property
name
=
"
minimum
"
value
=
"
1
"
toString(), qos,
payload, packetId);
mqttConnection
.
sendPublish(publishMsg);
drainQueueToConnection();
}
else
{
final
SessionRegistry
.
PublishedMessage
msg
=
new
SessionRegistry
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
,
CONNECTION_REFUSED_IDENTIFIER_REJECTED
, channel
.
readOutbound());
assertFalse(
"
Connection must be closed by the broker
"
, channel
.
isOpen());
}
@Test
public
void
testBindWithSameClientIDBadCredentialsDoesntDropExistingClient
(outputEvent
.
getMessage()
.
contains(
"
LEAK:
"
)) {
println
stdout
println
stderr
throw
new
RuntimeException
(
"
anotherConnection
.
processDisconnect(
null
);
}
private
MQTTConnection
connectNotCleanAs
(
String
clientId
) {
EmbeddedChannel
import
java.util.Queue
;
public
interface
IQueueRepository
{
Queue<
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
String
cli
,
=
"
moquette_store.
h2
"
;
public
static
final
String
DEFAULT_PERSISTENT_PATH
=
System
.
getProperty(
"
user.dir
"
font-family
:Tahoma;
mso-fareast-font-family
:
"Times New Roman"
;}
@page
Section1
{
size
:
8.5
in
11.0
in
;
margin
:
Increase the maximum file descriptors if we can.
if
[
"
$cygwin
"
=
"
false
"
-a
"
$darwin
"
=
"
false
"
-a
"
Subscription
expectedSubscription
=
new
Subscription
(clientId,
new
Topic
(topic), desiredQos);
final
Set<
Subscription
>
matchedSubscriptions
=
subscriptions
.
matchWithoutQosSharpening(
:
'
2.0.10.Final
'
,
classifier
:
'
linux-x86_64
'
testRuntime
group
:
'
io.netty
'
,
AttributeKey<
MessageMetrics
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
"
MessageMetrics
"
);
private
static
final
AttributeKey<
MessageMetrics
UnpooledByteBufAllocator
.
DEFAULT
,
"
Hello world!
"
))
.qos(
AT_LEAST_ONCE
)
.build());
//
Exercise
final
ByteBuf
anyPayload
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
"
"
);
if
(passwdPath
.
isEmpty()) {
authenticator
=
new
AcceptAllAuthenticator
();
}
else
{
authenticator
=
new
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
assertEquals(
"
After CONNECT subscription MUST be empty
"
,
0
, subscriptions
.
size());
//
subscribe(channel, NEWS_TOPIC, AT_MOST_ONCE);
;
/*
* @see java.security.KeyStore#getInstance(String) for allowed types, default to "jks"
*/
public
static
final
String
KEY_STORE_TYPE
=
"
key_store_type
"
;
public
static
final
'
librato-java
'
,
version
:
'
2.1.0
'
compile
group
:
'
com.bugsnag
'
,
name
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
'
,
name
:
'
commons-codec
'
,
version
:
'
1.10
'
compile
group
:
'
org.slf4j
/>
<
property
name
=
"
maximum
"
value
=
"
1
"
/>
<
property
name
.
PublishedMessage
(topic, qos, payload);
sessionQueue
.
add(msg);
}
}
private
boolean
canSkipQueue
() {
return
sessionQueue
.
isEmpty()
&&
() {
//
Connect a client1
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.username(
TEST_USER
)
.password(
TEST_PWD
)
Netty ResourceLeakDetector
"
);
}
def
buffer
=
(outputEvent
.
getDestination()
==
TestOutputEvent.Destination.StdOut
)
?
stdout
:
stderr
buffer
channel
=
new
EmbeddedChannel
();
MQTTConnection
connection
=
createMQTTConnection(
CONFIG
, channel);
connection
.
processConnect(
ConnectionTestUtils
.
buildConnectNotClean(clientId));
boolean
clean
);
}
12
broker/src/main/java/io/moquette/broker/MemoryQueueRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,12 @@
package
io.moquette.broker
;
import
java.util.Queue
)
+
File
.
separator
+
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
;
+
DEFAULT_MOQUETTE_STORE_H2_DB_FILENAME
;
public
static
final
String
WEB_SOCKET_PORT_PROPERTY_NAME
=
1.0
in
1.25
in
1.0
in
1.25
in
;
mso-header-margin
:
.5
in
;
mso-footer-margin
:
.5
$nonstop
"
=
"
false
"
]
;
then
MAX_FD_LIMIT=
`
ulimit -H -n
`
if
[
$?
-eq
0 ]
;
new
Topic
(topic));
assertEquals(
1
, matchedSubscriptions
.
size());
final
Subscription
onlyMatchedSubscription
=
matchedSubscriptions
.
iterator()
.
next();
assertEquals(expectedSubscription, onlyMatchedSubscription);
name
:
'
netty-tcnative
'
,
version
:
'
2.0.10.Final
'
,
classifier
>
ATTR_KEY_METRICS
=
AttributeKey
.
valueOf(
"
MessageMetrics
"
);
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
.
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
ResourceAuthenticator
(resourceLoader, passwdPath);
}
LOG
.
info(
"
An {} authenticator instance will be used
"
, authenticator
.
getClass()
.
getName());
}
return
authenticator;
}
final
MqttSubscribeMessage
subscribeMsg
=
MqttMessageBuilders
.subscribe()
.addSubscription(
AT_MOST_ONCE
,
NEWS_TOPIC
)
.messageId(
1
)
.build();
connection
.
String
KEY_STORE_PASSWORD_PROPERTY_NAME
=
"
key_store_password
"
;
public
static
final
String
KEY_MANAGER_PASSWORD_PROPERTY_NAME
=
"
key_manager_password
"
;
public
:
'
bugsnag
'
,
version
:
'
[3.0,4.0)
'
compile
group
:
'
commons-codec
'
,
name
:
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
'
,
name
:
'
slf4j-api
'
,
version
:
'
1.7.5
'
runtime
group
:
'
org.slf4j
'
=
"
message
"
value
=
"
missing copyright header
"
/>
</
module
>
<!--
Unmaintainable Javadoc tags
-->
<!--
module name="RegexpSingleline">
inflightSlots
.
get()
>
0
&&
connected()
&&
mqttConnection
.
channel
.
isWritable();
}
void
pubAckReceived
(
int
.build();
sut
.
processConnect(msg);
assertEqualsConnAck(
CONNECTION_ACCEPTED
, channel
.
readOutbound());
//
create another connect same clientID but with bad credentials
MqttConnectMessage
evilClientConnMsg
=
MqttMessageBuilders
.
connect()
.protocolVersion(
MqttVersion
.
append(outputEvent
.
getMessage())
//
TODO re-enable this
//
if (outputEvent.getMessage().contains("LEAK:")) {
//
println stdout
//
println stderr
//
throw new RuntimeException("Netty ResourceLeakDetector")
//
}
}
ConnectionTestUtils
.
assertConnectAccepted(channel);
return
connection;
}
private
MQTTConnection
connectAs
(
String
clientId
) {
EmbeddedChannel
channel
=
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
public
class
MemoryQueueRepository
implements
IQueueRepository
{
@Override
public
Queue<
SessionRegistry
.
EnqueuedMessage
>
"
websocket_port
"
;
public
static
final
String
WSS_PORT_PROPERTY_NAME
=
"
secure_websocket_port
"
;
9
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
in
;
mso-paper-source
:
0
;}
div
.
Section1
{
page
:Section1;}
--
>
</
style
>
</
then
if
[
"
$MAX_FD
"
=
"
maximum
"
-o
"
$MAX_FD
"
=
"
max
"
}
private
void
verifyNoPublishIsReceived
(
EmbeddedChannel
channel
) {
final
Object
messageReceived
=
channel
.
readOutbound();
assertNull(
"
Received an out message from processor while not expected
:
'
linux-x86_64
'
}
}
8
broker/src/main/java/io/moquette/broker/IQueueRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,8 @@
package
io.moquette.broker
;
@@ -52,7 +54,7 @@ public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception
public
void
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
public
void
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
,
FAKE_CLIENT_ID
, anyPayload,
true
,
MqttMessageBuilders
.
publish()
.payload(anyPayload)
.qos(
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
private
void
initInterceptors
(
IConfig
props
,
List<? extends
InterceptHandler
>
embeddedObservers
) {
LOG
.
info(
"
Configuring message interceptors...
"
processSubscribe(subscribeMsg);
assertEquals(
"
Subscribe MUST contain one subscription
"
,
1
, subscriptions
.
size());
connection
.
processDisconnect(
null
);
assertEquals(
"
Disconnection MUSTN'T clear subscriptions
static
final
String
ALLOW_ANONYMOUS_PROPERTY_NAME
=
"
allow_anonymous
"
;
public
static
final
String
ALLOW_ZERO_BYTE_CLIENT_ID_PROPERTY_NAME
=
"
allow_zero_byte_client_id
"
;
'
commons-codec
'
,
version
:
'
1.10
'
//
compile group: 'org.hdrhistogram', name: 'HdrHistogram', version:'2.1.4'
compile
group
:
'
com.hazelcast
'
,
name
,
name
:
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
//
only for local tests
testCompile
group
:
'
<property name="format" value="(@(author|version)|\(non-Javadoc\))"/>
<property name="ignoreCase" value="true"/>
<property name="message" value="unmaintainable Javadoc tags: @author, @version, or (non-Javadoc)"/>
</module
-->
<!--
IDE-generated comment
-->
<
module
name
=
"
RegexpSingleline
"
>
<
ackPacketId
) {
//
TODO remain to invoke in somehow m_interceptor.notifyMessageAcknowledged
inflightWindow
.
remove(ackPacketId);
inflightSlots
.
incrementAndGet();
drainQueueToConnection();
}
public
void
resendInflightNotAcked
() {
Collection<
InFlightPacket
.
MQTT_3_1
)
.clientId(
FAKE_CLIENT_ID
)
.username(
EVIL_TEST_USER
)
.password(
EVIL_TEST_PWD
)
.build();
EmbeddedChannel
evilChannel
=
new
}
}
17
perf/build.gradle
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
150
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkPublisher.java
Show comments
View file
Edit file
new
EmbeddedChannel
();
MQTTConnection
connection
=
createMQTTConnection(
CONFIG
, channel);
connection
.
processConnect(
ConnectionTestUtils
.
buildConnect(clientId));
ConnectionTestUtils
.
assertConnectAccepted(channel);
return
createQueue
(
String
cli
,
boolean
clean
) {
return
new
ConcurrentLinkedQueue<>
();
}
}
9
Edit file
Delete file
@@ -52,6 +52,7 @@
private
volatile
boolean
initialized;
private
PostOffice
dispatcher;
private
BrokerInterceptor
interceptor;
private
H2Builder
h2Builder;
public
head
>
<
body
style
=""
lang
="
EN-US
"
>
<
div
class
="
Section1
"
>
<
]
;
then
MAX_FD=
"
$MAX_FD_LIMIT
"
fi
ulimit
-n
$MAX_FD
if
[
$?
-ne
0 ]
;
then
warn
"
, messageReceived);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
import
java.util.Queue
;
public
interface
IQueueRepository
{
Queue<
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
String
cli
write
(
ChannelHandlerContext
ctx
,
Object
msg
,
ChannelPromise
promise
)
throws
Exception
{
MessageMetrics
metrics
=
ctx
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify
assertTrue(
"
QoS0 MUST clean retained message for topic
Accept
Reject
Save preferences
);
List<
InterceptHandler
>
observers
=
new
ArrayList<>
(embeddedObservers);
String
interceptorClassName
=
props
.
getProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
);
"
,
1
, subscriptions
.
size());
connectMessage
=
MqttMessageBuilders
.
connect()
.clientId(
FAKE_CLIENT_ID
)
.cleanSession(
true
)
.build();
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
public
static
final
String
ACL_FILE_PROPERTY_NAME
=
"
acl_file
"
;
public
static
final
String
AUTHORIZATOR_CLASS_NAME
=
"
authorizator_class
"
:
'
hazelcast
'
,
version
:
'
3.5.4
'
compile
group
:
'
org.slf4j
'
,
name
org.slf4j
'
,
name
:
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
property
name
=
"
format
"
value
=
"
File \| Settings \| File Templates
"
/>
<
property
name
=
"
message
>
expired
=
new
ArrayList<>
(
INFLIGHT_WINDOW_SIZE
);
inflightTimeouts
.
drainTo(expired);
debugLogPacketIds(expired);
for
(
InFlightPacket
notAckPacketId
:
expired) {
if
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
EmbeddedChannel
();
//
Exercise
BrokerConfiguration
config
=
new
BrokerConfiguration
(
true
,
true
,
false
);
final
MQTTConnection
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
169
perf/src/main/java/io/moquette/parser/netty/performance/BenchmarkSubscriber.java
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
connection;
}
@Test
public
void
testConnectSubPub_cycle_getTimeout_on_second_disconnect_issue142
() {
connect(connection,
FAKE_CLIENT_ID
);
subscribe(connection,
NEWS_TOPIC
,
AT_MOST_ONCE
);
//
publish on /news
final
ByteBuf
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -161,18 +161,21 @@ public void startServer(IConfig config, List<? extends InterceptHandler> handler
authorizatorPolicy
=
initializeAuthorizatorPolicy(authorizatorPolicy, config);
final
ISubscriptionsRepository
subscriptionsRepository;
final
IQueueRepository
queueRepository;
if
(persistencePath
!=
static
void
main
(
String
[]
args
)
throws
IOException
{
final
Server
server
=
new
Server
();
@@ -162,7 +163,8 @@ public void startServer(IConfig config, List<? extends InterceptHandler> handler
p
style
="
text-align: center;
"
align
="
center
"
>
<
b
>
Eclipse Public License - v 1.0
</
b
>
</
p
"
Could not set maximum file descriptor limit:
$MAX_FD
"
fi
else
warn
"
Could not query maximum file descriptor limit:
$MAX_FD_LIMIT
"
fi
fi
#
For Darwin, add options to specify how the application appears in the dock
if
$darwin
;
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
,
boolean
clean
);
}
12
broker/src/main/java/io/moquette/broker/MemoryQueueRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,12 @@
package
io.moquette.broker
;
import
java.util.Queue
;
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
get();
MessageMetrics
metrics
=
ctx
.
channel()
.
attr(
ATTR_KEY_METRICS
)
.
"
, retainedRepository
.
isEmtpy());
}
@Test
public
void
testPublishWithQoS1
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
NEWS_TOPIC
if
(interceptorClassName
!=
null
&&
!
interceptorClassName
.
isEmpty()) {
InterceptHandler
handler
=
loadClass(interceptorClassName,
InterceptHandler
.
class,
io.moquette.broker
.
Server
channel
=
new
EmbeddedChannel
();
connection
=
createMQTTConnection(
CONFIG
, channel);
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
assertEquals(
"
After CONNECT with clean, subscription MUST be empty
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
;
public
static
final
String
AUTHENTICATOR_CLASS_NAME
=
"
authenticator_class
"
;
public
static
final
String
DB_AUTHENTICATOR_DRIVER
=
"
authenticator.db.driver
:
'
slf4j-api
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
org.slf4j
'
,
name
org.fusesource.mqtt-client
'
,
name
:
'
mqtt-client
'
,
version
:
'
1.12
'
testCompile
group
:
'
org.eclipse.paho
moquette/about.html at 1a6dd8a259e64b4153b35e458dca642df634ca8b · moquette-io/moquette · GitHub
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
"
value
=
"
IDE-generated comment
"
/>
</
module
>
<!--
Force UNIX line separator
<module name="io.netty.build.checkstyle.NewlineCheck"/>
-->
<!--
Trailing whitespace
-->
(inflightWindow
.
containsKey(notAckPacketId
.
packetId)) {
final
SessionRegistry
.
PublishedMessage
msg
=
(
SessionRegistry
.
PublishedMessage
) inflightWindow
.
get(notAckPacketId
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
evilConnection
=
createMQTTConnection(config, evilChannel, postOffice);
evilConnection
.
processConnect(evilClientConnMsg);
//
Verify
//
the evil client gets a not auth notification
assertEqualsConnAck(
CONNECTION_REFUSED_BAD_USER_NAME_OR_PASSWORD
, evilChannel
.
readOutbound());
//
the good client remains connected
assertTrue(
Update about.html · moquette-io/moquette@1a6dd8a · GitHub
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
8f7b7df
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
payload
=
Unpooled
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
null
&&
!
persistencePath
.
isEmpty()) {
LOG
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
h2Builder
=
new
H2Builder
(config, scheduler);
subscriptionsRepository
final
ISubscriptionsRepository
subscriptionsRepository;
if
(persistencePath
!=
null
&&
!
persistencePath
.
isEmpty()) {
LOG
.
trace(
"
Configuring H2 subscriptions store to {}
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
THE ACCOMPANYING PROGRAM IS PROVIDED UNDER
THE TERMS OF THIS ECLIPSE PUBLIC LICENSE ("AGREEMENT"). ANY USE,
REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE
OF THIS AGREEMENT.
</
span
then
GRADLE_OPTS=
"
$GRADLE_OPTS
\"
-Xdock:name=
$APP_NAME
\"
\"
-Xdock:icon=
$APP_HOME
/media/gradle.icns
\"
"
fi
#
For Cygwin, switch paths to Windows format before running java
if
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
import
java.util.concurrent.ConcurrentLinkedQueue
;
public
class
MemoryQueueRepository
implements
IQueueRepository
{
@Override
public
Queue<
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
get();
metrics
.
incrementWrote(
1
);
metrics
.
incrementWrote(
1
);
ctx
.
write(msg, promise);
ctx
.
write(msg, promise)
.
addListener(
,
AT_LEAST_ONCE
);
//
Exercise
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
moquette/pom.xml at e2aa30d13975441966c1319dcc316266f5121eec · moquette-io/moquette · GitHub
.
class,
this
);
if
(handler
!=
null
) {
observers
.
add(handler);
}
}
interceptor
=
new
BrokerInterceptor
(props, observers);
"
,
0
, subscriptions
.
size());
//
publish on /news
final
ByteBuf
payload
=
Unpooled
.
copiedBuffer(
"
Hello world!
"
Update about.html · moquette-io/moquette@1a6dd8a · GitHub
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
"
;
public
static
final
String
DB_AUTHENTICATOR_URL
=
"
authenticator.db.url
"
;
public
static
final
String
DB_AUTHENTICATOR_QUERY
=
:
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
testCompile
group
:
'
org.fusesource.mqtt-client
'
,
name
'
,
name
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.2.0
'
testCompile
group
:
'
moquette/checkstyle-suppressions.xml at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
<
module
name
=
"
RegexpSingleline
"
>
<
property
name
=
"
format
"
value
=
.
packetId);
final
Topic
topic
=
msg
.
topic;
final
MqttQoS
qos
=
msg
.
publishingQos;
final
ByteBuf
Merge pull request #392 from AndreasMager/gradle_update · moquette-io/moquette@4307a90 · GitHub
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
"
Original connected client must remain connected
"
, channel
.
isOpen());
assertFalse(
"
Channel trying to connect with bad credentials must be closed
"
, evilChannel
.
isOpen());
}
@Test
public
void
testForceClientDisconnection_issue116
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
),
TEST_USER
,
TEST_PWD
, payload,
false
,
MqttMessageBuilders
.
publish()
.payload(payload
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
=
h2Builder
.
initStore()
.
subscriptionsRepository();
h2Builder
=
new
H2Builder
(config, scheduler)
.
initStore();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
"
, persistencePath);
subscriptionsRepository
=
new
H2Builder
(config, scheduler)
.
initStore()
.
subscriptionsRepository();
h2Builder
=
new
H2Builder
(config, scheduler);
subscriptionsRepository
=
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
1. DEFINITIONS
$cygwin
;
then
APP_HOME=
`
cygpath --path --mixed
"
$APP_HOME
"
`
CLASSPATH=
`
cygpath --path --mixed
"
$CLASSPATH
"
`
JAVACMD=
`
cygpath --unix
String
cli
,
boolean
clean
) {
return
new
ConcurrentLinkedQueue<>
();
}
}
9
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
CLOSE_ON_FAILURE
)
;
}
}
@Override
@Override
16
broker/src/main/java/io/moquette/spi/DurableSession.java
Show comments
View file
Edit file
Delete file
@@ -22,9 +22,7 @@
import
java.util.Collection
;
import
defaultCharset());
sut
.
receivedPublishQos1(connection,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
,
MqttMessageBuilders
.
publish()
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
}
@SuppressWarnings
(
"
unchecked
"
)
private
<
T
,
U
>
T
loadClass
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
,
TEST_PWD
, payload,
false
,
MqttMessageBuilders
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
authenticator.db.query
"
;
public
static
final
String
DB_AUTHENTICATOR_DIGEST
=
"
authenticator.db.digest
"
;
public
static
:
'
mqtt-client
'
,
version
:
'
1.12
'
testCompile
group
:
'
org.eclipse.paho
'
,
name
org.eclipse.jetty.websocket
'
,
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
moquette/checkstyle-suppressions.xml at e2aa30d13975441966c1319dcc316266f5121eec · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
moquette/checkstyle.xml at e2aa30d13975441966c1319dcc316266f5121eec · moquette-io/moquette · GitHub
"
\s+$
"
/>
<
property
name
=
"
message
"
value
=
"
trailing whitespace
"
/>
payload
=
msg
.
payload;
final
ByteBuf
copiedPayload
=
payload
.
retainedDuplicate();
MqttPublishMessage
publishMsg
=
publishNotRetainedDuplicated(notAckPacketId, topic, qos, copiedPayload);
mqttConnection
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
() {
MqttConnectMessage
msg
=
connMsg
.
clientId(
FAKE_CLIENT_ID
)
.username(
TEST_USER
)
.password(
TEST_PWD
)
.build();
sut
.
processConnect(msg);
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
false
)
.topicName(
NEWS_TOPIC
)
.
build());
ConnectionTestUtils
.
verifyPublishIsReceived((
EmbeddedChannel
) connection
.
channel,
AT_MOST_ONCE
,
"
Hello world!
queueRepository
=
h2Builder
.
queueRepository();
}
else
{
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
);
subscriptionsRepository
=
new
h2Builder
.
initStore()
.
subscriptionsRepository();
}
else
{
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
);
subscriptionsRepository
=
new
</
span
>
</
b
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
"
$JAVACMD
"
`
#
We build the pattern for arguments to be converted via cygpath
ROOTDIRSRAW=
`
find -L / -maxdepth 1 -mindepth 1 -type d
2>
/dev/null
`
SEP=
"
"
for
dir
in
$ROOTDIRSRAW
@@ -161,18 +161,21 @@ public void startServer(IConfig config, List<? extends InterceptHandler> handler
authorizatorPolicy
=
initializeAuthorizatorPolicy(authorizatorPolicy, config);
authorizatorPolicy
=
initializeAuthorizatorPolicy(authorizatorPolicy, config);
final
ISubscriptionsRepository
subscriptionsRepository;
final
ISubscriptionsRepository
subscriptionsRepository;
final
IQueueRepository
queueRepository;
if
java.util.Collection
;
import
java.util.HashSet
;
import
java.util.HashSet
;
import
java.util.Map
;
import
java.util.Set
;
import
java.util.Set
;
import
.payload(
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset()))
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
.retained(
true
)
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
(
String
className
,
Class<
T
>
intrface
,
Class<
U
>
constructorArgClass
,
U
props
) {
.
publish()
.payload(payload)
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
//
verify no publish is fired
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
final
int
PORT
=
1883
;
public
static
final
int
WEBSOCKET_PORT
=
8080
;
public
static
final
String
DISABLED_PORT_BIND
:
'
org.eclipse.paho.client.mqttv3
'
,
version
:
'
1.0.2
'
testCompile
group
:
'
org.eclipse.jetty.websocket
'
,
moquette/checkstyle.xml at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
com.h2database
'
,
name
:
'
h2
'
,
version
:
'
1.4.192
'
testRuntime
group
:
Sign in to GitHub · GitHub
Skip to content
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
checkstyle: resource folders excluded form check · moquette-io/moquette@e2aa30d · GitHub
checkstyle: resource folders excluded form check · moquette-io/moquette@e2aa30d · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
</
module
>
<!--
Prohibit consecutive empty lines (except the lines after package/import)
-->
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
=
"
.
sendPublish(publishMsg);
}
}
}
private
void
debugLogPacketIds
(
Collection<
InFlightPacket
>
expired
) {
if
(
!
LOG
.
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
assertEqualsConnAck(
CONNECTION_ACCEPTED
, channel
.
readOutbound());
//
now create another connection and check the new one closes the older
MQTTConnection
anotherConnection
=
createMQTTConnection(
CONFIG
);
anotherConnection
.
processConnect(msg);
EmbeddedChannel
anotherChannel
=
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
Save preferences
"
);
connection
.
processDisconnect(
null
);
final
MqttConnectMessage
notCleanConnect
=
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID
MemorySubscriptionsRepository
();
queueRepository
=
new
MemoryQueueRepository
();
}
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
.
init(subscriptionsRepository);
MemorySubscriptionsRepository
();
@@ -324,6 +326,11 @@ public void stopServer() {
//
and SessionsRepository does not stop its tasks. Thus shutdownNow().
scheduler
.
shutdownNow();
if
(h2Builder
!=
null
) {
LOG
.
trace(
"
Shutting down H2 persistence {}
>
"Contribution" means:
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
;
do
ROOTDIRS=
"
$ROOTDIRS$SEP$dir
"
SEP=
"
|
"
done
OURCYGPATTERN=
"
(^(
$ROOTDIRS
))
"
#
Add a user-defined pattern to the cygpath arguments
(persistencePath
!=
null
&&
!
persistencePath
.
isEmpty()) {
if
(persistencePath
!=
null
&&
!
persistencePath
.
java.util.concurrent.ConcurrentHashMap
;
public
class
DurableSession
extends
ClientSession
{
public
class
DurableSession
extends
ClientSession
{
@@ -51,20 +49,6 @@ void waitingAck(int messageID, IMessagesStore.StoredMessage msg) {
}
}
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
"
Any payload
"
);
}
@Test
public
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
T
instance
=
null
;
try
{
//
check if constructor with constructor arg class parameter
//
exists
LOG
.
info(
"
"
,
constructorArgClass
.
ConnectionTestUtils
.
verifyNoPublishIsReceived(channel);
}
@Test
public
void
testReceiveRetainedPublishRespectingSubscriptionQoSAndNotPublisher
() {
//
publisher publish a retained message on topic /news
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
final
ByteBuf
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
=
"
disabled
"
;
public
static
final
String
HOST
=
"
0.0.0.0
"
;
public
static
name
:
'
websocket-client
'
,
version
:
'
9.2.0.M1
'
testCompile
group
:
'
com.h2database
'
,
name
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
'
io.netty
'
,
name
:
'
netty-tcnative
'
,
version
:
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Sign in to GitHub · GitHub
Skip to content
broker/pom: code formatter used · moquette-io/moquette@99fea68 · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
format
"
value
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
isDebugEnabled()
||
expired
.
isEmpty()) {
return
;
}
StringBuilder
sb
=
new
StringBuilder
();
for
(
InFlightPacket
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
(
EmbeddedChannel
) anotherConnection
.
channel;
assertEqualsConnAck(
CONNECTION_ACCEPTED
, anotherChannel
.
readOutbound());
//
Verify
assertFalse(
"
First 'FAKE_CLIENT_ID' channel MUST be closed by the broker
"
, channel
.
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
);
EmbeddedChannel
subscriberChannel
=
new
EmbeddedChannel
();
MQTTConnection
subscriberConnection
=
createMQTTConnection(
CONFIG
, subscriberChannel);
subscriberConnection
.
processConnect(notCleanConnect);
ConnectionTestUtils
.
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions,
interceptor
);
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions,
queueRepository
);
dispatcher
"
);
h2Builder
.
closeStore();
}
LOG
.
info(
"
Moquette integration has been stopped.
"
);
}
2
broker/src/main/java/io/moquette/interception/BrokerInterceptor.java
Show comments
>
<
span
style
="
font-size: 10pt;
"
>
a)
in the case of the initial Contributor, the initial code and documentation
distributed under this Agreement, and
<
br
clear
="
left
"
>
b) in the case of each subsequent Contributor:
if
[
"
$GRADLE_CYGPATTERN
"
!=
"
"
]
;
then
OURCYGPATTERN=
"
isEmpty()) {
LOG
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
LOG
}
}
class
InboundFlightZone
{
final
Map<
Integer
,
IMessagesStore
.
void
testPublishWithQoS2
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
NEWS_TOPIC
,
EXACTLY_ONCE
);
//
Exercise
final
ByteBuf
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
getName(), className, intrface
.
getName());
instance
=
this
.
getClass()
.
getClassLoader()
.loadClass(className)
.asSubclass(intrface)
.getConstructor(constructorArgClass)
.newInstance(props);
}
catch
(
InstantiationException
payload
=
Unpooled
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
final
MqttPublishMessage
retainedPubQoS1Msg
=
MqttMessageBuilders
.
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
final
String
NEED_CLIENT_AUTH
=
"
need_client_auth
"
;
public
static
final
String
HAZELCAST_CONFIGURATION
=
"
hazelcast.configuration
"
;
:
'
h2
'
,
version
:
'
1.4.191
'
testRuntime
group
:
'
io.netty
'
,
name
:
moquette/ChangeLog.txt at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
'
2.0.10.Final
'
,
classifier
:
'
linux-x86_64
'
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
two or more consecutive empty lines
"
/>
</
module
>
<!--
-->
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
packet
:
expired) {
sb
.
append(packet
.
packetId)
.
append(
"
,
"
);
}
LOG
.
debug(
"
"
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
isOpen());
assertTrue(
"
Second 'FAKE_CLIENT_ID' channel MUST be still open
"
, anotherChannel
.
isOpen());
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
assertConnectAccepted(subscriberChannel);
subscribe(subscriberConnection,
NEWS_TOPIC
,
AT_MOST_ONCE
);
//
publish on /news
final
ByteBuf
payload2
=
Unpooled
.
copiedBuffer(
"
Hello world2!
=
new
PostOffice
(subscriptions, authorizatorPolicy,
new
MemoryRetainedRepository
(), sessions,
interceptor);
final
BrokerConfiguration
brokerConfig
=
new
BrokerConfiguration
(config);
4
broker/src/main/java/io/moquette/broker/Session.java
Show comments
View file
Edit file
Delete file
@@ -160,7 +160,7 @@ public void notifyTopicUnsubscribed(final String topic, final String clientID, f
public
void
notifyMessageAcknowledged
(
final
InterceptAcknowledgedMessage
msg
) {
for
(
final
InterceptHandler
handler
:
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
$OURCYGPATTERN
|(
$GRADLE_CYGPATTERN
)
"
fi
#
Now convert the arguments - kludge to limit ourselves to /bin/sh
i=0
for
arg
in
"
$@
"
;
do
CHECK=
`
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
h2Builder
=
new
H2Builder
(config, scheduler);
h2Builder
=
new
H2Builder
(config, scheduler)
.
initStore();
subscriptionsRepository
StoredMessage
>
inboundFlightMessages
=
new
ConcurrentHashMap<>
();
IMessagesStore
.
StoredMessage
lookup
(
int
messageID
) {
return
inboundFlightMessages
.
get(messageID);
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos2(connection,
MqttMessageBuilders
.
publish()
.payload(anyPayload)
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
|
IllegalAccessException
|
ClassNotFoundException
ex) {
LOG
.
warn(
"
"
+
"
errorMessage={}
"
, constructorArgClass
.
getName(), className, intrface
.
getName(), ex
publish()
.payload(payload
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
.topicName(
NEWS_TOPIC
)
.
build();
sut
.
receivedPublishQos1(connection,
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
public
static
final
String
NETTY_SO_BACKLOG_PROPERTY_NAME
=
"
netty.so_backlog
"
;
public
static
final
String
NETTY_SO_REUSEADDR_PROPERTY_NAME
=
"
'
netty-tcnative
'
,
version
:
'
2.0.10.Final
'
,
classifier
:
'
linux-x86_64
'
}
Copy lines
Copy permalink
View git blame
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1a6dd8a259
moquette
/
about.html
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
=
"
format
"
value
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
, expired
.
size(), sb);
}
private
MqttPublishMessage
publishNotRetainedDuplicated
(
InFlightPacket
notAckPacketId
,
Topic
topic
,
MqttQoS
qos
,
ByteBuf
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Update about.html
Loading branch information
andsel
committed
Apr 16, 2018
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
,
TEST_PWD
, payload2,
false
View file
Edit file
Delete file
@@ -97,10 +97,8 @@ public int compareTo(Delayed o) {
private
final
AtomicInteger
inflightSlots
=
new
AtomicInteger
(
INFLIGHT_WINDOW_SIZE
);
//
this should be configurable
Session
(
this
.
handlers
.
get(
InterceptAcknowledgedMessage
.
class)) {
LOG
.
debug(
"
"
,
msg
.
getMsg()
.
style
="
font-size: 10pt;
"
>
i)
changes to the Program, and
</
span
>
</
p
>
<
p
class
="
MsoNormal
echo
"
$arg
"
|
egrep -c
"
$OURCYGPATTERN
"
-
`
CHECK2=
`
echo
"
$arg
"
|
egrep -c
=
h2Builder
.
initStore()
.
subscriptionsRepository();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
queueRepository
=
h2Builder
.
queueRepository();
}
else
}
void
waitingRel
(
int
messageID
,
IMessagesStore
.
StoredMessage
msg
) {
inboundFlightMessages
.
put(messageID, msg);
}
}
private
.qos(
MqttQoS
.
EXACTLY_ONCE
)
.retained(
true
)
.topicName(
NEWS_TOPIC
)
.
build(),
"
username
"
);
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
e2aa30d139
moquette
/
pom.xml
Go to file
Go to file
T
Go to line
L
.
getCause(),
ex
.
getMessage());
return
null
;
}
catch
(
NoSuchMethodException
|
InvocationTargetException
e) {
try
{
LOG
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, payload,
1
,
true
,
retainedPubQoS1Msg);
//
subscriber connects subscribe to topic /news and receive the last retained message
EmbeddedChannel
subChannel
=
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Update about.html
Loading branch information
andsel
committed
Apr 16, 2018
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
netty.so_reuseaddr
"
;
public
static
final
String
NETTY_TCP_NODELAY_PROPERTY_NAME
=
"
netty.tcp_nodelay
"
;
public
static
final
String
NETTY_SO_KEEPALIVE_PROPERTY_NAME
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
checkstyle-suppressions.xml
Go to file
Go to file
T
Go to line
L
27 lines (23 sloc)
1.21 KB
Raw
Blame
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
>
<
html
xmlns
="
http://www.w3.org/1999/xhtml
"
>
<
head
>
<
meta
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
an empty line before '}'
"
/>
</
module
>
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
=
payload
) {
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBLISH
,
true
, qos,
false
,
0
);
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Merge pull request
#392
from AndreasMager/gradle_update
Loading branch information
andsel
committed
Mar 12, 2018
Verified
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
1 parent
4307a90
commit
1a6dd8a259e64b4153b35e458dca642df634ca8b
Unified
Split
Showing
1 changed file
with
2 additions
and
3 deletions
.
+2
−3
about.html
5
about.html
Show comments
,
MqttMessageBuilders
.
publish()
.payload(payload2
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
String
clientId
,
boolean
clean
,
Will
will
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
) {
this
.
getClientID(), msg
.
getPacketID(), msg
.
getTopic(), handler
.
getID());
msg
.
getMsg()
/*
.getClientID()
*/
, msg
.
getPacketID(), msg
.
getTopic(), handler
.
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
ii)
additions to the Program;
</
span
>
</
"
^-
"
`
#
## Determine if an option
if
[
$CHECK
-ne
0 ]
&&
[
$CHECK2
-eq
0 ]
;
then
#
{
}
else
{
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
);
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DurableSession
.
class);
private
static
final
Logger
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
EXACTLY_ONCE
,
"
Any payload
"
Copy path
Cannot retrieve contributors at this time
229 lines (208 sloc)
7.63 KB
Raw
Blame
<
project
xmlns
=
"
.
info(
"
"
, className, intrface
.
getName());
//
fallback to default constructor
instance
=
this
.
getClass()
.
getClassLoader()
.loadClass(className)
.asSubclass(intrface)
new
EmbeddedChannel
();
MQTTConnection
subConn
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, subChannel);
subConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
SUBSCRIBER_ID
));
ConnectionTestUtils
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
4307a90
commit
1a6dd8a259e64b4153b35e458dca642df634ca8b
Unified
Split
Showing
1 changed file
with
2 additions
and
3 deletions
.
+2
−3
=
"
netty.so_keepalive
"
;
public
static
final
String
NETTY_CHANNEL_TIMEOUT_SECONDS_PROPERTY_NAME
=
"
netty.channel_timeout.seconds
"
;
public
static
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
e2aa30d139
moquette
/
checkstyle-suppressions.xml
Go to file
Go to file
T
Go to line
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Copy path
Cannot retrieve contributors at this time
8 lines (7 sloc)
260 Bytes
Raw
Blame
<?
xml
version
=
"
1.0
"
?>
<!
DOCTYPE
suppressions
http-equiv
="
Content-Type
"
content
="
text/html; charset=ISO-8859-1
"/>
<
title
>
About
</
title
>
</
head
>
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
e2aa30d139
moquette
/
checkstyle.xml
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
"
format
"
value
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
MqttPublishVariableHeader
varHeader
=
new
MqttPublishVariableHeader
(topic
.
toString(), notAckPacketId
.
packetId);
return
new
MqttPublishMessage
(fixedHeader, varHeader, payload);
}
private
void
drainQueueToConnection
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
2 parents
2fb475a
+
7267264
commit
4307a9033328966728cf276a2b478d9f10ca2b91
Unified
Split
Showing
6 changed files
with
30 additions
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
View file
Edit file
Delete file
@@ -11,13 +11,12 @@ <h2>About Moquette MQT broker</h2>
<
p
>
June 11, 2014
</
p
>
<
h3
>
License
</
h3
>
build());
ConnectionTestUtils
.
verifyPublishIsReceived(subscriberChannel,
AT_MOST_ONCE
,
"
Hello world2!
"
);
subscriberConnection
.
processDisconnect(
null
);
assertFalse(
"
after a disconnect the client should be disconnected
"
clientId
=
clientId;
this
.
clean
=
clean;
this
(clean, clientId, sessionQueue);
this
.
will
=
will;
this
.
sessionQueue
getID());
executor
.
execute(()
-
>
handler
.
onMessageAcknowledged(msg));
}
}
4
broker/src/main/java/io/moquette/persistence/H2Builder.java
Show comments
View file
Edit file
Delete file
@@ -48,4 +48,8 @@ public H2Builder initStore() {
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
## Added a condition
eval
`
echo args
$i
`
=
`
cygpath --path --ignore --mixed
"
$arg
"
`
else
eval
`
echo args
$i
`
);
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
queueRepository
=
new
MemoryQueueRepository
();
}
LOG
=
LoggerFactory
.
getLogger(
DurableSession
.
class);
private
final
ISessionsStore
sessionsStore;
private
final
ISessionsStore
sessionsStore;
16
);
}
//
aka testPublishWithQoS1_notCleanSession
@Test
public
void
forwardQoS1PublishesWhenNotCleanSessionReconnects
() {
connection
.
processConnect(
ConnectionTestUtils
.
buildConnectNotClean(
FAKE_CLIENT_ID
));
http://maven.apache.org/POM/4.0.0
"
xmlns
:
xsi
=
"
http://www.w3.org/2001/XMLSchema-instance
"
xsi
:
schemaLocation
=
"
http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd
"
>
.getDeclaredConstructor()
.
newInstance();
}
catch
(
InstantiationException
|
IllegalAccessException
|
ClassNotFoundException
|
NoSuchMethodException
|
InvocationTargetException
ex) {
LOG
.
.
assertConnectAccepted(subChannel);
subscribe(subConn,
NEWS_TOPIC
,
MqttQoS
.
AT_MOST_ONCE
);
//
Verify publish is received
ConnectionTestUtils
.
verifyReceiveRetainedPublish(subChannel,
NEWS_TOPIC
,
"
about.html
5
about.html
Show comments
View file
Edit file
Delete file
@@ -11,13 +11,12 @@ <h2>About Moquette MQT broker</h2>
<
p
>
June 11, 2014
</
p
>
<
p
>
final
String
NETTY_EPOLL_PROPERTY_NAME
=
"
netty.epoll
"
;
public
static
final
String
NETTY_MAX_BYTES_PROPERTY_NAME
=
"
netty.mqtt.message_size
"
;
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
checkstyle.xml
Go to file
Go to file
T
Go to line
L
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
L
Copy path
Cannot retrieve contributors at this time
8 lines (7 sloc)
260 Bytes
Raw
Blame
<?
xml
version
=
"
1.0
"
?>
<!
DOCTYPE
suppressions
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
checkstyle: resource folders excluded form check
Loading branch information
Andreas Mager
committed
Feb 1, 2017
1 parent
99fea68
Wiki
Security
Insights
Permalink
Browse files
checkstyle: resource folders excluded form check
Loading branch information
Andreas Mager
committed
Feb 1, 2017
1 parent
99fea68
commit
e2aa30d13975441966c1319dcc316266f5121eec
Unified
Split
Showing
3 changed files
PUBLIC
"-//Puppy Crawl//DTD Suppressions 1.0//EN"
"http://www.puppycrawl.com/dtds/suppressions_1_0.dtd">
<
suppressions
>
<
suppress
checks
=
"
[a-zA-Z0-9]*
"
files
=
"
.*/resources/.*
<
body
lang
="
EN-US
"
>
<
h2
>
About Moquette MQT broker
</
h2
>
<
p
>
June 11, 2014
</
148 lines (145 sloc)
5.92 KB
Raw
Blame
<?
xml
version
=
"
1.0
"
encoding
=
"
UTF-8
"
?>
<!--
~ Copyright 2012 The Netty Project
an empty line after a short line that ends with '{'
"
/>
</
module
>
<
module
name
=
"
TreeWalker
"
>
<
module
name
=
() {
//
consume the queue
while
(
!
canSkipQueue()) {
final
SessionRegistry
.
EnqueuedMessage
msg
=
sessionQueue
.
remove();
inflightSlots
.
and
31 deletions
.
+4
−7
build.gradle
+8
−7
gradle/lint.gradle
BIN
gradle/wrapper/gradle-wrapper.jar
+1
−2
gradle/wrapper/gradle-wrapper.properties
+17
−9
gradlew
<
p
>
The Eclipse Foundation makes available all content in this plug-in (&quot;Moquette MQTT&quot;). Unless otherwise
indicated below, the Content is provided to you under the terms and conditions of the
<
p
>
The Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
"
>
, subscriberChannel
.
isOpen());
}
@Test
public
void
checkReplayofStoredPublishResumeAfter_a_disconnect_cleanSessionFalseQoS1
() {
final
MQTTConnection
publisher
=
connectAs(
=
sessionQueue;
}
Session
(
boolean
clean
,
String
clientId
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
public
ISubscriptionsRepository
subscriptionsRepository
() {
return
new
H2SubscriptionsRepository
(mvStore);
}
public
void
closeStore
() {
mvStore
.
close();
}
}
"
>
where
such changes and/or additions to the Program originate from and are distributed
by that particular Contributor. A Contribution 'originates' from a Contributor
if it was added to the Program by such Contributor itself or anyone acting on
such Contributor's behalf. Contributions do not include additions to the
Program which: (i) are separate modules of software distributed in conjunction
with the Program under their own license agreement, and (ii) are not derivative
works of the Program.
</
span
>
</
p
>
<
p
=
"
\"
$arg
\"
"
fi
i=
$((
i
+
1
))
done
case
$i
in
}
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
.
init(subscriptionsRepository);
subscriptions
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
Show comments
View file
Edit file
Delete file
@@ -1,3 +1,19 @@
/*
* Copyright (c) 2012-2017 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
connection
.
processDisconnect(
null
);
//
publish a QoS 1 message from another client publish a message on the topic
EmbeddedChannel
pubChannel
=
<
modelVersion
>4.0.0</
modelVersion
>
<
properties
>
<
project
.build.sourceEncoding>UTF-8</
project
.build.sourceEncoding>
<
netty
.version>4.1.6.Final</
netty
error(
"
"
+
"
errorMessage={}
"
, className, intrface
.
getName(), ex
.
getCause(), ex
.
getMessage());
return
null
;
}
Hello world!
"
,
MqttQoS
.
AT_MOST_ONCE
);
}
@Test
public
void
testLowerTheQosToTheRequestedBySubscription
() {
Subscription
subQos1
=
new
Subscription
June 11, 2014
</
p
>
<
h3
>
License
</
h3
>
<
h3
>
License
</
h3
>
public
static
final
int
DEFAULT_NETTY_MAX_BYTES_IN_MESSAGE
=
8092
;
public
static
final
String
METRICS_ENABLE_PROPERTY_NAME
=
"
use_metrics
"
;
Save preferences
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Copy path
Cannot retrieve contributors at this time
154 lines (151 sloc)
6.01 KB
Raw
Blame
<?
xml
version
=
"
1.0
"
encoding
=
"
UTF-8
"
Security
Insights
Permalink
Browse files
broker/pom: code formatter used
Loading branch information
Andreas Mager
committed
Feb 1, 2017
1 parent
682e905
commit
99fea68bb8e518c8d6284de7447d71efd3eb70a7
Unified
Split
Showing
1 changed file
PUBLIC
"-//Puppy Crawl//DTD Suppressions 1.0//EN"
"http://www.puppycrawl.com/dtds/suppressions_1_0.dtd">
<
suppressions
>
<
suppress
checks
=
"
[a-zA-Z0-9]*
"
files
=
"
.*/resources/.*
"
/>
commit
e2aa30d13975441966c1319dcc316266f5121eec
Unified
Split
Showing
3 changed files
with
10 additions
and
1 deletion
.
+8
−0
checkstyle-suppressions.xml
+1
−1
checkstyle.xml
+1
with
10 additions
and
1 deletion
.
+8
−0
checkstyle-suppressions.xml
+1
−1
checkstyle.xml
+1
−0
pom.xml
8
checkstyle-suppressions.xml
Show comments
"
/>
</
suppressions
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
p
>
<
h3
>
License
</
h3
>
<
p
>
The Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
~
~ The Netty Project licenses this file to you under the Apache License,
~ version 2.0 (the "License"); you may not use this file except in compliance
~ with the License. You may obtain a copy of the License at:
~
~ http://www.apache.org/licenses/LICENSE-2.0
~
~ Unless required by applicable law or agreed to in writing, software
~ distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
~ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
~ License for the specific language governing permissions and limitations
~ under the License.
-->
<!
DOCTYPE
module
PUBLIC
"
LineLength
"
>
<
property
name
=
"
max
"
value
=
"
120
"
/>
</
decrementAndGet();
int
sendPacketId
=
mqttConnection
.
nextPacketId();
inflightWindow
.
put(sendPacketId, msg);
if
(msg
instanceof
SessionRegistry
.
PubRelMarker
) {
MqttMessage
+0
−6
gradlew.bat
11
build.gradle
Show comments
View file
Edit file
Delete file
@@ -12,7 +12,8 @@ buildscript {
}
}
dependencies {
classpath
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.8
'
classpath
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
<
p
>
If you did not receive this Content directly from the Eclipse Foundation, the
Content is
<
p
>
"
Publisher
"
);
connect(
this
.
connection,
FAKE_CLIENT_ID
);
subscribe(connection,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
//
publish from another channel
publishQos1(publisher,
) {
13
broker/src/main/java/io/moquette/broker/SessionRegistry.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
package
io.moquette.broker
;
import
io.moquette.broker.Session.SessionStatus
;
import
io.moquette.interception.BrokerInterceptor
;
import
35
broker/src/test/java/io/moquette/integration/IntegrationUtils.java
Show comments
View file
Edit file
Delete file
@@ -18,54 +18,37 @@
import
java.io.File
;
import
java.util.Properties
;
import static
io.moquette.BrokerConstants.
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
>
<
span
style
="
font-size: 10pt;
"
>
"Contributor" means any person or
entity that distributes the Program.
</
span
>
</
p
>
<
p
(0)
set
-- ;;
(1)
set
--
"
$args0
"
;;
(2)
set
--
"
$args0
"
"
$args1
.
init(subscriptionsRepository);
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions,
interceptor
);
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions,
queueRepository
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.spi
;
package
io.moquette.spi
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
Oops, something went wrong.
new
EmbeddedChannel
();
MQTTConnection
pubConn
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, pubChannel);
pubConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
PUBLISHER_ID
));
.version>
<
source
.version>1.7</
source
.version>
<
target
.version>1.7</
target
.version>
<
bintray
.repo>andsel/maven</
bintray
.repo>
<
bintray
}
return
instance;
}
/**
* Use the broker to publish a message. It's intended for embedding applications. It can be used
* only after the integration is correctly started with startServer.
*
*
@param
msg the message to forward.
*
@param
clientId the id of the sending integration.
*
@throws
IllegalStateException if the integration is not yet started
(
"
Sub A
"
,
new
Topic
(
"
a/b
"
),
MqttQoS
.
AT_LEAST_ONCE
);
assertEquals(
MqttQoS
<
p
>
The Eclipse Foundation makes available all content in this plug-in (&quot;Moquette MQTT&quot;). Unless otherwise
<
p
>
The Content is provided to you under the terms and conditions of the
indicated below, the Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
public
static
final
String
METRICS_LIBRATO_EMAIL_PROPERTY_NAME
=
"
metrics.librato.email
"
;
public
static
final
String
METRICS_LIBRATO_TOKEN_PROPERTY_NAME
=
"
metrics.librato.token
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
ChangeLog.txt
Go to file
Go to file
T
Go to line
?>
<!--
~ Copyright 2012 The Netty Project
~
~ The Netty Project licenses this file to you under the Apache License,
~ version 2.0 (the "License"); you may not use this file except in compliance
~ with the License. You may obtain a copy of the License at:
~
~ http://www.apache.org/licenses/LICENSE-2.0
~
~ Unless required by applicable law or agreed to in writing, software
~ distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
~ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
~ License for the specific language governing permissions and limitations
~ under the License.
-->
<!
with
25 additions
and
25 deletions
.
+25
−25
broker/pom.xml
50
broker/pom.xml
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
<
project
xmlns
</
suppressions
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
−0
pom.xml
8
checkstyle-suppressions.xml
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,8 @@
<?
xml
version
=
"
1.0
"
View file
Edit file
Delete file
@@ -0,0 +1,8 @@
<?
xml
version
=
"
1.0
"
?>
<!
DOCTYPE
suppressions
PUBLIC
"-//Puppy Crawl//DTD Suppressions 1.0//EN"
"http://www.puppycrawl.com/dtds/suppressions_1_0.dtd">
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
="
http://www.eclipse.org/legal/epl-v10.html
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
<
p
>
The Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
"-//Puppy Crawl//DTD Check Configuration 1.2//EN"
"http://www.puppycrawl.com/dtds/configuration_1_2.dtd">
<
module
name
=
"
Checker
"
>
<
property
name
=
"
severity
"
value
module
>
<
module
name
=
"
WhitespaceAfter
"
/>
<
module
name
=
"
WhitespaceAround
pubRel
=
MQTTConnection
.
pubrel(sendPacketId);
mqttConnection
.
sendIfWritableElseDrop(pubRel);
}
else
{
final
SessionRegistry
'
net.ltgt.gradle:gradle-errorprone-plugin:0.0.13
'
classpath
'
gradle.plugin.com.github.spotbugs:gradlePlugin:1.6.0
'
classpath
'
The
Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
Toggle all file notes
0 comments on commit
1a6dd8a
Please
NEWS_TOPIC
,
"
Hello world MQTT!!-1
"
,
99
);
ConnectionTestUtils
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
@@ -32,9 +31,9 @@
import
java.util.concurrent.ConcurrentLinkedQueue
;
import
java.util.concurrent.ConcurrentMap
;
class
;
import static
io.moquette.BrokerConstants.
DEFAULT_MOQUETTE_STORE_H2_DB_FILENAME
;
import static
io.moquette.BrokerConstants.PERSISTENT_STORE_PROPERTY_NAME
;
import static
io.moquette.BrokerConstants.PORT_PROPERTY_NAME
;
import static
org.junit.Assert.assertFalse
;
/**
* Used to carry integration configurations.
*/
>
<
span
style
="
font-size: 10pt;
"
>
"Licensed Patents " mean patent
claims licensable by a Contributor which are necessarily infringed by the use
or sale of its Contribution alone or when combined with the Program.
</
span
>
</
p
>
<
"
;;
(3)
set
--
"
$args0
"
"
$args1
"
"
$args2
"
;;
(4)
set
--
"
);
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
new
MemoryRetainedRepository
(), sessions,
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
new
MemoryRetainedRepository
(), sessions,
Retry
Toggle all file notes
0 comments on commit
033a428
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
ConnectionTestUtils
.
assertConnectAccepted(pubChannel);
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
.parent.package>io.moquette.moquette-parent</
bintray
.parent.package>
</
properties
>
<
groupId
>io.moquette</
groupId
>
<
artifactId
>moquette-parent</
artifactId
>
<
*/
public
void
internalPublish
(
MqttPublishMessage
msg
,
final
String
clientId
) {
final
int
messageID
=
msg
.
.
AT_LEAST_ONCE
,
PostOffice
.
lowerQosToTheSubscriptionDesired(subQos1,
EXACTLY_ONCE
));
Subscription
subQos2
=
new
Subscription
(
"
Sub B
"
,
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
"
;
public
static
final
String
METRICS_LIBRATO_SOURCE_PROPERTY_NAME
=
"
metrics.librato.source
"
;
public
static
final
String
BUGSNAG_ENABLE_PROPERTY_NAME
L
Copy path
Cannot retrieve contributors at this time
103 lines (93 sloc)
6.14 KB
Raw
Blame
Version 0.12:
Fixed issue #415
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Rewritten completly the broker to introduce the concept of MqttConnection
Dropped suppoert for MapDB and keeped only H2 MvStore for persistence
Version 0.10:
Netty epoll system added
Separated in memory and MapDB storage implementations
Cleanly separated inflight part (inbound and outbound)
Version 0.9:
Moved canRead check to topic from publish phase to subscribe (#144)
DOCTYPE
module
PUBLIC
"-//Puppy Crawl//DTD Check Configuration 1.2//EN"
"http://www.puppycrawl.com/dtds/configuration_1_2.dtd">
<
module
name
=
"
Checker
"
>
<
property
name
=
=
"
http://maven.apache.org/POM/4.0.0
"
xmlns
:
xsi
=
"
http://www.w3.org/2001/XMLSchema-instance
"
xsi
:
schemaLocation
=
"
http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd
"
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
?>
<!
DOCTYPE
suppressions
PUBLIC
"-//Puppy Crawl//DTD Suppressions 1.0//EN"
"http://www.puppycrawl.com/dtds/suppressions_1_0.dtd">
<
suppressions
>
<
suppress
checks
=
"
[a-zA-Z0-9]*
<
suppressions
>
<
suppress
checks
=
"
[a-zA-Z0-9]*
"
files
=
"
.*/resources/.*
"
/>
</
suppressions
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
indicated below, the terms and conditions of the EPL still apply to any source code in the Content
and such source code may be obtained at
<
a
href
="
http://www.eclipse.org/
"
>
http://www.eclipse.org
</
a
>
.
</
p
=
"
warning
"
/>
<!--
<module name="SuppressionFilter">
<property name="file" value="checkstyle-suppressions.xml" />
</module>
<module name="io.netty.build.checkstyle.SuppressionFilter">
<property name="pattern" value="((LocalTime|WorldClock)Protocol|LinkedTransferQueue|Version|jzlib/.*|chmv8/.*|com/sun/nio/sctp/.*)\.java" />
</module>
-->
<
module
"
>
<
property
name
=
"
tokens
"
value
=
"
ASSIGN, BAND, BAND_ASSIGN, BOR, BOR_ASSIGN, BSR, BSR_ASSIGN, BXOR, BXOR_ASSIGN, DIV, DIV_ASSIGN, EQUAL, GE, GT, LAND, LCURLY, LE, LITERAL_ASSERT, LITERAL_CATCH, LITERAL_DO, LITERAL_ELSE, LITERAL_FINALLY, LITERAL_FOR, LITERAL_IF, LITERAL_RETURN, LITERAL_SYNCHRONIZED, LITERAL_TRY, LITERAL_WHILE, LOR, LT, MINUS, MINUS_ASSIGN, MOD, MOD_ASSIGN, NOT_EQUAL, PLUS, PLUS_ASSIGN, RCURLY, SL, SLIST, SL_ASSIGN, SR, SR_ASSIGN, STAR, STAR_ASSIGN, TYPE_EXTENSION_AND
"
/>
</
.
PublishedMessage
msgPub
=
(
SessionRegistry
.
PublishedMessage
) msg;
MqttPublishMessage
publishMsg
=
MQTTConnection
.
notRetainedPublishWithMessageId(msgPub
.
topic
.
com.github.jengelman.gradle.plugins:shadow:1.2.3
'
classpath
'
com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3
'
}
@@ -25,18 +26,14 @@ subprojects {
maven { url
"
https://repo.eclipse.org/content/repositories/paho-releases/
"
}
maven { url
"
https://oss.sonatype.org/content/repositories/snapshots
"
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
"
Hello world MQTT!!-1
"
);
connection
.
processDisconnect(
null
);
publishQos1(publisher,
NEWS_TOPIC
,
"
SessionRegistry
{
public
class
SessionRegistry
{
abstract
static
class
EnqueuedMessage
{
public
abstract
static
class
EnqueuedMessage
{
public
final
class
IntegrationUtils
{
static
String
localMapDBPath
() {
static
String
localH2MvStoreDBPath
() {
String
currentDir
=
System
p
>
<
span
style
="
font-size: 10pt;
"
>
"Program" means the Contributions
distributed in accordance with this Agreement.
</
span
>
</
p
>
<
p
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
;;
(5)
set
--
"
$args0
"
interceptor);
interceptor);
final
BrokerConfiguration
brokerConfig
=
new
BrokerConfiguration
(config);
final
BrokerConfiguration
brokerConfig
=
new
BrokerConfiguration
(config);
4
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
.
receivedPublishQos1(pubConn,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
,
MqttMessageBuilders
.
publish()
.payload(anyPayload
.
packaging
>pom</
packaging
>
<
version
>0.10-SNAPSHOT</
version
>
<
name
>Moquette MQTT</
name
>
<
description
>Moquette lightweight MQTT Broker</
description
>
variableHeader()
.
packetId();
if
(
!
initialized) {
LOG
.
error(
"
"
, clientId,
messageID);
throw
new
IllegalStateException
(
new
Topic
(
"
a/+
"
),
EXACTLY_ONCE
);
assertEquals(
EXACTLY_ONCE
,
PostOffice
.
lowerQosToTheSubscriptionDesired(subQos2,
EXACTLY_ONCE
));
}
}
>
.
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
<
p
>
If you did not receive this Content directly from the Eclipse Foundation, the
Content is
<
p
>
=
"
use_bugsnag
"
;
public
static
final
String
BUGSNAG_TOKEN_PROPERTY_NAME
=
"
bugsnag.token
"
;
public
static
final
Added javadoc and src jars creations for JCenter/Maven central
Added persisting of clean session flag for already existing client session (fix issue #145)
Moved the message logic management fo FSM, to better control the concurrency.
Changed default config to use in memory store and not default moquette.mapdb
Version 0.8:
Introduced authenticator and authorizator implementations.
Fixed bug, doesn't close the channel when connect doesn't contains a valid proto name, issue #65
Fixed bug, does not check for zero length topic (filters) in PUBLISH, SUBSCRIBE, and UNSUBSCRIBE, issue #67
Fixed issue #69
Fixed bug #68, UNSUBSCRIBE has to fail on bad topicFilter names
Fixed bug #81, on stop of moquette broker it doesn't shutdown due to no shutdown of ringbuffer used on the back of ProtocolProcessor
Moved config to be not only filesystem based, but also classpath and memory (fix issue #73)
Switched from commit persistence on every change to time based to fix delay in handling many msgs/sec (fix issue #79)
Changed willMessage and password in CONNECT message from String to byte[] (fix issue #94 and #95)
Fixed ugly empty session storage, avoid fake NullObject empty subscription subscription
Added check to avoid creation of LostConnectionEvents for not yet completed connects (fix issue #88)
Removed LMAX ringbuffer to use multi threading with persistent (copy on write) data structures
Fixed bug that on connection stolen dropped also the new connection (fix issue #108)
"
severity
"
value
=
"
warning
"
/>
<!--
<module name="SuppressionFilter">
<property name="file" value="checkstyle-suppressions.xml" />
</module>
<module name="io.netty.build.checkstyle.SuppressionFilter">
<property name="pattern" value="((LocalTime|WorldClock)Protocol|LinkedTransferQueue|Version|jzlib/.*|chmv8/.*|com/sun/nio/sctp/.*)\.java" />
</module>
>
xsi
:
schemaLocation
=
"
http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd
"
>
<
modelVersion
>4.0.0</
modelVersion
>
<
parent
>
<
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
files
=
"
.*/resources/.*
"
/>
</
suppressions
>
2
checkstyle.xml
Show comments
View file
Edit file
Delete file
@@ -22,7 +22,7 @@
<!--
>
2
checkstyle.xml
Show comments
View file
Edit file
Delete file
@@ -22,7 +22,7 @@
<!--
<module name="SuppressionFilter">
<property name="file" value="
/io/netty/
suppressions.xml" />
<property name="file" value="
checkstyle-
suppressions.xml" />
</module>
<module name="io.netty.build.checkstyle.SuppressionFilter">
Accept
Reject
Save preferences
>
</
body
>
</
html
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
name
=
"
FileTabCharacter
"
/>
<!--
<module name="JavadocPackage"/>
-->
<
module
name
=
"
NewlineAtEndOfFile
"
/>
<!--
module
>
<!--
Commented out due to false positives.
<module name="MissingDeprecated"/>
-->
<
module
name
=
"
MissingOverride
"
/>
<
module
name
=
toString(),
msgPub
.
publishingQos,
msgPub
.
payload, sendPacketId);
mqttConnection
.
sendPublish(publishMsg);
}
}
}
public
void
writabilityChanged
() {
}
maven { url
"
http
://repo.maven.apache.org/maven2
"
}
maven { url
"
https
://repo.maven.apache.org/maven2
"
}
}
apply
from
:
new
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Hello world MQTT!!-2
"
,
100
);
publishQos1(publisher,
NEWS_TOPIC
,
"
Hello world MQTT!!-3
"
,
101
);
createMQTTConnection(
CONFIG
);
connect(
this
}
static
class
PublishedMessage
extends
EnqueuedMessage
{
@@ -61,10 +60,12 @@
private
final
ConcurrentMap<
String
,
Session
>
pool
=
new
.
getProperty(
"
user.dir
"
);
return
currentDir
+
File
.
separator
+
"
target
"
+
File
.
>
<
span
style
="
font-size: 10pt;
"
>
"Recipient" means anyone who
receives the Program under this Agreement, including all Contributors.
</
span
>
</
p
>
<
p
>
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
"
;;
(6)
set
--
broker/src/main/java/io/moquette/broker/Session.java
Show comments
View file
Edit file
Delete file
@@ -97,10 +97,8 @@ public int compareTo(Delayed o) {
private
final
AtomicInteger
inflightSlots
=
new
AtomicInteger
(
INFLIGHT_WINDOW_SIZE
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
retainedDuplicate())
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
.topicName(
NEWS_TOPIC
)
.
build());
//
simulate a reconnection from the other client
connection
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
);
<
inceptionYear
>2011</
inceptionYear
>
<
url
>https://github.com/andsel/moquette/</
url
>
<
licenses
>
<
license
>
<
name
"
Can't publish on a integration is not yet started
"
);
}
LOG
.
trace(
"
"
, clientId, messageID);
dispatcher
.
internalPublish(msg);
}
public
void
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
The
Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
Toggle all file notes
0 comments on commit
1a6dd8a
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
String
STORAGE_CLASS_NAME
=
"
storage_class
"
;
private
BrokerConstants
() {
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Refactored the storage part to be more rational and use ClientSession concept
Added config property 'autosave_interval' (issue #97)
Removed leaking ref to parent's node (issue #119 and #126)
Added internal publish once the broker is embedded (issue #113)
Removed client active/not active state from persistence (issue #118)
Avoid deletion of client descriptor in case of multiple clients with same clientID (issues #116 and #124)
Removed a queue per client of inFlightIds (never cleaned) in favor of single atomic generator
Version 0.7:
Fix issue #38, added aligned to MQTT 3.1.1
Refactored big event switch to @Annotation dispatcher
Switched from HawtDB to MapDB
Fixed bug that didn't update client subscription on persistent store so that on server restart there where ghost subscriptions.
Fixed Issue #11, multiple republish of persisted QoS1/2 messages on clients reconnections.
Refactored the publish logic for QoS 1 2 to try to be more readable
Added packetIdentifier storage and generation
Fixed issue #16, bad packetId for will messages with qos > 0
Added store path variable "persistent_store" to configuration file (picked from Steven Warwick fork)
Removed OSGi bundle, developer time burner
-->
<
module
name
=
"
FileTabCharacter
"
/>
<!--
<module name="JavadocPackage"/>
-->
<
module
name
=
"
NewlineAtEndOfFile
"
relativePath
>../</
relativePath
>
@@ -23,37 +23,37 @@
<
artifactId
>slf4j-api</
artifactId
>
<
version
>1.7.5</
version
>
</
dependency
>
<!--
<module name="SuppressionFilter">
<module name="SuppressionFilter">
<property name="file" value="
/io/netty/
suppressions.xml" />
<property name="file" value="
checkstyle-
suppressions.xml" />
</module>
</module>
<module name="io.netty.build.checkstyle.SuppressionFilter">
<module name="io.netty.build.checkstyle.SuppressionFilter">
<property name="pattern" value="((LocalTime|WorldClock)Protocol|LinkedTransferQueue|Version|jzlib/.*|chmv8/.*|com/sun/nio/sctp/.*)\.java" />
<property name="pattern" value="((LocalTime|WorldClock)Protocol|LinkedTransferQueue|Version|jzlib/.*|chmv8/.*|com/sun/nio/sctp/.*)\.java" />
1
<property name="pattern" value="((LocalTime|WorldClock)Protocol|LinkedTransferQueue|Version|jzlib/.*|chmv8/.*|com/sun/nio/sctp/.*)\.java" />
1
pom.xml
Show comments
View file
Edit file
Delete file
@@ -138,6 +138,7 @@
<
version
>2.17</
version
>
<
configuration
>
<
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
Copyright headers
-->
<
module
name
=
"
RegexpSingleline
"
>
<
property
name
=
"
format
"
value
=
"
PackageAnnotation
"
/>
<
module
name
=
"
EmptyBlock
"
>
<
property
name
=
"
option
drainQueueToConnection();
}
public
void
sendQueuedMessagesWhileOffline
() {
LOG
.
trace(
"
"
,
this
,
this
.
File
(rootDir,
'
gradle/java.gradle
'
)
apply
from
:
new
File
(rootDir,
'
gradle/test.gradle
'
)
apply
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
connection,
FAKE_CLIENT_ID
);
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
"
Hello world MQTT!!-2
"
);
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
"
ConcurrentHashMap<>
();
private
final
ISubscriptionsDirectory
subscriptionsDirectory;
private
final
IQueueRepository
queueRepository;
private
final
ConcurrentMap<
String
,
Queue<
SessionRegistry
.
EnqueuedMessage
separator
+
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
;
}
static
String
localClusterMapDBPath
(
int
port
) {
String
currentDir
=
System
.
getProperty(
<
b
>
<
span
style
="
font-size: 10pt;
"
>
2. GRANT OF RIGHTS
</
span
>
</
b
>
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
"
"
$args5
"
);
//
this should be configurable
private
final
AtomicInteger
inflightSlots
=
new
AtomicInteger
(
INFLIGHT_WINDOW_SIZE
);
//
this should be configurable
Session
(
String
Save preferences
connectMessage
=
ConnectionTestUtils
.
buildConnectNotClean(
FAKE_CLIENT_ID
);
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
>The Apache License, Version 2.0</
name
>
<
url
>http://www.apache.org/licenses/LICENSE-2.0.txt</
url
>
</
license
>
<
license
>
<
name
>Eclipse Public License - Version 1.0</
name
stopServer
() {
LOG
.
info(
"
Unbinding integration from the configured ports
"
);
acceptor
.
close();
LOG
.
trace(
"
Stopping MQTT protocol processor
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Fixed github issue #30, returning error on mapdb file not deleted that corrupt reiterated builds
Added handling of allow_anonymous clients (as in mosquitto issue #34)
Modified the password_file format to use password stored in sha256 and not plain text
Added ACL file for topic read|write operations.
Removed cause of leakage of Netty Sessions (fix issue #39)
Cleaned Netty's stuff reference from Events used in Disruptor (fix issue #40)
Bad assignment of PacketID during publish to subscribed QoS0 topics (fix issue #38)
Fixed duplicated subscription with different QoS same client and topic (fix issue #49)
Fixed UNSUBSCRIBE that missed to remove the subscription from the persistent store (fix issue #50)
Fixed issue on multiple publish for overlapping subscription by the same client (fix issue #52).
Moved the authorization check before dropping an already connected client with same clientID (fix issue #44).
Fixed subscription tree that was unable to update clean session flag on subs with same client, topic and qos (fix issue #55)
Fixed overwriting of published qos in forward publish loop (fix issue #56)
Version 0.6:
>
<
property
name
=
"
lineSeparator
"
value
=
"
lf
"
/>
</
module
>
<
dependency
>
<
groupId
>io.netty</
groupId
>
<
artifactId
>netty-common</
artifactId
>
<
version
>
</
version
pom.xml
Show comments
View file
Edit file
Delete file
@@ -138,6 +138,7 @@
<
version
>2.17</
version
>
<
version
>2.17</
version
>
<
configuration
configLocation
>checkstyle.xml</
configLocation
>
<
suppressionsLocation
>checkstyle-suppressions.xml</
suppressionsLocation
>
<!--
<configLocation>/google_checks.xml</configLocation>
-->
Toggle all file notes
0 comments on commit
e2aa30d
Please
sign in
to comment.
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
"
^(\s|\*)*Copyright\s.*$
"
/>
<
property
name
=
"
minimum
"
value
=
"
1
"
/>
<
"
value
=
"
text
"
/>
</
module
>
<
module
name
=
"
LeftCurly
"
clientId);
drainQueueToConnection();
}
void
sendRetainedPublishOnSessionAtQos
(
Topic
topic
,
MqttQoS
qos
,
ByteBuf
payload
) {
if
(qos
from
:
new
File
(rootDir,
'
gradle/lint.gradle
'
)
apply
plugin
:
'
com.jfrog.bintray
'
Hello world MQTT!!-3
"
);
}
private
void
publishQos1
(
MQTTConnection
publisher
,
String
topic
>
>
queues
=
new
ConcurrentHashMap<>
();
SessionRegistry
(
ISubscriptionsDirectory
subscriptionsDirectory
,
BrokerInterceptor
"
user.dir
"
);
return
currentDir
+
File
.
separator
+
"
target
"
+
File
.
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
;;
(7)
set
--
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
clientId
,
boolean
clean
,
Will
will
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
) {
Session
(
String
clientId
,
AT_LEAST_ONCE
,
"
Any payload
"
);
}
@Test
public
void
checkReceivePublishedMessage_after_a_reconnect_with_notCleanSession
() {
//
first connect - subscribe -disconnect
connection
.
processConnect(
ConnectionTestUtils
>
<
url
>http://www.eclipse.org/org/documents/epl-v10.php</
url
>
</
license
>
</
licenses
>
<
developers
>
<
developer
>
"
);
initialized
=
false
;
//
calling shutdown() does not actually stop tasks that are not cancelled,
//
and SessionsRepository does not stop its tasks. Thus shutdownNow().
scheduler
.
shutdownNow();
if
(h2Builder
!=
null
) {
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Fix issue #42, bad password file path composition
Fix issue #43, missed topic case (finance/+ does has to match finance)
Integrated WebSocket support (issue #37)
Integrated SSL support (issue #41)
Fixed issue #40, check Logging inside the Felix OSGi
Fixed issue #46, implement correct behaviour for Will stuff
Splitted stores to persist messages and sessions into different interfaces
Renamed some methods in sessions store
Moved logging conf and slf4j-log4j deps out of broker to let it use the container's log configuration
Version 0.5:
Fix issue 20 (no flush of message on PINGREQ)
Fix issue 21 (bad channel timeout handler)
Created a self contained distribution package (issue 22)
Fix issue 28, OSGi-fied the broker
Fixed issue #31 missed to insert the hawtdb jars
Added a separate mvn module to host the OSGi bundle declaration
Fixed issue #30
<!--
Copyright headers
-->
<
module
name
=
"
RegexpSingleline
"
>
<
property
name
=
"
format
>
</
dependency
>
<
dependency
>
<
groupId
>io.netty</
groupId
>
<
artifactId
>netty-buffer</
artifactId
>
<
version
>
<
configuration
>
<
configLocation
>checkstyle.xml</
configLocation
>
<
configLocation
>checkstyle.xml</
configLocation
>
<
suppressionsLocation
>checkstyle-suppressions.xml</
suppressionsLocation
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Accept
Reject
Save preferences
property
name
=
"
maximum
"
value
=
"
1
"
/>
<
property
name
=
"
message
/>
<
module
name
=
"
RightCurly
"
/>
<!--
<module name="NeedBraces"/>
-->
<
module
name
=
"
!=
MqttQoS
.
AT_MOST_ONCE
) {
//
QoS 1 or 2
mqttConnection
.
sendPublishRetainedWithPacketId(topic, qos, payload);
}
else
{
mqttConnection
.
sendPublishRetainedQos0(topic, qos, payload);
}
}
apply
plugin
:
'
eclipse
'
apply
plugin
:
'
net.ltgt.errorprone
'
configurations
.
errorprone {
resolutionStrategy
.
force
'
,
String
payload
,
int
messageID
) {
final
ByteBuf
bytePayload
=
Unpooled
.
copiedBuffer(payload,
Charset
.
defaultCharset());
sut
m_interceptor
) {
SessionRegistry
(
ISubscriptionsDirectory
subscriptionsDirectory
,
IQueueRepository
queueRepository
) {
this
.
subscriptionsDirectory
=
subscriptionsDirectory;
this
.
separator
+
port
+
DEFAULT_MOQUETTE_STORE_MAP_DB_FILENAME
;
return
currentDir
+
File
.
separator
+
"
target
"
+
File
="
font-size: 10pt;
"
>
a)
Subject to the terms of this Agreement, each Contributor hereby grants Recipient
a non-exclusive, worldwide, royalty-free copyright license to
<
span
style
="
color: red;
"
>
</
span
>
reproduce, prepare derivative works of, publicly
display, publicly perform, distribute and sublicense the Contribution of such
"
"
$args5
"
"
$args6
"
;;
(8)
set
--
"
$args0
"
"
$args1
"
"
$args2
boolean
clean
,
Will
will
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
) {
.
buildConnectNotClean(
FAKE_CLIENT_ID
));
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
connection
.
processDisconnect(
null
);
//
connect - subscribe from another connection but with same ClientID
<
id
>andsel</
id
>
<
name
>Andrea Selva</
name
>
<
roles
>
<
role
>architect</
role
LOG
.
trace(
"
Shutting down H2 persistence {}
"
);
h2Builder
.
closeStore();
}
LOG
.
info(
"
Moquette integration has been stopped.
"
);
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Added password file for identity management on connect (Fix #23)
Version 0.4:
Dropped support for MINA
Fix Issue 15 (bad re-activation of client's subscriptions after a recconection)
Fix Issue 16 (bad re-publish of stored messages after a client reconnection)
Fixed a bug in unsubscribe due to missed clientID check
Fixed Issue 18 (descriptor of a disconnected (not active) client)
Bug fix for override subscriptions to the same /topic but with different QoS (latest wins)
Added test to check the downgrading of QoS of messages sent to registered subscribers (fixed a bug of double delivery of QoS2 messages)
Version 0.3:
Added Netty IO connectors
Dropped tests based on Fuse source client lib moving to Paho java client
Version 0.2:
Fixed issues (10, 11, 12, 13)
Fixed interdependency bug in test
Copy lines
Copy permalink
"
value
=
"
^(\s|\*)*Copyright\s.*$
"
/>
<
property
name
=
"
minimum
"
value
=
"
1
>
</
version
>
</
dependency
>
<
dependency
>
<
groupId
>io.netty</
groupId
>
<
artifactId
>netty-transport</
>
<!--
<!--
<configLocation>/google_checks.xml</configLocation>
<configLocation>/google_checks.xml</configLocation>
-->
-->
Toggle all file notes
0 comments on commit
e2aa30d
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
"
value
=
"
missing copyright header
"
/>
</
module
>
<!--
Unmaintainable Javadoc tags
-->
<
module
name
=
"
RegexpSingleline
AvoidNestedBlocks
"
>
<
property
name
=
"
allowInSwitchCase
"
value
=
"
true
"
/>
</
module
public
void
receivedPublishQos2
(
int
messageID
,
MqttPublishMessage
msg
) {
qos2Receiving
.
put(messageID, msg);
msg
.
retain();
//
retain to put in the inflight map
com.google.errorprone:error_prone_core:2.0.14
'
}
ext {
nettyVersion
=
'
4.1.12.Final
'
@@ -85,5 +82,5 @@ subprojects {
}
task
wrapper
(
type
:
Wrapper
.
receivedPublishQos1(publisher,
new
Topic
(topic),
TEST_USER
, bytePayload, messageID,
false
,
MqttMessageBuilders
.
publish()
.payload(
Unpooled
.
copiedBuffer(payload,
Charset
queueRepository
=
queueRepository;
}
void
bindToSession
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
msg
,
String
clientId
) {
@@ -178,9 +179,9 @@ private void unsubscribe(Session session) {
}
private
.
separator
+
DEFAULT_MOQUETTE_STORE_H2_DB_FILENAME
;
}
public
static
Properties
prepareTestProperties
() {
Properties
testProperties
=
new
Properties
();
testProperties
Contributor, if any, and such derivative works, in source code and object code
form.
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
"
"
$args3
"
"
$args4
"
"
$args5
"
"
$args6
"
"
$args7
"
;;
(9)
this
.
clientId
=
clientId;
this
(clean, clientId, sessionQueue);
this
.
clean
=
clean;
this
.
will
=
will;
this
EmbeddedChannel
secondChannel
=
new
EmbeddedChannel
();
MQTTConnection
secondConn
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, secondChannel);
secondConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
>
<
role
>developer</
role
>
<
role
>founder</
role
>
</
roles
>
<
timezone
>+1</
timezone
>
}
/**
* SPI method used by Broker embedded applications to get list of subscribers. Returns null if
* the broker is not started.
*
*
@return
list of subscriptions.
*/
//
TODO reimplement this
//
public List<Subscription> getSubscriptions() {
//
if (m_processorBootstrapper == null) {
//
return null;
//
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
"
/>
<
property
name
=
"
maximum
"
value
=
"
1
"
/>
<
property
name
=
artifactId
>
<
version
>
</
version
>
</
dependency
>
<
dependency
>
<
groupId
>io.netty</
groupId
>
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
>
<
property
name
=
"
format
"
value
=
"
(@(author|version)|\(non-Javadoc\))
"
/>
<
property
name
>
<
module
name
=
"
FinalClass
"
/>
<
module
name
=
"
HideUtilityClassConstructor
"
mqttConnection
.
sendPublishReceived(messageID);
}
public
void
receivedPubRelQos2
(
int
messageID
) {
final
MqttPublishMessage
removedMsg
) {
gradleVersion
=
'
3.3
'
gradleVersion
=
'
4.6
'
.
defaultCharset()))
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
Session
createNewSession
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
msg
,
String
clientId
) {
final
Queue<
SessionRegistry
.
EnqueuedMessage
.
put(
PERSISTENT_STORE_PROPERTY_NAME
,
IntegrationUtils
.
localMapDBPath
());
testProperties
.
put(
PERSISTENT_STORE_PROPERTY_NAME
,
IntegrationUtils
.
localH2MvStoreDBPath
());
testProperties
<
span
style
="
font-size: 10pt;
"
>
b)
Subject to the terms of this Agreement, each Contributor hereby grants
Recipient a non-exclusive, worldwide,
<
span
style
="
color: green;
"
set
--
"
$args0
"
"
$args1
"
"
$args2
"
"
$args3
"
"
$args4
"
"
.
will
=
will;
this
.
sessionQueue
=
sessionQueue;
}
}
Session
(
boolean
clean
,
String
clientId
,
FAKE_CLIENT_ID
));
ConnectionTestUtils
.
assertConnectAccepted(secondChannel);
subscribe(secondConn,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
//
publish a QoS 1 message another client publish a message on the topic
EmbeddedChannel
pubChannel
=
new
EmbeddedChannel
();
MQTTConnection
</
developer
>
</
developers
>
<
contributors
>
<
contributor
>
<
name
>Steven Warwick</
name
>
}
//
return this.subscriptionsStore.listAllSubscriptions();
//
}
/**
* SPI method used by Broker embedded applications to add intercept handlers.
*
*
@param
interceptHandler the handler to add.
*/
public
void
addInterceptHandler
(
InterceptHandler
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
"
message
"
value
=
"
missing copyright header
"
/>
</
module
>
<!--
Unmaintainable Javadoc tags
-->
<!--
module name="RegexpSingleline">
<property name="format" value="(@(author|version)|\(non-Javadoc\))"/>
<
artifactId
>netty-handler</
artifactId
>
<
version
>
</
version
>
</
dependency
>
<
dependency
>
<
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
=
"
ignoreCase
"
value
=
"
true
"
/>
<
property
name
=
"
message
"
value
/>
<
module
name
=
"
CovariantEquals
"
/>
<
module
name
=
"
EmptyStatement
"
/>
=
qos2Receiving
.
remove(messageID);
ReferenceCountUtil
.
release(removedMsg);
}
@Override
public
String
toString
() {
return
"
Session{
}
15
gradle/lint.gradle
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,10 @@
apply
plugin
:
'
checkstyle
'
apply
plugin
:
'
findbugs
.
build());
}
private
void
publishQos2
(
MQTTConnection
connection
,
String
topic
,
String
payload
) {
final
ByteBuf
bytePayload
>
sessionQueue
=
queues
.
computeIfAbsent(clientId, (
String
cli)
-
>
new
ConcurrentLinkedQueue<>
());
final
boolean
clean
=
msg
.
put(
PORT_PROPERTY_NAME
,
"
1883
"
);
return
testProperties;
}
public
static
Properties
prepareTestClusterProperties
(
int
port
>
</
span
>
royalty-free
patent license under Licensed Patents to make, use, sell, offer to sell, import
and otherwise transfer the Contribution of such Contributor, if any, in source
code and object code form. This patent license shall apply to the combination
of the Contribution and the Program if, at the time the Contribution is added
by the Contributor, such addition of the Contribution causes such combination
to be covered by the Licensed Patents. The patent license shall not apply to
any other combinations which include the Contribution. No hardware per se is
licensed hereunder.
</
span
>
</
$args5
"
"
$args6
"
"
$args7
"
"
$args8
"
;;
esac
fi
#
Escape application args
save
() {
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
) {
Session
(
boolean
clean
,
String
clientId
,
Queue<
SessionRegistry
.
EnqueuedMessage
pubConn
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, pubChannel);
pubConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
PUBLISHER_ID
));
ConnectionTestUtils
.
assertConnectAccepted(pubChannel);
final
ByteBuf
anyPayload
<
url
>http://stevenwarwick.com</
url
>
</
contributor
>
<
contributor
>
<
name
>Igor Yova</
name
>
<
url
interceptHandler
) {
if
(
!
initialized) {
LOG
.
error(
"
Moquette is not started, MQTT message interceptor cannot be added. InterceptorId={}
"
,
interceptHandler
.
getID());
throw
new
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
<property name="ignoreCase" value="true"/>
<property name="message" value="unmaintainable Javadoc tags: @author, @version, or (non-Javadoc)"/>
</module
-->
<!--
IDE-generated comment
-->
<
module
name
=
"
RegexpSingleline
"
>
<
groupId
>io.netty</
groupId
>
<
artifactId
>netty-codec</
artifactId
>
<
version
>
</
version
>
</
dependency
>
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
=
"
unmaintainable Javadoc tags: @author, @version, or (non-Javadoc)
"
/>
</
module
>
<!--
IDE-generated comment
-->
<
module
name
=
"
RegexpSingleline
"
moquette/license.txt at af8c0e3b9a186faf144f51218b934188af8b1120 · moquette-io/moquette · GitHub
<
module
name
=
"
EqualsHashCode
"
/>
<!--
<module name="FinalLocalVariable"/>
-->
<!--
Commented out due to http://jira.codehaus.org/browse/MCHECKSTYLE-111
<module name="RedundantThrows">
<property name="logLoadErrors" value="false"/>
<property name="suppressLoadErrors" value="true"/>
</module>
"
+
"
clientId='
"
+
clientId
+
'
\'
'
+
"
, clean=
"
+
clean
+
'
apply
plugin
:
'
com.github.spotbugs
'
apply
plugin
:
'
net.ltgt.errorprone
'
dependencies
{
errorprone
"
com.google.errorprone:error_prone_core:2.2.0
Added Apache 2.0 license · moquette-io/moquette@af8c0e3 · GitHub
=
Unpooled
.
copiedBuffer(payload,
Charset
.
defaultCharset());
sut
.
receivedPublishQos2(connection,
MqttMessageBuilders
.
publish()
.payload(bytePayload)
.qos(
MqttQoS
.
EXACTLY_ONCE
.
variableHeader()
.
isCleanSession();
final
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
=
queues
.
computeIfAbsent(clientId, (
String
cli)
-
) {
Properties
testProperties
=
new
Properties
();
testProperties
.
put(
PERSISTENT_STORE_PROPERTY_NAME
,
IntegrationUtils
.
localClusterMapDBPath(port));
testProperties
.
put(
PORT_PROPERTY_NAME
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
for
i
do
printf
%s
\\
n
"
$i
"
|
sed
"
s/'/'
\\\\
''/g;1s/^/'/;
\$
s/
\$
>
sessionQueue
) {
13
broker/src/main/java/io/moquette/broker/SessionRegistry.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
package
io.moquette.broker
;
package
io.moquette.broker
;
import
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos1(pubConn,
new
Topic
(
NEWS_TOPIC
>https://github.com/Fameing</
url
>
</
contributor
>
<
contributor
>
<
name
>Luca Capra</
name
>
<
url
>https://github.com/muka</
url
>
IllegalStateException
(
"
Can't register interceptors on a integration that is not yet started
"
);
}
LOG
.
info(
"
Adding MQTT message interceptor. InterceptorId={}
"
, interceptHandler
.
getID());
interceptor
property
name
=
"
format
"
value
=
"
File \| Settings \| File Templates
"
/>
<
property
name
=
"
message
<
dependency
>
<
groupId
>io.netty</
groupId
>
<
artifactId
>netty-codec-http</
artifactId
>
@@ -71,13 +71,13 @@
<
artifactId
>commons-codec</
artifactId
>
<
property
name
=
"
format
"
value
=
"
File \| Settings \| File Templates
"
/>
<
property
name
=
"
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
-->
<
module
name
=
"
SimplifyBooleanExpression
"
/>
<
module
name
=
"
SimplifyBooleanReturn
"
"
, status=
"
+
status
+
"
, inflightSlots=
"
+
inflightSlots
+
'
}
'
;
"
}
checkstyle
{
configProperties
.
checkstyleConfigDir
=
"
.
"
@@ -8,12 +13,8 @@ checkstyle {
toolVersion
=
'
6.7
'
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
)
.retained(
true
)
.topicName(
NEWS_TOPIC
)
.
build(),
"
username
"
);
}
/**
* subscriber connect and subscribe on "topic" subscriber disconnects publisher connects and
* send two message "hello1" "hello2" to "topic" subscriber connects again and receive "hello1"
>
queueRepository
.
createQueue(cli, clean));
final
Session
newSession;
if
(msg
.
variableHeader()
.
isWillFlag()) {
final
Session
.
Will
will
,
Integer
.
toString(port));
return
testProperties;
}
/*
public static void cleanPersistenceFile(IConfig config) {
String fileName = config.getProperty(PERSISTENT_STORE_PROPERTY_NAME);
cleanPersistenceFile(fileName);
private
IntegrationUtils
() {
}
public static void cleanPersistenceFile(String fileName) {
File dbFile = new File(fileName);
public
static
c)
Recipient understands that although each Contributor grants the licenses to its
Contributions set forth herein, no assurances are provided by any Contributor
that the Program does not infringe the patent or other intellectual property
rights of any other entity. Each Contributor disclaims any liability to Recipient
for claims brought by any other entity based on infringement of intellectual
property rights or otherwise. As a condition to exercising the rights and
licenses granted hereunder, each Recipient hereby assumes sole responsibility
to secure any other intellectual property rights needed, if any. For example,
if a third party patent license is required to allow Recipient to distribute
the Program, it is Recipient's responsibility to acquire that license before
distributing the Program.
</
span
/'
\\\\
/
"
;
done
echo
"
"
}
APP_ARGS=
$(
save
"
$@
"
)
#
Collect all arguments for the java command, following the shell quoting and substitution rules
eval
io.moquette.broker.Session.SessionStatus
;
import
io.moquette.broker.Session.SessionStatus
;
import
io.moquette.interception.BrokerInterceptor
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
),
TEST_USER
, anyPayload,
1
,
true
,
MqttMessageBuilders
.
publish()
.payload(anyPayload
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
</
contributor
>
<
contributor
>
<
name
>Wagner Macedo</
name
>
<
url
>https://github.com/wagnerluis1982</
url
>
</
contributor
.
addInterceptHandler(interceptHandler);
}
/**
* SPI method used by Broker embedded applications to remove intercept handlers.
*
*
@param
interceptHandler the handler to remove.
*/
public
void
removeInterceptHandler
(
InterceptHandler
interceptHandler
) {
if
"
value
=
"
IDE-generated comment
"
/>
</
module
>
<!--
Force UNIX line separator
<module name="io.netty.build.checkstyle.NewlineCheck"/>
-->
<!--
Trailing whitespace
-->
<
>
<
version
>1.10</
version
>
</
dependency
>
<
dependency
>
<
groupId
>org.mapdb</
groupId
>
<
artifactId
message
"
value
=
"
IDE-generated comment
"
/>
</
module
>
<!--
Force UNIX line separator
<module name="io.netty.build.checkstyle.NewlineCheck"/>
-->
<!--
Trailing whitespace
-->
<
Added Apache 2.0 license · moquette-io/moquette@af8c0e3 · GitHub
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
/>
<
module
name
=
"
SuperFinalize
"
/>
<
module
name
=
"
PackageDeclaration
"
/>
<
module
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
}
findbugs
{
toolVersion
=
'
3.
0
.1
'
spotbugs
{
toolVersion
=
'
3.
1
.1
'
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
* "hello2"
*/
@Test
public
void
checkQoS2SubscriberDisconnectReceivePersistedPublishes
() {
connect(
this
.
connection,
FAKE_CLIENT_ID
);
subscribe(connection,
NEWS_TOPIC
,
=
createWill(msg);
5
broker/src/main/java/io/moquette/persistence/H2Builder.java
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,7 @@
package
io.moquette.persistence
;
import
io.moquette.BrokerConstants
;
import
io.moquette.broker.IQueueRepository
void
clearTestStorage
() {
String
dbPath
=
localH2MvStoreDBPath();
File
dbFile
=
new
File
(dbPath);
if
(dbFile
.
exists()) {
dbFile
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
set
--
$DEFAULT_JVM_OPTS
$JAVA_OPTS
$GRADLE_OPTS
"
\"
-Dorg.gradle.appname=
$APP_BASE_NAME
\"
"
-classpath
"
\"
$CLASSPATH
\"
"
org.gradle.wrapper.GradleWrapperMain
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.subscriptions.Topic
;
@@ -32,9 +31,9 @@
import
java.util.concurrent.ConcurrentLinkedQueue
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
import
java.util.concurrent.ConcurrentMap
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify that after a reconnection the client receive the message
ConnectionTestUtils
.
verifyPublishIsReceived(secondChannel,
AT_LEAST_ONCE
,
"
Any payload
"
);
}
@Test
>
<
contributor
>
<
name
>Luis Barrios</
name
>
<
url
>https://github.com/lbarriosh</
url
>
</
contributor
>
<
contributor
(
!
initialized) {
LOG
.
error(
"
Moquette is not started, MQTT message interceptor cannot be removed. InterceptorId={}
"
,
interceptHandler
.
getID());
throw
new
IllegalStateException
(
"
module
name
=
"
RegexpSingleline
"
>
<
property
name
=
"
format
"
value
=
"
\s+$
"
moquette/about.html at master · moquette-io/moquette · GitHub
>mapdb</
artifactId
>
<!--
version>1.1.0-SNAPSHOT</version
-->
<!--
<version>2.0.0-SNAPSHOT</version>
-->
<!--
<version>2.0-alpha3</version>
-->
<!--
version>1.1.0-SNAPSHOT</version
-->
<!--
<version>2.0.0-SNAPSHOT</version>
-->
module
name
=
"
RegexpSingleline
"
>
<
property
name
=
"
format
"
value
=
"
\s+$
"
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Bumped 0.3 · moquette-io/moquette@f4162c2 · GitHub
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
name
=
"
ExplicitInitialization
"
/>
<
module
name
=
"
DefaultComesLast
"
/>
<
module
name
=
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
ignoreFailures true
omitVisitors
=
[
'
RuntimeExceptionCapture
'
]
}
tasks
.
withType(
FindBugs
) {
maxHeapSize
=
'
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
EXACTLY_ONCE
);
connection
.
processDisconnect(
null
);
final
MQTTConnection
publisher
=
connectAs(
"
Publisher
"
);
publishQos2(publisher,
NEWS_TOPIC
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.config.IConfig
;
import
org.h2.mvstore.MVStore
;
@@ -52,4 +53,8 @@ public ISubscriptionsRepository subscriptionsRepository() {
public
void
closeStore
() {
mvStore
.
.
delete();
new File(fileName + ".p").delete();
new File(fileName + ".t").delete();
}
assertFalse(dbFile
.
exists());
}
*/
private
IntegrationUtils
() {
}
}
4
broker/src/test/java/io/moquette/integration/ServerIntegrationDBAuthenticatorTest.java
Show comments
font-size: 10pt;
"
>
d)
Each Contributor represents that to its knowledge it has sufficient copyright
rights in its Contribution, if any, to grant the copyright license set forth in
this Agreement.
</
span
>
</
p
>
<
p
>
<
b
"
$APP_ARGS
"
#
by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
if
[
"
$(
uname
)
"
=
"
Darwin
"
]
&&
;
import
java.util.concurrent.ConcurrentMap
;
class
SessionRegistry
{
public
class
SessionRegistry
{
abstract
static
class
EnqueuedMessage
{
public
abstract
public
void
noPublishToInactiveSession
() {
//
create an inactive session for Subscriber
connection
.
processConnect(
ConnectionTestUtils
.
buildConnectNotClean(
SUBSCRIBER_ID
));
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
>
<
name
>Christophe Mourette</
name
>
<
url
>https://github.com/mackristof</
url
>
</
contributor
>
<
contributor
>
<
Can't deregister interceptors from a integration that is not yet started
"
);
}
LOG
.
info(
"
Removing MQTT message interceptor. InterceptorId={}
"
, interceptHandler
.
getID());
interceptor
.
removeInterceptHandler(interceptHandler);
}
}
Copy lines
/>
<
property
name
=
"
message
"
value
=
"
trailing whitespace
"
/>
</
module
>
<!--
Prohibit consecutive empty lines (except the lines after package/import)
Join GitHub · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
<!--
<version>2.0-alpha3</version>
-->
<
version
>1.0.8</
version
>
</
dependency
>
@@ -111,11 +111,11 @@
<!--
/>
<
property
name
=
"
message
"
value
=
"
trailing whitespace
"
/>
</
module
>
<!--
Minor, changed header (#536) · moquette-io/moquette@8ba0b4d · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
"
UnnecessaryParentheses
"
/>
<!--
<module name="AvoidStarImport">
<property name="allowStaticMemberImports" value="true"/>
</module>
-->
<
module
name
=
"
RedundantImport
"
/>
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
2g
'
}
BIN
+1005 Bytes (100%)
gradle/wrapper/gradle-wrapper.jar
Show comments
View file
Edit file
Delete file
Binary file not shown.
3
gradle/wrapper/gradle-wrapper.properties
Show comments
View file
Edit file
Delete file
moquette/README.md at master · moquette-io/moquette · GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
,
"
Hello world MQTT!!-1
"
);
publishQos2(publisher,
NEWS_TOPIC
,
"
Hello world MQTT!!-2
"
);
createMQTTConnection(
CONFIG
);
connect(
this
.
connection,
close();
}
public
IQueueRepository
queueRepository
() {
return
new
H2QueueRepository
(mvStore);
}
}
3
...tte/persistence/h2/H2PersistentQueue.java → ...quette/persistence/H2PersistentQueue.java
Show comments
View file
Edit file
View file
Edit file
Delete file
@@ -32,6 +32,8 @@
import
java.security.NoSuchAlgorithmException
;
import
java.sql.SQLException
;
import
java.util.Properties
;
import static
org.junit.Assert.assertFalse
;
import static
org.junit.Assert.assertTrue
>
<
span
style
="
font-size: 10pt;
"
>
3. REQUIREMENTS
</
span
>
</
b
>
</
p
>
<
[
"
$HOME
"
=
"
$PWD
"
]
;
then
cd
"
$(
dirname
"
$0
static
class
EnqueuedMessage
{
}
}
static
class
PublishedMessage
extends
EnqueuedMessage
{
static
NEWS_TOPIC
,
AT_LEAST_ONCE
);
connection
.
processDisconnect(
null
);
//
Exercise
name
>Victor Kazakov</
name
>
<
url
>https://github.com/kazvictor</
url
>
</
contributor
>
<
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
-->
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
=
"
format
"
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
needs extra dependencies: objenesis & hamcrest
-->
<
dependency
>
<
groupId
>org.mockito</
groupId
>
<
artifactId
>mockito-core</
artifactId
>
<
version
>1.9.0</
Prohibit consecutive empty lines (except the lines after package/import)
-->
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
=
"
format
"
value
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
<!--
Commented out due to false positives.
<module name="UnusedImports">
<property name="processJavadoc" value="true"/>
</module>
-->
<
module
name
=
"
JavadocStyle
"
>
<
property
name
@@ -1,6 +1,5 @@
#
Thu Aug 10 18:13:58 CEST 2017
distributionBase
=GRADLE_USER_HOME
distributionPath
=wrapper/dists
distributionUrl
=https\://services.gradle.org/distributions/gradle-4.6-bin.zip
zipStoreBase
=GRADLE_USER_HOME
zipStorePath
=wrapper/dists
distributionUrl
=
https\://services.gradle.org/distributions/gradle-3.3-bin.zip
26
gradlew
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
FAKE_CLIENT_ID
);
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
EXACTLY_ONCE
,
"
Hello world MQTT!!-1
"
);
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
EXACTLY_ONCE
,
Delete file
@@ -13,7 +13,7 @@
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.persistence
.h2
;
package
io.moquette.persistence
;
import
org.h2.mvstore.MVMap
;
import
org.h2.mvstore.MVStore
;
public
class
ServerIntegrationDBAuthenticatorTest
{
@@ -99,6 +101,8 @@ public void tearDown() throws Exception {
}
stopServer();
IntegrationUtils
.
clearTestStorage();
}
@AfterClass
2
broker/src/test/java/io/moquette/integration/ServerIntegrationFuseTest.java
Show comments
p
>
<
span
style
="
font-size: 10pt;
"
>
A Contributor may choose to distribute the
Program in object code form under its own license agreement, provided that:
</
span
>
</
p
>
<
"
)
"
fi
exec
"
$JAVACMD
"
"
$@
"
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
class
PublishedMessage
extends
EnqueuedMessage
{
@@ -61,10 +60,12 @@
private
final
ConcurrentMap<
String
,
Session
>
pool
=
new
ConcurrentHashMap<>
();
private
EmbeddedChannel
pubChannel
=
new
EmbeddedChannel
();
MQTTConnection
pubConn
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, pubChannel);
pubConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
contributor
>
<
name
>Neeme Praks</
name
>
<
url
>https://github.com/nemecec</
url
>
</
contributor
>
<
contributor
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
value
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
two or more consecutive empty lines
"
/>
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
version
>
<
artifactId
>mockito-core</
artifactId
>
<
version
>1.9.0</
version
>
<
scope
>test</
scope
>
</
dependency
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
two or more consecutive empty lines
"
/>
</
module
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Sign in to GitHub · GitHub
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Added GitHub Issue template · moquette-io/moquette@a49792a · GitHub
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
af8c0e3b9a
moquette
/
license.txt
Go to file
Go to file
T
Go to line
=
"
checkFirstSentence
"
value
=
"
false
"
/>
</
module
>
<
module
name
=
Show comments
View file
Edit file
Delete file
@@ -1,4 +1,4 @@
#!
/usr/bin/env
bash
#!
/usr/bin/env
sh
#
#############################################################################
#
#
@@ -33,11 +33,11 @@ DEFAULT_JVM_OPTS=""
#
Use the maximum available, or set MAX_FD != -1 to use that value.
remove unnecessary quotes (#478) · moquette-io/moquette@d2cce3f · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Projects
Wiki
Security
Insights
Permalink
Browse files
Added Apache 2.0 license
Loading branch information
andsel
committed
Oct 4, 2013
1 parent
f4162c2
commit
af8c0e3b9a186faf144f51218b934188af8b1120
Unified
Split
Showing
"
Hello world MQTT!!-2
"
);
}
/**
* subscriber connect and subscribe on "a/b" QoS 1 and "a/+" QoS 2 publisher connects and send a
* message "hello" on "a/b" subscriber must receive only a single message not twice
*/
@Test
public
void
checkSinglePublishOnOverlappingSubscriptions
() {
final
MQTTConnection
publisher
=
connectAs(
;
@@ -88,6 +88,7 @@ public T poll() {
}
final
long
nextTail
=
tail
.
getAndIncrement();
final
T
tail
=
this
.
queueMap
View file
Edit file
Delete file
@@ -68,6 +68,8 @@ public void tearDown() throws Exception {
}
m_server
.
stopServer();
IntegrationUtils
.
clearTestStorage();
}
@Test
2
broker/src/test/java/io/moquette/integration/ServerIntegrationOpenSSLTest.java
Show comments
View file
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
a)
it complies with the terms and conditions of this Agreement; and
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
final
ConcurrentMap<
String
,
Session
>
pool
=
new
ConcurrentHashMap<>
();
private
final
ISubscriptionsDirectory
subscriptionsDirectory;
private
final
ISubscriptionsDirectory
subscriptionsDirectory;
PUBLISHER_ID
));
ConnectionTestUtils
.
assertConnectAccepted(pubChannel);
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
>
<
name
>Kevin Berendsen</
name
>
<
url
>https://github.com/kevto</
url
>
</
contributor
>
<
contributor
>
<
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
</
module
>
<!--
-->
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
=
"
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
Search
All GitHub
↵
Jump to
↵
No suggested jump to results
Search
All GitHub
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
>
<
dependency
>
<
groupId
>org.fusesource.mqtt-client</
groupId
>
<
artifactId
>mqtt-client</
artifactId
>
@@ -129,7 +129,7 @@
<
version
>1.0.2</
>
<!--
-->
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
=
"
format
"
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
moquette/about.html at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
moquette/.gitignore at master · moquette-io/moquette · GitHub
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
L
Copy path
Cannot retrieve contributors at this time
205 lines (170 sloc)
11.3 KB
Raw
Blame
Copyright 2012-2013 (c) Andrea Selva
Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/
TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
1. Definitions.
"License" shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.
"Licensor" shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.
"
UpperEll
"
/>
<
module
name
=
"
ArrayTypeStyle
"
/>
<
module
name
=
"
MAX_FD=
"
maximum
"
warn (
) {
warn
() {
echo
"
$*
"
}
die (
) {
die
() {
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
1 changed file
with
205 additions
and
0 deletions
.
+205
−0
license.txt
205
license.txt
Show comments
"
Publisher
"
);
connect(
this
.
connection,
FAKE_CLIENT_ID
);
subscribe(connection,
"
a/b
"
,
AT_LEAST_ONCE
);
subscribe(connection,
.
get(nextTail);
queueMap
.
remove(nextTail);
this
.
metadataMap
.
put(
"
tail
"
, nextTail
+
1
);
return
tail;
Edit file
Delete file
@@ -55,7 +55,7 @@ protected void startServer() throws IOException {
sslProps
.
put(
BrokerConstants
.
JKS_PATH_PROPERTY_NAME
,
"
serverkeystore.jks
"
);
sslProps
.
put(
BrokerConstants
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
private
final
IQueueRepository
queueRepository;
private
final
ConcurrentMap<
String
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
defaultCharset());
sut
.
receivedPublishQos1(pubConn,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
,
MqttMessageBuilders
.
publish()
.payload(anyPayload)
name
>Chris Schaefer</
name
>
<
url
>https://github.com/windbender</
url
>
</
contributor
>
<
contributor
>
<
name
>Keith Hughes</
name
format
"
value
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
an empty line before '}'
↵
Jump to
↵
Search
All GitHub
↵
Jump to
↵
Sign in
Join GitHub
Create your account
GitHub requires JavaScript enabled during sign up, for our signup captcha. Please enable JavaScript during sign up.
Username
Email address
Password
Make sure it's
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
version
>
<
scope
>test</
scope
>
</
dependency
>
<
dependency
>
<
groupId
>org.eclipse.jetty.websocket</
groupId
value
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
an empty line before '}'
"
/>
Added implementation of retained store in H2 · moquette-io/moquette@2138513 · GitHub
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Updated travis ci config to openjdk12 · moquette-io/moquette@fc1b603 · GitHub
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Projects
Wiki
Security
Insights
Permalink
Browse files
Added Apache 2.0 license
Loading branch information
andsel
committed
Oct 4, 2013
1 parent
f4162c2
commit
af8c0e3b9a186faf144f51218b934188af8b1120
Unified
Split
remove unnecessary quotes which fixes execution in windows 10 by joestr · Pull Request #478 · moquette-io/moquette · GitHub
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
"Legal Entity" shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
control with that entity. For the purposes of this definition,
"control" means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.
"You" (or "Your") shall mean an individual or Legal Entity
exercising permissions granted by this License.
"Source" form shall mean the preferred form for making modifications,
including but not limited to software source code, documentation
source, and configuration files.
"Object" form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
not limited to compiled object code, generated documentation,
and conversions to other media types.
OuterTypeFilename
"
/>
<
module
name
=
"
ModifierOrder
"
/>
<
module
name
=
"
RedundantModifier
"
/>
echo
echo
"
$*
"
echo
@@ -154,11 +154,19 @@ if $cygwin ; then
esac
fi
#
Split up the JVM_OPTS And GRADLE_OPTS values into an array, following the shell quoting and substitution rules
splitJvmOpts()
{
JVM_OPTS=(
"
$@
"
)
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
View file
Edit file
Delete file
@@ -0,0 +1,205 @@
Copyright 2012-2013 (c) Andrea Selva
Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/
TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
1. Definitions.
"License" shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.
"Licensor" shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.
"Legal Entity" shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
"
a/+
"
,
EXACTLY_ONCE
);
//
force the publisher to send
publishQos1(publisher,
"
a/b
"
,
"
Hello world MQTT!!
"
,
60
}
25
broker/src/main/java/io/moquette/persistence/H2QueueRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,25 @@
package
io.moquette.persistence
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.SessionRegistry
;
.
KEY_STORE_PASSWORD_PROPERTY_NAME
,
"
passw0rdsrv
"
);
sslProps
.
put(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
,
"
passw0rdsrv
"
);
sslProps
style
="
font-size: 10pt;
"
>
b)
its license agreement:
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
>
queues
=
new
ConcurrentHashMap<>
();
private
final
ConcurrentMap<
String
,
Queue<
SessionRegistry
.
EnqueuedMessage
>
>
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
.retained(
true
)
.topicName(
NEWS_TOPIC
)
.
build());
verifyNoPublishIsReceived(channel);
}
private
>
<
url
>http://www.inhabitech.com/blog/author/keith/</
url
>
</
contributor
>
</
contributors
>
<
scm
>
<
connection
"
/>
</
module
>
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
=
"
format
at least 15 characters
OR
at least 8 characters
including a number
and a lowercase letter
.
Learn more
.
Email preferences
Send me occasional product updates, announcements, and offers.
Verify your account
Create account
By creating an account, you agree to the
Terms of Service
. For more information about GitHub's privacy practices, see the
GitHub Privacy Statement
. We'll occasionally send you account-related emails.
Product
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
about.html
Go to file
Go to file
T
>
<
artifactId
>websocket-client</
artifactId
>
@@ -152,7 +152,7 @@
<
scope
>test</
scope
>
</
</
module
>
<
module
name
=
"
RegexpMultiline
"
>
<
property
name
=
"
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
moquette/.travis.yml at master · moquette-io/moquette · GitHub
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Showing
1 changed file
with
205 additions
and
0 deletions
.
+205
−0
license.txt
205
license.txt
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,205 @@
Copyright 2012-2013 (c) Andrea Selva
Moved packages from old io.moquette.server to new io.moquette.broker · moquette-io/moquette@1ba9eb3 · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Wiki
Security
Insights
Permalink
Browse files
Bumped 0.3
Loading branch information
andsel
committed
Sep 23, 2013
1 parent
64e332f
commit
f4162c286815c9dc9fd8cd59bfaa723f1432ca72
Unified
Split
Showing
"Work" shall mean the work of authorship, whether in Source or
Object form, made available under the License, as indicated by a
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).
"Derivative Works" shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.
"Contribution" shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
or by an individual or Legal Entity authorized to submit on behalf of
<
module
name
=
"
GenericWhitespace
"
/>
<
module
name
=
"
EmptyForInitializerPad
"
/>
#
Escape application args
save
() {
for
i
do
printf
%s
\\
n
"
$i
"
|
sed
"
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
control with that entity. For the purposes of this definition,
"control" means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.
"You" (or "Your") shall mean an individual or Legal Entity
exercising permissions granted by this License.
"Source" form shall mean the preferred form for making modifications,
including but not limited to software source code, documentation
source, and configuration files.
"Object" form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
not limited to compiled object code, generated documentation,
and conversions to other media types.
"Work" shall mean the work of authorship, whether in Source or
);
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
"
Hello world MQTT!!
"
);
ConnectionTestUtils
.
verifyNoPublishIsReceived(channel);
}
}
Copy lines
import
org.h2.mvstore.MVStore
;
import
java.util.Queue
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
public
class
H2QueueRepository
implements
IQueueRepository
{
private
MVStore
.
put(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
,
IntegrationUtils
.
localMapDBPath
());
sslProps
.
put(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
,
IntegrationUtils
.
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
i)
effectively disclaims on behalf of all Contributors all warranties and
conditions, express and implied, including warranties or conditions of title
and non-infringement, and implied warranties or conditions of merchantability
and fitness for a particular purpose;
</
queues
=
new
ConcurrentHashMap<>
();
SessionRegistry
(
ISubscriptionsDirectory
subscriptionsDirectory
,
BrokerInterceptor
m_interceptor
) {
SessionRegistry
(
ISubscriptionsDirectory
subscriptionsDirectory
void
verifyNoPublishIsReceived
(
EmbeddedChannel
channel
) {
final
Object
messageReceived
=
channel
.
readOutbound();
assertNull(
"
Received an out message from processor while not expected
"
, messageReceived);
>scm:git:git@github.com:andsel/moquette.git</
connection
>
<
developerConnection
>scm:git:git@github.com:andsel/moquette.git</
developerConnection
>
<
url
>git@github.com:andsel/moquette.git</
url
>
</
scm
>
<
modules
"
value
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
an empty line after a short line that ends with '{'
Features
Security
Team
Enterprise
Customer stories
The ReadME Project
Pricing
Resources
Roadmap
Platform
Developer API
Partners
Atom
Electron
GitHub Desktop
Support
Help
Community Forum
Go to line
L
Copy path
Cannot retrieve contributors at this time
27 lines (23 sloc)
1.21 KB
Raw
Blame
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
>
<
html
xmlns
="
http://www.w3.org/1999/xhtml
"
dependency
>
</
dependencies
>
<
build
>
<
plugins
>
<
plugin
>
@@ -165,32 +165,32 @@
</
configuration
format
"
value
=
"
"
/>
<
property
name
=
"
message
"
value
=
"
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Minor, changed header (
#536
)
Loading branch information
andsel
committed
Oct 1, 2020
Verified
This commit was created on GitHub.com and signed with a
verified signature
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/
TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
1. Definitions.
"License" shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.
"Licensor" shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.
"Legal Entity" shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
control with that entity. For the purposes of this definition,
"control" means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.
"You" (or "Your") shall mean an individual or Legal Entity
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
1 changed file
with
1 addition
and
1 deletion
.
+1
−1
pom.xml
2
pom.xml
Show comments
View file
Edit file
Delete file
@@ -3,7 +3,7 @@
xsi
:
the copyright owner. For the purposes of this definition, "submitted"
means any form of electronic, verbal, or written communication sent
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
designated in writing by the copyright owner as "Not a Contribution."
"Contributor" shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
subsequently incorporated within the Work.
2. Grant of Copyright License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
Work and such Derivative Works in Source or Object form.
3. Grant of Patent License. Subject to the terms and conditions of
<
module
name
=
"
EmptyForIteratorPad
"
/>
<
module
name
=
"
MethodParamPad
"
/>
<
s/'/'
\\\\
''/g;1s/^/'/;
\$
s/
\$
/'
\\\\
/
"
;
done
echo
"
"
}
eval
splitJvmOpts
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
Object form, made available under the License, as indicated by a
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).
"Derivative Works" shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.
"Contribution" shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
or by an individual or Legal Entity authorized to submit on behalf of
the copyright owner. For the purposes of this definition, "submitted"
means any form of electronic, verbal, or written communication sent
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
mvStore;
public
H2QueueRepository
(
MVStore
mvStore
) {
this
.
mvStore
=
mvStore;
localH2MvStoreDBPath
());
m_server
.
startServer(sslProps);
}
}
2
broker/src/test/java/io/moquette/integration/ServerIntegrationPahoTest.java
Show comments
View file
Edit file
Delete file
@@ -80,6 +80,8 @@ public void tearDown() throws Exception {
}
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
,
IQueueRepository
queueRepository
) {
this
.
subscriptionsDirectory
=
subscriptionsDirectory;
this
.
subscriptionsDirectory
=
subscriptionsDirectory;
this
.
queueRepository
}
@Test
public
void
cleanRetainedMessageStoreWhenPublishWithRetainedQos0IsReceived
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
//
publish a QoS1 retained message
final
ByteBuf
anyPayload
=
>
<
module
>netty_parser</
module
>
<
module
>broker</
module
>
<
module
>distribution</
module
>
<
"
/>
</
module
>
<
module
name
=
"
TreeWalker
"
>
<
module
name
=
Professional Services
Learning Lab
Certifications
Status
Contact GitHub
Company
About
Blog
Careers
Press
Social Impact
Shop
Twitter
Facebook
YouTube
LinkedIn
GitHub
>
<
head
>
<
meta
http-equiv
="
Content-Type
"
content
="
text/html; charset=ISO-8859-1
"/>
<
title
>
About
>
</
plugin
>
<!--
Includes to generate OSGi headers
-->
<
plugin
>
<!--
Includes to generate OSGi headers
-->
<
plugin
>
an empty line after a short line that ends with '{'
"
/>
</
module
>
<
module
name
=
"
TreeWalker
"
>
<
module
name
=
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
6ee0137
commit
8ba0b4dfe52dce28a4eb5e362f18afaf850e71d4
Unified
Split
Showing
1 changed file
with
1 addition
and
1 deletion
.
+1
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
exercising permissions granted by this License.
"Source" form shall mean the preferred form for making modifications,
including but not limited to software source code, documentation
source, and configuration files.
"Object" form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
not limited to compiled object code, generated documentation,
and conversions to other media types.
"Work" shall mean the work of authorship, whether in Source or
Object form, made available under the License, as indicated by a
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).
"Derivative Works" shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
schemaLocation
=
"
http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd
"
>
<
modelVersion
>4.0.0</
modelVersion
>
<
properties
>
<
moquette-version
>0.3
-SNAPSHOT
</
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.
4. Redistribution. You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
module
name
=
"
ParenPad
"
/>
<
module
name
=
"
TypecastParenPad
"
/>
<
module
name
$DEFAULT_JVM_OPTS
$JAVA_OPTS
$GRADLE_OPTS
JVM_OPTS[
${
#
JVM_OPTS[*]}
]=
"
-Dorg.gradle.appname=
$APP_BASE_NAME
"
APP_ARGS=
$(
save
"
$@
"
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
README.md
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
89 lines (59 sloc)
2.84 KB
Raw
Blame
Moquette Project
Documentation reference guide
Guide on how to use and configure Moquette
Google Group
Google Group to participate in development discussions.
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
designated in writing by the copyright owner as "Not a Contribution."
"Contributor" shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
subsequently incorporated within the Work.
2. Grant of Copyright License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
Work and such Derivative Works in Source or Object form.
3. Grant of Patent License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
}
@Override
public
Queue<
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
String
cli
,
boolean
clean
) {
if
(
!
stopServer();
IntegrationUtils
.
clearTestStorage();
}
private
void
stopServer
() {
2
broker/src/test/java/io/moquette/integration/ServerIntegrationRestartTest.java
Show comments
View file
Edit file
Delete file
span
style
="
font-size: 10pt;
"
>
ii)
effectively excludes on behalf of all Contributors all liability for damages,
including direct, indirect, special, incidental and consequential damages, such
as lost profits;
</
span
>
</
p
>
<
p
=
queueRepository;
}
}
void
bindToSession
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
msg
,
String
clientId
) {
void
bindToSession
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
final
MqttPublishMessage
publishMsg
=
MqttMessageBuilders
.
publish()
.payload(
module
>embedding_moquette</
module
>
<
module
>osgi_test</
module
>
<
module
>perf</
module
>
</
modules
>
"
LineLength
"
>
<
property
name
=
"
max
"
value
=
"
120
"
/>
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Site Map
What is Git?
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
</
title
>
</
head
>
<
body
lang
="
EN-US
"
>
<
h2
>
About Moquette MQT broker
<
artifactId
>maven-jar-plugin</
artifactId
>
<
configuration
>
<
archive
>
<
archive
>
<
manifestFile
>
/META-INF/MANIFEST.MF</
"
LineLength
"
>
<
property
name
=
"
max
"
value
=
"
120
"
/>
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
−1
README.md
2
README.md
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
##
What is
Moquette
?
##
Moquette
Project
[![
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Added GitHub Issue template
Loading branch information
andsel
committed
Oct 20, 2017
1 parent
1b272e5
commit
a49792adf5d6bcf636737478e972207f516dc4df
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.
"Contribution" shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
or by an individual or Legal Entity authorized to submit on behalf of
the copyright owner. For the purposes of this definition, "submitted"
means any form of electronic, verbal, or written communication sent
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
moquette-version
>
<
moquette-version
>0.3</
moquette-version
>
<
mina-version
>2.0.7</
mina-version
>
</
properties
>
Toggle all file notes
0 comments on commit
modifications, and in Source or Object form, provided that You
meet the following conditions:
(a) You must give any other recipients of the Work or
Derivative Works a copy of this License; and
(b) You must cause any modified files to carry prominent notices
stating that You changed the files; and
(c) You must retain, in the Source form of any Derivative Works
that You distribute, all copyright, patent, trademark, and
attribution notices from the Source form of the Work,
excluding those notices that do not pertain to any part of
the Derivative Works; and
(d) If the Work includes a "NOTICE" text file as part of its
distribution, then any Derivative Works that You distribute must
include a readable copy of the attribution notices contained
within such NOTICE file, excluding those notices that do not
pertain to any part of the Derivative Works, in at least one
=
"
ParameterName
"
>
<
property
name
=
"
format
"
value
=
"
^(?!arg[0-9])[_a-z][_a-zA-Z0-9]*$
"
/>
</
)
exec
"
$JAVACMD
"
"
"
-classpath
"
$CLASSPATH
"
org.gradle.wrapper.GradleWrapperMain
"
$@
"
#
Collect all arguments for the java command, following the shell quoting and substitution rules
eval
set
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
remove unnecessary quotes (
#478
)
Moquette aims to be a MQTT compliant broker. The broker supports QoS 0, QoS 1 and QoS 2.
Its designed to be evented, uses Netty for the protocol encoding and decoding part.
Embeddable
Freedomotic
is an home automation framework and uses Moquette embedded to interface with MQTT by a specific
plugin
.
Moquette is also used into
Atomize Spin
a software solution for the logistic field.
Part of moquette are used into the
Vertx MQTT module
, into
MQTT spy
and into
WSO2 Messge broker
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.
4. Redistribution. You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
clean) {
return
new
H2PersistentQueue<>
(mvStore, cli);
}
return
new
ConcurrentLinkedQueue<>
();
@@ -82,6 +82,8 @@ public void tearDown() throws Exception {
}
m_server
.
stopServer();
IntegrationUtils
.
clearTestStorage();
}
@Test
11
broker/src/test/java/io/moquette/integration/ServerIntegrationSSLClientAuthTest.java
Show comments
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
iii)
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
msg
,
String
clientId
) {
@@ -178,9 +179,9 @@ private void unsubscribe(Session session) {
}
}
private
Session
createNewSession
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset()))
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
.retained(
true
)
<
reporting
>
<
plugins
>
<
plugin
>
<
groupId
>org.codehaus.mojo</
groupId
>
<
artifactId
>cobertura-maven-plugin</
</
module
>
<
module
name
=
"
WhitespaceAfter
"
/>
<
module
name
=
"
WhitespaceAround
"
>
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
</
h2
>
<
p
>
June 11, 2014
</
p
>
<
h3
>
License
</
h3
>
<
manifestFile
>
</
archive
>
</
archive
>
</
configuration
>
<
executions
>
<
execution
>
<
</
module
>
<
module
name
=
"
WhitespaceAfter
"
/>
<
module
name
=
"
WhitespaceAround
"
>
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Build Status
](https://api.travis-ci.org/moquette-io/moquette.svg?branch=master)](https://travis-ci.org/moquette-io/moquette)
Toggle all file notes
0 comments on commit
8ba0b4d
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
about.html
Go to file
Go to file
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
Unified
Split
Showing
1 changed file
with
13 additions
and
0 deletions
.
+13
−0
.github/ISSUE_TEMPLATE.md
13
.github/ISSUE_TEMPLATE.md
Show comments
View file
Edit file
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
.gitignore
Go to file
Go to file
designated in writing by the copyright owner as "Not a Contribution."
"Contributor" shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
subsequently incorporated within the Work.
2. Grant of Copyright License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
Work and such Derivative Works in Source or Object form.
3. Grant of Patent License. Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
f4162c2
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
of the following places: within a NOTICE text file distributed
as part of the Derivative Works; within the Source form or
documentation, if provided along with the Derivative Works; or,
within a display generated by the Derivative Works, if and
wherever such third-party notices normally appear. The contents
of the NOTICE file are for informational purposes only and
do not modify the License. You may add Your own attribution
notices within Derivative Works that You distribute, alongside
or as an addendum to the NOTICE text from the Work, provided
that such additional attribution notices cannot be construed
as modifying the License.
You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
module
>
</
module
>
</
module
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
--
$DEFAULT_JVM_OPTS
$JAVA_OPTS
$GRADLE_OPTS
"
\"
-Dorg.gradle.appname=
$APP_BASE_NAME
\"
"
-classpath
"
\"
$CLASSPATH
\"
"
org.gradle.wrapper.GradleWrapperMain
Loading branch information
joestr
authored and
andsel
committed
May 21, 2019
1 parent
78ac8b4
commit
d2cce3fef45b1a2b44220c03cf65f6c0446140aa
Unified
Split
Showing
1 changed file
with
2 additions
and
.
Try the demo instance
Point your browser to
cloud instance
, request an account then use it from your MQTT clients.
1 minute set up
Start play with it, download the self distribution tar from
BinTray
, the un untar and start the broker listening on
1883
port and enjoy!
Or if you are on Windows shell
Embedding in other projects
To embed Moquette in another maven project is sufficient to include a repository and declare the dependency:
Include dependency in your project:
Build from sources
After a git clone of the repository, cd into the cloned sources and:
./gradlew clean moquette-distribution:distMoquetteTar
meet the following conditions:
(a) You must give any other recipients of the Work or
Derivative Works a copy of this License; and
(b) You must cause any modified files to carry prominent notices
stating that You changed the files; and
(c) You must retain, in the Source form of any Derivative Works
that You distribute, all copyright, patent, trademark, and
attribution notices from the Source form of the Work,
excluding those notices that do not pertain to any part of
the Derivative Works; and
(d) If the Work includes a "NOTICE" text file as part of its
distribution, then any Derivative Works that You distribute must
include a readable copy of the attribution notices contained
within such NOTICE file, excluding those notices that do not
pertain to any part of the Derivative Works, in at least one
}
}
4
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
Show comments
View file
Edit file
Delete file
@@ -52,6 +52,7 @@
private
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
View file
Edit file
Delete file
@@ -142,14 +142,14 @@ protected void startServer() throws IOException {
sslProps
.
put(
BrokerConstants
.
JKS_PATH_PROPERTY_NAME
,
"
signedserverkeystore.jks
"
);
sslProps
.
put(
BrokerConstants
states that any provisions which differ from this Agreement are offered by that
Contributor alone and not by any other party; and
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
(
MQTTConnection
mqttConnection
,
MqttConnectMessage
msg
,
String
clientId
) {
private
Session
createNewSession
(
MQTTConnection
mqttConnection
,
.topicName(
NEWS_TOPIC
)
.build();
sut
.
receivedPublishQos1(connection,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
artifactId
>
<
version
>2.6</
version
>
</
plugin
>
</
plugins
>
</
reporting
>
<
build
<
property
name
=
"
tokens
"
value
=
"
ASSIGN, BAND, BAND_ASSIGN, BOR, BOR_ASSIGN, BSR, BSR_ASSIGN, BXOR, BXOR_ASSIGN, DIV, DIV_ASSIGN, EQUAL, GE, GT, LAND, LCURLY, LE, LITERAL_ASSERT, LITERAL_CATCH, LITERAL_DO, LITERAL_ELSE, LITERAL_FINALLY, LITERAL_FOR, LITERAL_IF, LITERAL_RETURN, LITERAL_SYNCHRONIZED, LITERAL_TRY, LITERAL_WHILE, LOR, LT, MINUS, MINUS_ASSIGN, MOD, MOD_ASSIGN, NOT_EQUAL, PLUS, PLUS_ASSIGN, RCURLY, SL, SLIST, SL_ASSIGN, SR, SR_ASSIGN, STAR, STAR_ASSIGN, TYPE_EXTENSION_AND
"
/>
</
module
>
<!--
Commented out due to false positives.
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
p
>
The Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
For purposes of the EPL, &quot;Program&quot; will mean the Content.
goals
>
<
goal
>test-jar</
goal
>
<
goal
>test-jar</
goal
>
</
goals
>
</
execution
<
property
name
=
"
tokens
"
value
=
"
ASSIGN, BAND, BAND_ASSIGN, BOR, BOR_ASSIGN, BSR, BSR_ASSIGN, BXOR, BXOR_ASSIGN, DIV, DIV_ASSIGN, EQUAL, GE, GT, LAND, LCURLY, LE, LITERAL_ASSERT, LITERAL_CATCH, LITERAL_DO, LITERAL_ELSE, LITERAL_FINALLY, LITERAL_FOR, LITERAL_IF, LITERAL_RETURN, LITERAL_SYNCHRONIZED, LITERAL_TRY, LITERAL_WHILE, LOR, LT, MINUS, MINUS_ASSIGN, MOD, MOD_ASSIGN, NOT_EQUAL, PLUS, PLUS_ASSIGN, RCURLY, SL, SLIST, SL_ASSIGN, SR, SR_ASSIGN, STAR, STAR_ASSIGN, TYPE_EXTENSION_AND
"
/>
</
module
>
<!--
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Added implementation of retained store in H2
Loading branch information
andsel
committed
Nov 28, 2018
1 parent
80daadf
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
27 lines (23 sloc)
1.21 KB
Raw
Blame
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
>
<
html
xmlns
="
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Updated travis ci config to openjdk12
Loading branch information
andsel
committed
Delete file
@@ -0,0 +1,13 @@
###
Expected behavior
###
Actual behavior
###
Steps to reproduce
###
Minimal yet complete reproducer code (or URL to code) or complete log file
###
Moquette MQTT version
###
JVM version (e.g.
`java -version`
)
###
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
49 lines (44 sloc)
730 Bytes
Raw
Blame
/
build
*
/
build
/
/
target
/
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.
4. Redistribution. You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You
meet the following conditions:
(a) You must give any other recipients of the Work or
Derivative Works a copy of this License; and
(b) You must cause any modified files to carry prominent notices
stating that You changed the files; and
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
for any such Derivative Works as a whole, provided Your use,
reproduction, and distribution of the Work otherwise complies with
the conditions stated in this License.
5. Submission of Contributions. Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.
6. Trademarks. This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
origin of the Work and reproducing the content of the NOTICE file.
7. Disclaimer of Warranty. Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
Contributor provides its Contributions) on an "AS IS" BASIS,
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
"
$APP_ARGS
"
#
by default we should be in the correct project dir, but when run from Finder on Mac, the cwd is wrong
if
[
"
$(
uname
)
"
=
"
Darwin
"
]
&&
2 deletions
.
+2
−2
distribution/src/main/scripts/moquette.bat
4
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
Delete file
@@ -31,7 +31,7 @@ goto end
rem
Set JavaHome if it exists
if
exist
or
./gradlew clean moquette-distribution:distMoquetteZip
.
In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
If you like Moquette you can support us by donating.
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
of the following places: within a NOTICE text file distributed
as part of the Derivative Works; within the Source form or
documentation, if provided along with the Derivative Works; or,
within a display generated by the Derivative Works, if and
wherever such third-party notices normally appear. The contents
of the NOTICE file are for informational purposes only and
do not modify the License. You may add Your own attribution
notices within Derivative Works that You distribute, alongside
or as an addendum to the NOTICE text from the Work, provided
that such additional attribution notices cannot be construed
as modifying the License.
You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
for any such Derivative Works as a whole, provided Your use,
(
true
,
true
,
false
);
private
IAuthenticator
mockAuthenticator;
private
PostOffice
postOffice;
private
MemoryQueueRepository
queueRepository;
@Before
.
KEY_STORE_PASSWORD_PROPERTY_NAME
,
"
passw0rdsrv
"
);
sslProps
.
put(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
,
"
passw0rdsrv
"
);
"
>
<
span
style
="
font-size: 10pt;
"
>
iv)
states that source code for the Program is available from such Contributor, and
informs licensees how to obtain it in a reasonable manner on or through a
medium customarily used for software exchange.
<
span
style
="
color: blue;
MqttConnectMessage
msg
,
String
clientId
) {
final
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
=
queues
.
computeIfAbsent(clientId, (
String
,
publishMsg);
assertMessageIsRetained(
NEWS_TOPIC
);
//
publish a QoS0 retained message
//
Exercise
final
ByteBuf
qos0Payload
=
Unpooled
.
copiedBuffer(
"
QoS0 payload
>
<
plugins
>
<
plugin
>
<
groupId
>org.apache.maven.plugins</
groupId
>
<
artifactId
>maven-compiler-plugin</
artifactId
>
<
configuration
<module name="MissingDeprecated"/>
-->
<
module
name
=
"
MissingOverride
"
/>
<
</
p
>
<
p
>
The Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
indicated below, the terms and conditions of the EPL still apply to any source code in the Content
and such source code may be obtained at
<
a
href
="
http://www.eclipse.org/
"
>
</
executions
>
</
plugin
>
<
plugin
>
</
plugin
>
<
plugin
>
<
Commented out due to false positives.
<module name="MissingDeprecated"/>
-->
<
module
name
=
"
MissingOverride
"
/>
<
module
name
=
"
PackageAnnotation
"
commit
213851335a4f22fc30796911d5bebcd1d26fb7c7
Unified
Split
Showing
9 changed files
with
132 additions
and
20 deletions
.
+2
−0
ChangeLog.txt
+3
−1
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
+21
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
master
moquette
/
.travis.yml
Go to file
Go to file
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
http://www.w3.org/1999/xhtml
"
>
<
head
>
<
meta
http-equiv
="
Content-Type
"
content
="
text/html; charset=ISO-8859-1
"/>
<
Jul 21, 2019
1 parent
c1e0b17
commit
fc1b6033819c77b05e9a3986dd2fbb10705f5722
Unified
Split
Showing
1 changed file
with
1 addition
and
1 deletion
.
+1
−1
.travis.yml
OS version (e.g.
`uname -a`
)
Toggle all file notes
0 comments on commit
a49792a
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
/
parser
/
target
/
/
benchmarking
/
target
/
.idea
/
*
.iml
broker
/
target
/
(c) You must retain, in the Source form of any Derivative Works
that You distribute, all copyright, patent, trademark, and
attribution notices from the Source form of the Work,
excluding those notices that do not pertain to any part of
the Derivative Works; and
(d) If the Work includes a "NOTICE" text file as part of its
distribution, then any Derivative Works that You distribute must
include a readable copy of the attribution notices contained
within such NOTICE file, excluding those notices that do not
pertain to any part of the Derivative Works, in at least one
of the following places: within a NOTICE text file distributed
as part of the Derivative Works; within the Source form or
documentation, if provided along with the Derivative Works; or,
within a display generated by the Derivative Works, if and
wherever such third-party notices normally appear. The contents
of the NOTICE file are for informational purposes only and
do not modify the License. You may add Your own attribution
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Moved packages from old io.moquette.server to new io.moquette.broker
Loading branch information
andsel
committed
Nov 11, 2018
1 parent
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
remove unnecessary quotes which fixes execution in windows 10
#478
Merged
andsel
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.
8. Limitation of Liability. In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
negligent acts) or agreed to in writing, shall any Contributor be
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
[
"
$HOME
"
=
"
$PWD
"
]
;
then
cd
"
$(
dirname
"
$0
"
{
"
%JAVA_HOME%
\bin\java
"
} (
set
"
JAVA
=
"
%JAVA_HOME%
\bin\java
"
set
JAVA
=
"
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
reproduction, and distribution of the Work otherwise complies with
the conditions stated in this License.
5. Submission of Contributions. Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.
6. Trademarks. This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
origin of the Work and reproducing the content of the NOTICE file.
7. Disclaimer of Warranty. Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
Contributor provides its Contributions) on an "AS IS" BASIS,
public
void
setUp
() {
@@ -62,8 +63,9 @@ public void setUp() {
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
sslProps
.
put(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
,
IntegrationUtils
.
localMapDBPath
());
sslProps
.
put(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
,
"
>
</
span
>
</
span
>
</
p
>
<
p
>
<
span
style
cli)
-
>
new
ConcurrentLinkedQueue<>
());
final
boolean
clean
=
msg
.
variableHeader()
.
isCleanSession();
final
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, connection
.
getClientId(), qos0Payload,
true
>
<
source
>
</
source
>
<
target
>
</
target
>
</
configuration
>
</
plugin
>
module
name
=
"
PackageAnnotation
"
/>
<
module
name
=
"
EmptyBlock
"
>
<
property
name
>
http://www.eclipse.org
</
a
>
.
</
p
>
</
body
>
</
html
>
Copy lines
Copy permalink
View git blame
groupId
>org.apache.felix</
groupId
>
<
artifactId
>maven-bundle-plugin</
artifactId
>
<
executions
>
<
execution
>
<
id
>bundle-manifest</
/>
<
module
name
=
"
EmptyBlock
"
>
<
property
name
=
"
option
"
value
−5
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
+12
−9
broker/src/main/java/io/moquette/broker/PostOffice.java
+24
−0
broker/src/main/java/io/moquette/broker/RetainedMessage.java
+4
−1
broker/src/main/java/io/moquette/broker/Server.java
+5
−0
broker/src/main/java/io/moquette/persistence/H2Builder.java
+55
−0
broker/src/main/java/io/moquette/persistence/H2RetainedRepository.java
+6
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
13 lines (12 sloc)
275 Bytes
Raw
Blame
language
:
java
jdk
:
-
openjdk12
before_cache
Reject
Save preferences
title
>
About
</
title
>
</
head
>
<
body
lang
="
EN-US
"
>
<
h2
>
2
.travis.yml
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,6 @@
language
:
java
jdk
:
-
oraclejdk8
-
openjdk12
before_cache
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
client
/
target
/
parser_commons
/
target
/
netty_parser
/
target
notices within Derivative Works that You distribute, alongside
or as an addendum to the NOTICE text from the Work, provided
that such additional attribution notices cannot be construed
as modifying the License.
You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
for any such Derivative Works as a whole, provided Your use,
reproduction, and distribution of the Work otherwise complies with
58fd90d
commit
1ba9eb3613bc79d28c5d45d9c0984033d36d83af
Unified
Split
Showing
127 changed files
with
274 additions
and
1,414 deletions
.
+3
merged 1 commit into
moquette-io
:
master
from
unknown repository
May 21, 2019
Merged
remove unnecessary quotes which fixes execution in windows 10
#478
andsel
merged 1 commit into
moquette-io
Accept
Reject
Save preferences
9. Accepting Warranty or Additional Liability. While redistributing
the Work or Derivative Works thereof, You may choose to offer,
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.
END OF TERMS AND CONDITIONS
APPENDIX: How to apply the Apache License to your work.
To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets "[]"
replaced with your own identifying information. (Don't include
the brackets!) The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
)
"
fi
exec
"
$JAVACMD
"
"
$@
"
6
gradlew.bat
Show comments
View file
Edit file
%JAVA_HOME%
\bin\java
"
)
echo
Using JAVA_HOME:
"
%JAVA_HOME%
"
@@ -83,6 +83,6 @@ rem set JAVA_OPTS=%JAVA_OPTS% -XX:PrintFLSStatistics=1
rem
set JAVA_OPTS=%JAVA_OPTS% -Xloggc:/var/log/moquette/gc.log
set
JAVA_OPTS
=
%JAVA_OPTS%
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.
8. Limitation of Liability. In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
negligent acts) or agreed to in writing, shall any Contributor be
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
IntegrationUtils
.
localH2MvStoreDBPath
());
sslProps
.
put(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
true
"
);
m_server
.
startServer(sslProps);
="
font-size: 10pt;
"
>
When the Program is made available in source
code form:
</
span
>
</
p
>
<
p
class
="
MsoNormal
"
style
boolean
clean
=
msg
.
variableHeader()
.
isCleanSession();
final
Queue<
SessionRegistry
.
EnqueuedMessage
>
sessionQueue
=
queues
,
MqttMessageBuilders
.
publish()
.payload(qos0Payload)
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
//
<
plugin
>
<
groupId
>org.apache.maven.plugins</
groupId
>
<
artifactId
>maven-checkstyle-plugin</
artifactId
>
<
version
>2.17</
version
>
=
"
option
"
value
=
"
text
"
/>
</
module
>
<
module
name
=
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
id
>
<
phase
>process-classes</
phase
>
<
goals
>
<
goals
>
<
goal
>manifest</
goal
>
</
=
"
text
"
/>
</
module
>
<
module
name
=
"
LeftCurly
"
/>
<
−4
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
2
ChangeLog.txt
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,8 @@
Version 0.12:
Fixed issue #415
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Rewritten completly the broker to introduce the concept of MqttConnection
Dropped suppoert for MapDB and keeped only H2 MvStore for persistence
Version 0.10:
Netty epoll system added
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache
:
directories
:
-
$HOME/.gradle/caches/
-
$HOME/.gradle/wrapper/
script
:
-
./gradlew install test
About Moquette MQT broker
</
h2
>
<
p
>
June 11, 2014
</
p
>
<
h3
>
License
</
h3
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
Toggle all file notes
0 comments on commit
fc1b603
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
/
netty_parser
/
target
/
parser_commons
/
target
/
distribution
/
target
/
broker
/
moquette.log
broker
/
the conditions stated in this License.
5. Submission of Contributions. Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.
6. Trademarks. This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
origin of the Work and reproducing the content of the NOTICE file.
7. Disclaimer of Warranty. Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
Contributor provides its Contributions) on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
−3
broker/src/main/java/io/moquette/broker/Authorizator.java
+1
−1
+1
−1
broker/src/main/java/io/moquette/broker/BrokerConfiguration.java
+2
−2
+1
−1
+7
−8
+1
−1
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
+1
:
master
from
unknown repository
May 21, 2019
Conversation
1
Commits
1
Checks
0
Files changed
Conversation
Copy link
Quote reply
Contributor
joestr
file or class name and description of purpose be included on the
same "printed page" as the copyright notice for easier
identification within third-party archives.
Copyright [yyyy] [name of copyright owner]
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
Copy lines
Copy permalink
View git blame
Reference in new issue
Delete file
@@ -49,7 +49,6 @@ goto fail
@
rem
Get command-line arguments, handling Windows variants
if
not
"
%OS%
"
==
"
Windows_NT
"
goto
win9xME_args
if
-XX:+UseGCLogFileRotation
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:NumberOfGCLogFiles=
10
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
"
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
9. Accepting Warranty or Additional Liability. While redistributing
the Work or Derivative Works thereof, You may choose to offer,
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.
END OF TERMS AND CONDITIONS
APPENDIX: How to apply the Apache License to your work.
To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets "[]"
replaced with your own identifying information. (Don't include
new
SessionRegistry
(subscriptions,
queueRepository
);
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
}
@Before
public
void
setUp
()
throws
Exception
{
String
dbPath
=
IntegrationUtils
.
localMapDBPath
();
String
dbPath
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
a)
it must be made available under this Agreement; and
</
span
>
</
p
>
.
computeIfAbsent(clientId, (
String
cli)
-
>
queueRepository
.
createQueue(cli, clean));
final
Session
newSession;
final
Session
newSession;
if
(msg
Verify
assertTrue(
"
Retained message for topic /news must be cleared
"
, retainedRepository
.
isEmtpy());
}
private
void
assertMessageIsRetained
(
String
expectedTopicName
) {
MqttPublishMessage
<
configuration
>
<
configLocation
>checkstyle.xml</
configLocation
>
<
suppressionsLocation
>checkstyle-suppressions.xml</
suppressionsLocation
>
<!--
<configLocation>/google_checks.xml</configLocation>
-->
<
consoleOutput
"
LeftCurly
"
/>
<
module
name
=
"
RightCurly
"
/>
<!--
<module name="NeedBraces"/>
-->
<
module
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
goals
>
</
goals
>
</
execution
>
</
executions
>
</
plugin
>
Toggle all file notes
0 comments on commit
99fea68
module
name
=
"
RightCurly
"
/>
<
module
name
=
"
NeedBraces
"
/>
<
module
4
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -18,6 +18,8 @@
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.List
;
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
>
<
p
>
The Content is provided to you under the terms and conditions of the
Eclipse Public License Version 1.0 (&quot;EPL&quot;). A copy of the EPL is available
at
<
a
href
="
http://www.eclipse.org/legal/epl-v10.html
"
>
http://www.eclipse.org/legal/epl-v10.html
</
a
>
.
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Accept
Reject
Save preferences
runner
/
bundle
/
target
/
/
bundle
/
runner
/
/
osgi_test
/
target
/
/
perf
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.
8. Limitation of Liability. In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
negligent acts) or agreed to in writing, shall any Contributor be
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.
−1
+1
−1
broker/src/main/java/io/moquette/broker/ISubscriptionsRepository.java
+0
−1
broker/src/main/java/io/moquette/broker/InflightResender.java
+3
−5
broker/src/main/java/io/moquette/broker/MQTTConnection.java
+1
−1
broker/src/main/java/io/moquette/broker/MQTTConnectionFactory.java
+1
−1
commented
May 21, 2019
removed unnecessary quotes on line 34 and line 86; these quotes make an execution in Windows 10 impossible;
remove unnecessary quotes
…
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
Loading status checks…
831f24a
Copy link
Quote reply
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
"
%@eval[2+2]
"
==
"
4
"
goto
4NT_args
:
win9xME_args
@
rem
Slurp the command line arguments.
@@ -60,11 +59,6 @@ set _SKIP=2
if
"
%JAVA%
-server
%JAVA_OPTS%
%JAVA_OPTS_SCRIPT%
-Dlog4j.configuration=file:
%LOG_FILE%
-Dmoquette.path=
%MOQUETTE_PATH%
-cp
%MOQUETTE_HOME%
\lib\* io.moquette.broker.Server
Toggle all file notes
0 comments on commit
d2cce3f
Please
sign in
the brackets!) The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
file or class name and description of purpose be included on the
same "printed page" as the copyright notice for easier
identification within third-party archives.
Copyright [yyyy] [name of copyright owner]
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
Toggle all file notes
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
4
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
Show comments
View file
Edit file
Delete file
@@ -45,6 +45,7 @@
private
EmbeddedChannel
channel;
private
=
IntegrationUtils
.
localH2MvStoreDBPath
();
File
dbFile
=
new
File
(dbPath);
assertFalse(
String
.
format(
"
The DB storagefile %s already exists
<
p
class
="
MsoNormal
"
style
="
margin-left: 0.5in;
"
>
<
span
style
="
font-size: 10pt;
"
>
b) a
.
variableHeader()
.
isWillFlag()) {
if
(msg
.
variableHeader()
.
isWillFlag()) {
final
Session
.
Will
will
=
msg
=
retainedRepository
.
retainedOnTopic(expectedTopicName);
assertEquals(expectedTopicName, msg
.
variableHeader()
.
topicName());
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
>true</
consoleOutput
>
</
configuration
>
<
executions
>
<
execution
>
<
phase
>validate</
phase
>
name
=
"
AvoidNestedBlocks
"
>
<
property
name
=
"
allowInSwitchCase
"
value
=
"
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
name
=
"
AvoidNestedBlocks
"
>
<
property
name
=
"
allowInSwitchCase
"
value
=
"
true
"
public
interface
IRetainedRepository
{
void
cleanRetained
(
Topic
topic
);
@@ -26,5 +28,5 @@
boolean
isEmpty
();
MqttPublishMessage
retainedOnTopic
(
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
For purposes of the EPL, &quot;Program&quot; will mean the Content.
</
p
>
<
p
>
The Content is
being redistributed by another party (&quot;Redistributor&quot;) and different terms and conditions may
apply to your use of any object code in the Content. Check the Redistributor's license that was
provided with the Content. If no such license exists, contact the Redistributor. Unless otherwise
indicated below, the terms and conditions of the EPL still apply to any source code in the Content
and such source code may be obtained at
<
a
href
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
/
target
/
/
mapdb_storage
/
target
/
*
~
*
.log
*
.DS_Store
.settings
/
.project
.classpath
/
9. Accepting Warranty or Additional Liability. While redistributing
the Work or Derivative Works thereof, You may choose to offer,
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.
END OF TERMS AND CONDITIONS
APPENDIX: How to apply the Apache License to your work.
To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets "[]"
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
+1
−2
broker/src/main/java/io/moquette/broker/MemorySubscriptionsRepository.java
+1
−1
+7
−7
+5
−9
broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java
+0
−1
broker/src/main/java/io/moquette/broker/NewNettyMQTTHandler.java
Collaborator
andsel
commented
May 21, 2019
Thanks a lot
@joestr
Hide details
View details
andsel
merged commit
d2cce3f
into
moquette-io
:
master
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
x%
~1
"
==
"
x
"
goto
execute
set
CMD_LINE_ARGS
=
%
*
goto
execute
:
4NT_args
@
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
0 comments on commit
af8c0e3
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
SessionRegistry
sessionRegistry;
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
@@ -67,8 +68,9 @@ private MQTTConnection createMQTTConnection(BrokerConfiguration config, Channel
ISubscriptionsDirectory
"
, dbPath), dbFile
.
exists());
@@ -171,12 +171,7 @@ public void tearDown() throws Exception {
if
(m_server
!=
null
) {
m_server
.
stopServer();
}
String
dbPath
=
IntegrationUtils
.
copy of this Agreement must be included with each copy of the Program.
</
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
Contributors may not remove or alter any
createWill(msg);
final
Session
.
Will
will
=
createWill(msg);
5
broker/src/main/java/io/moquette/persistence/H2Builder.java
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,7 @@
package
io.moquette.persistence
;
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
<
goals
>
<
goal
>check</
goal
>
</
goals
>
</
execution
>
</
executions
>
</
plugin
true
"
/>
</
module
>
<
module
name
=
"
FinalClass
"
/>
<
module
name
=
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
/>
</
module
>
<
module
name
=
"
FinalClass
"
/>
<
module
name
=
"
HideUtilityClassConstructor
"
String
topic
);
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
);
}
26
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
Show comments
View file
Edit file
Delete file
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
="
http://www.eclipse.org/
"
>
http://www.eclipse.org
</
a
>
.
</
p
>
</
body
>
</
html
>
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
*
/
bin
/
*
.swp
*
.class
#
Mobile Tools for Java (J2ME)
.mtj.tmp
/
#
Package Files #
*
.war
*
.ear
replaced with your own identifying information. (Don't include
the brackets!) The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
file or class name and description of purpose be included on the
same "printed page" as the copyright notice for easier
identification within third-party archives.
Copyright [yyyy] [name of copyright owner]
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
Toggle all file notes
+6
−7
broker/src/main/java/io/moquette/broker/PostOffice.java
+22
−24
broker/src/main/java/io/moquette/broker/Server.java
+2
−2
broker/src/main/java/io/moquette/broker/Session.java
+4
−4
broker/src/main/java/io/moquette/broker/SessionRegistry.java
+1
−1
+1
−1
+1
−3
May 21, 2019
1 check passed
1 check passed
continuous-integration/travis-ci/pr
The Travis CI build passed
Details
gugia
added a commit to gugia/moquette that referenced this pull request
May 25, 2020
remove unnecessary quotes (
moquette-io#478
)
…
6a16900
Sign up for free
to join this conversation on GitHub
. Already have an account?
Sign in to comment
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
rem
Get arguments from the 4NT Shell from JP Software
set
CMD_LINE_ARGS
=
%$
:
execute
@
rem
Setup the command line
Toggle all file notes
0 comments on commit
4307a90
Please
sign in
to comment.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
localMapDBPath();
File
dbFile
=
new
File
(dbPath);
if
(dbFile
.
exists()) {
dbFile
copyright notices contained within the Program.
</
span
>
</
p
>
<
p
>
package
io.moquette.persistence
;
import
io.moquette.BrokerConstants
;
import
io.moquette.BrokerConstants
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.ISubscriptionsRepository
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
>
</
plugins
>
</
build
>
<
profiles
>
<
profile
>
<
id
>release-sign-artifacts</
id
"
HideUtilityClassConstructor
"
/>
<
module
name
=
"
CovariantEquals
"
/>
<
module
name
=
"
EmptyStatement
"
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
/>
<
module
name
=
"
CovariantEquals
"
/>
<
module
name
=
"
EmptyStatement
"
/>
<
@@ -16,8 +16,12 @@
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.ArrayList
;
import
Save preferences
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
#
virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml
hs_err_pid
*
broker
/
*
moquette_store.
*
embedding_moquette
/
target
/
broker
/
nb-configuration.xml
broker
/
0 comments on commit
af8c0e3
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
+1
−3
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+3
Reviewers
No reviews
Assignees
No one assigned
Labels
None yet
Projects
None yet
Milestone
No milestone
Linked issues
Successfully merging this pull request may close these issues.
None yet
2 participants
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
);
.
delete();
}
assertFalse(dbFile
.
exists());
IntegrationUtils
.
clearTestStorage();
}
@Test
11
broker/src/test/java/io/moquette/integration/ServerIntegrationSSLTest.java
Show comments
View file
Edit file
<
span
style
="
font-size: 10pt;
"
>
Each Contributor must identify itself as the
originator of its Contribution, if any, in a manner that reasonably allows
subsequent Recipients to identify the originator of the Contribution.
</
span
>
</
p
>
<
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.config.IConfig
;
import
io.moquette.broker.config.IConfig
;
import
org.h2.mvstore.MVStore
;
import
org.h2.mvstore.MVStore
;
@@ -52,4 +53,8 @@ public ISubscriptionsRepository subscriptionsRepository() {
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
>
<
build
>
<
plugins
>
<
plugin
>
<
groupId
>org.apache.maven.plugins</
groupId
>
<
artifactId
/>
<
module
name
=
"
EqualsHashCode
"
/>
<!--
<module name="FinalLocalVariable"/>
-->
<!--
Commented out due to http://jira.codehaus.org/browse/MCHECKSTYLE-111
<module name="RedundantThrows">
<property name="logLoadErrors" value="false"/>
<property name="suppressLoadErrors" value="true"/>
module
name
=
"
EqualsHashCode
"
/>
<!--
<module name="FinalLocalVariable"/>
-->
<!--
Commented out due to http://jira.codehaus.org/browse/MCHECKSTYLE-111
<module name="RedundantThrows">
<property name="logLoadErrors" value="false"/>
<property name="suppressLoadErrors" value="true"/>
</module>
java.util.List
;
import
java.util.Map
;
import
java.util.concurrent.ConcurrentHashMap
;
import
java.util.concurrent.ConcurrentMap
;
@@ -26,16 +30,20 @@
*
*/
final
class
MemoryRetainedRepository
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
nbactions-Server.xml
maven-metadata.xml
/
.gradle
/
/
bin
/
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
−3
+3
−3
+1
−1
+1
−1
+1
−1
+1
−1
+1
−3
+3
−3
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
final
PostOffice
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(), sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
5
Delete file
@@ -90,13 +90,13 @@ protected void startServer() throws IOException {
sslProps
.
put(
BrokerConstants
.
JKS_PATH_PROPERTY_NAME
,
"
serverkeystore.jks
"
);
sslProps
.
put(
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
4. COMMERCIAL DISTRIBUTION
</
span
>
</
b
>
public
void
closeStore
() {
public
void
closeStore
() {
mvStore
.
close();
mvStore
.
close();
}
}
public
>maven-source-plugin</
artifactId
>
<
executions
>
<
execution
>
<
id
>attach-sources</
id
>
<
goals
>
<
goal
</module>
-->
<
module
name
=
"
SimplifyBooleanExpression
"
/>
<
module
name
=
"
SimplifyBooleanReturn
"
/>
-->
<
module
name
=
"
SimplifyBooleanExpression
"
/>
<
module
name
=
"
SimplifyBooleanReturn
"
/>
<
module
implements
IRetainedRepository
{
private
final
ConcurrentMap<
String
,
MqttPublishMessage
>
storage
=
new
ConcurrentHashMap<>
();
private
final
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
+3
−3
+2
−3
+2
−3
+2
−2
+1
−1
+2
−2
+2
−3
+2
−3
+1
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
Show comments
View file
Edit file
Delete file
@@ -54,6 +54,7 @@
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
BrokerConfiguration
(
true
,
BrokerConstants
.
KEY_STORE_PASSWORD_PROPERTY_NAME
,
"
passw0rdsrv
"
);
sslProps
.
put(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
,
"
passw0rdsrv
"
);
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
Commercial distributors of software may
accept certain responsibilities with respect to end users, business partners
and the like. While this license is intended to facilitate the commercial use
of the Program, the Contributor who includes the Program in a commercial
product offering should do so in a manner which does not create potential
liability for other Contributors. Therefore, if a Contributor includes the
IQueueRepository
queueRepository
() {
return
new
H2QueueRepository
(mvStore);
}
}
}
3
...tte/persistence/h2/H2PersistentQueue.java → ...quette/persistence/H2PersistentQueue.java
Show comments
View file
Edit file
Delete file
@@ -13,7 +13,7 @@
>jar</
goal
>
</
goals
>
</
execution
>
</
executions
>
</
plugin
>
<
plugin
>
<
module
name
=
"
SuperFinalize
"
/>
<
module
name
=
"
PackageDeclaration
"
/>
<
module
name
=
"
SuperFinalize
"
/>
<
module
name
=
"
PackageDeclaration
"
/>
<
module
name
=
ConcurrentMap<
Topic
,
RetainedMessage
>
storage
=
new
ConcurrentHashMap<>
();
@Override
public
void
cleanRetained
(
Topic
topic
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
Reject
Save preferences
−3
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
true
,
false
);
private
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
@@ -82,9 +83,9 @@ private SessionRegistry initPostOfficeAndSubsystems() {
ISubscriptionsRepository
sslProps
.
put(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
,
IntegrationUtils
.
localMapDBPath
());
sslProps
.
put(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
,
Program in a commercial product offering, such Contributor ("Commercial
Contributor") hereby agrees to defend and indemnify every other
Contributor ("Indemnified Contributor") against any losses, damages and
costs (collectively "Losses") arising from claims, lawsuits and other
legal actions brought by a third party against the Indemnified Contributor to
the extent caused by the acts or omissions of such Commercial Contributor in
connection with its distribution of the Program in a commercial product
offering. The obligations in this section do not apply to any claims or Losses
relating to any actual or alleged intellectual property infringement. In order
to qualify, an Indemnified Contributor must: a) promptly notify the Commercial
Contributor in writing of such claim, and b) allow the Commercial Contributor
to control, and cooperate with the Commercial Contributor in, the defense and
any related settlement negotiations. The Indemnified Contributor may participate
in any such claim at its own expense.
</
*
*
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.persistence
.h2
;
package
io.moquette.persistence
;
import
org.h2.mvstore.MVMap
;
<
groupId
>org.apache.maven.plugins</
groupId
>
<
artifactId
>maven-javadoc-plugin</
artifactId
>
<
executions
>
<
execution
>
<
id
name
=
"
ExplicitInitialization
"
/>
<
module
name
=
"
DefaultComesLast
"
/>
<
module
name
=
"
ExplicitInitialization
"
/>
<
module
name
=
"
DefaultComesLast
"
/>
<
module
name
=
"
UnnecessaryParentheses
"
) {
storage
.
remove(topic
.
toString()
);
storage
.
remove(topic);
}
@Override
public
void
retain
(
Topic
topic
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Sign in to GitHub · GitHub
Skip to content
+1
−1
+0
−52
broker/src/main/java/io/moquette/connections/MqttConnectionMetrics.java
+0
−91
broker/src/main/java/io/moquette/connections/MqttSession.java
+0
−52
broker/src/main/java/io/moquette/connections/MqttSubscription.java
+3
−5
+1
−1
broker/src/main/java/io/moquette/interception/InterceptHandler.java
Reject
Save preferences
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
retainedRepository
=
new
MemoryRetainedRepository
();
queueRepository
=
new
MemoryQueueRepository
();
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
IntegrationUtils
.
localH2MvStoreDBPath
());
m_server
.
startServer(sslProps);
}
@Before
public
void
setUp
()
throws
Exception
{
String
dbPath
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
For example, a Contributor might include the
Program in a commercial product offering, Product X. That Contributor is then a
import
org.h2.mvstore.MVMap
;
import
org.h2.mvstore.MVStore
;
import
org.h2.mvstore.MVStore
;
@@ -88,6 +88,7 @@ public T poll() {
}
}
final
long
nextTail
=
tail
>attach-javadocs</
id
>
<
goals
>
<
goal
>jar</
goal
>
</
goals
>
</
execution
>
</
"
UnnecessaryParentheses
"
/>
<!--
<module name="AvoidStarImport">
<property name="allowStaticMemberImports" value="true"/>
</module>
-->
<
module
name
=
"
RedundantImport
"
/>
moquette/NewNettyMQTTHandler.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
/>
<
module
name
=
"
AvoidStarImport
"
>
<
property
name
=
"
allowStaticMemberImports
"
value
=
,
MqttPublishMessage
msg
) {
storage
.
put(topic
.
toString(), msg);
final
ByteBuf
payload
=
msg
.
content();
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
moquette/MoquetteIdleTimeoutHandler.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
+1
−1
broker/src/main/java/io/moquette/interception/Interceptor.java
+1
−1
broker/src/main/java/io/moquette/interception/messages/InterceptSubscribeMessage.java
+1
−1
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
+5
−4
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
+1
−1
broker/src/main/java/io/moquette/persistence/MemoryStorageService.java
+0
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
=
IntegrationUtils
.
localMapDBPath
();
String
dbPath
=
IntegrationUtils
.
localH2MvStoreDBPath
();
File
dbFile
=
new
File
(dbPath);
assertFalse(
moquette/NewNettyAcceptor.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
Commercial Contributor. If that Commercial Contributor then makes performance
claims, or offers warranties related to Product X, those performance claims and
warranties are such Commercial Contributor's responsibility alone. Under this
section, the Commercial Contributor would have to defend claims against the
other Contributors related to those performance claims and warranties, and if a
court requires any other Contributor to pay any damages as a result, the
Commercial Contributor must pay those damages.
</
span
>
</
p
>
<
p
>
<
.
getAndIncrement();
final
long
nextTail
=
tail
.
getAndIncrement();
final
T
tail
=
this
.
queueMap
.
get(nextTail);
final
executions
>
</
plugin
>
<
plugin
>
<
groupId
>org.apache.maven.plugins</
groupId
>
<
artifactId
>maven-gpg-plugin</
artifactId
>
<
moquette/MemoryRetainedRepository.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
<!--
Commented out due to false positives.
<module name="UnusedImports">
<property name="processJavadoc" value="true"/>
</module>
-->
<
module
name
=
"
JavadocStyle
"
>
<
property
name
=
"
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
"
true
"
/>
</
module
>
<
module
name
=
"
RedundantImport
"
/>
<!--
Commented out due to false positives.
remove unnecessary quotes (#478) · gugia/moquette@6a16900 · GitHub
byte
[] rawPayload
=
new
byte
[payload
.
readableBytes()];
payload
.
getBytes(
0
, rawPayload);
final
RetainedMessage
toStore
=
new
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
−31
broker/src/main/java/io/moquette/server/Constants.java
+1
−1
broker/src/main/java/io/moquette/spi/IMatchingCondition.java
+1
−1
broker/src/main/java/io/moquette/spi/IMessagesStore.java
+2
−2
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
+1
−2
broker/src/test/java/io/moquette/broker/ConnectionTestUtils.java
+5
−6
moquette/PostOffice.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
String
.
format(
"
The DB storagefile %s already exists
"
, dbPath), dbFile
.
exists());
@@ -118,12 +118,7 @@ public void tearDown() throws Exception {
if
(m_server
moquette/NettyUtils.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
b
>
<
span
style
="
font-size: 10pt;
"
>
5. NO WARRANTY
</
span
>
</
b
>
</
p
>
T
tail
=
this
.
queueMap
.
get(nextTail);
queueMap
.
remove(nextTail);
this
.
metadataMap
.
put(
"
tail
"
executions
>
<
execution
>
<
id
>sign-artifacts</
id
>
<
phase
>package</
phase
>
<
goals
>
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
checkFirstSentence
"
value
=
"
false
"
/>
</
module
>
<
module
name
=
"
UpperEll
"
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
<module name="UnusedImports">
<property name="processJavadoc" value="true"/>
</module>
-->
<
module
name
=
"
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
RetainedMessage
(msg
.
fixedHeader()
.
qosLevel(), rawPayload);
storage
.
put(topic, toStore);
}
@Override
@@ -44,7 +52,15 @@ public boolean isEmpty() {
}
@Override
public
MqttPublishMessage
retainedOnTopic
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
moquette/MemorySubscriptionsRepository.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
+4
−5
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
+2
−2
+1
−1
+5
−6
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
+5
−6
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
+7
−9
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
return
sessionRegistry;
5
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
Show comments
View file
Edit file
Delete file
@@ -64,6 +64,7 @@
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
BrokerConfiguration
(
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
!=
null
) {
m_server
.
stopServer();
}
String
dbPath
=
IntegrationUtils
.
localMapDBPath();
File
dbFile
=
new
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
<
p
>
<
span
style
="
font-size: 10pt;
"
>
EXCEPT AS EXPRESSLY SET FORTH IN THIS
AGREEMENT, THE PROGRAM IS PROVIDED ON AN "AS IS" BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING,
, nextTail
+
1
);
this
.
metadataMap
.
put(
"
tail
"
, nextTail
+
1
);
return
tail;
<
goal
>sign</
goal
>
</
goals
>
</
execution
>
</
executions
>
</
plugin
>
</
plugins
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
moquette/ISubscriptionsRepository.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
moquette/ISslContextCreator.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
/>
<
module
name
=
"
ArrayTypeStyle
"
/>
<
module
name
=
"
OuterTypeFilename
"
/>
<
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
moquette/MQTTConnectionFactory.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
JavadocStyle
"
>
<
property
name
=
"
checkFirstSentence
"
value
=
"
false
"
/>
</
module
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
(
String
topic
) {
return
storage
.
get(topic);
public
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
) {
final
moquette/MQTTConnection.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
+6
−7
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
+5
−7
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
+4
−3
+2
−1
+2
−2
+2
−2
+1
−1
moquette/InflightResender.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
true
,
true
,
false
);
private
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
@@ -89,9 +90,9 @@ private SessionRegistry initPostOfficeAndSubsystems() {
File
(dbPath);
if
(dbFile
.
exists()) {
dbFile
.
delete();
}
assertFalse(dbFile
.
exists());
IntegrationUtils
.
clearTestStorage();
}
@Test
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT,
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely
responsible for determining the appropriateness of using and distributing the
Program and assumes all risks associated with its exercise of rights under this
Agreement , including but not limited to the risks and costs of program errors,
compliance with applicable laws, damage to or loss of data, programs or
equipment, and unavailability or interruption of operations.
</
span
>
</
p
>
<
p
>
<
b
return
tail;
}
}
25
broker/src/main/java/io/moquette/persistence/H2QueueRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,25 @@
package
io.moquette.persistence
;
import
io.moquette.broker.IQueueRepository
;
>
</
build
>
</
profile
>
</
profiles
>
<
repositories
>
<
repository
>
<
id
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
module
name
=
"
ModifierOrder
"
/>
<
module
name
=
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
moquette/DebugUtils.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
moquette/IRetainedRepository.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
moquette/DefaultMoquetteSslContextCreator.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
>
<
module
name
=
"
UpperEll
"
/>
<
module
name
=
"
ArrayTypeStyle
"
/>
<
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Topic
searchTopic
=
new
Topic
(topic);
final
List<
RetainedMessage
>
matchingMessages
=
new
ArrayList<>
();
for
(
Map
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
+1
−2
+6
−9
+1
−1
+1
−1
+2
−3
+5
−5
+3
−3
+1
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
retainedRepository
=
new
MemoryRetainedRepository
();
queueRepository
=
new
MemoryQueueRepository
2
distribution/build.gradle
Show comments
View file
Edit file
Delete file
@@ -9,7 +9,7 @@ mainClassName = "io.moquette.integration.Server"
dependencies
{
compile project(
'
:moquette-broker
'
)
compile project(
'
:moquette-h2-storage
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
>
<
span
style
="
font-size: 10pt;
"
>
6. DISCLAIMER OF LIABILITY
</
span
>
</
b
>
</
p
>
import
io.moquette.broker.SessionRegistry
;
import
org.h2.mvstore.MVStore
;
import
java.util.Queue
;
import
java.util.concurrent.ConcurrentLinkedQueue
;
public
class
H2QueueRepository
implements
IQueueRepository
{
>Paho Releases</
id
>
<
url
>https://repo.eclipse.org/content/repositories/paho-releases/</
url
>
</
repository
>
<
repository
>
<
id
>sonatype-snapshots</
id
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
moquette/BugSnagErrorsHandler.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
"
RedundantModifier
"
/>
<
module
name
=
"
GenericWhitespace
"
/>
<
module
name
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
moquette/BrokerConfiguration.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
module
name
=
"
OuterTypeFilename
"
/>
<
module
name
=
"
ModifierOrder
"
/>
<
module
name
moquette/Authorizator.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
gugia
/
moquette
forked from
moquette-io/moquette
Watch
2
Star
.
Entry<
Topic
,
RetainedMessage
>
entry
:
storage
.
entrySet()) {
final
Topic
scanTopic
=
entry
.
getKey();
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
−1
+6
−6
+5
−5
+3
−3
+9
−9
+6
−6
+1
−1
+3
−3
+5
−6
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
();
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
'
)
compile project(
'
:moquette-mapdb-storage
'
)
//
compile project(':moquette-mapdb-storage')
compile
group
:
'
org.slf4j
'
,
name
:
'
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
<
p
>
<
span
style
="
font-size: 10pt;
"
>
EXCEPT AS EXPRESSLY SET FORTH IN THIS
AGREEMENT, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF
THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF
THE POSSIBILITY OF SUCH DAMAGES.
private
MVStore
mvStore;
public
H2QueueRepository
(
MVStore
mvStore
) {
this
.
mvStore
=
mvStore;
}
@Override
public
Queue<
>
<
snapshots
>
<
enabled
>true</
enabled
>
</
snapshots
>
<
url
>https://oss.sonatype.org/content/repositories/snapshots</
url
>
</
repository
>
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
=
"
EmptyForInitializerPad
"
/>
<
module
name
=
"
EmptyForIteratorPad
"
/>
<
module
name
=
"
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Travis CI - Test and Deploy Your Code with Confidence
Hey there!
Looks like you have JavaScript disabled.
The Travis CI webclient needs JavaScript to work properly.
Please enable JavaScript to get the best Travis CI experience.
Thank you!
moquette/.travis.yml at fc1b6033819c77b05e9a3986dd2fbb10705f5722 · moquette-io/moquette · GitHub
moquette/AutoFlushHandler.java at 1ba9eb3613bc79d28c5d45d9c0984033d36d83af · moquette-io/moquette · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
=
"
RedundantModifier
"
/>
<
module
name
=
"
GenericWhitespace
"
/>
<
module
name
=
"
EmptyForInitializerPad
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
0
Fork
666
Code
Pull requests
0
Actions
Projects
0
Security
Insights
More
Code
Pull requests
Actions
Projects
Security
Insights
if
(searchTopic
.
match(scanTopic)) {
matchingMessages
.
add(entry
.
getValue());
}
}
return
matchingMessages;
}
}
21
broker/src/main/java/io/moquette/broker/PostOffice.java
Show comments
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
+3
−4
+0
−57
broker/src/test/java/io/moquette/spi/impl/MockReceiverChannel.java
+0
−273
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryMatchingTest.java
+0
−307
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryTest.java
+0
−179
broker/src/test/java/io/moquette/spi/impl/subscriptions/TopicTest.java
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
sessionRegistry;
4
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
Show comments
View file
Edit file
Delete file
slf4j-log4j12
'
,
version
:
'
1.7.5
'
}
10
mapdb_storage/build.gradle
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
</
span
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
SessionRegistry
.
EnqueuedMessage
>
createQueue
(
String
cli
,
boolean
clean
) {
if
(
!
clean) {
return
new
</
repositories
>
<
distributionManagement
>
<
repository
>
<
id
>bintray</
id
>
<
url
>https://api.bintray.com/maven/
/
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
MethodParamPad
"
/>
<
module
name
=
"
ParenPad
"
/>
<
module
name
=
"
TypecastParenPad
"
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
broker
/
NewNettyMQTTHandler.java
/
Jump to
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
moquette/.travis.yml at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
Sign in to GitHub · GitHub
Skip to content
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
moquette/PostOfficePublishTest.java at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Updated travis ci config to openjdk12 · moquette-io/moquette@fc1b603 · GitHub
Updated travis ci config to openjdk12 · moquette-io/moquette@fc1b603 · GitHub
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
"
/>
<
module
name
=
"
EmptyForIteratorPad
"
/>
<
module
name
=
"
MethodParamPad
"
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Permalink
Browse files
remove unnecessary quotes (
moquette-io#478
)
Loading branch information
joestr
authored and
gugia
committed
May 25, 2020
1 parent
8ad2ae2
commit
6a16900507b75567d29e3f909fbe6d95b5016fea
View file
Edit file
Delete file
@@ -21,6 +21,7 @@
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.Unpooled
;
import
io.netty.handler.codec.mqtt.*
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
java
/
io
/
moquette
/
broker
/
MoquetteIdleTimeoutHandler.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
+1
−1
broker/src/test/java/io/moquette/testclient/RawClient.java
+2
−2
broker/src/test/resources/log4j.properties
+1
−1
distribution/build.gradle
+3
−3
distribution/src/main/resources/log4j.properties
+1
−1
distribution/src/main/resources/moquette.conf
+1
−1
distribution/src/main/scripts/moquette.bat
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
@@ -65,6 +65,7 @@
private
IAuthenticator
mockAuthenticator;
private
SessionRegistry
sessionRegistry;
public
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
Retry
85
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBMessagesStore.java
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
1141e9f
Please
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
java
/
io
/
java
/
io
/
moquette
/
broker
/
NewNettyAcceptor.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
>
7. GENERAL
</
span
>
</
b
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
H2PersistentQueue<>
(mvStore, cli);
}
return
new
ConcurrentLinkedQueue<>
();
}
}
4
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
Show comments
View file
Edit file
Delete file
@@ -52,6 +52,7 @@
private
static
</
url
>
</
repository
>
</
distributionManagement
>
</
project
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
/
main
/
java
/
io
/
moquette
/
broker
/
MemoryRetainedRepository.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
/>
<
module
name
=
"
ParameterName
"
>
<
property
name
=
"
format
"
value
=
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
114 lines (96 sloc)
4.12 KB
Raw
Blame
/*
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
After fix #488 used also in H2RetainedRepository · moquette-io/moquette@c1e0b17 · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
/>
<
module
name
=
"
ParenPad
"
/>
<
module
name
=
"
TypecastParenPad
"
/>
<
module
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Unified
Split
Showing
1 changed file
with
2 additions
and
2 deletions
.
+2
−2
distribution/src/main/scripts/moquette.bat
4
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
Delete file
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
@@ -99,19 +100,21 @@ private void publishRetainedMessagesForSubscriptions(String clientID, List<Subsc
Session
targetSession
=
this
.
sessionRegistry
.
retrieve(clientID);
for
(
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
51 lines (45 sloc)
1.96 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
+1
−1
distribution/src/main/scripts/moquette.sh
+4
−4
embedding_moquette/src/main/java/io/moquette/testembedded/EmbeddedLauncher.java
+1
−1
h2_storage/src/main/java/io/moquette/persistence/h2/H2MessagesStore.java
+1
−1
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentStore.java
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
main
/
java
/
io
/
moquette
/
broker
/
PostOffice.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
@@ -87,8 +88,9 @@ private void prepareSUT() {
subscriptions
=
new
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
/
moquette
/
broker
/
NettyUtils.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
377 lines (333 sloc)
17.7 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
"
>
If any provision of this Agreement is invalid
or unenforceable under applicable law, it shall not affect the validity or
enforceability of the remainder of the terms of this Agreement, and without
further action by the parties hereto, such provision shall be reformed to the
minimum extent necessary to make such provision valid and enforceable.
</
span
>
</
p
>
<
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
static
final
BrokerConfiguration
CONFIG
=
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
50 lines (42 sloc)
1.44 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
"
^(?!arg[0-9])[_a-z][_a-zA-Z0-9]*$
"
/>
</
module
>
</
module
>
</
module
>
Copy lines
Copy permalink
View git blame
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
name
=
"
ParameterName
"
>
<
property
name
=
"
format
"
value
=
"
^(?!arg[0-9])[_a-z][_a-zA-Z0-9]*$
"
/>
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
@@ -31,7 +31,7 @@ goto end
rem
Set JavaHome if it exists
if
exist
{
"
%JAVA_HOME%
\bin\java
"
} (
set
"
JAVA
=
"
%JAVA_HOME%
\bin\java
"
Subscription
subscription
:
newSubscriptions) {
final
String
topicFilter
=
subscription
.
getTopicFilter()
.
toString();
final
MqttPublishMessage
retainedMsg
=
retainedRepository
.
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
java
/
io
java
/
io
/
moquette
/
broker
/
MemorySubscriptionsRepository.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
org.slf4j.Logger
+2
−2
h2_storage/src/main/java/io/moquette/persistence/h2/H2SessionsStore.java
+0
−11
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
+0
−14
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+1
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBMessagesStore.java
+1
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
301 lines (254 sloc)
12.6 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
Go to definition
R
Copy path
Cannot retrieve contributors at this time
74 lines (60 sloc)
2.67 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
p
>
<
span
style
="
font-size: 10pt;
"
>
If Recipient institutes patent litigation
against any entity (including a cross-claim or counterclaim in a lawsuit)
alleging that the Program itself (excluding combinations of the Program with
other software or hardware) infringes such Recipient's patent(s), then such
new
BrokerConfiguration
(
true
,
true
,
false
);
private
IAuthenticator
mockAuthenticator;
private
IAuthenticator
mockAuthenticator;
private
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Topic
;
import
java
/
io
/
moquette
/
broker
/
ISubscriptionsRepository.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
/
src
/
main
/
java
/
io
/
moquette
/
broker
/
ISslContextCreator.java
/
Jump to
Code definitions
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
import
io.netty.channel.*
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.handler.codec.mqtt.MqttMessage
;
import
io.netty.util.AttributeKey
;
import
io.netty.util.ReferenceCountUtil
;
import
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
java
/
io
/
moquette
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
java
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
java
</
module
>
</
module
>
</
module
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
set
JAVA
=
"
%JAVA_HOME%
\bin\java
"
)
echo
Using JAVA_HOME:
"
%JAVA_HOME%
"
@@ -83,6 +83,6 @@ rem set JAVA_OPTS=%JAVA_OPTS% -XX:PrintFLSStatistics=1
rem
set JAVA_OPTS=%JAVA_OPTS% -Xloggc:/var/log/moquette/gc.log
retainedOnTopic(topicFilter);
final
List<
RetainedMessage
>
retainedMsgs
=
retainedRepository
.
retainedOnTopic(topicFilter);
if
(
retainedMsg
==
null
) {
if
(
/
moquette
/
broker
/
MQTTConnection.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
37 lines (31 sloc)
1.15 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
;
import
org.slf4j.LoggerFactory
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.handler.timeout.IdleState
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBPersistentStore.java
+2
−2
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBSessionsStore.java
+0
−18
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBPersistentStoreTest.java
+0
−14
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBSessionsStoreTest.java
6
broker/src/main/java/io/moquette/broker/Authorizator.java
Show comments
/
java
/
io
/
moquette
/
broker
/
InflightResender.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.interception.BrokerInterceptor
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.util.Attribute
io.moquette.BrokerConstants
;
import
io.moquette.broker.config.IConfig
;
import
io.moquette.broker.metrics.*
;
import
io.netty.bootstrap.ServerBootstrap
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.channel.*
;
Recipient's rights granted under Section 2(b) shall terminate as of the date
such litigation is filed.
</
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
PostOffice
postOffice;
private
PostOffice
postOffice;
private
MemoryQueueRepository
queueRepository;
@Before
@Before
public
void
setUp
() {
public
void
setUp
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.concurrent.ConcurrentHashMap
;
import
java.util.concurrent.ConcurrentMap
;
/*
* In memory retained messages store
*
*/
final
class
MemoryRetainedRepository
implements
IRetainedRepository
{
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
27 lines (22 sloc)
857 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
27 lines (23 sloc)
830 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.io.IOException
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
@Sharable
public
class
NewNettyMQTTHandler
extends
ChannelInboundHandlerAdapter
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
/
broker
/
MQTTConnectionFactory.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
/
src
/
main
/
java
/
io
/
moquette
/
broker
/
DebugUtils.java
/
Jump to
Code definitions
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
/
io
/
moquette
/
broker
/
IRetainedRepository.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
/
io
/
moquette
/
broker
/
DefaultMoquetteSslContextCreator.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
/
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+UseGCLogFileRotation
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:NumberOfGCLogFiles=
10
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
retainedMsgs
.
isEmpty()
) {
//
not found
continue
;
}
final
MqttQoS
retainedQos
=
retainedMsg
.
fixedHeader()
.
qosLevel();
R
Copy path
Cannot retrieve contributors at this time
478 lines (420 sloc)
20.4 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Subscription
;
import
java.util.ArrayList
;
import
io.netty.handler.timeout.IdleStateEvent
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
@Sharable
public
class
MoquetteIdleTimeoutHandler
extends
ChannelDuplexHandler
{
private
static
final
View file
Edit file
Delete file
@@ -15,8 +15,8 @@
*/
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Topic
;
import
io.moquette.
spi
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
162 lines (137 sloc)
5.62 KB
Raw
Blame
/*
* Copyright (c) 2012-2016 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.buffer.ByteBuf
;
import
new
SessionRegistry
(subscriptions,
queueRepository
);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
Learn more
Accept
Reject
Save preferences
;
import
io.netty.util.AttributeKey
;
/**
* Some Netty's channels utilities.
*/
public
final
class
NettyUtils
{
public
static
final
String
ATTR_USERNAME
=
import
io.netty.channel.epoll.EpollEventLoopGroup
;
import
io.netty.channel.epoll.EpollServerSocketChannel
;
import
io.netty.channel.nio.NioEventLoopGroup
;
import
io.netty.channel.socket.ServerSocketChannel
;
import
io.netty.channel.socket.SocketChannel
;
import
io.netty.channel.socket.nio.NioServerSocketChannel
;
"
>
All Recipient's rights under this Agreement
shall terminate if it fails to comply with any of the material terms or
conditions of this Agreement and does not cure such failure in a reasonable
period of time after becoming aware of such noncompliance. If all Recipient's
rights under this Agreement terminate, Recipient agrees to cease use and
distribution of the Program as soon as reasonably practicable. However,
Recipient's obligations under this Agreement and any licenses granted by
Recipient relating to the Program shall continue and survive.
</
span
>
</
p
>
<
() {
@@ -62,8 +63,9 @@ public void setUp() {
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
private
final
ConcurrentMap<
String
,
MqttPublishMessage
>
storage
=
new
ConcurrentHashMap<>
();
@Override
public
void
cleanRetained
(
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Subscription
;
import
java.util.List
;
public
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
moquette
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
broker
/
BugSnagErrorsHandler.java
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
NewNettyMQTTHandler
.
class);
private
static
final
String
ATTR_CONNECTION
src
/
main
/
java
/
io
/
moquette
/
broker
/
BrokerConfiguration.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Cannot retrieve contributors at this time
39 lines (34 sloc)
1.42 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
40 lines (34 sloc)
1.19 KB
Raw
Blame
/*
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
fc1b603381
moquette
/
.travis.yml
Go to file
Go to file
T
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
1ba9eb3613
moquette
/
broker
/
src
/
main
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
29 lines (24 sloc)
942 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
186 lines (170 sloc)
8.08 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
java
/
io
/
moquette
/
broker
/
Authorizator.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
"
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
%JAVA%
-server
%JAVA_OPTS%
%JAVA_OPTS_SCRIPT%
-Dlog4j.configuration=file:
%LOG_FILE%
-Dmoquette.path=
%MOQUETTE_PATH%
-cp
MqttQoS
qos
=
lowerQosToTheSubscriptionDesired(subscription, retainedQos);
final
ByteBuf
origPayload
=
retainedMsg
.
payload();
ByteBuf
payload
=
origPayload
.
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
java.util.Collections
;
import
java.util.List
;
public
class
MemorySubscriptionsRepository
implements
ISubscriptionsRepository
{
Logger
LOG
=
LoggerFactory
.
getLogger(
MoquetteIdleTimeoutHandler
.
class);
@Override
public
void
userEventTriggered
.security.IAuthorizatorPolicy
;
import
io.moquette.
broker
.subscriptions.Topic
;
import
io.moquette.
broker
.security.IAuthorizatorPolicy
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
io.netty.handler.codec.mqtt.MqttSubscribeMessage
;
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.handler.codec.mqtt.*
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.ArrayList
;
import
java.util.List
;
import
java.util.Set
;
.
NO_OBSERVERS_INTERCEPTOR
);
}
4
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
Show comments
View file
Edit file
Delete file
@@ -56,6 +56,7 @@
private
IAuthenticator
mockAuthenticator;
private
SessionRegistry
sessionRegistry;
"
username
"
;
private
static
final
String
ATTR_CLIENTID
=
"
ClientID
"
;
private
static
final
String
import
io.netty.handler.codec.MessageToMessageDecoder
;
import
io.netty.handler.codec.MessageToMessageEncoder
;
import
io.netty.handler.codec.http.HttpObjectAggregator
;
import
io.netty.handler.codec.http.HttpRequestDecoder
;
import
io.netty.handler.codec.http.HttpResponseEncoder
;
import
io.netty.handler.codec.http.HttpServerCodec
p
>
<
span
style
="
font-size: 10pt;
"
>
Everyone is permitted to copy and distribute
copies of this Agreement, but in order to avoid inconsistency the Agreement is
copyrighted and may only be modified in the following manner. The Agreement
Steward reserves the right to publish new versions (including revisions) of
this Agreement from time to time. No one other than the Agreement Steward has
the right to modify this Agreement. The Eclipse Foundation is the initial
Agreement Steward. The Eclipse Foundation may assign the responsibility to
serve as the Agreement Steward to a suitable separate entity. Each new version
of the Agreement will be given a distinguishing version number. The Program
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
subscriptions
.
init(subscriptionsRepository);
queueRepository
Topic
topic
) {
storage
.
remove(topic
.
toString());
}
@Override
public
void
retain
(
Topic
topic
,
interface
ISubscriptionsRepository
{
List<
Subscription
>
listAllSubscriptions
();
void
addNewSubscription
(
Subscription
subscription
);
}
Copy lines
Copy permalink
View git blame
Reference in new issue
io.netty.handler.ssl.SslContext
;
/**
* SSL certificate loader used to open SSL connections (websocket and MQTT-S).
*/
public
interface
ISslContextCreator
{
SslContext
initSSLContext
();
}
Copy lines
Copy permalink
View git blame
Reference in new issue
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
41 lines (35 sloc)
1.35 KB
Raw
=
"
connection
"
;
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CONNECTION
=
AttributeKey
.
valueOf(
ATTR_CONNECTION
);
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
51 lines (43 sloc)
1.86 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.netty.channel.Channel
;
class
MQTTConnectionFactory
{
private
final
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
.travis.yml
Go to file
Go to line
L
Copy path
Cannot retrieve contributors at this time
13 lines (12 sloc)
275 Bytes
Raw
Blame
language
:
java
jdk
:
-
openjdk12
before_cache
:
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
/
broker
/
src
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
/
java
/
io
/
moquette
/
broker
/
AutoFlushHandler.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Topic
;
import
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Updated travis ci config to openjdk12
Loading branch information
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Updated travis ci config to openjdk12
Loading branch information
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
97 lines (86 sloc)
3.62 KB
Raw
Blame
/*
%MOQUETTE_HOME%
\lib\* io.moquette.broker.Server
Toggle all file notes
0 comments on commit
6a16900
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
retainedDuplicate();
targetSession
.
sendRetainedPublishOnSessionAtQos(subscription
.
getTopicFilter(), qos, payload);
for
(
RetainedMessage
retainedMsg
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.netty.buffer.ByteBuf
;
import
private
final
List<
Subscription
>
subscriptions
=
new
ArrayList<>
();
(
ChannelHandlerContext
ctx
,
Object
evt
)
throws
Exception
{
if
import
io.netty.handler.codec.mqtt.MqttTopicSubscription
;
@@ -26,7 +26,7 @@
import
java.util.ArrayList
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.util.concurrent.EventExecutor
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.stream.Collectors
;
import static
io.moquette.broker.Utils.messageId
;
import static
io.netty.handler.codec.mqtt.MqttMessageIdVariableHeader.from
;
import static
public
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryQueueRepository
CLEAN_SESSION
=
"
removeTemporaryQoS2
"
;
private
static
final
String
KEEP_ALIVE
=
"
keepAlive
"
;
private
static
final
;
import
io.netty.handler.codec.http.websocketx.BinaryWebSocketFrame
;
import
io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler
;
import
io.netty.handler.codec.mqtt.MqttDecoder
;
import
io.netty.handler.codec.mqtt.MqttEncoder
;
import
io.netty.handler.ssl.SslContext
;
import
io.netty.handler.ssl.SslHandler
;
(including Contributions) may always be distributed subject to the version of
the Agreement under which it was received. In addition, after a new version of
the Agreement is published, Contributor may elect to distribute the Program
(including its Contributions) under the new version. Except as expressly stated
in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to
the intellectual property of any Contributor under this Agreement, whether
expressly, by implication, estoppel or otherwise. All rights in the Program not
expressly granted under this Agreement are reserved.
</
span
>
</
p
>
<
p
>
<
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
MqttPublishMessage
msg
) {
storage
.
put(topic
.
toString(), msg);
}
@Override
public
boolean
isEmtpy
() {
return
storage
.
isEmpty();
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
private
MQTTConnectionFactory
connectionFactory;
NewNettyMQTTHandler
(
MQTTConnectionFactory
connectionFactory
) {
this
.
connectionFactory
=
connectionFactory;
}
private
static
void
mqttConnection
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.BrokerConstants
BrokerConfiguration
brokerConfig;
private
final
IAuthenticator
authenticator;
private
final
SessionRegistry
sessionRegistry;
private
final
PostOffice
postOffice;
MQTTConnectionFactory
(
BrokerConfiguration
brokerConfig
,
;
import
io.netty.buffer.ByteBuf
;
import
java.nio.charset.StandardCharsets
;
public
final
class
DebugUtils
{
public
static
String
payload2Str
(
ByteBuf
content
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
13 lines (12 sloc)
275 Bytes
Raw
Blame
language
:
java
jdk
:
-
openjdk12
before_cache
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache
:
directories
:
-
$HOME/.gradle/caches/
-
$HOME/.gradle/wrapper/
script
:
-
./gradlew install test
Copy lines
Copy permalink
/
test
/
java
/
io
/
moquette
/
broker
/
PostOfficePublishTest.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
After
fix
#488
used also in H2RetainedRepository
Loading branch information
andsel
committed
Jul 21, 2019
1 parent
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
172 lines (147 sloc)
6.09 KB
Raw
Blame
/*
* Copyright (c) 2012-2016 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
io.netty.handler.codec.mqtt.MqttPublishMessage
;
public
interface
IRetainedRepository
{
void
cleanRetained
(
Topic
topic
);
void
retain
(
Topic
topic
andsel
committed
Jul 21, 2019
1 parent
c1e0b17
commit
fc1b6033819c77b05e9a3986dd2fbb10705f5722
Unified
Split
Showing
1 changed file
with
1 addition
and
1 deletion
.
+1
−1
andsel
committed
Jul 21, 2019
1 parent
c1e0b17
commit
fc1b6033819c77b05e9a3986dd2fbb10705f5722
Unified
Split
Showing
1 changed file
with
1 addition
and
1 deletion
.
+1
−1
io.moquette.broker
;
import
java.io.File
;
import
java.io.FileInputStream
;
import
java.io.FileNotFoundException
;
import
java.io.IOException
;
import
java.io.InputStream
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
:
retainedMsgs) {
final
MqttQoS
retainedQos
=
retainedMsg
.
qosLevel();
MqttQoS
qos
=
lowerQosToTheSubscriptionDesired(subscription, retainedQos);
//
final ByteBuf origPayload = retainedMsg.getPayload();
final
ByteBuf
io.netty.channel.Channel
;
import
io.netty.channel.ChannelPipeline
;
import
io.netty.handler.codec.mqtt.*
;
import
io.netty.handler.timeout.IdleStateHandler
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
@Override
public
List<
Subscription
>
listAllSubscriptions
() {
return
Collections
.
unmodifiableList(subscriptions);
}
@Override
public
void
addNewSubscription
(
(evt
instanceof
IdleStateEvent
) {
IdleState
e
=
((
IdleStateEvent
) evt)
.
state();
if
(e
==
IdleState
.
READER_IDLE
) {
java.util.List
;
import static
io.moquette.
spi.impl
.Utils.messageId
;
import static
io.moquette.
broker
.Utils.messageId
;
import static
io.netty.handler.codec.mqtt.MqttQoS.FAILURE
;
final
class
Authorizator
{
import
java.util.concurrent.ScheduledFuture
;
import
java.util.concurrent.TimeUnit
;
/**
* Resend inflight not ack'ed publish packets (QoS1 PUB and QoS2 PUB/PUBREL). It's inspired by IdleStateHandler but it's
* specialized version, just invoking Session's resendInflightNotAcked by the channel after a period.
*/
public
class
InflightResender
extends
io.netty.handler.codec.mqtt.MqttQoS.*
;
class
PostOffice
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
PostOffice
.
class);
private
queueRepository;
@Before
public
void
setUp
() {
@@ -78,8 +79,9 @@ private void prepareSUT() {
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
AttributeKey<
Object
>
ATTR_KEY_KEEPALIVE
=
AttributeKey
.
valueOf(
KEEP_ALIVE
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLEANSESSION
import
io.netty.handler.timeout.IdleStateHandler
;
import
io.netty.util.concurrent.Future
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
javax.net.ssl.SSLEngine
;
import
java.util.List
span
style
="
font-size: 10pt;
"
>
This Agreement is governed by the laws of the
State of New York and the intellectual property laws of the United States of
America. No party to this Agreement will bring a legal action under this
Agreement more than one year after the cause of action arose. Each party waives
its rights to a jury trial in any resulting litigation.
</
span
>
</
p
>
);
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(),
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
}
@Override
public
MqttPublishMessage
retainedOnTopic
(
String
topic
) {
return
storage
.
get(topic);
}
}
Copy lines
Copy permalink
View git blame
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
io.moquette.broker
;
import
com.bugsnag.Bugsnag
;
import
io.moquette.broker.config.IConfig
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelInboundHandlerAdapter
;
(
Channel
channel
,
MQTTConnection
connection
) {
channel
.
attr(
ATTR_KEY_CONNECTION
)
.
set(connection);
}
private
static
MQTTConnection
;
import
io.moquette.broker.config.IConfig
;
class
BrokerConfiguration
{
private
final
boolean
allowAnonymous;
private
final
boolean
allowZeroByteClientId;
private
final
boolean
IAuthenticator
authenticator
,
SessionRegistry
sessionRegistry
,
PostOffice
postOffice
) {
this
.
brokerConfig
=
brokerConfig;
this
.
authenticator
=
) {
final
ByteBuf
copy
=
content
.
copy();
final
byte
[] bytesContent;
if
(copy
.
isDirect()) {
final
int
size
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache
:
directories
:
-
$HOME/.gradle/caches/
-
$HOME/.gradle/wrapper/
script
:
-
./gradlew install test
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
415 lines (350 sloc)
18.8 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
fe918c4
commit
c1e0b1752b058e45daa41220c726ea145d47127f
Unified
Split
Showing
1 changed file
with
1 addition
and
1 deletion
.
+1
−1
broker/src/main/java/io/moquette/persistence/H2RetainedRepository.java
2
broker/src/main/java/io/moquette/persistence/H2RetainedRepository.java
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandlerContext
;
import
,
MqttPublishMessage
msg
);
boolean
isEmtpy
();
MqttPublishMessage
retainedOnTopic
(
String
topic
);
}
Copy lines
Copy permalink
View git blame
Reference in new issue
.travis.yml
2
.travis.yml
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,6 @@
language
:
java
jdk
:
-
oraclejdk8
-
openjdk12
.travis.yml
2
.travis.yml
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,6 @@
language
:
java
language
:
java
jdk
:
jdk
:
;
import
java.net.URL
;
import
java.security.GeneralSecurityException
;
import
java.security.KeyManagementException
;
import
java.security.KeyStore
;
import
java.security.KeyStoreException
;
import
java.security.NoSuchAlgorithmException
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
io.netty.handler.codec.mqtt.MqttSubscribeMessage
;
import
io.netty.handler.codec.mqtt.MqttTopicSubscription
;
import
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
payloadBuf
=
Unpooled
.
wrappedBuffer(retainedMsg
.
getPayload());
//
ByteBuf payload = origPayload.retainedDuplicate();
targetSession
.
sendRetainedPublishOnSessionAtQos(subscription
.
getTopicFilter(), qos, payloadBuf);
}
}
java.nio.charset.StandardCharsets
;
import
java.util.*
;
import
java.util.concurrent.TimeUnit
;
import
java.util.concurrent.atomic.AtomicInteger
;
import static
io.netty.channel.ChannelFutureListener.CLOSE_ON_FAILURE
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
Subscription
subscription
) {
subscriptions
.
add(subscription);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
LOG
.
info(
"
Firing channel inactive event. MqttClientId = {}.
"
,
NettyUtils
.
clientID(ctx
.
channel()));
//
fire a close that then fire channelInactive to trigger publish of Will
ctx
.
close()
.
addListener(
2
...quette/server/netty/AutoFlushHandler.java → .../io/moquette/broker/AutoFlushHandler.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
server.netty
;
package
io.moquette.
broker
ChannelDuplexHandler
{
/**
* Placeholder event to resend not-acked publish messages in the in flight window.
*
*/
public
static
class
ResendNotAckedPublishes
{
}
private
final
class
WriterIdleTimeoutTask
implements
final
Authorizator
authorizator;
private
final
ISubscriptionsDirectory
subscriptions;
private
final
IRetainedRepository
retainedRepository;
private
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
=
AttributeKey
.
valueOf(
CLEAN_SESSION
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLIENTID
=
AttributeKey
;
import
java.util.Optional
;
import
java.util.concurrent.TimeUnit
;
import static
io.moquette.BrokerConstants.*
;
import static
io.netty.channel.ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE
;
class
NewNettyAcceptor
{
private
static
<
p
class
="
MsoNormal
"
>
<!--[if !supportEmptyParas]-->
&nbsp;
<!--[endif]-->
<
o:p
>
</
(),
new
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
4
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
import static
io.moquette.BrokerConstants.BUGSNAG_TOKEN_PROPERTY_NAME
;
@Sharable
public
class
BugSnagErrorsHandler
extends
ChannelInboundHandlerAdapter
{
private
Bugsnag
bugsnag;
public
void
init
(
mqttConnection
(
Channel
channel
) {
return
(
MQTTConnection
) channel
.
attr(
ATTR_KEY_CONNECTION
)
.
get();
}
@Override
reauthorizeSubscriptionsOnConnect;
BrokerConfiguration
(
IConfig
props
) {
allowAnonymous
=
props
.
boolProp(
BrokerConstants
.
ALLOW_ANONYMOUS_PROPERTY_NAME
,
true
);
allowZeroByteClientId
authenticator;
this
.
sessionRegistry
=
sessionRegistry;
this
.
postOffice
=
postOffice;
}
public
MQTTConnection
create
(
Channel
channel
=
copy
.
readableBytes();
bytesContent
=
new
byte
[size];
copy
.
readBytes(bytesContent);
}
else
{
bytesContent
=
copy
.
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.security.PermitAllAuthorizatorPolicy
;
Show comments
View file
Edit file
Delete file
@@ -45,7 +45,7 @@ public boolean isEmpty() {
final
List<
RetainedMessage
>
matchingMessages
=
new
ArrayList<>
();
for
(
Map
.
io.netty.util.concurrent.EventExecutor
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.concurrent.ScheduledFuture
;
import
java.util.concurrent.TimeUnit
;
/**
* Auto-flush data on channel after a read timeout. It's inspired by IdleStateHandler but it's
* specialized version, just flushing data after no read is done on the channel after a period. It's
* used to avoid aggressively flushing from the ProtocolProcessor.
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
before_cache
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
Toggle all file notes
0 comments on commit
fc1b603
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
-
oraclejdk8
-
openjdk12
before_cache
:
before_cache
:
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
-
rm -fr $HOME/.gradle/caches/*/plugin-resolution/
Toggle all file notes
0 comments on commit
;
import
java.security.PrivateKey
;
import
java.security.cert.Certificate
;
import
java.security.cert.X509Certificate
;
import
java.util.Collections
;
import
java.util.Objects
;
import
io.moquette.BrokerConstants
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.ArrayList
;
import
java.util.List
;
import static
io.moquette.broker.Utils.messageId
;
import static
io.netty.handler.codec.mqtt.MqttQoS.FAILURE
;
final
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
}
24
broker/src/main/java/io/moquette/broker/RetainedMessage.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,24 @@
package
io.moquette.broker
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
java.io.Serializable
import static
io.netty.handler.codec.mqtt.MqttConnectReturnCode.*
;
import static
io.netty.handler.codec.mqtt.MqttMessageIdVariableHeader.from
;
import static
io.netty.handler.codec.mqtt.MqttQoS.*
;
final
class
MQTTConnection
{
private
static
final
Logger
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
CLOSE_ON_FAILURE
);
}
}
else
{
if
(
LOG
.
isTraceEnabled()) {
LOG
.
trace(
"
"
,
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandlerContext
;
2
broker/src/main/java/io/moquette/broker/BrokerConfiguration.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,7 @@
package
io.moquette.broker
Runnable
{
private
final
ChannelHandlerContext
ctx;
WriterIdleTimeoutTask
(
ChannelHandlerContext
ctx
) {
this
.
ctx
=
ctx;
}
@Override
SessionRegistry
sessionRegistry;
private
BrokerInterceptor
interceptor;
PostOffice
(
ISubscriptionsDirectory
subscriptions
,
IAuthorizatorPolicy
authorizatorPolicy
,
IRetainedRepository
retainedRepository
,
SessionRegistry
sessionRegistry
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
);
sut
=
new
PostOffice
(subscriptions,
new
.
valueOf(
ATTR_CLIENTID
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_USERNAME
=
AttributeKey
.
valueOf(
ATTR_USERNAME
);
public
static
final
String
MQTT_SUBPROTOCOL_CSV_LIST
=
"
mqtt, mqttv3.1, mqttv3.1.1
"
;
static
class
WebSocketFrameToByteBufDecoder
extends
MessageToMessageDecoder<
BinaryWebSocketFrame
>
{
@Override
protected
o:p
>
</
p
>
</
div
>
<
div
class
="
Section2
"
>
<
p
Show comments
View file
Edit file
Delete file
@@ -45,6 +45,7 @@
private
EmbeddedChannel
channel;
private
EmbeddedChannel
channel;
private
SessionRegistry
sessionRegistry;
private
SessionRegistry
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
IConfig
props
) {
final
String
token
=
props
.
getProperty(
BUGSNAG_TOKEN_PROPERTY_NAME
);
this
.
bugsnag
=
new
Bugsnag
(token);
public
void
channelRead
(
ChannelHandlerContext
ctx
,
Object
message
)
throws
Exception
{
MqttMessage
msg
=
(
=
props
.
boolProp(
BrokerConstants
.
ALLOW_ZERO_BYTE_CLIENT_ID_PROPERTY_NAME
,
false
);
reauthorizeSubscriptionsOnConnect
=
props
.
) {
return
new
MQTTConnection
(channel, brokerConfig, authenticator, sessionRegistry, postOffice);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
array();
}
return
new
String
(bytesContent,
StandardCharsets
.
UTF_8
);
}
private
DebugUtils
() {
}
}
Copy lines
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.netty.buffer.ByteBuf
Entry<
Topic
,
RetainedMessage
>
entry
:
queueMap
.
entrySet()) {
final
Topic
scanTopic
=
entry
.
getKey();
if
(
*/
public
class
AutoFlushHandler
extends
ChannelDuplexHandler
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
AutoFlushHandler
.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
fc1b603
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
;
import
io.moquette.broker.config.IConfig
;
import
io.netty.handler.ssl.ClientAuth
;
import
io.netty.handler.ssl.SslContext
;
import
io.netty.handler.ssl.SslContextBuilder
;
import
io.netty.handler.ssl.SslProvider
;
import
class
Authorizator
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
Authorizator
.
class);
private
final
IAuthorizatorPolicy
;
public
class
RetainedMessage
implements
Serializable
{
private
final
MqttQoS
qos;
private
final
byte
[] payload;
public
RetainedMessage
LOG
=
LoggerFactory
.
getLogger(
MQTTConnection
.
class);
final
Channel
channel;
private
BrokerConfiguration
brokerConfig;
private
IAuthenticator
authenticator;
private
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
NettyUtils
.
clientID(ctx
.
channel()),
evt
.
getClass()
.
getName());
}
super
.
userEventTriggered(ctx, evt);
}
}
}
Copy lines
;
import
io.moquette.BrokerConstants
;
import
io.moquette.
server
.config.IConfig
;
import
io.moquette.
broker
.config.IConfig
;
class
BrokerConfiguration
{
public
void
run
() {
if
(
!
ctx
.
channel()
.
isOpen()) {
return
;
}
long
nextDelay
,
BrokerInterceptor
interceptor
) {
this
.
authorizator
=
new
Authorizator
(authorizatorPolicy);
this
.
subscriptions
=
subscriptions;
this
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
}
4
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
Show comments
View file
Object
getAttribute
(
ChannelHandlerContext
ctx
,
AttributeKey<
Object
>
key
) {
Attribute<
Object
>
attr
=
void
decode
(
ChannelHandlerContext
chc
,
BinaryWebSocketFrame
frame
,
List<
Object
>
out
)
throws
Exception
{
//
style
="
text-align: center;
"
align
="
center
"
>
<
b
>
Apache License
</
b
>
</
br
>
sessionRegistry;
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
MemoryQueueRepository
queueRepository;
@Before
@Before
public
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
}
@Override
public
void
exceptionCaught
(
ChannelHandlerContext
ctx
,
Throwable
cause
)
throws
Exception
{
bugsnag
.
notify(cause);
MqttMessage
) message;
if
(msg
.
fixedHeader()
==
null
) {
throw
new
IOException
(
"
Unknown packet
"
);
}
final
boolProp(
BrokerConstants
.
REAUTHORIZE_SUBSCRIPTIONS_ON_CONNECT
,
false
);
}
public
BrokerConfiguration
(
boolean
allowAnonymous
,
boolean
allowZeroByteClientId
,
boolean
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
;
import
io.netty.buffer.ByteBufUtil
;
import
io.netty.buffer.Unpooled
;
import
io.netty.buffer.UnpooledByteBufAllocator
;
import
io.netty.channel.Channel
;
import
io.netty.channel.embedded.EmbeddedChannel
;
import
io.netty.handler.codec.mqtt.*
searchTopic
.
match(
scanTopic
)) {
if
(
scanTopic
.
match(
searchTopic
)) {
matchingMessages
.
add(entry
.
getValue());
}
class);
private
static
final
long
MIN_TIMEOUT_NANOS
=
TimeUnit
.
MILLISECONDS
.
toNanos(
1
);
private
final
long
writerIdleTimeNanos;
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
javax.net.ssl.KeyManagerFactory
;
import
javax.net.ssl.TrustManagerFactory
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
/**
* Moquette integration implementation to load SSL certificate from local filesystem path configured in
* config file.
*/
class
policy;
Authorizator
(
IAuthorizatorPolicy
policy
) {
this
.
policy
=
policy;
}
/**
*
@param
clientID
* the clientID
(
MqttQoS
qos
,
byte
[]
payload
) {
this
.
qos
=
qos;
this
.
payload
=
SessionRegistry
sessionRegistry;
private
final
PostOffice
postOffice;
private
boolean
connected;
private
final
AtomicInteger
lastPacketId
=
new
AtomicInteger
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
4
...te/server/netty/BugSnagErrorsHandler.java → ...moquette/broker/BugSnagErrorsHandler.java
Show comments
View file
Edit file
Delete file
@@ -13,10 +13,10 @@
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
server.netty
;
package
=
resenderTimeNanos
-
(
System
.
nanoTime()
-
lastExecutionTime);
if
(nextDelay
<=
0
) {
//
Writer is idle - set a new timeout and notify the callback.
resenderTimeout
.
retainedRepository
=
retainedRepository;
this
.
sessionRegistry
=
sessionRegistry;
this
.
interceptor
=
interceptor;
}
public
void
Edit file
Delete file
@@ -47,6 +47,7 @@
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZEROBYTE_CLIENT_ID
=
new
BrokerConfiguration
(
ctx
.
channel()
.
attr(key);
return
attr
.
get();
}
public
static
void
keepAlive
(
Channel
channel
,
int
convert the frame to a ByteBuf
ByteBuf
bb
=
frame
.
content();
//
System.out.println("WebSocketFrameToByteBufDecoder decode - " +
//
ByteBufUtil.hexDump(bb));
bb
.
retain();
out
.
add(bb);
Version 2.0, January 2004
<
br
/>
http://www.apache.org/licenses/
<
br
/>
</
p
>
<
p
>
<
span
style
="
void
setUp
() {
public
void
setUp
() {
@@ -67,8 +68,9 @@ private MQTTConnection createMQTTConnection(BrokerConfiguration config, Channel
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsDirectory
subscriptions
=
new
ctx
.
fireExceptionCaught(cause);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
MQTTConnection
mqttConnection
=
mqttConnection(ctx
.
channel());
try
{
mqttConnection
.
handleMessage(msg);
}
catch
(
Throwable
ex) {
//
ctx.fireExceptionCaught(ex);
LOG
reauthorizeSubscriptionsOnConnect
) {
this
.
allowAnonymous
=
allowAnonymous;
this
.
allowZeroByteClientId
=
allowZeroByteClientId;
this
.
reauthorizeSubscriptionsOnConnect
=
reauthorizeSubscriptionsOnConnect;
}
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
;
import
org.junit.Before
;
import
org.junit.Test
;
import
java.nio.charset.Charset
;
import
java.util.*
;
import static
io.moquette.broker.PostOfficeUnsubscribeTest.CONFIG
;
import static
}
Toggle all file notes
0 comments on commit
c1e0b17
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
volatile
ScheduledFuture<?>
writerIdleTimeout;
volatile
long
lastWriteTime;
//
private boolean firstWriterIdleEvent = true;
private
volatile
int
state;
//
0 - none, 1 - initialized, 2 - destroyed
public
AutoFlushHandler
(
long
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
DefaultMoquetteSslContextCreator
implements
ISslContextCreator
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
final
IConfig
*
@param
username
* the username
*
@param
msg
* the subscribe message to verify
*
@return
the list of verified topics for the given subscribe message.
*/
List<
MqttTopicSubscription
>
verifyTopicsReadAccess
(
String
payload;
}
public
MqttQoS
qosLevel
() {
return
qos;
}
public
byte
[]
getPayload
() {
return
payload;
}
}
(
0
);
MQTTConnection
(
Channel
channel
,
BrokerConfiguration
brokerConfig
,
IAuthenticator
authenticator
,
SessionRegistry
sessionRegistry
,
PostOffice
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
io.moquette.
broker
;
import
com.bugsnag.Bugsnag
;
import
io.moquette.
server
.config.IConfig
;
import
io.moquette.
broker
.config.IConfig
;
import
io.netty.channel.ChannelHandler.Sharable
=
ctx
.
executor()
.
schedule(
this
, resenderTimeNanos,
TimeUnit
.
NANOSECONDS
);
try
{
resendNotAcked(ctx
/*
, event
*/
init
(
SessionRegistry
sessionRegistry
) {
this
.
sessionRegistry
=
sessionRegistry;
}
public
void
fireWill
(
Session
.
Will
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
@@ -67,8 +68,9 @@ private MQTTConnection createMQTTConnection(BrokerConfiguration config, Channel
ISubscriptionsDirectory
subscriptions
keepAlive
) {
channel
.
attr(
NettyUtils
.
ATTR_KEY_KEEPALIVE
)
.
set(keepAlive);
}
public
static
void
cleanSession
(
Channel
}
}
static
class
ByteBufToWebSocketFrameEncoder
extends
MessageToMessageEncoder<
ByteBuf
>
{
@Override
protected
void
encode
(
ChannelHandlerContext
chc
font-size: 10pt;
"
>
TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
</
spam
>
</
p
>
<
p
>
<
b
>
<
span
style
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
.
error(
"
Error processing protocol message: {}
"
, msg
.
fixedHeader()
.
messageType(), ex);
ctx
.
channel()
.
close()
.
addListener(
new
public
boolean
isAllowAnonymous
() {
return
allowAnonymous;
}
public
boolean
isAllowZeroByteClientId
() {
return
allowZeroByteClientId;
}
public
boolean
isReauthorizeSubscriptionsOnConnect
Learn more
Accept
Reject
Save preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
io.netty.handler.codec.mqtt.MqttQoS.AT_LEAST_ONCE
;
import static
io.netty.handler.codec.mqtt.MqttQoS.AT_MOST_ONCE
;
import static
io.netty.handler.codec.mqtt.MqttQoS.EXACTLY_ONCE
;
import static
java.util.Collections.singleton
;
import static
java.util.Collections.singletonMap
;
import static
org.junit.Assert.*
;
public
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
writerIdleTime
,
TimeUnit
unit
) {
if
(unit
==
null
) {
throw
new
NullPointerException
(
"
unit
"
);
props;
DefaultMoquetteSslContextCreator
(
IConfig
props
) {
this
.
props
=
Objects
.
requireNonNull(props);
}
@Override
public
SslContext
initSSLContext
clientID
,
String
username
,
MqttSubscribeMessage
msg
) {
List<
MqttTopicSubscription
>
ackTopics
=
new
ArrayList<>
();
final
int
5
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -162,21 +162,24 @@ public void startServer(IConfig config, List<? extends InterceptHandler> handler
final
ISubscriptionsRepository
subscriptionsRepository;
final
IQueueRepository
queueRepository;
final
IRetainedRepository
retainedRepository;
if
postOffice
) {
this
.
channel
=
channel;
this
.
brokerConfig
=
brokerConfig;
this
.
authenticator
=
authenticator;
this
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelInboundHandlerAdapter
;
2
...java/io/moquette/spi/impl/DebugUtils.java → ...n/java/io/moquette/broker/DebugUtils.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
);
}
catch
(
Throwable
t) {
ctx
.
fireExceptionCaught(t);
}
}
else
{
//
Write occurred before the timeout - set a new timeout with shorter delay.
resenderTimeout
=
ctx
.
will
) {
//
MQTT 3.1.2.8-17
publish2Subscribers(will
.
payload,
new
Topic
(will
.
topic), will
.
qos);
}
public
void
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sut
channel
,
boolean
cleanSession
) {
channel
.
attr(
NettyUtils
.
ATTR_KEY_CLEANSESSION
)
.
set(cleanSession);
}
public
static
boolean
,
ByteBuf
bb
,
List<
Object
>
out
)
throws
Exception
{
//
convert the ByteBuf to a WebSocketFrame
BinaryWebSocketFrame
result
=
new
BinaryWebSocketFrame
="
font-size: 10pt;
"
>
1. Definitions.
</
span
>
</
b
>
</
p
>
<
p
>
<
span
subscriptions
.
init(subscriptionsRepository);
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
ChannelFutureListener
() {
@Override
public
void
operationComplete
(
ChannelFuture
future
) {
LOG
.
info(
"
Closed client channel due to exception in processing
"
);
}
() {
return
reauthorizeSubscriptionsOnConnect;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
class
PostOfficePublishTest
{
private
static
final
String
FAKE_CLIENT_ID
=
"
FAKE_123
"
;
private
static
final
String
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
}
writerIdleTimeNanos
=
Math
.
max(unit
.
toNanos(writerIdleTime),
MIN_TIMEOUT_NANOS
);
}
@Override
public
void
handlerAdded
(
ChannelHandlerContext
() {
LOG
.
info(
"
Checking SSL configuration properties...
"
);
final
String
keyPassword
=
props
.
getProperty(
BrokerConstants
.
KEY_MANAGER_PASSWORD_PROPERTY_NAME
messageId
=
messageId(msg);
for
(
MqttTopicSubscription
req
:
msg
.
payload()
.
topicSubscriptions()) {
Topic
topic
=
new
Topic
(persistencePath
!=
null
&&
!
persistencePath
.
isEmpty()) {
LOG
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
h2Builder
=
.
sessionRegistry
=
sessionRegistry;
this
.
postOffice
=
postOffice;
this
.
connected
=
false
;
}
void
handleMessage
io.moquette.
spi.impl
;
package
io.moquette.
broker
;
import
io.netty.buffer.ByteBuf
;
15
...ver/DefaultMoquetteSslContextCreator.java → ...ker/DefaultMoquetteSslContextCreator.java
Show comments
View file
Edit file
Delete file
executor()
.
schedule(
this
, nextDelay,
TimeUnit
.
NANOSECONDS
);
}
}
}
private
static
final
Logger
LOG
=
subscribeClientToTopics
(
MqttSubscribeMessage
msg
,
String
clientID
,
String
username
,
MQTTConnection
mqttConnection
) {
//
verify which topics of the subscribe ongoing has read access permission
int
messageID
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sut
=
new
SessionRegistry
(subscriptions,
queueRepository
);
final
PostOffice
postOffice
cleanSession
(
Channel
channel
) {
return
(
Boolean
) channel
.
attr(
NettyUtils
.
ATTR_KEY_CLEANSESSION
)
.
get();
();
//
System.out.println("ByteBufToWebSocketFrameEncoder encode - " +
//
ByteBufUtil.hexDump(bb));
result
.
content()
.
writeBytes(bb);
out
.
add(result);
}
}
private
abstract
style
="
font-size: 10pt;
"
>
"License" shall mean the terms and conditions for use, reproduction,
and distribution as defined by Sections 1 through 9 of this document.
</
span
>
</
p
>
<
p
>
<
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
);
final
PostOffice
postOffice
=
new
Save preferences
});
}
finally
{
ReferenceCountUtil
.
release(msg);
}
}
@Override
public
void
channelActive
(
ChannelHandlerContext
ctx
) {
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
FAKE_CLIENT_ID2
=
"
FAKE_456
"
;
static
final
String
SUBSCRIBER_ID
=
"
Subscriber
"
;
static
final
ctx
)
throws
Exception
{
if
(ctx
.
channel()
.
isActive()
&&
ctx
.
channel()
.
isRegistered()) {
//
channelActive() event has been fired already, which means this.channelActive() will
);
if
(keyPassword
==
null
||
keyPassword
.
isEmpty()) {
LOG
.
warn(
"
The key manager password is null or empty. The SSL context won't be initialized.
"
);
return
null
;
(req
.
topicName());
if
(
!
policy
.
canRead(topic, username, clientID)) {
//
send SUBACK with 0x80, the user hasn't credentials to read the topic
LOG
.
warn(
"
"
+
"
new
H2Builder
(config, scheduler)
.
initStore();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
queueRepository
=
h2Builder
.
queueRepository();
retainedRepository
=
h2Builder
(
MqttMessage
msg
) {
MqttMessageType
messageType
=
msg
.
fixedHeader()
.
messageType();
LOG
.
debug(
"
"
, messageType, channel);
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
server
;
package
io.moquette.
broker
;
import
java.io.File
;
import
java.io.FileInputStream
LoggerFactory
.
getLogger(
InflightResender
.
class);
private
static
final
long
MIN_TIMEOUT_NANOS
=
TimeUnit
.
MILLISECONDS
.
toNanos(
=
messageId(msg);
List<
MqttTopicSubscription
>
ackTopics
=
authorizator
.
verifyTopicsReadAccess(clientID, username, msg);
MqttSubAckMessage
ackMessage
=
doAckMessageFromValidateFilters(ackTopics, messageID);
//
store topics subscriptions in session
List<
Subscription
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(), sut,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
2
...persistence/h2/H2PersistentQueueTest.java → ...te/persistence/H2PersistentQueueTest.java
Show comments
View file
}
public
static
void
clientID
(
Channel
channel
,
String
clientID
) {
channel
.
attr(
NettyUtils
.
ATTR_KEY_CLIENTID
static
class
PipelineInitializer
{
abstract
void
init
(
SocketChannel
channel
)
throws
Exception
;
}
private
static
final
span
style
="
font-size: 10pt;
"
>
"Licensor" shall mean the copyright owner or entity authorized by
the copyright owner that is granting the License.
</
span
>
</
p
>
<
p
>
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
final
PostOffice
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(), sessionRegistry,
MQTTConnection
connection
=
connectionFactory
.
create(ctx
.
channel());
mqttConnection(ctx
.
channel(), connection);
}
@Override
public
void
channelInactive
(
ChannelHandlerContext
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
String
PUBLISHER_ID
=
"
Publisher
"
;
private
static
final
String
TEST_USER
=
"
fakeuser
"
;
private
static
//
not be invoked. We have to initialize here instead.
initialize(ctx);
}
else
{
//
channelActive() event has not been fired yet. this.channelActive() will be invoked
//
and initialization will occur there.
}
}
@Override
public
void
handlerRemoved
(
ChannelHandlerContext
}
try
{
SslProvider
sslProvider
=
getSSLProvider();
KeyStore
ks
=
loadKeyStore();
SslContextBuilder
contextBuilder;
switch
(sslProvider) {
case
JDK
:
topic: {}
"
, clientID, username, messageId, topic);
ackTopics
.
add(
new
MqttTopicSubscription
(topic
.
toString(),
FAILURE
));
}
else
{
MqttQoS
qos;
.
retainedRepository();
}
else
{
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
);
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
queueRepository
switch
(messageType) {
case
CONNECT
:
processConnect((
MqttConnectMessage
) msg);
break
;
case
SUBSCRIBE
:
processSubscribe((
MqttSubscribeMessage
) msg);
break
;
@@ -34,8 +34,7 @@
import
java.util.Objects
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.spi.security.ISslContextCreator
;
import
io.moquette.broker.config.IConfig
;
import
1
);
private
final
long
resenderTimeNanos;
volatile
ScheduledFuture<?>
resenderTimeout;
volatile
long
lastExecutionTime;
private
volatile
int
state;
//
0 - none, 1 - initialized, 2 - destroyed
public
>
newSubscriptions
=
ackTopics
.
stream()
.filter(req
-
>
req
.
qualityOfService()
!=
FAILURE
)
.map(req
-
>
{
Edit file
Delete file
@@ -13,7 +13,7 @@
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.persistence
.h2
;
package
io.moquette.persistence
;
import
io.moquette.BrokerConstants
;
import
)
.
set(clientID);
}
public
static
String
clientID
(
Channel
channel
) {
return
(
String
) channel
.
attr(
Logger
LOG
=
LoggerFactory
.
getLogger(
NewNettyAcceptor
.
class);
private
EventLoopGroup
bossGroup;
private
EventLoopGroup
workerGroup;
private
BytesMetricsCollector
bytesMetricsCollector
<
span
style
="
font-size: 10pt;
"
>
"Legal Entity" shall mean the union of the acting entity and all
other entities that control, are controlled by, or are under common
control with that entity. For the purposes of this definition,
"control" means (i) the power, direct or indirect, to cause the
direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.
</
span
>
</
p
new
MemoryRetainedRepository
(), sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
5
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
Show comments
View file
Edit file
Delete file
@@ -54,6 +54,7 @@
moquette/PostOffice.java at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
moquette/H2RetainedRepository.java at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
moquette/RetainedMessage.java at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
ctx
) {
final
MQTTConnection
mqttConnection
=
mqttConnection(ctx
.
channel());
mqttConnection
.
handleConnectionLost();
}
@Override
public
void
exceptionCaught
(
Learn more
Accept
Reject
Save preferences
moquette/H2Builder.java at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
final
String
TEST_PWD
=
"
fakepwd
"
;
private
static
final
String
NEWS_TOPIC
=
"
/news
"
;
private
ctx
) {
destroy();
}
@Override
public
void
channelRegistered
(
ChannelHandlerContext
ctx
)
throws
Exception
{
//
Initialize early if channel is active already.
contextBuilder
=
builderWithJdkProvider(ks, keyPassword);
break
;
case
OPENSSL
:
case
OPENSSL_REFCNT
:
contextBuilder
=
builderWithOpenSSLProvider(ks, keyPassword);
break
;
default
if
(topic
.
isValid()) {
LOG
.
debug(
"
"
,
clientID, username, messageId, topic);
qos
=
req
.
qualityOfService();
}
else
moquette/ChangeLog.txt at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
=
new
MemoryQueueRepository
();
retainedRepository
=
new
MemoryRetainedRepository
();
}
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
;
case
UNSUBSCRIBE
:
processUnsubscribe((
MqttUnsubscribeMessage
) msg);
break
;
case
PUBLISH
:
processPublish((
MqttPublishMessage
moquette/Server.java at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
io.netty.handler.ssl.ClientAuth
;
import
io.netty.handler.ssl.SslContext
;
import
io.netty.handler.ssl.SslContextBuilder
;
@@ -46,16 +45,16 @@
import
org.slf4j.LoggerFactory
;
/**
* Moquette
server
implementation to load SSL certificate from local filesystem path configured in
* Moquette
InflightResender
(
long
writerIdleTime
,
TimeUnit
unit
) {
if
(unit
==
null
) {
throw
new
NullPointerException
(
"
final
Topic
topic
=
new
Topic
(req
.
topicName());
return
new
Subscription
(clientID, topic, req
org.h2.mvstore.MVStore
;
2
distribution/build.gradle
Show comments
View file
Edit file
Delete file
@@ -8,8 +8,6 @@ mainClassName = "io.moquette.integration.Server"
dependencies
{
NettyUtils
.
ATTR_KEY_CLIENTID
)
.
get();
}
public
static
void
userName
(
=
new
BytesMetricsCollector
();
private
MessageMetricsCollector
metricsCollector
=
new
MessageMetricsCollector
();
private
Optional<? extends
ChannelInboundHandler
>
metrics;
private
Optional<? extends
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"You" (or "Your") shall mean an individual or Legal Entity
exercising permissions granted by this License.
</
span
>
</
p
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
BrokerConfiguration
(
true
,
true
,
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
ChannelHandlerContext
ctx
,
Throwable
cause
) {
LOG
.
error(
"
Unexpected exception while processing MQTT message. Closing Netty channel. CId={}
"
,
NettyUtils
.
clientID(ctx
.
channel()), cause);
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
static
final
String
BAD_FORMATTED_TOPIC
=
"
#MQTTClient
"
;
private
MQTTConnection
connection;
private
EmbeddedChannel
channel;
private
PostOffice
sut;
//
if (ctx.channel().isActive()) {
//
initialize(ctx);
//
}
super
.
channelRegistered(ctx);
}
@Override
public
void
channelActive
(
ChannelHandlerContext
ctx
)
:
LOG
.
error(
"
unsupported SSL provider {}
"
, sslProvider);
return
null
;
}
//
if client authentification is enabled a trustmanager needs to be added to the ServerContext
String
sNeedsClientAuth
=
props
.
{
LOG
.
warn(
"
"
, clientID,
username, messageId, topic);
qos
=
FAILURE
;
}
ackTopics
.
add(
new
MqttTopicSubscription
(topic
moquette/IRetainedRepository.java at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
.
init(subscriptionsRepository);
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions, queueRepository);
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
new
MemoryRetainedRepository
()
, sessions,
dispatcher
) msg);
break
;
case
PUBREC
:
processPubRec(msg);
break
;
case
PUBCOMP
:
processPubComp(msg);
break
;
case
PUBREL
:
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
integration
implementation to load SSL certificate from local filesystem path configured in
* config file.
*/
public
class
DefaultMoquetteSslContextCreator
implements
ISslContextCreator
{
class
DefaultMoquetteSslContextCreator
implements
ISslContextCreator
{
private
static
moquette/MemoryRetainedRepository.java at 213851335a4f22fc30796911d5bebcd1d26fb7c7 · moquette-io/moquette · GitHub
unit
"
);
}
resenderTimeNanos
=
Math
.
max(unit
.
toNanos(writerIdleTime),
MIN_TIMEOUT_NANOS
);
}
@Override
public
void
handlerAdded
.
qualityOfService());
})
.
collect(
Collectors
.
toList());
for
(
Subscription
subscription
:
newSubscriptions) {
subscriptions
.
add(subscription);
compile project(
'
:moquette-broker
'
)
compile project(
'
:moquette-h2-storage
'
)
//
compile project(':moquette-mapdb-storage')
compile
group
:
'
Channel
channel
,
String
username
) {
channel
.
attr(
NettyUtils
.
ATTR_KEY_USERNAME
)
.
set(username);
}
public
static
ChannelInboundHandler
>
errorsCather;
private
int
nettySoBacklog;
private
boolean
nettySoReuseaddr;
private
boolean
nettyTcpNodelay;
private
boolean
nettySoKeepalive;
private
int
nettyChannelTimeoutSeconds;
private
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"Source" form shall mean the preferred form for making modifications,
including but not limited to software source code, documentation
source, and configuration files.
</
span
>
</
false
);
new
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryRetainedRepository
retainedRepository;
private
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
ctx
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
}
@Override
public
void
channelWritabilityChanged
(
ChannelHandlerContext
ctx
) {
//
if (ctx.channel().isWritable()) {
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
private
ISubscriptionsDirectory
subscriptions;
public
static
final
String
FAKE_USER_NAME
=
"
UnAuthUser
"
;
private
MqttConnectMessage
connectMessage;
private
SessionRegistry
throws
Exception
{
//
This method will be invoked only if this handler was added
//
before channelActive() event is fired. If a user adds this handler
//
after the channelActive() event, initialize() will be called by beforeAdd().
//
initialize(ctx);
super
.
channelActive(ctx);
}
@Override
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
if
(
Boolean
.
valueOf(sNeedsClientAuth)) {
addClientAuthentication(ks, contextBuilder);
}
.
toString(), qos));
}
}
return
ackTopics;
}
/**
* Ask the authorization policy if the topic can be used in a publish.
*
*
@param
topic
* the topic to write to.
*
@param
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Added implementation of retained store in H2 · moquette-io/moquette@2138513 · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
=
new
PostOffice
(subscriptions, authorizatorPolicy,
retainedRepository
, sessions,
interceptor);
final
BrokerConfiguration
brokerConfig
=
new
BrokerConfiguration
(config);
MQTTConnectionFactory
connectionFactory
=
processPubRel(msg);
break
;
case
DISCONNECT
:
processDisconnect(msg);
break
;
case
PUBACK
:
processPubAck(msg);
break
;
case
PINGREQ
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
final
IConfig
props;
public
DefaultMoquetteSslContextCreator
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
(
ChannelHandlerContext
ctx
)
throws
Exception
{
if
(ctx
.
channel()
.
isActive()
&&
ctx
.
channel()
}
//
add the subscriptions to Session
Session
session
=
sessionRegistry
.
retrieve(clientID);
session
.
addSubscriptions(newSubscriptions);
//
send ack message
mqttConnection
.
sendSubAckMessage(messageID, ackMessage);
publishRetainedMessagesForSubscriptions(clientID, newSubscriptions);
org.slf4j
'
,
name
:
'
slf4j-log4j12
'
,
version
:
'
1.7.5
'
}
String
userName
(
Channel
channel
) {
return
(
String
) channel
.
attr(
int
maxBytesInMessage;
private
Class<? extends
ServerSocketChannel
>
channelClass;
public
void
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
queueRepository;
@Before
@Before
public
void
setUp
() {
public
void
setUp
() {
@@ -82,9 +83,9 @@ private SessionRegistry initPostOfficeAndSubsystems() {
ISubscriptionsRepository
subscriptionsRepository
=
new
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
remove unnecessary quotes which fixes execution in windows 10 by joestr · Pull Request #478 · moquette-io/moquette · GitHub
//
m_processor.notifyChannelWritable(ctx.channel());
//
}
final
MQTTConnection
mqttConnection
=
mqttConnection(ctx
.
channel());
mqttConnection
.
writabilityChanged();
ctx
.
fireChannelWritabilityChanged();
}
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
sessionRegistry;
private
MockAuthenticator
mockAuthenticator;
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
BrokerConfiguration
(
true
,
true
,
false
);
remove unnecessary quotes which fixes execution in windows 10 by joestr · Pull Request #478 · moquette-io/moquette · GitHub
public
void
channelInactive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
destroy();
super
.
channelInactive(ctx);
}
private
void
initialize
(
contextBuilder
.
sslProvider(sslProvider);
SslContext
sslContext
=
contextBuilder
.
build();
LOG
.
info(
"
The SSL context has been initialized successfully.
"
);
return
sslContext;
user
* the user
*
@param
client
* the client
*
@return
true if the user from client can publish data on topic.
*/
boolean
canWrite
(
Topic
topic
,
String
user
,
Added implementation of retained store in H2 · moquette-io/moquette@2138513 · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
remove unnecessary quotes which fixes execution in windows 10 by joestr · Pull Request #478 · moquette-io/moquette · GitHub
new
MQTTConnectionFactory
(brokerConfig, authenticator, sessions,
5
broker/src/main/java/io/moquette/persistence/H2Builder.java
Show comments
View file
Edit file
Delete file
@@ -2,6 +2,7 @@
import
io.moquette.BrokerConstants
;
import
io.moquette.broker.IQueueRepository
;
:
MqttFixedHeader
pingHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PINGRESP
,
false
,
AT_MOST_ONCE
,
false
,
0
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
(
IConfig
props
) {
DefaultMoquetteSslContextCreator
(
IConfig
props
) {
this
.
props
=
Objects
.
requireNonNull(props);
}
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
.
isRegistered()) {
//
channelActive() event has been fired already, which means this.channelActive() will
//
not be invoked. We have to initialize here instead.
initialize(ctx);
}
else
{
//
channelActive() event has not been fired yet. this.channelActive() will be invoked
//
and initialization will occur there.
}
}
@Override
public
for
(
Subscription
subscription
:
newSubscriptions) {
interceptor
.
notifyTopicSubscribed(subscription, username);
}
}
private
void
publishRetainedMessagesForSubscriptions
(
String
clientID
9
h2_storage/build.gradle
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
58
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
Show comments
View file
Edit file
Delete file
Load diff
NettyUtils
.
ATTR_KEY_USERNAME
)
.
get();
}
private
NettyUtils
() {
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
initialize
(
NewNettyMQTTHandler
mqttHandler
,
IConfig
props
,
ISslContextCreator
sslCtxCreator
) {
LOG
.
debug(
"
Initializing Netty acceptor
"
>
"Object" form shall mean any form resulting from mechanical
transformation or translation of a Source form, including but
not limited to compiled object code, generated documentation,
and conversions to other media types.
</
span
>
</
p
>
<
p
>
<
span
style
="
MemorySubscriptionsRepository
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
subscriptions
.
init(subscriptionsRepository);
retainedRepository
=
new
MemoryRetainedRepository
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Skip to content
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
@Override
public
void
userEventTriggered
(
ChannelHandlerContext
ctx
,
Object
evt
) {
if
(evt
instanceof
InflightResender
.
ResendNotAckedPublishes
) {
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
private
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
queueRepository;
@Before
public
void
setUp
() {
sessionRegistry
=
initPostOfficeAndSubsystems();
mockAuthenticator
=
new
MockAuthenticator
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
ChannelHandlerContext
ctx
) {
//
Avoid the case where destroy() is called before scheduling timeouts.
//
See: https://github.com/netty/netty/issues/143
if
(
LOG
.
isDebugEnabled()) {
LOG
.
debug(
"
"
}
catch
(
GeneralSecurityException
|
IOException
ex) {
LOG
.
error(
"
Unable to initialize SSL context.
"
, ex);
return
null
;
}
String
client
) {
return
policy
.
canWrite(topic, user, client);
}
boolean
canRead
(
Topic
topic
,
String
user
,
String
client
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
Separated CTrie as data structure from the rest of CTrieSubscriptionD… · moquette-io/moquette@80daadf · GitHub
Moved packages from old io.moquette.server to new io.moquette.broker · moquette-io/moquette@1ba9eb3 · GitHub
Avoid multiple calls to initialize of AutoFlushHadler and extracted c… · moquette-io/moquette@58fd90d · GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
import
io.moquette.broker.IRetainedRepository
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.config.IConfig
;
import
org.h2.mvstore.MVStore
;
@@ -57,4 +58,8 @@ public void closeStore() {
public
IQueueRepository
queueRepository
() {
return
);
MqttMessage
pingResp
=
new
MqttMessage
(pingHeader);
channel
.
writeAndFlush(pingResp)
.
addListener(
CLOSE_ON_FAILURE
);
break
;
default
:
LOG
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
@@ -131,7 +130,7 @@ private static SslContextBuilder builderWithJdkProvider(KeyStore ks, String keyP
}
/**
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the
server
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the
integration
* certificate and key in order to provide it to OpenSSL.
* <
p
>
* TODO: SNI is currently not supported, we use only the first found private key.
@@ -153,7 +152,7 @@ private static SslContextBuilder builderWithOpenSSLProvider(KeyStore ks, String
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
void
handlerRemoved
(
ChannelHandlerContext
ctx
)
throws
Exception
{
destroy();
}
@Override
public
void
channelRegistered
(
ChannelHandlerContext
ctx
,
List<
Subscription
>
newSubscriptions
) {
Session
targetSession
=
this
.
sessionRegistry
.
retrieve(clientID);
for
(
Subscription
subscription
:
newSubscriptions) {
This file was deleted.
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
c4d928b
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
);
nettySoBacklog
=
props
.
intProp(
BrokerConstants
.
NETTY_SO_BACKLOG_PROPERTY_NAME
,
128
);
nettySoReuseaddr
=
props
.
boolProp(
font-size: 10pt;
"
>
"Work" shall mean the work of authorship, whether in Source or
Object form, made available under the License, as indicated by a
copyright notice that is included in or attached to the work
(an example is provided in the Appendix below).
</
span
>
</
p
>
<
p
>
<
();
retainedRepository
=
new
MemoryRetainedRepository
();
queueRepository
=
new
MemoryQueueRepository
();
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions,
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
final
MQTTConnection
mqttConnection
=
mqttConnection(ctx
.
channel());
mqttConnection
.
resendNotAckedPublishes();
}
ctx
.
fireUserEventTriggered(evt);
}
}
Copy lines
Copy permalink
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
(singleton(
FAKE_CLIENT_ID
), singletonMap(
TEST_USER
,
TEST_PWD
));
connection
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
);
connectMessage
=
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
, ctx
.
channel(),
NettyUtils
.
clientID(ctx
.
channel()));
}
switch
(state) {
case
1
:
case
2
:
return
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
}
private
KeyStore
loadKeyStore
()
throws
IOException
,
GeneralSecurityException
{
final
String
jksPath
=
props
.
getProperty(
BrokerConstants
.
moquette/moquette.bat at d2cce3fef45b1a2b44220c03cf65f6c0446140aa · moquette-io/moquette · GitHub
moquette/.gitignore at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
) {
return
policy
.
canRead(topic, user, client);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Sign in to GitHub · GitHub
Skip to content
Moved packages from old io.moquette.server to new io.moquette.broker · moquette-io/moquette@1ba9eb3 · GitHub
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
new
H2QueueRepository
(mvStore);
}
public
IRetainedRepository
retainedRepository
() {
return
new
H2RetainedRepository
(mvStore);
}
}
55
broker/src/main/java/io/moquette/persistence/H2RetainedRepository.java
.
error(
"
"
, messageType, channel);
break
;
}
}
private
void
processPubComp
(
MqttMessage
msg
) {
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
private
static
void
addClientAuthentication
(
KeyStore
ks
,
SslContextBuilder
contextBuilder
)
throws
NoSuchAlgorithmException
,
KeyStoreException
{
LOG
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
)
throws
Exception
{
//
Initialize early if channel is active already.
if
(ctx
.
channel()
.
isActive()) {
initialize(ctx);
}
super
final
String
topicFilter
=
subscription
.
getTopicFilter()
.
toString();
final
MqttPublishMessage
retainedMsg
=
retainedRepository
.
retainedOnTopic(topicFilter);
if
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
BrokerConstants
.
NETTY_SO_REUSEADDR_PROPERTY_NAME
,
true
);
nettyTcpNodelay
=
props
.
boolProp(
BrokerConstants
.
NETTY_TCP_NODELAY_PROPERTY_NAME
,
true
);
span
style
="
font-size: 10pt;
"
>
"Derivative Works" shall mean any work, whether in Source or Object
form, that is based on (or derived from) the Work and for which the
editorial revisions, annotations, elaborations, or other modifications
represent, as a whole, an original work of authorship. For the purposes
of this License, Derivative Works shall not include works that remain
separable from, or merely link (or bind by name) to the interfaces of,
the Work and Derivative Works thereof.
</
span
>
</
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
/
broker
/
src
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
/
broker
/
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
/
broker
/
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
/
broker
/
);
}
private
MQTTConnection
createMQTTConnection
(
BrokerConfiguration
config
) {
channel
=
new
EmbeddedChannel
();
return
createMQTTConnection(config, channel);
}
private
MQTTConnection
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
;
}
state
=
1
;
EventExecutor
loop
=
ctx
.
executor();
lastWriteTime
=
System
.
nanoTime();
writerIdleTimeout
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
JKS_PATH_PROPERTY_NAME
);
LOG
.
info(
"
Initializing SSL context. KeystorePath = {}.
"
, jksPath);
if
(jksPath
==
null
||
jksPath
.
isEmpty()) {
LOG
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
moquette/ISSUE_TEMPLATE.md at a49792adf5d6bcf636737478e972207f516dc4df · moquette-io/moquette · GitHub
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
/
ChangeLog.txt
Go to file
Go to file
T
Go to line
L
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,55 @@
package
io.moquette.persistence
;
import
io.moquette.broker.IRetainedRepository
;
import
io.moquette.broker.RetainedMessage
;
import
io.moquette.broker.subscriptions.Topic
;
final
int
messageID
=
((
MqttMessageIdVariableHeader
) msg
.
variableHeader())
.
messageId();
final
Session
session
=
sessionRegistry
.
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
.
warn(
"
Client authentication is enabled. The keystore will be used as a truststore.
"
);
//
use keystore as truststore, as
server
needs to trust certificates signed by the
server
certificates
//
use keystore as truststore, as
integration
needs to trust certificates signed by the
integration
certificates
TrustManagerFactory
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
.
channelRegistered(ctx);
}
@Override
public
void
channelActive
(
ChannelHandlerContext
ctx
)
throws
Exception
{
//
This method will be invoked only if this handler was added
(retainedMsg
==
null
) {
//
not found
continue
;
}
final
MqttQoS
retainedQos
=
retainedMsg
.
fixedHeader()
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
nettySoKeepalive
=
props
.
boolProp(
BrokerConstants
.
NETTY_SO_KEEPALIVE_PROPERTY_NAME
,
true
);
nettyChannelTimeoutSeconds
=
props
.
intProp(
BrokerConstants
.
NETTY_CHANNEL_TIMEOUT_SECONDS_PROPERTY_NAME
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"Contribution" shall mean any work of authorship, including
the original version of the Work and any modifications or additions
to that Work or Derivative Works thereof, that is intentionally
submitted to Licensor for inclusion in the Work by the copyright owner
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
sessionRegistry;
/
main
/
java
/
io
/
moquette
/
broker
/
PostOffice.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
src
/
main
/
java
/
io
/
moquette
/
persistence
/
H2RetainedRepository.java
/
Jump to
src
/
main
/
java
/
io
/
moquette
/
broker
/
RetainedMessage.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
src
/
main
/
java
/
io
/
moquette
/
persistence
/
H2Builder.java
/
Jump to
Code definitions
No definitions found in this file.
createMQTTConnection
(
BrokerConfiguration
config
,
Channel
channel
) {
return
new
MQTTConnection
(channel, config, mockAuthenticator, sessionRegistry, sut);
}
private
SessionRegistry
initPostOfficeAndSubsystems
() {
subscriptions
=
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
=
loop
.
schedule(
new
WriterIdleTimeoutTask
(ctx), writerIdleTimeNanos,
TimeUnit
.
NANOSECONDS
);
}
private
void
destroy
() {
state
=
2
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
.
warn(
"
The keystore path is null or empty. The SSL context won't be initialized.
"
);
return
null
;
}
final
String
keyStorePassword
=
props
.
getProperty(
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
Skip to content
Sign up
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Copy path
Cannot retrieve contributors at this time
103 lines (93 sloc)
6.14 KB
Raw
Blame
Version 0.12:
Fixed issue #415
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Rewritten completly the broker to introduce the concept of MqttConnection
Dropped suppoert for MapDB and keeped only H2 MvStore for persistence
Version 0.10:
Netty epoll system added
Separated in memory and MapDB storage implementations
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
org.h2.mvstore.MVMap
;
import
org.h2.mvstore.MVStore
;
retrieve(getClientId());
session
.
processPubComp(messageID);
}
private
void
processPubRec
(
MqttMessage
msg
/
broker
/
src
/
main
/
java
/
io
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.
init(ks);
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
/
broker
/
src
/
main
/
java
//
before channelActive() event is fired. If a user adds this handler
//
after the channelActive() event, initialize() will be called by beforeAdd().
initialize(ctx);
super
.
channelActive(ctx);
}
@Override
public
void
channelInactive
(
ChannelHandlerContext
ctx
)
throws
Exception
.
qosLevel();
MqttQoS
qos
=
lowerQosToTheSubscriptionDesired(subscription, retainedQos);
final
ByteBuf
origPayload
=
retainedMsg
.
payload();
ByteBuf
payload
=
origPayload
.
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
,
10
);
maxBytesInMessage
=
props
.
intProp(
BrokerConstants
.
NETTY_MAX_BYTES_PROPERTY_NAME
,
BrokerConstants
.
DEFAULT_NETTY_MAX_BYTES_IN_MESSAGE
);
boolean
or by an individual or Legal Entity authorized to submit on behalf of
the copyright owner. For the purposes of this definition, "submitted"
means any form of electronic, verbal, or written communication sent
to the Licensor or its representatives, including but not limited to
communication on electronic mailing lists, source code control systems,
and issue tracking systems that are managed by, or on behalf of, the
Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise
designated in writing by the copyright owner as "Not a Contribution."
</
return
sessionRegistry;
5
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
Show comments
View file
Edit file
Delete file
@@ -64,6 +64,7 @@
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
static
final
BrokerConfiguration
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
304 lines (258 sloc)
12.8 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
55 lines (45 sloc)
1.66 KB
Raw
Blame
package
io.moquette.persistence
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
24 lines (17 sloc)
470 Bytes
Raw
Blame
package
io.moquette.broker
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
65 lines (53 sloc)
2.13 KB
Raw
Blame
package
io.moquette.persistence
;
import
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
retainedRepository
=
new
MemoryRetainedRepository
();
queueRepository
=
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
;
if
(writerIdleTimeout
!=
null
) {
writerIdleTimeout
.
cancel(
false
);
writerIdleTimeout
=
null
;
}
}
/**
* Is called when the write timeout expire.
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
BrokerConstants
.
KEY_STORE_PASSWORD_PROPERTY_NAME
);
if
(keyStorePassword
==
null
||
keyStorePassword
.
isEmpty()) {
LOG
.
warn(
"
The keystore password is null or empty. The SSL context won't be initialized.
"
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
Accept
Reject
Save preferences
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
213851335a
moquette
/
broker
/
src
/
main
/
java
/
io
/
moquette
/
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Added implementation of retained store in H2
Loading branch information
Cleanly separated inflight part (inbound and outbound)
Version 0.9:
Moved canRead check to topic from publish phase to subscribe (#144)
Added javadoc and src jars creations for JCenter/Maven central
Added persisting of clean session flag for already existing client session (fix issue #145)
Moved the message logic management fo FSM, to better control the concurrency.
Changed default config to use in memory store and not default moquette.mapdb
Version 0.8:
Introduced authenticator and authorizator implementations.
Fixed bug, doesn't close the channel when connect doesn't contains a valid proto name, issue #65
Fixed bug, does not check for zero length topic (filters) in PUBLISH, SUBSCRIBE, and UNSUBSCRIBE, issue #67
Fixed issue #69
Fixed bug #68, UNSUBSCRIBE has to fail on bad topicFilter names
Fixed bug #81, on stop of moquette broker it doesn't shutdown due to no shutdown of ringbuffer used on the back of ProtocolProcessor
Moved config to be not only filesystem based, but also classpath and memory (fix issue #73)
Switched from commit persistence on every change to time based to fix delay in handling many msgs/sec (fix issue #79)
Changed willMessage and password in CONNECT message from String to byte[] (fix issue #94 and #95)
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
import
java.util.ArrayList
;
import
java.util.List
;
import
java.util.Map
;
public
class
H2RetainedRepository
implements
IRetainedRepository
{
private
final
) {
final
int
messageID
=
((
MqttMessageIdVariableHeader
) msg
.
variableHeader())
.
messageId();
final
/
moquette
/
broker
/
Server.java
/
Jump to
Code definitions
No definitions found in this file.
contextBuilder
.
clientAuth(
ClientAuth
.
REQUIRE
);
2
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
Show comments
/
io
/
moquette
/
broker
/
MemoryRetainedRepository.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
{
destroy();
super
.
channelInactive(ctx);
}
private
void
initialize
(
ChannelHandlerContext
ctx
) {
//
Avoid the case where destroy() is called before scheduling timeouts.
//
See: https://github.com/netty/netty/issues/143
if
(
retainedDuplicate();
targetSession
.
sendRetainedPublishOnSessionAtQos(subscription
.
getTopicFilter(), qos, payload);
}
}
/**
* Create the SUBACK response from a list of topicFilters
*/
private
MqttSubAckMessage
doAckMessageFromValidateFilters
(
List<
MqttTopicSubscription
epoll
=
props
.
boolProp(
BrokerConstants
.
NETTY_EPOLL_PROPERTY_NAME
,
false
);
if
(epoll) {
LOG
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
"Contributor" shall mean Licensor and any individual or Legal Entity
on behalf of whom a Contribution has been received by Licensor and
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
=
new
BrokerConfiguration
(
true
,
true
,
false
);
new
BrokerConfiguration
(
true
,
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.interception.BrokerInterceptor
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.IRetainedRepository
;
import
io.moquette.broker.RetainedMessage
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.io.Serializable
;
public
class
RetainedMessage
implements
Serializable
{
private
final
MqttQoS
qos;
private
final
byte
[] payload;
public
RetainedMessage
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Learn more
Accept
Reject
Save preferences
io.moquette.BrokerConstants
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.IRetainedRepository
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.config.IConfig
;
import
org.h2.mvstore.MVStore
new
MemoryQueueRepository
();
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
Pull requests
Actions
Projects
Wiki
Security
Insights
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
*
*
@param
ctx the channel context.
*/
private
void
channelIdle
(
ChannelHandlerContext
ctx
) {
//
ctx.fireUserEventTriggered(evt);
if
(
LOG
.
);
return
null
;
}
String
ksType
=
props
.
getProperty(
BrokerConstants
.
KEY_STORE_TYPE
,
"
jks
"
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
broker
/
IRetainedRepository.java
/
Jump to
Code definitions
No definitions found in this file.
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
andsel
committed
Nov 28, 2018
1 parent
80daadf
commit
213851335a4f22fc30796911d5bebcd1d26fb7c7
Unified
Split
Showing
9 changed files
with
132 additions
and
20 deletions
.
Fixed ugly empty session storage, avoid fake NullObject empty subscription subscription
Added check to avoid creation of LostConnectionEvents for not yet completed connects (fix issue #88)
Removed LMAX ringbuffer to use multi threading with persistent (copy on write) data structures
Fixed bug that on connection stolen dropped also the new connection (fix issue #108)
Refactored the storage part to be more rational and use ClientSession concept
Added config property 'autosave_interval' (issue #97)
Removed leaking ref to parent's node (issue #119 and #126)
Added internal publish once the broker is embedded (issue #113)
Removed client active/not active state from persistence (issue #118)
Avoid deletion of client descriptor in case of multiple clients with same clientID (issues #116 and #124)
Removed a queue per client of inFlightIds (never cleaned) in favor of single atomic generator
Version 0.7:
Fix issue #38, added aligned to MQTT 3.1.1
Refactored big event switch to @Annotation dispatcher
Switched from HawtDB to MapDB
Fixed bug that didn't update client subscription on persistent store so that on server restart there where ghost subscriptions.
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
New issue
Have a question about this project?
Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
Pick a username
Email Address
Password
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
MVMap<
Topic
,
RetainedMessage
>
queueMap;
public
H2RetainedRepository
(
MVStore
mvStore
) {
this
.
queueMap
=
mvStore
Session
session
=
sessionRegistry
.
retrieve(getClientId());
session
.
processPubRec(messageID);
}
static
MqttMessage
pubrel
(
int
messageID
) {
MqttFixedHeader
Code navigation not available for this commit
Go to file
Go to file
T
Go to line
L
Go to definition
R
Copy path
Cannot retrieve contributors at this time
386 lines (347 sloc)
17.3 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Topic
;
import
io.moquette.
broker
.subscriptions.Topic
;
Go to definition
R
Copy path
Cannot retrieve contributors at this time
66 lines (58 sloc)
2.14 KB
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
LOG
.
isDebugEnabled()) {
LOG
.
debug(
"
Initializing autoflush handler on channel {}
"
, ctx
.
channel());
}
switch
(state) {
case
1
:
>
topicFilters
,
int
messageId
) {
List<
Integer
>
grantedQoSLevels
=
new
ArrayList<>
();
for
.
info(
"
Netty is using Epoll
"
);
bossGroup
=
new
EpollEventLoopGroup
();
workerGroup
=
new
EpollEventLoopGroup
();
channelClass
subsequently incorporated within the Work.
</
span
>
</
p
>
<
p
>
<
b
>
<
span
style
="
true
,
false
);
private
MemoryRetainedRepository
retainedRepository;
private
MemoryRetainedRepository
retainedRepository;
private
MemoryQueueRepository
queueRepository;
@Before
@Before
public
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.Unpooled
;
import
io.netty.handler.codec.mqtt.*
org.h2.mvstore.MVMap
;
import
org.h2.mvstore.MVStore
;
import
java.util.ArrayList
;
import
java.util.List
;
import
java.util.Map
;
public
class
H2RetainedRepository
implements
IRetainedRepository
(
MqttQoS
qos
,
byte
[]
payload
) {
this
.
qos
=
qos;
this
.
payload
=
Sign up for GitHub
By clicking “Sign up for GitHub”, you agree to our
terms of service
and
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
remove unnecessary quotes which fixes execution in windows 10
#478
Merged
andsel
merged 1 commit into
moquette-io
:
master
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.concurrent.ScheduledExecutorService
;
import
java.util.concurrent.TimeUnit
;
public
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
sessionRegistry;
}
@Test
public
void
testPublishQoS0ToItself
() {
connection
.
processConnect(connectMessage);
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
remove unnecessary quotes which fixes execution in windows 10
#478
Merged
andsel
merged 1 commit into
moquette-io
:
master
from
unknown repository
May 21, 2019
+2
−2
isTraceEnabled()) {
LOG
.
trace(
"
"
, ctx
.
channel(),
NettyUtils
.
clientID(ctx
.
channel()));
}
ctx
.
channel()
);
final
KeyStore
keyStore
=
KeyStore
.
getInstance(ksType);
LOG
.
info(
"
Loading keystore. KeystorePath = {}.
"
, jksPath);
try
(
InputStream
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
Loading status checks…
Added implementation of retained store in H2
Loading branch information
andsel
committed
Nov 28, 2018
1 parent
80daadf
commit
213851335a4f22fc30796911d5bebcd1d26fb7c7
Unified
Split
Showing
9 changed files
with
132 additions
and
20 deletions
.
32 lines (25 sloc)
970 Bytes
Raw
Blame
/*
* Copyright (c) 2012-2018 The original author or authors
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Moved packages from old io.moquette.server to new io.moquette.broker
Loading branch information
andsel
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Avoid multiple calls to initialize of AutoFlushHadler and extracted c…
Loading branch information
andsel
+2
−0
ChangeLog.txt
+3
−1
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
+21
−5
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
+12
−9
broker/src/main/java/io/moquette/broker/PostOffice.java
+24
−0
broker/src/main/java/io/moquette/broker/RetainedMessage.java
+4
−1
broker/src/main/java/io/moquette/broker/Server.java
Fixed Issue #11, multiple republish of persisted QoS1/2 messages on clients reconnections.
Refactored the publish logic for QoS 1 2 to try to be more readable
Added packetIdentifier storage and generation
Fixed issue #16, bad packetId for will messages with qos > 0
Added store path variable "persistent_store" to configuration file (picked from Steven Warwick fork)
Removed OSGi bundle, developer time burner
Fixed github issue #30, returning error on mapdb file not deleted that corrupt reiterated builds
Added handling of allow_anonymous clients (as in mosquitto issue #34)
Modified the password_file format to use password stored in sha256 and not plain text
Added ACL file for topic read|write operations.
Removed cause of leakage of Netty Sessions (fix issue #39)
Cleaned Netty's stuff reference from Events used in Disruptor (fix issue #40)
Bad assignment of PacketID during publish to subscribed QoS0 topics (fix issue #38)
Fixed duplicated subscription with different QoS same client and topic (fix issue #49)
Fixed UNSUBSCRIBE that missed to remove the subscription from the persistent store (fix issue #50)
Fixed issue on multiple publish for overlapping subscription by the same client (fix issue #52).
privacy statement
. We’ll occasionally send you account related emails.
Already on GitHub?
Sign in
to your account
Jump to bottom
remove unnecessary quotes which fixes execution in windows 10
#478
Merged
andsel
merged 1 commit into
moquette-io
:
master
from
unknown repository
May 21, 2019
Merged
.
openMap(
"
retained_store
"
);
}
@Override
public
void
cleanRetained
(
Topic
topic
) {
queueMap
.
pubRelHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBREL
,
false
,
AT_LEAST_ONCE
,
false
,
0
);
return
new
* ------------------------------------------------------
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* and Apache License v2.0 which accompanies this distribution.
*
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
public
interface
IRetainedRepository
{
2
...ette/spi/security/ISslContextCreator.java → ...o/moquette/broker/ISslContextCreator.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* The Eclipse Public License is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* The Apache License v2.0 is available at
* http://www.opensource.org/licenses/apache2.0.php
*
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
case
2
:
return
;
}
state
=
1
;
EventExecutor
loop
=
ctx
.
executor();
lastExecutionTime
(
MqttTopicSubscription
req
:
topicFilters) {
grantedQoSLevels
.
add(req
.
qualityOfService()
.
value());
}
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
=
EpollServerSocketChannel
.
class;
}
else
{
LOG
.
info(
"
Netty is using NIO
"
);
bossGroup
=
new
NioEventLoopGroup
font-size: 10pt;
"
>
2. Grant of Copyright License.
</
span
>
</
b
>
</
p
>
<
p
>
<
span
void
setUp
() {
public
void
setUp
() {
@@ -89,9 +90,9 @@ private SessionRegistry initPostOfficeAndSubsystems() {
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
ISubscriptionsRepository
subscriptionsRepository
=
new
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.ArrayList
;
import
java.util.List
;
import
java.util.Set
;
import
java.util.stream.Collectors
{
private
final
MVMap<
Topic
,
RetainedMessage
>
queueMap;
public
H2RetainedRepository
(
MVStore
mvStore
) {
this
.
queueMap
payload;
}
public
MqttQoS
qosLevel
() {
return
qos;
}
public
byte
[]
getPayload
() {
return
payload;
}
}
from
unknown repository
May 21, 2019
Conversation
1
Commits
1
Checks
0
Files changed
remove unnecessary quotes
831f24a
Select commit
831f24a
remove unnecessary quotes
joestr
class
H2Builder
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
H2Builder
.
class);
private
final
String
ConnectionTestUtils
.
assertConnectAccepted(channel);
//
subscribe
subscribe(
AT_MOST_ONCE
,
NEWS_TOPIC
, connection);
//
Exercise
final
ByteBuf
payload
=
Unpooled
.
copiedBuffer(
Conversation
1
Commits
1
Checks
0
Files changed
1
Merged
remove unnecessary quotes which fixes execution in windows 10
#478
Changes from
all commits
Commits
Show all changes
1 commit
Select commit
831f24a
.
flush();
}
private
final
class
WriterIdleTimeoutTask
implements
Runnable
{
private
final
ChannelHandlerContext
ctx;
WriterIdleTimeoutTask
(
ChannelHandlerContext
ctx
jksInputStream
=
jksDatastore(jksPath)) {
keyStore
.
load(jksInputStream, keyStorePassword
.
toCharArray());
}
return
keyStore;
}
private
static
SslContextBuilder
builderWithJdkProvider
(
KeyStore
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
d2cce3fef4
moquette
/
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
.gitignore
Go to file
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Moved packages from old io.moquette.server to new io.moquette.broker
Loading branch information
+2
−0
ChangeLog.txt
+3
−1
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
+21
−5
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
+12
−9
broker/src/main/java/io/moquette/broker/PostOffice.java
+24
−0
broker/src/main/java/io/moquette/broker/RetainedMessage.java
+4
−1
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.List
;
public
interface
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
Insights
Permalink
Browse files
Separated CTrie as data structure from the rest of CTrieSubscriptionD…
Loading branch information
andsel
committed
Nov 24, 2018
1 parent
f3daad5
commit
80daadff4748a450b693a4761fb1b2a12f742655
Unified
Split
Showing
6 changed files
with
327 additions
committed
Nov 11, 2018
1 parent
58fd90d
commit
1ba9eb3613bc79d28c5d45d9c0984033d36d83af
Unified
Split
Showing
127 changed files
with
274 additions
and
1,414 deletions
.
+3
−3
broker/src/main/java/io/moquette/broker/Authorizator.java
committed
Nov 11, 2018
1 parent
8f7b7df
commit
58fd90d33d97265a88b8e2837e8b3df11a5d8f1c
Unified
Split
Showing
2 changed files
with
65 additions
and
98 deletions
.
+56
−71
broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java
+5
−0
broker/src/main/java/io/moquette/persistence/H2Builder.java
+55
−0
broker/src/main/java/io/moquette/persistence/H2RetainedRepository.java
+6
−4
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
2
ChangeLog.txt
Show comments
View file
Edit file
Delete file
@@ -1,6 +1,8 @@
Version 0.12:
Moved the authorization check before dropping an already connected client with same clientID (fix issue #44).
Fixed subscription tree that was unable to update clean session flag on subs with same client, topic and qos (fix issue #55)
Fixed overwriting of published qos in forward publish loop (fix issue #56)
Version 0.6:
Fix issue #42, bad password file path composition
Fix issue #43, missed topic case (finance/+ does has to match finance)
Integrated WebSocket support (issue #37)
Integrated SSL support (issue #41)
Fixed issue #40, check Logging inside the Felix OSGi
Fixed issue #46, implement correct behaviour for Will stuff
Splitted stores to persist messages and sessions into different interfaces
Renamed some methods in sessions store
Moved logging conf and slf4j-log4j deps out of broker to let it use the container's log configuration
Version 0.5:
Fix issue 20 (no flush of message on PINGREQ)
Fix issue 21 (bad channel timeout handler)
Created a self contained distribution package (issue 22)
remove unnecessary quotes which fixes execution in windows 10
#478
andsel
merged 1 commit into
moquette-io
:
master
from
unknown repository
May 21, 2019
+2
−2
Conversation
1
Commits
1
remove(topic);
}
@Override
public
void
retain
(
Topic
topic
,
MqttPublishMessage
msg
) {
final
ByteBuf
payload
=
msg
MqttMessage
(pubRelHeader, from(messageID));
}
private
void
processPubAck
(
MqttMessage
msg
) {
final
int
messageID
=
((
MqttMessageIdVariableHeader
) msg
.
import
io.moquette.BrokerConstants
;
import
io.moquette.broker.config.*
;
import
io.moquette.interception.InterceptHandler
;
import
io.moquette.persistence.H2Builder
;
import
io.moquette.persistence.MemorySubscriptionsRepository
;
import
io.moquette.interception.BrokerInterceptor
;
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
spi.security
;
package
io.moquette.
broker
;
import
io.netty.handler.ssl.SslContext
;
2
broker/src/main/java/io/moquette/broker/ISubscriptionsRepository.java
Show comments
View file
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.ArrayList
;
import
java.util.List
;
import
java.util.Map
;
import
java.util.concurrent.ConcurrentHashMap
;
import
java.util.concurrent.ConcurrentMap
;
=
System
.
nanoTime();
resenderTimeout
=
loop
.
schedule(
new
WriterIdleTimeoutTask
(ctx), resenderTimeNanos,
TimeUnit
.
NANOSECONDS
);
}
MqttMessageType
.
SUBACK
,
false
,
AT_MOST_ONCE
,
false
,
0
);
MqttSubAckPayload
payload
=
new
();
workerGroup
=
new
NioEventLoopGroup
();
channelClass
=
NioServerSocketChannel
.
style
="
font-size: 10pt;
"
>
Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
copyright license to reproduce, prepare Derivative Works of,
publicly display, publicly perform, sublicense, and distribute the
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
subscriptions
.
init(subscriptionsRepository);
retainedRepository
=
new
MemoryRetainedRepository
();
retainedRepository
=
new
MemoryRetainedRepository
;
import static
io.moquette.broker.Utils.messageId
;
import static
io.netty.handler.codec.mqtt.MqttMessageIdVariableHeader.from
;
import static
io.netty.handler.codec.mqtt.MqttQoS.*
;
class
PostOffice
{
private
static
final
Logger
LOG
=
mvStore
.
openMap(
"
retained_store
"
);
}
@Override
public
void
cleanRetained
(
Topic
topic
) {
queueMap
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
May 21, 2019
Merged
remove unnecessary quotes which fixes execution in windows 10
#478
remove unnecessary quotes
831f24a
Select commit
831f24a
remove unnecessary quotes
joestr
May 21, 2019
Workflow runs completed with no jobs
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
storePath;
private
final
int
autosaveInterval;
//
in seconds
private
final
ScheduledExecutorService
scheduler;
private
MVStore
mvStore;
public
H2Builder
(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
,
FAKE_CLIENT_ID
remove unnecessary quotes
joestr
May 21, 2019
File filter...
Filter file types
.bat
(1)
All 1 file type selected
Filter viewed files
Hide viewed files
Clear filters
Jump to…
Jump to file
Failed to load files.
Retry
Always
Unified
) {
this
.
ctx
=
ctx;
}
@Override
public
void
run
() {
if
(
!
ctx
.
channel()
ks
,
String
keyPassword
)
throws
GeneralSecurityException
{
LOG
.
info(
"
Initializing key manager...
"
);
final
KeyManagerFactory
kmf
distribution
/
src
/
main
/
scripts
/
moquette.bat
Go to file
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
88 lines (73 sloc)
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
49 lines (44 sloc)
730 Bytes
Raw
Blame
/
build
*
/
build
/
/
andsel
committed
Nov 11, 2018
1 parent
58fd90d
commit
1ba9eb3613bc79d28c5d45d9c0984033d36d83af
Unified
Split
Showing
127 changed files
with
274 additions
and
1,414 deletions
.
broker/src/main/java/io/moquette/broker/Server.java
+5
−0
broker/src/main/java/io/moquette/persistence/H2Builder.java
+55
−0
broker/src/main/java/io/moquette/persistence/H2RetainedRepository.java
+6
−4
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
2
ChangeLog.txt
Show comments
View file
Edit file
Delete file
IRetainedRepository
{
void
cleanRetained
(
Topic
topic
);
void
retain
(
Topic
topic
,
MqttPublishMessage
msg
);
boolean
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
and
285 deletions
.
+233
−0
broker/src/main/java/io/moquette/broker/subscriptions/CTrie.java
+9
−196
broker/src/main/java/io/moquette/broker/subscriptions/CTrieSubscriptionDirectory.java
+1
−1
broker/src/main/java/io/moquette/broker/subscriptions/DumpTreeVisitor.java
+1
−1
broker/src/main/java/io/moquette/broker/subscriptions/SubscriptionCounterVisitor.java
+22
+1
−1
+1
−1
broker/src/main/java/io/moquette/broker/BrokerConfiguration.java
+2
−2
+1
−1
+7
−8
+1
−1
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
+1
−1
+9
−27
broker/src/main/java/io/moquette/server/netty/AutoFlushHandler.java
127
broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java
Show comments
View file
Edit file
Delete file
@@ -95,10 +95,10 @@ protected void encode(ChannelHandlerContext chc, ByteBuf bb, List<Object> out) t
private
static
final
Logger
LOG
=
LoggerFactory
Version 0.12:
Fixed issue #415
Fixed issue #415
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Rewritten completly the broker to introduce the concept of MqttConnection
Dropped suppoert for MapDB and keeped only H2 MvStore for persistence
Version 0.10:
Version 0.10:
Netty epoll system added
Netty epoll system added
4
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
Show comments
View file
Edit file
Delete file
Fix issue 28, OSGi-fied the broker
Fixed issue #31 missed to insert the hawtdb jars
Added a separate mvn module to host the OSGi bundle declaration
Fixed issue #30
Added password file for identity management on connect (Fix #23)
Version 0.4:
Dropped support for MINA
Fix Issue 15 (bad re-activation of client's subscriptions after a recconection)
Fix Issue 16 (bad re-publish of stored messages after a client reconnection)
Fixed a bug in unsubscribe due to missed clientID check
Fixed Issue 18 (descriptor of a disconnected (not active) client)
Bug fix for override subscriptions to the same /topic but with different QoS (latest wins)
Added test to check the downgrading of QoS of messages sent to registered subscribers (fixed a bug of double delivery of QoS2 messages)
Version 0.3:
Added Netty IO connectors
Dropped tests based on Fuse source client lib moving to Paho java client
Checks
0
Files changed
1
Commits on May 21, 2019
remove unnecessary quotes
…
joestr
committed
May 21, 2019
Loading status checks…
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
.
content();
byte
[] rawPayload
=
new
byte
[payload
.
readableBytes()];
payload
.
getBytes(
0
, rawPayload);
final
RetainedMessage
variableHeader())
.
messageId();
Session
session
=
sessionRegistry
.
retrieve(getClientId());
session
.
pubAckReceived(messageID);
}
void
processConnect
(
MqttConnectMessage
msg
import
io.moquette.broker.security.*
;
import
io.moquette.broker.subscriptions.CTrieSubscriptionDirectory
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Subscription
;
import
io.moquette.
broker
.subscriptions.Subscription
/*
* In memory retained messages store
*
*/
final
class
MemoryRetainedRepository
implements
IRetainedRepository
{
private
final
ConcurrentMap<
Topic
,
RetainedMessage
>
storage
private
void
destroy
() {
state
=
2
;
if
(resenderTimeout
!=
null
) {
resenderTimeout
.
cancel(
false
);
resenderTimeout
MqttSubAckPayload
(grantedQoSLevels);
return
new
MqttSubAckMessage
(fixedHeader, from(messageId), payload);
}
public
void
unsubscribe
(
List<
String
>
topics
,
class;
}
final
boolean
useFineMetrics
=
props
.
boolProp(
METRICS_ENABLE_PROPERTY_NAME
,
false
);
if
(useFineMetrics) {
DropWizardMetricsHandler
metricsHandler
=
Work and such Derivative Works in Source or Object form.
</
span
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
();
queueRepository
=
new
MemoryQueueRepository
();
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions,
SessionRegistry
sessionRegistry
=
new
SessionRegistry
(subscriptions, queueRepository);
=
LoggerFactory
.
getLogger(
PostOffice
.
class);
private
final
Authorizator
authorizator;
private
final
ISubscriptionsDirectory
subscriptions;
private
.
remove(topic);
}
@Override
public
void
retain
(
Topic
topic
,
MqttPublishMessage
msg
) {
final
ByteBuf
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
IConfig
props
,
ScheduledExecutorService
scheduler
) {
this
.
storePath
=
props
.
getProperty(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
,
"
, payload,
false
,
MqttMessageBuilders
.
publish()
.payload(payload
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
Split
Just for now
Hide whitespace changes
Apply and reload
4
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
Delete file
Open in desktop
@@ -31,7 +31,7 @@ goto end
rem
Set JavaHome if it exists
if
exist
{
"
.
isOpen()) {
return
;
}
//
long lastWriteTime = IdleStateHandler.this.lastWriteTime;
//
long lastWriteTime = lastWriteTime;
long
nextDelay
=
writerIdleTimeNanos
-
(
System
=
KeyManagerFactory
.
getInstance(
KeyManagerFactory
.
getDefaultAlgorithm());
kmf
.
init(ks, keyPassword
.
toCharArray());
LOG
.
info(
"
Initializing SSL context...
"
3.79 KB
Raw
Blame
@
ECHO
OFF
rem
#
rem
# Copyright (c) 2012-2015 Andrea Selva
rem
#
echo
"
"
echo
"
___ ___ _ _ ___ ________ _____ _____
target
/
/
parser
/
target
/
/
benchmarking
/
target
/
.idea
/
*
.iml
broker
+3
−3
broker/src/main/java/io/moquette/broker/Authorizator.java
+1
−1
+1
−1
broker/src/main/java/io/moquette/broker/BrokerConfiguration.java
+2
−2
+1
−1
+7
−8
+1
−1
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
@@ -1,6 +1,8 @@
Version 0.12:
Fixed issue #415
Dropped Hazelcast because at the moment Moquette is not designed to be clusterizable
Rewritten completly the broker to introduce the concept of MqttConnection
Dropped suppoert for MapDB and keeped only H2 MvStore for persistence
Version 0.10:
Netty epoll system added
4
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -18,6 +18,8 @@
import
isEmpty
();
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
);
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
a49792adf5
moquette
/
.github
/
ISSUE_TEMPLATE.md
Go to file
−22
broker/src/test/java/io/moquette/broker/subscriptions/CTrieSubscriptionDirectoryMatchingTest.java
+61
−65
233
broker/src/main/java/io/moquette/broker/subscriptions/CTrie.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,233 @@
package
io.moquette.broker.subscriptions
;
import
java.util.Collections
+1
−1
broker/src/main/java/io/moquette/broker/ISubscriptionsRepository.java
+0
−1
broker/src/main/java/io/moquette/broker/InflightResender.java
+3
−5
broker/src/main/java/io/moquette/broker/MQTTConnection.java
+1
−1
broker/src/main/java/io/moquette/broker/MQTTConnectionFactory.java
+1
−1
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
+1
−2
.
getLogger(
NewNettyAcceptor
.
class);
EventLoopGroup
m_bossGroup
;
EventLoopGroup
m_workerGroup
;
BytesMetricsCollector
m_bytesMetricsCollector
=
new
@@ -18,6 +18,8 @@
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.List
;
public
interface
Version 0.2:
Fixed issues (10, 11, 12, 13)
Fixed interdependency bug in test
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
831f24a
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
toStore
=
new
RetainedMessage
(msg
.
fixedHeader()
.
qosLevel(), rawPayload);
queueMap
.
put(topic, toStore);
}
@Override
public
boolean
isEmpty
) {
MqttConnectPayload
payload
=
msg
.
payload();
String
clientId
=
payload
.
clientIdentifier();
final
String
username
=
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.io.File
;
import
java.io.IOException
;
import
java.lang.reflect.InvocationTargetException
;
import
;
import
java.util.List
;
1
broker/src/main/java/io/moquette/broker/InflightResender.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
=
new
ConcurrentHashMap<>
();
@Override
public
void
cleanRetained
(
Topic
topic
) {
storage
.
remove(topic);
}
@Override
public
=
null
;
}
}
private
void
resendNotAcked
(
ChannelHandlerContext
ctx
/*
, IdleStateEvent evt
*/
) {
if
(
MQTTConnection
mqttConnection
,
int
messageId
) {
final
String
clientID
=
mqttConnection
.
getClientId();
for
(
new
DropWizardMetricsHandler
();
metricsHandler
.
init(props);
this
.
metrics
>
3. Grant of Patent License.
</
span
>
</
b
>
<
p
>
<
p
>
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
sut
=
new
PostOffice
(subscriptions,
new
final
IRetainedRepository
retainedRepository;
private
SessionRegistry
sessionRegistry;
private
BrokerInterceptor
interceptor;
PostOffice
(
ISubscriptionsDirectory
subscriptions
,
IAuthorizatorPolicy
authorizatorPolicy
,
payload
=
msg
.
content();
byte
[] rawPayload
=
new
byte
[payload
.
readableBytes()];
payload
.
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
);
final
String
autosaveProp
=
props
.
getProperty(
BrokerConstants
.
AUTOSAVE_INTERVAL_PROPERTY_NAME
,
"
30
"
);
this
.
NEWS_TOPIC
)
.
build());
//
Verify
ConnectionTestUtils
.
verifyReceivePublish(channel,
NEWS_TOPIC
,
"
Hello world!
"
);
}
@Test
public
void
%JAVA_HOME%
\bin\java
"
} (
set
"
JAVA
=
"
%JAVA_HOME%
\bin\java
"
set
JAVA
=
"
%JAVA_HOME%
\bin\java
"
)
.
nanoTime()
-
lastWriteTime);
if
(nextDelay
<=
0
) {
//
Writer is idle - set a new timeout and notify the callback.
writerIdleTimeout
=
ctx
.
executor()
.
);
return
SslContextBuilder
.
forServer(kmf);
}
/**
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the integration
* certificate and key in order to provide it to OpenSSL.
* <
p
>
* TODO: SNI is currently not supported, we use only the first found private key.
*/
private
"
echo
"
| \/ | | | | | | \/ | _ |_ _|_ _|
"
echo
"
| . . | ___ __ _ _ _ ___| |_| |_ ___ | . . | | | | | | | |
"
echo
"
| |\/| |/ _ \ / _\ | | | |/ _ \ __| __/ _ \ | |\/| | | | | | | | |
"
echo
"
| | | | (_) | (_| | |_| | __/ |_| || __/ | | | \ \/' / | | | |
"
echo
/
target
/
client
/
target
/
parser_commons
/
target
/
netty_parser
/
target
/
netty_parser
/
target
/
+1
−1
+1
−1
broker/src/main/java/io/moquette/broker/ISubscriptionsRepository.java
+0
−1
broker/src/main/java/io/moquette/broker/InflightResender.java
+3
−5
broker/src/main/java/io/moquette/broker/MQTTConnection.java
+1
−1
broker/src/main/java/io/moquette/broker/MQTTConnectionFactory.java
+1
−1
io.moquette.broker.subscriptions.Topic
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.List
;
public
interface
IRetainedRepository
{
void
cleanRetained
(
Topic
topic
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Go to file
T
Go to line
L
Copy path
Cannot retrieve contributors at this time
This file is used as an issue template.
You are using an old version of issue templates. Please update to the new issue template workflow.
Learn more
13 lines (7 sloc)
248 Bytes
Raw
Blame
Expected behavior
Actual behavior
;
import
java.util.HashSet
;
import
java.util.Optional
;
import
java.util.Set
;
public
class
CTrie
{
interface
IVisitor
<T> {
void
broker/src/main/java/io/moquette/broker/MemorySubscriptionsRepository.java
+1
−1
+7
−7
+5
−9
broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java
+0
−1
broker/src/main/java/io/moquette/broker/NewNettyMQTTHandler.java
+6
−7
broker/src/main/java/io/moquette/broker/PostOffice.java
+22
−24
broker/src/main/java/io/moquette/broker/Server.java
BytesMetricsCollector
();
MessageMetricsCollector
m_metricsCollector
=
new
MessageMetricsCollector
();
private
EventLoopGroup
bossGroup
;
private
EventLoopGroup
workerGroup
IRetainedRepository
{
public
interface
IRetainedRepository
{
void
cleanRetained
(
Topic
topic
);
void
cleanRetained
(
Topic
topic
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
() {
return
queueMap
.
isEmpty();
}
@Override
public
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
) {
final
Topic
payload
.
userName();
LOG
.
trace(
"
"
, clientId, username, channel);
if
(isNotProtocolVersion(msg,
MqttVersion
.
MQTT_3_1
)
&&
isNotProtocolVersion(msg,
java.text.ParseException
;
import
java.util.ArrayList
;
import
java.util.Collections
;
import
java.util.List
;
import
java.util.Properties
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.util.concurrent.EventExecutor
;
8
broker/src/main/java/io/moquette/broker/MQTTConnection.java
Show comments
View file
Edit file
Delete file
@@ -15,10 +15,8 @@
void
retain
(
Topic
topic
,
MqttPublishMessage
msg
) {
final
ByteBuf
payload
=
msg
.
content();
byte
[] rawPayload
LOG
.
isTraceEnabled()) {
LOG
.
trace(
"
"
, ctx
.
channel(),
NettyUtils
.
clientID(ctx
.
channel()));
}
ctx
.
String
t
:
topics) {
Topic
topic
=
new
Topic
(t);
boolean
validTopic
=
topic
.
isValid();
if
=
Optional
.
of(metricsHandler);
}
else
{
this
.
metrics
=
Optional
.
empty();
}
final
boolean
useBugSnag
<
span
style
="
font-size: 10pt;
"
>
Subject to the terms and conditions of
this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable
(except as stated in this section) patent license to make, have made,
use, offer to sell, sell, import, and otherwise transfer the Work,
where such license applies only to those patent claims licensable
by such Contributor that are necessarily infringed by their
Contribution(s) alone or by combination of their Contribution(s)
with the Work to which such Contribution(s) was submitted. If You
PermitAllAuthorizatorPolicy
(), retainedRepository, sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
return
sessionRegistry;
return
sessionRegistry;
4
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
Show comments
IRetainedRepository
retainedRepository
,
SessionRegistry
sessionRegistry
,
BrokerInterceptor
interceptor
) {
this
.
authorizator
=
new
Authorizator
(authorizatorPolicy);
this
.
getBytes(
0
, rawPayload);
final
RetainedMessage
toStore
=
new
RetainedMessage
(msg
.
fixedHeader()
.
qosLevel(), rawPayload);
queueMap
.
put(topic, toStore);
}
autosaveInterval
=
Integer
.
parseInt(autosaveProp);
this
.
scheduler
=
scheduler;
}
testForceClientDisconnection_issue116
() {
final
MQTTConnection
clientXA
=
connectAs(
"
subscriber
"
);
subscribe(clientXA,
NEWS_TOPIC
,
echo
Using JAVA_HOME:
"
%JAVA_HOME%
"
@@ -83,6 +83,6 @@ rem set JAVA_OPTS=%JAVA_OPTS% -XX:PrintFLSStatistics=1
rem
set JAVA_OPTS=%JAVA_OPTS% -Xloggc:/var/log/moquette/gc.log
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+UseGCLogFileRotation
set
JAVA_OPTS
=
schedule(
this
, writerIdleTimeNanos,
TimeUnit
.
NANOSECONDS
);
try
{
/*
* IdleStateEvent event; if (firstWriterIdleEvent) { firstWriterIdleEvent =
* false; event = IdleStateEvent.FIRST_WRITER_IDLE_STATE_EVENT; } else { event =
* IdleStateEvent.WRITER_IDLE_STATE_EVENT; }
*/
channelIdle(ctx
/*
, event
static
SslContextBuilder
builderWithOpenSSLProvider
(
KeyStore
ks
,
String
keyPassword
)
throws
GeneralSecurityException
{
for
(
String
alias
:
"
\_| |_/\___/ \__, |\__,_|\___|\__|\__\___| \_| |_/\_/\_\ \_/ \_/
"
echo
"
| |
"
echo
"
|_|
"
echo
"
"
echo
"
version: 0.13-SNAPSHOT
"
parser_commons
/
target
/
distribution
/
target
/
broker
/
moquette.log
broker
/
runner
/
bundle
/
target
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
+1
−2
broker/src/main/java/io/moquette/broker/MemorySubscriptionsRepository.java
+1
−1
+7
−7
+5
−9
broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java
+0
−1
broker/src/main/java/io/moquette/broker/NewNettyMQTTHandler.java
+6
−7
);
@@ -26,5 +28,5 @@
boolean
isEmpty
();
MqttPublishMessage
retainedOnTopic
(
String
topic
);
List<
RetainedMessage
>
retainedOnTopic
(
String
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Steps to reproduce
Minimal yet complete reproducer code (or URL to code) or complete log file
Moquette MQTT version
JVM version (e.g.
java -version
)
OS version (e.g.
uname -a
)
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
visit
(
CNode
node
,
int
deep
);
T
getResult
();
}
private
static
final
Token
ROOT
=
+2
−2
broker/src/main/java/io/moquette/broker/Session.java
+4
−4
broker/src/main/java/io/moquette/broker/SessionRegistry.java
+1
−1
+1
−1
+1
−3
+1
−3
+1
−1
;
private
BytesMetricsCollector
bytesMetricsCollector
=
new
BytesMetricsCollector
();
private
MessageMetricsCollector
metricsCollector
=
new
MessageMetricsCollector
();
private
Optional<? extends
ChannelInboundHandler
);
@@ -26,5 +28,5 @@
boolean
isEmpty
();
boolean
isEmpty
();
MqttPublishMessage
retainedOnTopic
(
String
topic
);
List<
RetainedMessage
>
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
searchTopic
=
new
Topic
(topic);
final
List<
RetainedMessage
>
matchingMessages
=
new
ArrayList<>
();
for
(
Map
.
MqttVersion
.
MQTT_3_1_1
)) {
LOG
.
warn(
"
"
, clientId, channel);
abortConnection(
CONNECTION_REFUSED_UNACCEPTABLE_PROTOCOL_VERSION
);
return
;
}
final
boolean
;
import
java.util.concurrent.Executors
;
import
java.util.concurrent.ScheduledExecutorService
;
import static
io.moquette.logging.LoggingUtils.getInterceptorIds
;
public
class
Server
{
private
static
final
Logger
*/
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
import
io.moquette.spi.impl.DebugUtils
;
import
io.moquette.spi.impl.subscriptions.Topic
;
import
io.moquette.spi.security.IAuthenticator
;
import
=
new
byte
[payload
.
readableBytes()];
payload
.
getBytes(
0
, rawPayload);
final
RetainedMessage
toStore
=
new
RetainedMessage
(msg
.
fireUserEventTriggered(
new
ResendNotAckedPublishes
());
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
(
!
validTopic) {
//
close the connection, not valid topicFilter is a protocol violation
mqttConnection
.
dropConnection();
LOG
.
warn(
"
"
, clientID,
topics, topic);
return
;
=
props
.
boolProp(
BUGSNAG_ENABLE_PROPERTY_NAME
,
false
);
if
(useBugSnag) {
BugSnagErrorsHandler
bugSnagHandler
=
new
BugSnagErrorsHandler
();
bugSnagHandler
.
institute patent litigation against any entity (including a
cross-claim or counterclaim in a lawsuit) alleging that the Work
or a Contribution incorporated within the Work constitutes direct
or contributory patent infringement, then any patent licenses
granted to You under this License for that Work shall terminate
as of the date such litigation is filed.
</
span
>
</
p
>
<
p
>
<
b
View file
Edit file
Delete file
@@ -65,6 +65,7 @@
private
IAuthenticator
mockAuthenticator;
private
IAuthenticator
mockAuthenticator;
private
SessionRegistry
sessionRegistry;
private
SessionRegistry
subscriptions
=
subscriptions;
this
.
retainedRepository
=
retainedRepository;
this
.
@Override
public
boolean
isEmpty
() {
return
queueMap
.
isEmpty();
}
@Override
public
@SuppressWarnings
(
"
FutureReturnValueIgnored
"
)
public
H2Builder
initStore
() {
AT_MOST_ONCE
);
final
MQTTConnection
clientXB
=
connectAs(
"
publisher
"
%JAVA_OPTS%
-XX:NumberOfGCLogFiles=
10
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
"
set
JAVA_OPTS
*/
);
}
catch
(
Throwable
t) {
ctx
.
fireExceptionCaught(t);
}
Collections
.
list(ks
.
aliases())) {
if
(ks
.
entryInstanceOf(alias,
KeyStore
set
"
CURRENT_DIR
=
%cd%
"
if
not
"
%MOQUETTE_HOME%
"
/
/
bundle
/
runner
/
/
osgi_test
/
target
/
/
broker/src/main/java/io/moquette/broker/PostOffice.java
+22
−24
broker/src/main/java/io/moquette/broker/Server.java
+2
−2
broker/src/main/java/io/moquette/broker/Session.java
+4
−4
broker/src/main/java/io/moquette/broker/SessionRegistry.java
+1
−1
topic
);
}
26
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -16,8 +16,12 @@
package
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
new
Token
(
"
root
"
);
private
static
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+3
>
metrics;
private
Optional<? extends
ChannelInboundHandler
>
errorsCather;
@@ -125,13 +125,13 @@ public void initialize(NewNettyMQTTHandler mqttHandler, IConfig props, ISslConte
boolean
epoll
=
props
.
boolProp(
BrokerConstants
.
retainedOnTopic
(
String
topic
);
}
}
26
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -16,8 +16,12 @@
package
io.moquette.broker
;
package
Save preferences
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Entry<
Topic
,
RetainedMessage
>
entry
:
queueMap
.
entrySet()) {
final
Topic
scanTopic
=
entry
.
getKey();
if
cleanSession
=
msg
.
variableHeader()
.
isCleanSession();
if
(clientId
==
null
||
clientId
.
length()
==
0
) {
LOG
=
LoggerFactory
.
getLogger(
io.moquette.broker
.
Server
.
class);
private
ScheduledExecutorService
scheduler;
private
NewNettyAcceptor
acceptor;
private
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelPipeline
;
@@ -154,7 +152,7 @@ void processConnect(MqttConnectMessage msg) {
//
Generating client id.
fixedHeader()
.
qosLevel(), rawPayload);
storage
.
put(topic, toStore);
}
@Override
public
boolean
isEmpty
() {
return
storage
.
isEmpty();
}
@Override
public
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
}
LOG
.
trace(
"
"
, clientID, topic);
subscriptions
.
removeSubscription(topic, clientID);
//
TODO remove the subscriptions to Session
//
clientSession.unsubscribeFrom(topic);
String
username
=
NettyUtils
init(props);
this
.
errorsCather
=
Optional
.
of(bugSnagHandler);
}
else
{
this
.
errorsCather
=
Optional
.
empty();
}
>
<
span
style
="
font-size: 10pt;
"
>
4. Redistribution.
</
span
>
</
b
>
</
p
>
<
sessionRegistry;
public
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
);
public
static
sessionRegistry
=
sessionRegistry;
this
.
interceptor
=
interceptor;
}
public
void
init
(
SessionRegistry
sessionRegistry
) {
this
.
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
) {
final
Topic
searchTopic
=
new
Topic
(topic);
final
List<
RetainedMessage
LOG
.
info(
"
Initializing H2 store
"
);
if
(storePath
==
null
||
storePath
.
isEmpty()) {
throw
new
IllegalArgumentException
);
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Hello
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos2(clientXB,
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
%JAVA%
-server
%JAVA_OPTS%
%JAVA_OPTS_SCRIPT%
-Dlog4j.configuration=file:
%LOG_FILE%
-Dmoquette.path=
%MOQUETTE_PATH%
-cp
%MOQUETTE_HOME%
\lib\* io.moquette.broker.Server
Toggle all file notes
ProTip!
Use
}
else
{
//
Write occurred before the timeout - set a new timeout with shorter delay.
writerIdleTimeout
=
ctx
.
executor()
.
schedule(
this
, nextDelay,
TimeUnit
.
NANOSECONDS
);
}
.
PrivateKeyEntry
.
class)) {
PrivateKey
key
=
(
PrivateKey
) ks
.
getKey(alias, keyPassword
.
toCharArray());
Certificate
[] chain
=
ks
.
==
"
"
goto
gotHome
set
"
MOQUETTE_HOME
=
%CURRENT_DIR%
"
if
exist
"
%MOQUETTE_HOME%
\bin\moquette.bat
"
goto
okHome
perf
/
target
/
/
mapdb_storage
/
target
/
*
~
*
.log
*
.DS_Store
.settings
/
+1
−1
+1
−3
+1
−3
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.ArrayList
;
import
java.util.List
;
import
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
final
INode
NO_PARENT
=
null
;
private
enum
Action
{
OK
,
REPEAT
}
INode
root;
CTrie
() {
−3
+3
−3
+1
−1
+1
−1
+1
−1
+1
−1
+1
−3
+3
−3
+3
−3
NETTY_EPOLL_PROPERTY_NAME
,
false
);
if
(epoll) {
LOG
.
info(
"
Netty is using Epoll
"
);
m_bossGroup
=
new
EpollEventLoopGroup
();
io.moquette.broker
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
(searchTopic
.
match(scanTopic)) {
matchingMessages
.
add(entry
.
getValue());
}
}
return
matchingMessages;
}
}
10
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
if
(
!
brokerConfig
.
isAllowZeroByteClientId()) {
LOG
.
warn(
"
"
, username, channel);
abortConnection(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
}
if
volatile
boolean
initialized;
private
PostOffice
dispatcher;
private
BrokerInterceptor
interceptor;
private
H2Builder
h2Builder;
public
static
void
main
(
clientId
=
UUID
.
randomUUID()
.
toString()
.
replace(
"
-
"
,
"
"
);
LOG
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
) {
final
Topic
searchTopic
=
new
Topic
(topic);
final
List<
RetainedMessage
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
.
userName(mqttConnection
.
channel);
interceptor
.
notifyTopicUnsubscribed(topic
.
toString(), clientID, username);
}
//
ack the client
mqttConnection
.
sendUnsubAckMessage(topics, clientID, messageId);
}
void
initializePlainTCPTransport(mqttHandler, props);
initializeWebSocketTransport(mqttHandler, props);
if
(securityPortsConfigured(props)) {
SslContext
sslContext
=
sslCtxCreator
.
initSSLContext();
if
(sslContext
==
null
) {
LOG
.
p
>
<
span
style
="
font-size: 10pt;
"
>
You may reproduce and distribute copies of the
Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You
meet the following conditions:
</
span
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
(
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
sessionRegistry
=
sessionRegistry;
}
public
void
fireWill
(
Session
.
Will
will
) {
//
MQTT 3.1.2.8-17
publish2Subscribers(will
.
payload,
new
>
matchingMessages
=
new
ArrayList<>
();
for
(
Map
.
Entry<
Topic
,
RetainedMessage
>
entry
:
(
"
H2 store path can't be null or empty
"
);
}
mvStore
=
new
MVStore
.
Builder
()
.fileName(storePath)
.autoCommitDisabled()
.open();
LOG
.
MqttMessageBuilders
.
publish()
.payload(anyPayload)
.qos(
MqttQoS
.
EXACTLY_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build(),
n
and
p
to navigate between commits in a pull request.
Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
© 2020 GitHub, Inc.
}
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
getCertificateChain(alias);
X509Certificate
[] certChain
=
new
X509Certificate
[chain
.
length];
System
.
arraycopy(chain,
0
, certChain,
0
, chain
.
cd
..
set
"
MOQUETTE_HOME
=
%cd%
"
cd
"
%CURRENT_DIR%
"
:
gotHome
if
exist
"
.project
.classpath
/
*
/
bin
/
*
.swp
*
.class
#
Mobile Tools for Java (J2ME)
.mtj.tmp
/
#
+1
−1
+1
−1
+3
−3
+3
−3
+1
−1
+1
java.util.Map
;
import
java.util.concurrent.ConcurrentHashMap
;
import
java.util.concurrent.ConcurrentMap
;
@@ -26,16 +30,20 @@
*
*/
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
final
CNode
mainNode
=
new
CNode
();
mainNode
.
token
=
ROOT
;
this
.
+2
−3
+2
−3
+2
−2
+1
−1
+2
−2
+2
−3
+2
−3
+1
−3
+1
m_workerGroup
=
new
EpollEventLoopGroup
();
bossGroup
=
new
EpollEventLoopGroup
();
workerGroup
=
new
EpollEventLoopGroup
();
channelClass
=
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.ArrayList
;
import
java.util.List
;
import
java.util.Map
;
import
java.util.concurrent.ConcurrentHashMap
;
import
java.util.concurrent.ConcurrentHashMap
;
Show comments
View file
Edit file
Delete file
@@ -390,7 +390,7 @@ public void cleanRetainedMessageStoreWhenPublishWithRetainedQos0IsReceived() {
sut
.
receivedPublishQos1(connection,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
(
!
cleanSession) {
LOG
.
warn(
"
"
,
username, channel);
abortConnection(
String
[]
args
)
throws
IOException
{
final
Server
server
=
new
Server
.
debug(
"
Client has connected with
server
"
, clientId,
LOG
.
debug(
"
Client has connected with
integration
"
>
matchingMessages
=
new
ArrayList<>
();
for
(
Map
.
Entry<
Topic
,
RetainedMessage
>
entry
:
storage
Learn more
Accept
Reject
Save preferences
receivedPublishQos0
(
Topic
topic
,
String
username
,
String
clientID
,
ByteBuf
payload
,
boolean
retain
,
MqttPublishMessage
msg
error(
"
Can't initialize SSLHandler layer! Exiting, check your configuration of jks
"
);
return
;
}
initializeSSLTCPTransport(mqttHandler, props, sslContext);
initializeWSSTransport(mqttHandler, props, sslContext);
}
}
private
boolean
securityPortsConfigured
(
IConfig
props
>
<
p
>
<
ul
>
<
li
>
<
span
style
="
font-size: 10pt;
"
>
(a) You must give any other recipients of the Work or
@Before
public
void
setUp
() {
public
void
setUp
() {
@@ -87,8 +88,9 @@ private void prepareSUT() {
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
=
new
Topic
(will
.
topic), will
.
qos);
}
public
void
subscribeClientToTopics
(
MqttSubscribeMessage
msg
,
String
clientID
,
String
username
queueMap
.
entrySet()) {
final
Topic
scanTopic
=
entry
.
getKey();
if
(searchTopic
.
match(scanTopic)) {
matchingMessages
.
add(entry
.
trace(
"
Scheduling H2 commit task
"
);
scheduler
.
scheduleWithFixedDelay(()
-
>
{
LOG
.
trace(
"
Committing to H2
"
);
"
username
"
);
final
MQTTConnection
clientYA
=
connectAs(
"
subscriber
"
);
subscribe(clientYA,
NEWS_TOPIC
,
AT_MOST_ONCE
);
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
length);
return
SslContextBuilder
.
forServer(key, certChain);
}
}
throw
new
KeyManagementException
(
"
the SSL key-store does not contain a private key
"
);
}
private
static
%MOQUETTE_HOME%
\bin\moquette.bat
"
goto
okHome
echo
The MOQUETTE_HOME environment variable is not defined correctly
echo
This environment variable is needed to run this program
goto
end
:
okHome
rem
Set JavaHome if it exists
if
exist
{
Package Files #
*
.war
*
.ear
#
virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml
hs_err_pid
*
broker
/
*
moquette_store.
*
embedding_moquette
/
−1
+1
−1
+1
−1
+1
−3
+3
−3
+3
−3
+2
−3
+2
−3
+2
−2
final
class
MemoryRetainedRepository
implements
IRetainedRepository
{
private
final
ConcurrentMap<
String
,
MqttPublishMessage
>
storage
=
new
ConcurrentHashMap<>
();
Save preferences
root
=
new
INode
(mainNode);
}
Optional<
CNode
>
lookup
(
Topic
topic
) {
INode
inode
=
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
EpollServerSocketChannel
.
class;
}
else
{
LOG
.
info(
"
Netty is using NIO
"
);
m_bossGroup
=
new
NioEventLoopGroup
import
java.util.concurrent.ConcurrentMap
;
import
java.util.concurrent.ConcurrentMap
;
@@ -26,16 +30,20 @@
*
*/
*
*/
final
class
MemoryRetainedRepository
implements
IRetainedRepository
{
,
true
,
publishMsg);
assertMessageIsRetained(
NEWS_TOPIC
);
assertMessageIsRetained(
NEWS_TOPIC
, anyPayload
);
//
publish a QoS0 retained message
//
Exercise
@@ -406,8 +406,10 @@ public void cleanRetainedMessageStoreWhenPublishWithRetainedQos0IsReceived() {
assertTrue(
CONNECTION_REFUSED_IDENTIFIER_REJECTED
);
return
;
}
//
Generating client id.
clientId
=
UUID
.
randomUUID()
.
toString()
.
replace(
"
();
server
.
startServer();
System
.
out
.
println(
"
Server started, version 0.12-SNAPSHOT
"
);
//
Bind a shutdown hook
Runtime
.
getRuntime()
, clientId,
username, channel);
}
2
broker/src/main/java/io/moquette/broker/MQTTConnectionFactory.java
Show comments
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
package
io.moquette.broker
;
import
io.moquette.
spi
.
entrySet()) {
final
Topic
scanTopic
=
entry
.
getKey();
if
(searchTopic
.
match(scanTopic)) {
matchingMessages
.
add(entry
.
) {
if
(
!
authorizator
.
canWrite(topic, username, clientID)) {
LOG
.
error(
"
"
, clientID, topic);
return
;
}
) {
String
sslTcpPortProp
=
props
.
getProperty(
BrokerConstants
.
SSL_PORT_PROPERTY_NAME
);
String
wssPortProp
=
props
.
getProperty(
BrokerConstants
.
Derivative Works a copy of this License; and
</
span
>
<
p
>
</
li
>
<
li
>
<
span
style
="
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
,
MQTTConnection
mqttConnection
) {
//
verify which topics of the subscribe ongoing has read access permission
int
messageID
=
messageId(msg);
List<
MqttTopicSubscription
>
ackTopics
=
authorizator
.
verifyTopicsReadAccess(clientID, username, msg);
getValue());
}
}
return
matchingMessages;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
mvStore
.
commit();
}, autosaveInterval, autosaveInterval,
TimeUnit
.
SECONDS
);
return
this
;
}
public
ISubscriptionsRepository
subscriptionsRepository
() {
return
new
final
MQTTConnection
clientYB
=
connectAs(
"
publisher
"
);
final
ByteBuf
anyPayload2
=
Unpooled
.
copiedBuffer(
"
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
void
addClientAuthentication
(
KeyStore
ks
,
SslContextBuilder
contextBuilder
)
throws
NoSuchAlgorithmException
,
KeyStoreException
{
LOG
.
warn(
"
%JAVA_HOME%
\bin\java
"
} (
set
JAVA
=
"
%JAVA_HOME%
\bin\java
"
)
echo
Using JAVA_HOME:
"
%JAVA_HOME%
"
target
/
broker
/
nb-configuration.xml
broker
/
nbactions-Server.xml
maven-metadata.xml
/
.gradle
/
/
bin
/
Copy lines
Copy permalink
+1
−1
+2
−2
+2
−3
+2
−3
+1
−3
+1
−1
+1
−1
+1
−1
+1
private
final
ConcurrentMap<
Topic
,
RetainedMessage
>
storage
=
new
ConcurrentHashMap<>
();
@Override
public
void
cleanRetained
(
Topic
topic
this
.
root;
Token
token
=
topic
.
headToken();
while
(
!
topic
.
isEmpty()
&&
(inode
.
mainNode()
−1
+0
−52
broker/src/main/java/io/moquette/connections/MqttConnectionMetrics.java
+0
−91
broker/src/main/java/io/moquette/connections/MqttSession.java
+0
−52
broker/src/main/java/io/moquette/connections/MqttSubscription.java
+3
−5
+1
−1
broker/src/main/java/io/moquette/interception/InterceptHandler.java
+1
();
m_workerGroup
=
new
NioEventLoopGroup
();
bossGroup
=
new
NioEventLoopGroup
();
workerGroup
=
new
NioEventLoopGroup
();
channelClass
=
final
class
MemoryRetainedRepository
implements
IRetainedRepository
{
private
final
ConcurrentMap<
String
,
MqttPublishMessage
>
storage
=
new
ConcurrentHashMap<>
"
Retained message for topic /news must be cleared
"
, retainedRepository
.
isEmpty());
}
private
void
assertMessageIsRetained
(
String
expectedTopicName
) {
MqttPublishMessage
msg
=
-
"
,
"
"
);
LOG
.
debug(
"
"
, clientId,
username, channel);
}
if
(
!
login(msg, clientId)) {
.
addShutdownHook(
new
Thread
(server
::
stopServer));
}
/**
* Starts Moquette bringing the configuration from the file located at m_config/moquette.conf
*
*
@throws
IOException in case of any IO error.
*/
public
void
startServer
.security.IAuthenticator
;
import
io.moquette.
broker
.security.IAuthenticator
;
import
io.netty.channel.Channel
;
class
MQTTConnectionFactory
{
2
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
Show comments
View file
getValue());
}
}
return
matchingMessages;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
publish2Subscribers(payload, topic,
AT_MOST_ONCE
);
if
(retain) {
//
QoS == 0 && retain => clean old retained
retainedRepository
.
cleanRetained(topic);
}
interceptor
.
notifyTopicPublished(msg, clientID, username);
}
void
receivedPublishQos1
(
WSS_PORT_PROPERTY_NAME
);
return
sslTcpPortProp
!=
null
||
wssPortProp
!=
null
;
}
private
void
initFactory
(
String
host
font-size: 10pt;
"
>
(b) You must cause any modified files to carry prominent notices
stating that You changed the files; and
</
span
>
<
p
>
</
li
>
</
li
>
<
.
init(subscriptionsRepository);
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
MqttSubAckMessage
ackMessage
=
doAckMessageFromValidateFilters(ackTopics, messageID);
//
store topics subscriptions in session
List<
Subscription
>
newSubscriptions
=
ackTopics
.
stream()
.filter(req
-
>
req
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
H2SubscriptionsRepository
(mvStore);
}
public
void
closeStore
() {
mvStore
.
close();
}
public
IQueueRepository
queueRepository
() {
return
new
Hello 2
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos2(clientYB,
MqttMessageBuilders
.
publish()
.payload(anyPayload2)
.qos(
MqttQoS
.
EXACTLY_ONCE
)
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
Client authentication is enabled. The keystore will be used as a truststore.
"
);
//
use keystore as truststore, as integration needs to trust certificates signed by the integration certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.
echo
Using MOQUETTE_HOME:
"
%MOQUETTE_HOME%
"
rem
set LOG_CONSOLE_LEVEL=info
rem
set LOG_FILE_LEVEL=fine
set
JAVA_OPTS
=
set
JAVA_OPTS_SCRIPT
=
-XX:+HeapDumpOnOutOfMemoryError -Djava.awt.headless=true
set
MOQUETTE_PATH
=
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
−1
+1
−1
+1
−1
+1
−1
+1
−1
+1
−1
+0
−52
broker/src/main/java/io/moquette/connections/MqttConnectionMetrics.java
+0
−91
broker/src/main/java/io/moquette/connections/MqttSession.java
+0
) {
storage
.
remove(topic
.
toString()
);
storage
.
remove(topic);
}
@Override
public
void
retain
(
Topic
topic
.
anyChildrenMatch(token))) {
topic
=
topic
.
exceptHeadToken();
inode
=
inode
.
mainNode()
.
childOf(token);
token
=
−1
broker/src/main/java/io/moquette/interception/Interceptor.java
+1
−1
broker/src/main/java/io/moquette/interception/messages/InterceptSubscribeMessage.java
+1
−1
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
+5
−4
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
+1
−1
broker/src/main/java/io/moquette/persistence/MemoryStorageService.java
+0
−31
broker/src/main/java/io/moquette/server/Constants.java
NioServerSocketChannel
.
class;
}
@@ -154,9 +154,7 @@ public void initialize(NewNettyMQTTHandler mqttHandler, IConfig props, ISslConte
}
initializePlainTCPTransport(mqttHandler, props);
initializeWebSocketTransport(mqttHandler, props);
String
sslTcpPortProp
=
props
.
getProperty(
BrokerConstants
.
SSL_PORT_PROPERTY_NAME
);
String
();
private
final
ConcurrentMap<
Topic
,
RetainedMessage
>
storage
=
new
ConcurrentHashMap<>
();
@Override
@Override
public
void
retainedRepository
.
retainedOnTopic(expectedTopicName);
assertEquals(expectedTopicName, msg
.
variableHeader()
.
topicName());
private
void
assertMessageIsRetained
(
String
expectedTopicName
,
ByteBuf
expectedPayload
) {
abortConnection(
CONNECTION_REFUSED_BAD_USER_NAME_OR_PASSWORD
);
channel
.
close()
.
addListener(
CLOSE_ON_FAILURE
);
return
;
}
try
()
throws
IOException
{
File
defaultConfigurationFile
=
defaultConfigFile();
LOG
.
info(
"
Starting Moquette integration. Configuration file path={}
"
, defaultConfigurationFile
.
getAbsolutePath());
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Topic
;
import
io.moquette.
broker
.subscriptions.Topic
;
import
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
MQTTConnection
connection
,
Topic
topic
,
String
username
,
ByteBuf
payload
,
int
messageID
,
boolean
retain
,
,
int
port
,
String
protocol
,
final
PipelineInitializer
pipelieInitializer
) {
LOG
.
debug(
"
Initializing integration. Protocol={}
"
span
style
="
font-size: 10pt;
"
>
(c) You must retain, in the Source form of any Derivative Works
that You distribute, all copyright, patent, trademark, and
attribution notices from the Source form of the Work,
excluding those notices that do not pertain to any part of
the Derivative Works; and
</
span
>
<
p
>
</
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
);
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
.
qualityOfService()
!=
FAILURE
)
.map(req
-
>
{
final
Topic
topic
=
new
Topic
(req
.
topicName());
return
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
H2QueueRepository
(mvStore);
}
public
IRetainedRepository
retainedRepository
() {
return
new
H2RetainedRepository
(mvStore);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
.retained(
true
)
.topicName(
NEWS_TOPIC
)
.
build(),
"
username
"
);
//
Verify
assertFalse(
"
First 'subscriber' channel MUST be closed by the broker
"
init(ks);
contextBuilder
.
clientAuth(
ClientAuth
.
REQUIRE
);
contextBuilder
.
trustManager(tmf);
}
private
SslProvider
getSSLProvider
() {
String
%MOQUETTE_HOME%
set
LOG_FILE
=
%MOQUETTE_HOME%
\config\moquette-log.properties
rem
# Use the Hotspot garbage-first collector.
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+UseG1GC
rem
# Have the JVM do less remembered set work during STW, instead
rem
# preferring concurrent GC. Reduces p99.9 latency.
set
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
−52
broker/src/main/java/io/moquette/connections/MqttSubscription.java
+3
−5
+1
−1
broker/src/main/java/io/moquette/interception/InterceptHandler.java
+1
−1
broker/src/main/java/io/moquette/interception/Interceptor.java
+1
−1
broker/src/main/java/io/moquette/interception/messages/InterceptSubscribeMessage.java
+1
−1
broker/src/main/java/io/moquette/persistence/MemoryMessagesStore.java
+5
,
MqttPublishMessage
msg
) {
storage
.
put(topic
.
toString(), msg);
final
ByteBuf
payload
=
msg
.
content();
byte
topic
.
headToken();
}
if
(inode
==
null
||
!
topic
.
isEmpty()) {
return
Optional
.
empty();
}
+1
−1
broker/src/main/java/io/moquette/spi/IMatchingCondition.java
+1
−1
broker/src/main/java/io/moquette/spi/IMessagesStore.java
+2
−2
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
+1
−2
broker/src/test/java/io/moquette/broker/ConnectionTestUtils.java
+5
−6
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
+4
wssPortProp
=
props
.
getProperty(
BrokerConstants
.
WSS_PORT_PROPERTY_NAME
);
if
(sslTcpPortProp
!=
null
||
wssPortProp
!=
null
) {
if
(securityPortsConfigured(props)) {
cleanRetained
(
Topic
topic
) {
public
void
cleanRetained
(
Topic
topic
) {
storage
.
remove(topic
.
toString()
);
storage
List<
RetainedMessage
>
msgs
=
retainedRepository
.
retainedOnTopic(expectedTopicName);
assertEquals(
1
, msgs
.
size());
RetainedMessage
msg
=
msgs
{
LOG
.
trace(
"
Binding MQTTConnection (channel: {}) to session
"
, channel);
sessionRegistry
.
bindToSession(
this
, msg, clientId);
initializeKeepAliveTimeout(channel, msg, clientId);
setupInflightResender(channel);
NettyUtils
.
clientID(channel, clientId);
IResourceLoader
filesystemLoader
=
new
FileResourceLoader
(defaultConfigurationFile);
final
IConfig
config
=
new
ResourceLoaderConfig
(filesystemLoader);
startServer(config);
}
private
static
File
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.concurrent.ConcurrentHashMap
;
3
broker/src/main/java/io/moquette/broker/MemorySubscriptionsRepository.java
Show comments
View file
Edit file
Delete file
@@ -15,11 +15,10 @@
*/
package
io.moquette.broker
;
import
io.moquette.
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
MqttPublishMessage
msg
) {
//
verify if topic can be write
topic
.
getTokens();
if
(
!
topic
.
isValid()) {
LOG
.
warn(
"
, protocol);
ServerBootstrap
b
=
new
ServerBootstrap
();
b
.
group(bossGroup, workerGroup)
.
channel(channelClass)
.childHandler(
li
>
<
li
>
<
span
style
="
font-size: 10pt;
"
MemoryRetainedRepository
(),
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(),
sessionRegistry,
new
Subscription
(clientID, topic, req
.
qualityOfService());
})
.
collect(
Collectors
.
toList());
for
(
Subscription
subscription
:
newSubscriptions) {
subscriptions
.
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
, clientXA
.
channel
.
isOpen());
ConnectionTestUtils
.
verifyPublishIsReceived((
EmbeddedChannel
) clientYA
.
channel,
AT_MOST_ONCE
,
"
Hello 2
"
);
}
providerName
=
props
.
getProperty(
BrokerConstants
.
SSL_PROVIDER
,
SslProvider
.
JDK
.
name());
try
{
return
JAVA_OPTS
=
%JAVA_OPTS%
-XX:G1RSetUpdatingPauseTimePercent=
5
rem
# Main G1GC tunable: lowering the pause target will lower throughput and vise versa.
rem
# 200ms is the JVM default and lowest viable setting
rem
# 1000ms increases throughput. Keep it smaller than the timeouts.
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:MaxGCPauseMillis=
500
rem
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
−4
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
+1
−1
broker/src/main/java/io/moquette/persistence/MemoryStorageService.java
+0
−31
broker/src/main/java/io/moquette/server/Constants.java
+1
−1
broker/src/main/java/io/moquette/spi/IMatchingCondition.java
+1
−1
broker/src/main/java/io/moquette/spi/IMessagesStore.java
+2
−2
[] rawPayload
=
new
byte
[payload
.
readableBytes()];
payload
.
getBytes(
0
, rawPayload);
final
RetainedMessage
toStore
=
new
RetainedMessage
(msg
return
Optional
.
of(inode
.
mainNode());
}
enum
NavigationAction
{
MATCH
,
GODEEP
,
STOP
}
private
NavigationAction
−5
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
+2
−2
+1
−1
+5
−6
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
+5
−6
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
+7
−9
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
+6
−7
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
SslContext
sslContext
=
sslCtxCreator
.
initSSLContext();
if
(sslContext
==
null
) {
LOG
.
error(
"
Can't initialize SSLHandler layer! Exiting, check your configuration of jks
"
.
remove(topic);
}
}
@Override
@Override
public
void
retain
(
Topic
topic
,
MqttPublishMessage
msg
) {
public
void
.
get(
0
);
assertEquals(
ByteBufUtil
.
hexDump(expectedPayload),
ByteBufUtil
.
hexDump(msg
.
getPayload()));
}
}
Toggle all file notes
0 comments on commit
2138513
LOG
.
trace(
"
CONNACK sent, channel: {}
"
, channel);
}
catch
(
SessionCorruptedException
scex) {
LOG
.
warn(
"
"
defaultConfigFile
() {
String
configPath
=
System
.
getProperty(
"
moquette.path
"
,
null
);
return
new
File
spi.impl
.subscriptions.Subscription
;
import
io.moquette.
broker
.subscriptions.Subscription
;
import
java.util.ArrayList
;
import
java.util.Collections
;
import
java.util.LinkedList
;
import
Learn more
Accept
Reject
Save preferences
Invalid topic format, force close the connection
"
);
connection
.
dropConnection();
return
;
}
final
String
clientId
=
connection
.
getClientId();
if
(
new
ChannelInitializer<
SocketChannel
>
() {
@Override
public
void
initChannel
(
SocketChannel
ch
)
throws
Exception
{
pipelieInitializer
.
>
(d) If the Work includes a "NOTICE" text file as part of its
distribution, then any Derivative Works that You distribute must
include a readable copy of the attribution notices contained
within such NOTICE file, excluding those notices that do not
pertain to any part of the Derivative Works, in at least one
of the following places: within a NOTICE text file distributed
as part of the Derivative Works; within the Source form or
documentation, if provided along with the Derivative Works; or,
within a display generated by the Derivative Works, if and
wherever such third-party notices normally appear. The contents
of the NOTICE file are for informational purposes only and
do not modify the License. You may add Your own attribution
notices within Derivative Works that You distribute, alongside
or as an addendum to the NOTICE text from the Work, provided
that such additional attribution notices cannot be construed
as modifying the License.
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
}
}
4
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
Show comments
View file
Edit file
Delete file
add(subscription);
}
//
add the subscriptions to Session
Session
session
=
sessionRegistry
.
retrieve(clientID);
session
.
addSubscriptions(newSubscriptions);
//
send ack message
mqttConnection
.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
private
MQTTConnection
connectAs
(
String
clientId
) {
EmbeddedChannel
channel
=
new
EmbeddedChannel
();
MQTTConnection
connection
=
createMQTTConnection(
SslProvider
.
valueOf(providerName);
}
catch
(
IllegalArgumentException
e) {
LOG
.
warn(
"
unknown SSL Provider {}, falling back on JDK provider
"
, providerName);
return
SslProvider
.
# Optional G1 Settings
rem
Save CPU time on large (
>
= 16GB) heaps by delaying region scanning
rem
until the heap is 70% full. The default in Hotspot 8u40 is 40%.
rem
set JAVA_OPTS=%JAVA_OPTS% -XX:InitiatingHeapOccupancyPercent=70
rem
For systems with
>
8 cores, the default ParallelGCThreads is 5/8 the number of logical cores.
rem
Otherwise equal to the number of cores when 8 or less.
rem
Machines with
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
+1
−2
broker/src/test/java/io/moquette/broker/ConnectionTestUtils.java
+5
−6
broker/src/test/java/io/moquette/broker/MQTTConnectionConnectTest.java
+4
−5
broker/src/test/java/io/moquette/broker/MQTTConnectionPublishTest.java
+2
−2
+1
−1
+5
−6
.
fixedHeader()
.
qosLevel(), rawPayload);
storage
.
put(topic, toStore);
}
@Override
@@ -44,7 +52,15 @@ public boolean isEmpty() {
}
@Override
public
MqttPublishMessage
retainedOnTopic
(
String
topic
evaluate
(
Topic
topic
,
CNode
cnode
) {
if
(
Token
.
MULTI
.
equals(cnode
.
token)) {
return
NavigationAction
+5
−7
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
+4
−3
+2
−1
+2
−2
+2
−2
+1
−1
+1
−2
+6
−9
+1
);
@@ -167,15 +165,21 @@ public void initialize(NewNettyMQTTHandler mqttHandler, IConfig props, ISslConte
}
}
private
void
initFactory
(
String
host
,
int
port
,
String
protocol
,
final
retain
(
Topic
topic
,
MqttPublishMessage
msg
) {
storage
.
put(topic
.
toString(), msg);
final
ByteBuf
payload
=
msg
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
, clientId, channel);
abortConnection(
CONNECTION_REFUSED_SERVER_UNAVAILABLE
);
}
}
private
void
setupInflightResender
(
Channel
channel
) {
channel
.
pipeline()
.addFirst(
"
(configPath,
IConfig
.
DEFAULT_CONFIG
);
}
/**
* Starts Moquette bringing the configuration from the given file
*
*
@param
configFile text file that contains the configuration.
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
java.util.List
;
public
class
MemorySubscriptionsRepository
implements
ISubscriptionsRepository
{
2
...ver/netty/MoquetteIdleTimeoutHandler.java → ...te/broker/MoquetteIdleTimeoutHandler.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
!
authorizator
.
canWrite(topic, username, clientId)) {
LOG
.
error(
"
"
, clientId, topic);
return
;
}
publish2Subscribers(payload, topic,
AT_LEAST_ONCE
);
connection
.
init(ch);
}
})
.option(
ChannelOption
.
SO_BACKLOG
, nettySoBacklog)
.option(
ChannelOption
.
SO_REUSEADDR
, nettySoReuseaddr)
.childOption(
ChannelOption
.
TCP_NODELAY
</
span
>
<
p
>
</
li
>
</
ul
>
</
span
>
</
p
@@ -56,6 +56,7 @@
private
IAuthenticator
mockAuthenticator;
private
IAuthenticator
mockAuthenticator;
private
SessionRegistry
sessionRegistry;
private
SessionRegistry
sessionRegistry;
public
static
final
BrokerConfiguration
CONFIG
sendSubAckMessage(messageID, ackMessage);
publishRetainedMessagesForSubscriptions(clientID, newSubscriptions);
for
(
Subscription
subscription
:
newSubscriptions) {
interceptor
.
notifyTopicSubscribed(subscription, username);
}
}
private
void
publishRetainedMessagesForSubscriptions
(
String
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
CONFIG
, channel);
connection
.
processConnect(
ConnectionTestUtils
.
buildConnect(clientId));
ConnectionTestUtils
.
assertConnectAccepted(channel);
return
connection;
}
private
JDK
;
}
}
private
InputStream
jksDatastore
(
String
jksPath
)
throws
FileNotFoundException
{
URL
jksUrl
>
10 cores should try setting these to
<
= full cores.
rem
set JAVA_OPTS=%JAVA_OPTS% -XX:ParallelGCThreads=16
rem
By default, ConcGCThreads is 1/4 of ParallelGCThreads.
rem
Setting both to the same value can reduce STW durations.
rem
set JAVA_OPTS=%JAVA_OPTS% -XX:ConcGCThreads=16
rem
## GC logging options -- uncomment to enable
set
JAVA_OPTS
=
%JAVA_OPTS%
broker/src/test/java/io/moquette/broker/PostOfficeInternalPublishTest.java
+5
−6
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
+7
−9
broker/src/test/java/io/moquette/broker/PostOfficeSubscribeTest.java
+6
−7
broker/src/test/java/io/moquette/broker/PostOfficeUnsubscribeTest.java
+5
−7
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
+4
−3
+2
−1
) {
return
storage
.
get(topic);
public
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
) {
final
Topic
searchTopic
=
new
.
MATCH
;
}
if
(topic
.
isEmpty()) {
return
NavigationAction
.
STOP
;
}
final
Token
token
=
−1
+1
−1
+2
−3
+5
−5
+3
−3
+1
−1
+6
−6
+5
−5
+3
−3
+9
PipelineInitializer
pipeliner
) {
private
boolean
securityPortsConfigured
(
IConfig
props
) {
String
sslTcpPortProp
=
props
.
getProperty(
BrokerConstants
.
.
content();
byte
[] rawPayload
=
new
byte
[payload
.
readableBytes()];
payload
.
getBytes(
0
, rawPayload);
final
RetainedMessage
toStore
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
inflightResender
"
,
new
InflightResender
(
5_000
,
TimeUnit
.
MILLISECONDS
));
}
private
void
initializeKeepAliveTimeout
(
File
configFile
)
throws
IOException
{
LOG
.
info(
"
Starting Moquette integration. Configuration file path: {}
"
, configFile
.
getAbsolutePath());
IResourceLoader
*/
package
io.moquette.
server.netty
;
package
io.moquette.
broker
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
14
.../io/moquette/server/netty/NettyUtils.java → ...n/java/io/moquette/broker/NettyUtils.java
sendPubAck(messageID);
if
(retain) {
if
(
!
payload
.
isReadable()) {
retainedRepository
.
cleanRetained(topic);
}
else
{
//
before wasn't stored
retainedRepository
.
, nettyTcpNodelay)
.childOption(
ChannelOption
.
SO_KEEPALIVE
, nettySoKeepalive);
try
{
LOG
.
debug(
"
"
, host, port);
//
Bind and start to accept incoming connections.
ChannelFuture
f
=
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
You may add Your own copyright statement to Your modifications and
may provide additional or different license terms and conditions
for use, reproduction, or distribution of Your modifications, or
for any such Derivative Works as a whole, provided Your use,
reproduction, and distribution of the Work otherwise complies with
the conditions stated in this License.
</
=
new
BrokerConfiguration
(
true
,
true
,
false
);
public
static
final
BrokerConfiguration
CONFIG
=
new
BrokerConfiguration
clientID
,
List<
Subscription
>
newSubscriptions
) {
Session
targetSession
=
this
.
sessionRegistry
.
retrieve(clientID);
for
(
Subscription
subscription
void
subscribe
(
MqttQoS
topic
,
String
newsTopic
,
MQTTConnection
connection
) {
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.addSubscription(topic, newsTopic)
=
getClass()
.
getClassLoader()
.
getResource(jksPath);
if
(jksUrl
!=
null
) {
LOG
.
info(
"
"
, jksUrl
.
-XX:+PrintGCDetails
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintGCDateStamps
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintHeapAtGC
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintTenuringDistribution
set
JAVA_OPTS
=
+2
−2
+2
−2
+1
−1
+1
−2
+6
−9
+1
−1
+1
−1
+2
−3
+5
Topic
(topic);
final
List<
RetainedMessage
>
matchingMessages
=
new
ArrayList<>
();
for
(
Map
.
Entry<
Topic
,
RetainedMessage
>
topic
.
headToken();
if
(
!
(
Token
.
SINGLE
.
equals(cnode
.
token)
||
cnode
.
token
.
−9
+6
−6
+1
−1
+3
−3
+5
−6
+3
−4
+0
−57
broker/src/test/java/io/moquette/spi/impl/MockReceiverChannel.java
+0
−273
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryMatchingTest.java
+0
SSL_PORT_PROPERTY_NAME
);
String
wssPortProp
=
props
.
getProperty(
BrokerConstants
.
WSS_PORT_PROPERTY_NAME
);
return
sslTcpPortProp
!=
null
||
wssPortProp
=
new
RetainedMessage
(msg
.
fixedHeader()
.
qosLevel(), rawPayload);
storage
.
put(topic, toStore);
}
}
@Override
@Override
@@ -44,7 +52,15 @@ public boolean isEmpty() {
}
}
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
(
Channel
channel
,
MqttConnectMessage
msg
,
String
clientId
) {
int
keepAlive
=
msg
.
variableHeader()
.
keepAliveTimeSeconds();
filesystemLoader
=
new
FileResourceLoader
(configFile);
final
IConfig
config
=
new
ResourceLoaderConfig
(filesystemLoader);
startServer(config);
}
/**
* Starts the integration with the given properties.
* <
Show comments
View file
Edit file
Delete file
@@ -14,9 +14,8 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
server.netty
;
package
io.moquette.
broker
;
import
retain(topic, msg);
}
}
interceptor
.
notifyTopicPublished(msg, clientId, username);
}
private
void
publish2Subscribers
(
ByteBuf
origPayload
,
Topic
topic
,
b
.
bind(host, port);
LOG
.
info(
"
"
, host, port, protocol);
f
.
sync()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
catch
span
>
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
(
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
@Before
public
void
setUp
() {
public
void
:
newSubscriptions) {
final
String
topicFilter
=
subscription
.
getTopicFilter()
.
toString();
final
List<
RetainedMessage
>
retainedMsgs
=
.messageId(
1
)
.build();
sut
.
subscribeClientToTopics(subscribe, connection
.
getClientId(),
null
,
this
.
connection);
MqttSubAckMessage
subAck
=
((
toExternalForm(), jksUrl);
return
getClass()
.
getClassLoader()
.
getResourceAsStream(jksPath);
}
LOG
.
warn(
"
No keystore has been found in the bundled resources. Scanning filesystem...
"
);
File
jksFile
=
new
%JAVA_OPTS%
-XX:+PrintGCApplicationStoppedTime
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+PrintPromotionFailure
rem
set JAVA_OPTS=%JAVA_OPTS% -XX:PrintFLSStatistics=1
rem
set JAVA_OPTS=%JAVA_OPTS% -Xloggc:/var/log/moquette/gc.log
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+UseGCLogFileRotation
set
JAVA_OPTS
−5
+3
−3
+1
−1
+6
−6
+5
−5
+3
−3
+9
−9
+6
−6
+1
−1
entry
:
storage
.
entrySet()) {
final
Topic
scanTopic
=
entry
.
getKey();
if
(searchTopic
.
match(scanTopic)) {
matchingMessages
equals(token)
||
ROOT
.
equals(cnode
.
token))) {
return
NavigationAction
.
STOP
;
}
return
NavigationAction
.
GODEEP
;
}
−307
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryTest.java
+0
−179
broker/src/test/java/io/moquette/spi/impl/subscriptions/TopicTest.java
+1
−1
broker/src/test/java/io/moquette/testclient/RawClient.java
+2
−2
broker/src/test/resources/log4j.properties
+1
−1
distribution/build.gradle
+3
−3
distribution/src/main/resources/log4j.properties
!=
null
;
}
private
void
initFactory
(
String
host
,
int
port
,
String
protocol
,
final
@Override
@Override
public
MqttPublishMessage
retainedOnTopic
(
String
topic
) {
public
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
) {
NettyUtils
.
keepAlive(channel, keepAlive);
NettyUtils
.
cleanSession(channel, msg
.
variableHeader()
.
isCleanSession());
NettyUtils
.
clientID(channel, clientId);
int
idleTime
p
>
* Its suggested to at least have the following properties:
* <
ul
>
* <
li
>port</li>
* <
li
>password_file</li>
* </ul>
*
*
@param
io.moquette.server.Constants
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.util.Attribute
;
@@ -28,12 +27,13 @@
public
final
class
NettyUtils
{
MqttQoS
publishingQos
) {
Set<
Subscription
>
topicMatchingSubscriptions
=
subscriptions
.
matchQosSharpening(topic);
for
(
final
Subscription
sub
:
topicMatchingSubscriptions) {
(
InterruptedException
ex) {
LOG
.
error(
"
An interruptedException was caught while initializing integration. Protocol={}
"
, protocol, ex);
}
}
private
void
initializePlainTCPTransport
(
NewNettyMQTTHandler
handler
,
5. Submission of Contributions.
</
span
>
</
b
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
setUp
() {
@@ -78,8 +79,9 @@ private void prepareSUT() {
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
retainedRepository
.
retainedOnTopic(topicFilter);
if
(retainedMsgs
.
isEmpty()) {
//
not found
continue
;
}
for
(
RetainedMessage
retainedMsg
:
retainedMsgs) {
EmbeddedChannel
)
this
.
connection
.
channel)
.
readOutbound();
assertEquals(topic
.
value(), (
int
) subAck
File
(jksPath);
if
(jksFile
.
exists()) {
LOG
.
info(
"
Loading external keystore. Url = {}.
=
%JAVA_OPTS%
-XX:NumberOfGCLogFiles=
10
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
%JAVA%
-server
%JAVA_OPTS%
+3
−3
+5
−6
+3
−4
+0
−57
broker/src/test/java/io/moquette/spi/impl/MockReceiverChannel.java
+0
−273
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryMatchingTest.java
+0
−307
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryTest.java
+0
−179
.
add(entry
.
getValue());
}
}
return
matchingMessages;
}
}
21
broker/src/main/java/io/moquette/broker/PostOffice.java
Show comments
View file
Edit file
Delete file
@@ -21,6 +21,7 @@
public
Set<
Subscription
>
recursiveMatch
(
Topic
topic
) {
return
recursiveMatch(topic,
this
.
root);
}
private
Set<
Subscription
+1
−1
distribution/src/main/resources/moquette.conf
+1
−1
distribution/src/main/scripts/moquette.bat
+1
−1
distribution/src/main/scripts/moquette.sh
+4
−4
embedding_moquette/src/main/java/io/moquette/testembedded/EmbeddedLauncher.java
+1
−1
h2_storage/src/main/java/io/moquette/persistence/h2/H2MessagesStore.java
+1
−1
PipelineInitializer
pipelieInitializer
) {
LOG
.
debug(
"
Initializing server. Protocol={}
"
, protocol);
ServerBootstrap
b
=
new
ServerBootstrap
();
b
.
group(
return
storage
.
get(topic);
final
Topic
searchTopic
=
new
Topic
(topic);
final
List<
RetainedMessage
>
matchingMessages
=
new
=
Math
.
round(keepAlive
*
1.5f
);
setIdleTime(channel
.
pipeline(), idleTime);
LOG
.
debug(
"
"
,
clientId, keepAlive, msg
.
variableHeader()
configProps the properties map to use as configuration.
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
(
Properties
configProps
)
throws
IOException
{
LOG
.
debug(
"
Starting Moquette integration using properties object
public
static
final
String
ATTR_USERNAME
=
"
username
"
;
public
static
final
String
ATTR_SESSION_STOLEN
=
"
sessionStolen
MqttQoS
qos
=
lowerQosToTheSubscriptionDesired(sub, publishingQos);
Session
targetSession
=
this
.
sessionRegistry
.
retrieve(sub
.
getClientId());
boolean
isSessionPresent
=
IConfig
props
) {
LOG
.
debug(
"
Configuring TCP MQTT transport
"
);
final
MoquetteIdleTimeoutHandler
timeoutHandler
=
new
MoquetteIdleTimeoutHandler
();
String
>
Unless You explicitly state otherwise,
any Contribution intentionally submitted for inclusion in the Work
by You to the Licensor shall be under the terms and conditions of
this License, without any additional terms or conditions.
Notwithstanding the above, nothing herein shall supersede or modify
the terms of any separate license agreement you may have executed
with Licensor regarding such Contributions.
</
span
>
</
p
>
<
p
>
<
b
MemorySubscriptionsRepository
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
MemoryQueueRepository
final
MqttQoS
retainedQos
=
retainedMsg
.
qosLevel();
MqttQoS
qos
=
lowerQosToTheSubscriptionDesired(subscription, retainedQos);
//
final ByteBuf origPayload = retainedMsg.getPayload();
final
ByteBuf
payloadBuf
=
Unpooled
.
payload()
.
grantedQoSLevels()
.
get(
0
));
}
protected
void
subscribe
(
MQTTConnection
connection
,
String
topic
"
, jksFile
.
getAbsolutePath());
return
new
FileInputStream
(jksFile);
}
throw
new
FileNotFoundException
(
"
The keystore file does not exist. Url =
"
+
jksFile
%JAVA_OPTS_SCRIPT%
-Dlog4j.configuration=file:
%LOG_FILE%
-Dmoquette.path=
%MOQUETTE_PATH%
-cp
%MOQUETTE_HOME%
\lib\* io.moquette.broker.Server
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
broker/src/test/java/io/moquette/spi/impl/subscriptions/TopicTest.java
+1
−1
broker/src/test/java/io/moquette/testclient/RawClient.java
+2
−2
broker/src/test/resources/log4j.properties
+1
−1
distribution/build.gradle
+3
−3
distribution/src/main/resources/log4j.properties
+1
−1
distribution/src/main/resources/moquette.conf
+1
−1
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.Unpooled
;
import
io.netty.handler.codec.mqtt.*
;
import
org.slf4j.Logger
>
recursiveMatch
(
Topic
topic
,
INode
inode
) {
CNode
cnode
=
inode
.
mainNode();
NavigationAction
action
=
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentStore.java
+2
−2
h2_storage/src/main/java/io/moquette/persistence/h2/H2SessionsStore.java
+0
−11
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
+0
−14
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+1
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBMessagesStore.java
+1
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBPersistentStore.java
+2
m_bossGroup, m_workerGroup
)
.
channel(channelClass)
b
.
group(
bossGroup, workerGroup
)
.
channel(channelClass)
.childHandler(
new
ChannelInitializer<
SocketChannel
>
() {
ArrayList<>
();
for
(
Map
.
Entry<
Topic
,
RetainedMessage
>
entry
:
storage
.
entrySet()) {
final
Topic
scanTopic
=
.
isCleanSession(), idleTime);
}
private
void
setIdleTime
(
ChannelPipeline
pipeline
,
int
idleTime
) {
if
(pipeline
.
names()
.
"
);
final
IConfig
config
=
new
MemoryConfig
(configProps);
startServer(config);
}
/**
* Starts Moquette bringing the configuration files from the given Config implementation.
*
*
@param
config the configuration to use to start the broker.
"
;
public
static
final
String
ATTR_CHANNEL_STATUS
=
"
channelStatus
"
;
private
static
final
AttributeKey<
Object
>
ATTR_KEY_KEEPALIVE
targetSession
!=
null
;
if
(isSessionPresent) {
LOG
.
debug(
"
"
,
sub
.
getClientId(), sub
.
getTopicFilter(), qos);
//
host
=
props
.
getProperty(
BrokerConstants
.
HOST_PROPERTY_NAME
);
String
tcpPortProp
=
props
.
getProperty(
PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
>
<
span
style
="
font-size: 10pt;
"
>
6. Trademarks.
</
span
>
</
b
>
</
p
();
sessionRegistry
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry
=
new
SessionRegistry
(subscriptions,
queueRepository
);
sut
.
wrappedBuffer(retainedMsg
.
getPayload());
//
ByteBuf payload = origPayload.retainedDuplicate();
targetSession
.
sendRetainedPublishOnSessionAtQos(subscription
.
getTopicFilter(), qos, payloadBuf);
}
}
}
/**
* Create the SUBACK response from a list of topicFilters
*/
,
MqttQoS
desiredQos
) {
EmbeddedChannel
channel
=
(
EmbeddedChannel
) connection
.
channel;
MqttSubscribeMessage
subscribe
=
MqttMessageBuilders
.
subscribe()
.
getAbsolutePath());
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
distribution/src/main/scripts/moquette.bat
+1
−1
distribution/src/main/scripts/moquette.sh
+4
−4
embedding_moquette/src/main/java/io/moquette/testembedded/EmbeddedLauncher.java
+1
−1
h2_storage/src/main/java/io/moquette/persistence/h2/H2MessagesStore.java
+1
−1
h2_storage/src/main/java/io/moquette/persistence/h2/H2PersistentStore.java
+2
−2
h2_storage/src/main/java/io/moquette/persistence/h2/H2SessionsStore.java
;
import
org.slf4j.LoggerFactory
;
@@ -99,19 +100,21 @@ private void publishRetainedMessagesForSubscriptions(String clientID, List<Subsc
Session
targetSession
=
this
.
sessionRegistry
.
retrieve(clientID);
for
(
Subscription
subscription
:
evaluate(topic, cnode);
if
(action
==
NavigationAction
.
MATCH
) {
return
cnode
.
subscriptions;
}
if
(action
==
NavigationAction
−2
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBSessionsStore.java
+0
−18
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBPersistentStoreTest.java
+0
−14
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBSessionsStoreTest.java
6
broker/src/main/java/io/moquette/broker/Authorizator.java
Show comments
View file
Edit file
Delete file
@@ -15,8 +15,8 @@
*/
@Override
public
void
initChannel
(
SocketChannel
ch
)
throws
Exception
{
pipeliner
.
init(ch);
pipelieInitializer
.
init(ch);
}
entry
.
getKey();
if
(searchTopic
.
match(scanTopic)) {
matchingMessages
.
add(entry
.
getValue());
}
}
return
matchingMessages;
}
contains(
"
idleStateHandler
"
)) {
pipeline
.
remove(
"
idleStateHandler
"
);
}
pipeline
.
addFirst(
"
*
@throws
IOException in case of any IO Error.
*/
public
void
startServer
(
IConfig
config
)
throws
IOException
{
LOG
.
debug(
"
=
AttributeKey
.
valueOf(
Constants
.
KEEP_ALIVE
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLEANSESSION
=
AttributeKey
TODO determine the user bounded to targetSession
if
(
!
authorizator
.
canRead(topic,
"
TODO
"
, sub
.
getClientId())) {
LOG
.
debug(
"
);
if
(
DISABLED_PORT_BIND
.
equals(tcpPortProp)) {
LOG
.
info(
"
"
,
BrokerConstants
.
PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
This License does not grant permission to use the trade
names, trademarks, service marks, or product names of the Licensor,
except as required for reasonable and customary use in describing the
origin of the Work and reproducing the content of the NOTICE file.
</
span
>
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
new
MemoryRetainedRepository
(),
sut
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
private
MqttSubAckMessage
doAckMessageFromValidateFilters
(
List<
MqttTopicSubscription
>
topicFilters
,
int
messageId
) {
List<
Integer
>
grantedQoSLevels
=
new
.addSubscription(desiredQos, topic)
.messageId(
1
)
.build();
sut
.
subscribeClientToTopics(subscribe, connection
.
getClientId(),
null
, connection);
MqttSubAckMessage
subAck
=
channel
.
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
+0
−11
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
+0
−14
h2_storage/src/test/java/io/moquette/persistence/h2/H2SessionsStoreTest.java
+1
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBMessagesStore.java
+1
−1
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBPersistentStore.java
+2
−2
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBSessionsStore.java
+0
newSubscriptions) {
final
String
topicFilter
=
subscription
.
getTopicFilter()
.
toString();
final
MqttPublishMessage
retainedMsg
=
retainedRepository
.
retainedOnTopic(topicFilter);
final
List<
.
STOP
) {
return
Collections
.
emptySet();
}
if
(cnode
instanceof
TNode
) {
return
Collections
.
emptySet();
*/
package
io.moquette.broker
;
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Topic
;
import
io.moquette.
broker
.subscriptions.Topic
;
})
.option(
ChannelOption
.
SO_BACKLOG
, nettySoBacklog)
@@ -200,7 +204,7 @@ private void initializePlainTCPTransport(NewNettyMQTTHandler handler, IConfig pr
String
tcpPortProp
=
props
.
getProperty(
PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
}
}
}
21
broker/src/main/java/io/moquette/broker/PostOffice.java
Show comments
View file
Edit file
Delete file
@@ -21,6 +21,7 @@
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.subscriptions.Topic
;
import
idleStateHandler
"
,
new
IdleStateHandler
(idleTime,
0
,
0
));
}
private
boolean
isNotProtocolVersion
(
MqttConnectMessage
msg
,
MqttVersion
Starting Moquette integration using IConfig instance
"
);
startServer(config,
null
);
}
/**
* Starts Moquette with config provided by an implementation of IConfig class and with the set
* of InterceptHandler.
*
*
@param
config the configuration to use to start the broker.
*
@param
handlers the handlers to install in the broker.
*
@throws
.
valueOf(
Constants
.
CLEAN_SESSION
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLIENTID
=
AttributeKey
.
valueOf(
Constants
"
, sub
.
getClientId(), topic);
return
;
}
//
we need to retain because duplicate only copy r/w indexes and don't retain() causing refCnt = 0
ByteBuf
payload
=
origPayload
.
retainedDuplicate();
targetSession
.
return
;
}
int
port
=
Integer
.
parseInt(tcpPortProp);
initFactory(host, port,
"
TCP MQTT
"
,
new
PipelineInitializer
() {
</
p
>
<
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
7. Disclaimer of Warranty.
</
new
MemoryRetainedRepository
(),
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sessionRegistry,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
}
}
4
broker/src/test/java/io/moquette/broker/SessionRegistryTest.java
Show comments
View file
ArrayList<>
();
for
(
MqttTopicSubscription
req
:
topicFilters) {
grantedQoSLevels
.
add(req
.
qualityOfService()
.
value());
}
MqttFixedHeader
fixedHeader
readOutbound();
assertEquals(desiredQos
.
value(), (
int
) subAck
.
payload()
.
grantedQoSLevels()
.
get(
0
));
final
String
clientId
=
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
−18
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBPersistentStoreTest.java
+0
−14
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBSessionsStoreTest.java
6
broker/src/main/java/io/moquette/broker/Authorizator.java
Show comments
View file
Edit file
Delete file
@@ -15,8 +15,8 @@
*/
package
io.moquette.broker
;
RetainedMessage
>
retainedMsgs
=
retainedRepository
.
retainedOnTopic(topicFilter);
if
(
retainedMsg
==
null
) {
if
(
retainedMsgs
}
Topic
remainingTopic
=
(
ROOT
.
equals(cnode
.
token))
?
topic
:
topic
.
exceptHeadToken();
Set<
Subscription
>
import
io.moquette.
spi
.security.IAuthorizatorPolicy
;
import
io.moquette.
broker
.security.IAuthorizatorPolicy
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
io.netty.handler.codec.mqtt.MqttSubscribeMessage
if
(
DISABLED_PORT_BIND
.
equals(tcpPortProp)) {
LOG
.
info(
"
"
,
BrokerConstants
.
PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
DISABLED_PORT_BIND
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.Unpooled
;
import
io.netty.handler.codec.mqtt.*
version
) {
return
msg
.
variableHeader()
.
version()
!=
version
.
protocolLevel();
}
private
void
abortConnection
(
MqttConnectReturnCode
IOException in case of any IO Error.
*/
public
void
startServer
(
IConfig
config
,
List<? extends
InterceptHandler
>
handlers
)
throws
IOException
{
LOG
.
.
ATTR_CLIENTID
);
private
static
final
String
ATTR_CLIENTID
=
"
ClientID
"
;
private
static
final
String
CLEAN_SESSION
sendPublishOnSessionAtQos(topic, qos, payload);
}
else
{
//
If we are, the subscriber disconnected after the subscriptions tree selected that session as a
//
destination.
LOG
.
debug(
"
"
, sub
.
getClientId(),
sub
.
@Override
void
init
(
SocketChannel
channel
) {
ChannelPipeline
pipeline
=
channel
.
pipeline();
configureMQTTPipeline(pipeline, timeoutHandler, handler);
}
});
}
span
>
</
b
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
Edit file
Delete file
@@ -47,6 +47,7 @@
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
MqttMessageBuilders
.
ConnectBuilder
connMsg;
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZEROBYTE_CLIENT_ID
=
new
MqttFixedHeader
(
MqttMessageType
.
SUBACK
,
false
,
AT_MOST_ONCE
,
false
,
0
);
MqttSubAckPayload
payload
connection
.
getClientId();
Subscription
expectedSubscription
=
new
Subscription
(clientId,
new
Topic
(topic), desiredQos);
final
Set<
Subscription
>
matchedSubscriptions
=
Learn more
Accept
Reject
Save preferences
import
io.moquette.
spi.impl
.subscriptions.Topic
;
import
io.moquette.
spi
.security.IAuthorizatorPolicy
;
import
io.moquette.
broker
.subscriptions.Topic
;
import
io.moquette.
.
isEmpty()
) {
//
not found
continue
;
}
final
MqttQoS
retainedQos
=
retainedMsg
.
fixedHeader()
.
qosLevel();
MqttQoS
subscriptions
=
new
HashSet<>
();
if
(remainingTopic
.
isEmpty()) {
subscriptions
.
addAll(cnode
.
subscriptions);
}
for
(
INode
;
import
io.netty.handler.codec.mqtt.MqttSubscribeMessage
;
import
io.netty.handler.codec.mqtt.MqttTopicSubscription
;
import
io.netty.handler.codec.mqtt.MqttTopicSubscription
;
@@ -26,7 +26,7 @@
import
java.util.ArrayList
;
import
java.util.ArrayList
;
import
);
return
;
}
int
port
=
Integer
.
parseInt(tcpPortProp);
@@ -209,33 +213,38 @@ private void initializePlainTCPTransport(NewNettyMQTTHandler handler, IConfig pr
@Override
void
init
(
SocketChannel
channel
;
import
io.netty.handler.codec.mqtt.*
;
import
org.slf4j.Logger
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
org.slf4j.LoggerFactory
;
@@ -99,19 +100,21 @@ private void publishRetainedMessagesForSubscriptions(String clientID, List<Subsc
Session
targetSession
returnCode
) {
MqttConnAckMessage
badProto
=
connAck(returnCode,
false
);
channel
.
writeAndFlush(badProto)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
channel
.
close()
debug(
"
Starting moquette integration using IConfig instance and intercept handlers
"
);
startServer(config, handlers,
null
,
null
,
null
);
}
public
void
startServer
(
IConfig
config
=
"
removeTemporaryQoS2
"
;
private
static
final
String
KEEP_ALIVE
=
"
keepAlive
"
;
private
static
final
AttributeKey<
getTopicFilter(), qos);
}
}
}
/**
* First phase of a publish QoS2 protocol, sent by publisher to the broker. Publish to all interested
* subscribers.
*/
void
receivedPublishQos2
(
MQTTConnection
connection
,
MqttPublishMessage
mqttPublishMessage
,
String
private
void
configureMQTTPipeline
(
ChannelPipeline
pipeline
,
MoquetteIdleTimeoutHandler
timeoutHandler
,
NewNettyMQTTHandler
handler
) {
pipeline
.
addFirst(
"
idleStateHandler
>
Unless required by applicable law or
agreed to in writing, Licensor provides the Work (and each
Contributor provides its Contributions) on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied, including, without limitation, any warranties or conditions
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any
risks associated with Your exercise of permissions under this License.
</
span
>
</
p
>
<
=
private
static
final
BrokerConfiguration
ALLOW_ANONYMOUS_AND_ZEROBYTE_CLIENT_ID
=
new
BrokerConfiguration
(
true
,
true
,
false
);
new
BrokerConfiguration
=
new
MqttSubAckPayload
(grantedQoSLevels);
return
new
MqttSubAckMessage
(fixedHeader, from(messageId), payload);
}
public
void
unsubscribe
(
List<
String
subscriptions
.
matchWithoutQosSharpening(
new
Topic
(topic));
assertEquals(
1
, matchedSubscriptions
.
size());
broker
.security.IAuthorizatorPolicy
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
io.netty.handler.codec.mqtt.MqttSubscribeMessage
;
import
io.netty.handler.codec.mqtt.MqttTopicSubscription
qos
=
lowerQosToTheSubscriptionDesired(subscription, retainedQos);
final
ByteBuf
origPayload
=
retainedMsg
.
payload();
ByteBuf
payload
=
origPayload
.
retainedDuplicate();
targetSession
subInode
:
cnode
.
allChildren()) {
subscriptions
.
addAll(recursiveMatch(remainingTopic, subInode));
}
return
subscriptions;
}
public
void
addToTree
(
Subscription
newSubscription
java.util.List
;
import
java.util.List
;
import static
io.moquette.
spi.impl
.Utils.messageId
;
import static
io.moquette.
broker
.Utils.messageId
;
import static
io.netty.handler.codec.mqtt.MqttQoS.FAILURE
;
) {
ChannelPipeline
pipeline
=
channel
.
pipeline();
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
=
this
.
sessionRegistry
.
retrieve(clientID);
Session
targetSession
=
this
.
sessionRegistry
.
retrieve(clientID);
for
(
Subscription
subscription
:
.
addListener(
CLOSE_ON_FAILURE
);
}
private
MqttConnAckMessage
connAck
(
MqttConnectReturnCode
returnCode
,
boolean
sessionPresent
) {
MqttFixedHeader
mqttFixedHeader
=
new
,
List<? extends
InterceptHandler
>
handlers
,
ISslContextCreator
sslCtxCreator
,
IAuthenticator
authenticator
,
IAuthorizatorPolicy
authorizatorPolicy
)
throws
IOException
{
Object
>
ATTR_KEY_KEEPALIVE
=
AttributeKey
.
valueOf(
KEEP_ALIVE
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLEANSESSION
=
AttributeKey
username
) {
LOG
.
trace(
"
Processing PUBREL message on connection: {}
"
, connection);
final
Topic
topic
=
new
Topic
(mqttPublishMessage
.
variableHeader()
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
));
pipeline
.
addAfter(
"
idleStateHandler
"
,
"
idleEventHandler
"
p
>
<
b
>
<
span
style
="
font-size: 10pt;
"
>
8. Limitation of Liability.
</
span
>
</
b
>
</
(
true
,
true
,
false
);
private
MemoryQueueRepository
queueRepository;
@Before
@Before
public
void
setUp
() {
public
void
setUp
>
topics
,
MQTTConnection
mqttConnection
,
int
messageId
) {
final
String
clientID
=
mqttConnection
.
getClientId();
for
(
String
final
Subscription
onlyMatchedSubscription
=
matchedSubscriptions
.
iterator()
.
next();
assertEquals(expectedSubscription, onlyMatchedSubscription);
}
@Test
public
void
testPublishToMultipleSubscribers
() {
final
Set<
;
@@ -26,7 +26,7 @@
import
java.util.ArrayList
;
import
java.util.List
;
import static
io.moquette.
spi.impl
.Utils.messageId
;
import static
io.moquette.
broker
.Utils.messageId
;
.
sendRetainedPublishOnSessionAtQos(subscription
.
getTopicFilter(), qos, payload);
for
(
RetainedMessage
retainedMsg
:
retainedMsgs) {
final
MqttQoS
retainedQos
=
retainedMsg
.
qosLevel();
) {
Action
res;
do
{
res
=
insert(newSubscription
.
topicFilter,
this
.
root, newSubscription);
}
while
import static
io.netty.handler.codec.mqtt.MqttQoS.FAILURE
;
final
class
Authorizator
{
final
class
Authorizator
{
2
...quette/server/netty/AutoFlushHandler.java → .../io/moquette/broker/AutoFlushHandler.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
0
));
pipeline
.
addAfter(
"
idleStateHandler
"
,
"
idleEventHandler
"
, timeoutHandler);
//
pipeline.addLast("logger", new LoggingHandler("Netty", LogLevel.ERROR));
if
(errorsCather
newSubscriptions) {
for
(
Subscription
subscription
:
newSubscriptions) {
final
String
topicFilter
=
subscription
.
getTopicFilter()
.
toString();
final
String
MqttFixedHeader
(
MqttMessageType
.
CONNACK
,
false
,
MqttQoS
.
AT_MOST_ONCE
,
false
,
0
);
MqttConnAckVariableHeader
mqttConnAckVariableHeader
final
long
start
=
System
.
currentTimeMillis();
if
(handlers
==
null
) {
handlers
=
Collections
.
emptyList();
.
valueOf(
CLEAN_SESSION
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLIENTID
=
AttributeKey
.
valueOf(
.
topicName());
final
ByteBuf
payload
=
mqttPublishMessage
.
payload();
final
String
clientId
=
connection
.
getClientId();
if
(
!
, timeoutHandler);
//
pipeline.addLast("logger", new LoggingHandler("Netty", LogLevel.ERROR));
if
(errorsCather
.
isPresent()) {
pipeline
.
addLast(
"
bugsnagCatcher
"
, errorsCather
.
get());
}
pipeline
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
In no event and under no legal theory,
whether in tort (including negligence), contract, or otherwise,
unless required by applicable law (such as deliberate and grossly
negligent acts) or agreed to in writing, shall any Contributor be
liable to You for damages, including any direct, indirect, special,
incidental, or consequential damages of any character arising as a
() {
@@ -67,8 +68,9 @@ private MQTTConnection createMQTTConnection(BrokerConfiguration config, Channel
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsRepository
subscriptionsRepository
=
new
t
:
topics) {
Topic
topic
=
new
Topic
(t);
boolean
validTopic
=
topic
.
isValid();
if
(
!
String
>
clientIds
=
new
HashSet<>
(
Arrays
.
asList(
FAKE_CLIENT_ID
,
FAKE_CLIENT_ID2
));
mockAuthenticator
=
new
MockAuthenticator
(clientIds, singletonMap(
import static
io.netty.handler.codec.mqtt.MqttQoS.FAILURE
;
final
class
Authorizator
{
2
...quette/server/netty/AutoFlushHandler.java → .../io/moquette/broker/AutoFlushHandler.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
MqttQoS
qos
=
lowerQosToTheSubscriptionDesired(subscription, retainedQos);
//
final ByteBuf origPayload = retainedMsg.getPayload();
final
ByteBuf
payloadBuf
=
Unpooled
.
wrappedBuffer(retainedMsg
.
getPayload());
//
ByteBuf payload = origPayload.retainedDuplicate();
targetSession
(res
==
Action
.
REPEAT
);
}
private
Action
insert
(
Topic
topic
,
final
INode
inode
,
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.
server.netty
;
package
io.moquette.
broker
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelDuplexHandler
.
isPresent()) {
pipeline
.
addLast(
"
bugsnagCatcher
"
, errorsCather
.
get());
}
pipeline
.
addFirst(
"
bytemetrics
"
topicFilter
=
subscription
.
getTopicFilter()
.
toString();
final
MqttPublishMessage
retainedMsg
=
retainedRepository
.
retainedOnTopic(topicFilter);
final
List<
RetainedMessage
>
=
new
MqttConnAckVariableHeader
(returnCode, sessionPresent);
return
new
MqttConnAckMessage
(mqttFixedHeader, mqttConnAckVariableHeader);
}
private
boolean
login
(
MqttConnectMessage
msg
,
final
String
}
LOG
.
trace(
"
Starting Moquette Server. MQTT message interceptors={}
"
, getInterceptorIds(handlers));
scheduler
=
Executors
.
newScheduledThreadPool(
1
);
final
String
handlerProp
=
ATTR_CLIENTID
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_USERNAME
=
AttributeKey
.
valueOf(
ATTR_USERNAME
);
public
static
authorizator
.
canWrite(topic, username, clientId)) {
LOG
.
error(
"
"
, clientId, topic);
return
;
}
publish2Subscribers(payload, topic,
EXACTLY_ONCE
);
final
boolean
retained
=
.
addFirst(
"
bytemetrics
"
,
new
BytesMetricsHandler
(bytesMetricsCollector));
pipeline
.
addLast(
"
autoflush
"
,
new
AutoFlushHandler
result of this License or out of the use or inability to use the
Work (including but not limited to damages for loss of goodwill,
other commercial damages or losses), even if such Contributor
has been advised of the possibility of such damages.
</
span
>
</
p
>
<
p
>
<
b
>
<
MemorySubscriptionsRepository
();
ISubscriptionsRepository
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptions
.
init(subscriptionsRepository);
subscriptions
.
init(subscriptionsRepository);
queueRepository
=
new
validTopic) {
//
close the connection, not valid topicFilter is a protocol violation
mqttConnection
.
dropConnection();
LOG
.
warn(
"
"
, clientID,
topics, topic);
return
;
}
LOG
.
TEST_USER
,
TEST_PWD
));
EmbeddedChannel
channel1
=
new
EmbeddedChannel
();
MQTTConnection
connection1
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, channel1);
connection1
.
processConnect(
server.netty
;
package
io.moquette.
broker
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandlerContext
;
2
broker/src/main/java/io/moquette/broker/BrokerConfiguration.java
Show comments
View file
.
sendRetainedPublishOnSessionAtQos(subscription
.
getTopicFilter(), qos, payloadBuf);
}
}
}
24
broker/src/main/java/io/moquette/broker/RetainedMessage.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,24 @@
package
io.moquette.broker
;
Subscription
newSubscription
) {
Token
token
=
topic
.
headToken();
if
(
!
topic
.
isEmpty()
&&
inode
.
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelHandlerContext
;
2
broker/src/main/java/io/moquette/broker/BrokerConfiguration.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,7 @@
package
io.moquette.broker
;
,
new
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
autoflush
"
,
new
AutoFlushHandler
(
1
,
TimeUnit
.
retainedMsgs
=
retainedRepository
.
retainedOnTopic(topicFilter);
if
(
retainedMsg
==
null
) {
if
(
retainedMsgs
.
isEmpty()
) {
//
clientId
) {
//
handle user authentication
if
(msg
.
variableHeader()
.
hasUserName()) {
byte
[] pwd
=
null
;
if
(msg
.
System
.
getProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
);
if
(handlerProp
!=
null
) {
config
.
setProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
Object
getAttribute
(
ChannelHandlerContext
ctx
,
AttributeKey<
Object
>
key
) {
14
broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java
Show comments
View file
Edit file
Delete file
@@ -17,12 +17,8 @@
mqttPublishMessage
.
fixedHeader()
.
isRetain();
if
(retained) {
if
(
!
payload
.
isReadable()) {
retainedRepository
.
cleanRetained(topic);
}
else
{
(
1
,
TimeUnit
.
SECONDS
));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
(maxBytesInMessage));
span
style
="
font-size: 10pt;
"
>
9. Accepting Warranty or Additional Liability.
</
span
>
</
b
>
</
p
>
<
p
MemoryQueueRepository
();
sut
=
new
SessionRegistry
(subscriptions,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
sut
=
new
SessionRegistry
(subscriptions,
queueRepository
);
trace(
"
"
, clientID, topic);
subscriptions
.
removeSubscription(topic, clientID);
//
TODO remove the subscriptions to Session
//
clientSession.unsubscribeFrom(topic);
String
username
=
NettyUtils
.
userName(mqttConnection
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID
));
ConnectionTestUtils
.
assertConnectAccepted(channel1);
EmbeddedChannel
channel2
=
new
EmbeddedChannel
();
MQTTConnection
connection2
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
Edit file
Delete file
@@ -16,7 +16,7 @@
package
io.moquette.broker
;
import
io.moquette.BrokerConstants
;
import
io.moquette.
server
.config.IConfig
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
java.io.Serializable
;
public
class
RetainedMessage
implements
Serializable
{
private
mainNode()
.
anyChildrenMatch(token)) {
Topic
remainingTopic
=
topic
.
exceptHeadToken();
INode
nextInode
=
inode
.
mainNode()
.
childOf(token);
return
package
io.moquette.broker
;
import
io.moquette.BrokerConstants
;
import
io.moquette.BrokerConstants
;
import
io.moquette.
server
.config.IConfig
;
import
io.moquette.
SECONDS
));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
"
,
not found
//
not found
continue
;
continue
;
}
}
for
(
RetainedMessage
retainedMsg
:
retainedMsgs) {
final
MqttQoS
retainedQos
variableHeader()
.
hasPassword()) {
pwd
=
msg
.
payload()
.
password()
.
getBytes(
StandardCharsets
.
UTF_8
);
}
else
if
, handlerProp);
}
final
String
persistencePath
=
config
.
getProperty(
BrokerConstants
.
PERSISTENT_STORE_PROPERTY_NAME
);
LOG
.
debug(
"
Configuring Using persistent store file, path: {}
"
package
io.moquette.broker
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.server.netty.AutoFlushHandler
;
import
io.moquette.server.netty.BugSnagErrorsHandler
;
import
//
before wasn't stored
retainedRepository
.
retain(topic, mqttPublishMessage);
}
}
String
clientID
=
connection
.
getClientId();
interceptor
.
notifyTopicPublished(mqttPublishMessage, clientID, username);
}
static
pipeline
.
addLast(
"
encoder
"
,
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
"
,
>
<
span
style
="
font-size: 10pt;
"
>
While redistributing
the Work or Derivative Works thereof, You may choose to offer,
and charge a fee for, acceptance of support, warranty, indemnity,
or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only
on Your own behalf and on Your sole responsibility, not on behalf
of any other Contributor, and only if You agree to indemnify,
defend, and hold each Contributor harmless for any liability
incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.
</
final
PostOffice
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
(),
final
PostOffice
postOffice
=
new
PostOffice
(subscriptions,
new
PermitAllAuthorizatorPolicy
.
channel);
interceptor
.
notifyTopicUnsubscribed(topic
.
toString(), clientID, username);
}
//
ack the client
mqttConnection
.
sendUnsubAckMessage(topics, clientID, messageId);
}
void
receivedPublishQos0
(
Topic
, channel2);
connection2
.
processConnect(
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID2
));
ConnectionTestUtils
.
assertConnectAccepted(channel2);
//
subscribe
final
MqttQoS
qos
import
io.moquette.
broker
.config.IConfig
;
class
BrokerConfiguration
{
4
...te/server/netty/BugSnagErrorsHandler.java → ...moquette/broker/BugSnagErrorsHandler.java
Show comments
View file
Edit file
Delete file
@@ -13,10 +13,10 @@
*
final
MqttQoS
qos;
private
final
byte
[] payload;
public
RetainedMessage
(
MqttQoS
qos
,
byte
[]
payload
) {
insert(remainingTopic, nextInode, newSubscription);
}
else
{
if
(topic
.
isEmpty()) {
return
insertSubscription(inode, newSubscription);
}
else
{
return
createNodeAndInsertSubscription(topic, inode, newSubscription);
}
}
}
broker
.config.IConfig
;
class
BrokerConfiguration
{
class
BrokerConfiguration
{
4
...te/server/netty/BugSnagErrorsHandler.java → ...moquette/broker/BugSnagErrorsHandler.java
Show comments
View file
Edit file
Delete file
@@ -13,10 +13,10 @@
*
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
=
retainedMsg
.
fixedHeader()
.
qosLevel();
final
MqttQoS
retainedQos
=
retainedMsg
.
qosLevel();
MqttQoS
qos
=
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error(
"
Client didn't supply any password and MQTT anonymous mode is disabled CId={}
"
, clientId);
return
false
;
}
final
String
login
, persistencePath);
initInterceptors(config, handlers);
LOG
.
debug(
"
Initialized MQTT protocol processor
"
);
if
(sslCtxCreator
==
null
) {
LOG
.
info(
"
Using default SSL context creator
io.moquette.server.netty.MoquetteIdleTimeoutHandler
;
import
io.moquette.server.netty.metrics.*
;
import
io.moquette.spi.security.ISslContextCreator
;
import
io.moquette.broker.config.IConfig
;
import
io.moquette.broker.metrics.*
;
import
io.netty.bootstrap.ServerBootstrap
;
import
MqttQoS
lowerQosToTheSubscriptionDesired
(
Subscription
sub
,
MqttQoS
qos
) {
if
(qos
.
value()
>
sub
.
getRequestedQos()
.
value()) {
new
MessageMetricsHandler
(metricsCollector));
pipeline
.
addLast(
"
messageLogger
"
,
new
MQTTMessageLogger
());
if
(metrics
.
isPresent()) {
pipeline
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
END OF TERMS AND CONDITIONS
</
(),
new
MemoryRetainedRepository
(), sut,
new
MemoryRetainedRepository
(), sut,
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
ConnectionTestUtils
.
NO_OBSERVERS_INTERCEPTOR
);
2
...persistence/h2/H2PersistentQueueTest.java → ...te/persistence/H2PersistentQueueTest.java
Show comments
topic
,
String
username
,
String
clientID
,
ByteBuf
payload
,
boolean
retain
,
MqttPublishMessage
msg
) {
if
(
=
AT_MOST_ONCE
;
final
String
newsTopic
=
NEWS_TOPIC
;
subscribe(qos, newsTopic, connection1);
subscribe(qos, newsTopic, connection2);
//
Exercise
final
ByteBuf
payload
=
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
server.netty
;
package
io.moquette.
broker
;
import
com.bugsnag.Bugsnag
;
import
io.moquette.
server
.config.IConfig
;
import
this
.
qos
=
qos;
this
.
payload
=
payload;
}
public
MqttQoS
qosLevel
() {
return
qos;
}
private
Action
insertSubscription
(
INode
inode
,
Subscription
newSubscription
) {
CNode
cnode
=
inode
.
mainNode();
CNode
updatedCnode
=
*
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.
server.netty
;
package
io.moquette.
broker
;
import
com.bugsnag.Bugsnag
;
import
com.bugsnag.Bugsnag
;
"
,
new
MQTTMessageLogger
());
if
(metrics
.
isPresent()) {
pipeline
.
addLast(
"
wizardMetrics
"
, metrics
.
get());
lowerQosToTheSubscriptionDesired(subscription, retainedQos);
MqttQoS
qos
=
lowerQosToTheSubscriptionDesired(subscription, retainedQos);
final
ByteBuf
origPayload
=
retainedMsg
.
payload();
//
final ByteBuf origPayload = retainedMsg.getPayload();
ByteBuf
payload
=
=
msg
.
payload()
.
userName();
if
(
!
authenticator
.
checkValid(clientId, login, pwd)) {
LOG
.
error(
"
"
, clientId, login);
return
"
);
sslCtxCreator
=
new
DefaultMoquetteSslContextCreator
(config);
}
authenticator
=
initializeAuthenticator(authenticator, config);
authorizatorPolicy
=
initializeAuthorizatorPolicy(authorizatorPolicy, config);
final
ISubscriptionsRepository
subscriptionsRepository;
io.netty.buffer.ByteBuf
;
import
io.netty.channel.*
;
@@ -172,7 +168,7 @@ private boolean securityPortsConfigured(IConfig props) {
}
private
void
initFactory
qos
=
sub
.
getRequestedQos();
}
return
qos;
}
/**
* Intended usage is only for embedded versions of the broker, where the hosting application
.
addLast(
"
wizardMetrics
"
, metrics
.
get());
}
pipeline
.
addLast(
"
handler
"
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
APPENDIX: How to apply the Apache License to your work.
</
span
View file
Edit file
Delete file
@@ -13,7 +13,7 @@
*
*
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.persistence
.h2
;
package
io.moquette.persistence
;
!
authorizator
.
canWrite(topic, username, clientID)) {
LOG
.
error(
"
"
, clientID, topic);
return
;
}
publish2Subscribers(payload, topic,
AT_MOST_ONCE
);
if
(retain) {
//
Unpooled
.
copiedBuffer(
"
Hello world!
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
io.moquette.
broker
.config.IConfig
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelInboundHandlerAdapter
;
2
public
byte
[]
getPayload
() {
return
payload;
}
}
5
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -162,21 +162,24 @@ public void startServer(IConfig config, List<? extends InterceptHandler> handler
final
cnode
.
copy()
.
addSubscription(newSubscription);
if
(inode
.
compareAndSet(cnode, updatedCnode)) {
return
Action
.
OK
;
}
else
{
return
import
io.moquette.
server
.config.IConfig
;
import
io.moquette.
broker
.config.IConfig
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.channel.ChannelHandlerContext
}
pipeline
.
addLast(
"
handler
"
, handler);
configureMQTTPipeline(pipeline, timeoutHandler, handler);
}
});
}
private
void
configureMQTTPipeline
(
ChannelPipeline
origPayload
.
retainedDuplicate();
final
ByteBuf
payloadBuf
=
Unpooled
.
wrappedBuffer(retainedMsg
.
getPayload());
targetSession
.
sendRetainedPublishOnSessionAtQos(subscription
.
getTopicFilter(), qos, payload);
//
false
;
}
NettyUtils
.
userName(channel, login);
}
else
if
(
!
brokerConfig
.
isAllowAnonymous()) {
LOG
.
error(
"
final
IQueueRepository
queueRepository;
final
IRetainedRepository
retainedRepository;
if
(persistencePath
!=
null
&&
!
persistencePath
.
isEmpty()) {
LOG
.
(
String
host
,
int
port
,
String
protocol
,
final
PipelineInitializer
pipelieInitializer
) {
LOG
.
* want to use the broker to send a publish message. Like normal external publish message but
* with some changes to avoid security check, and the handshake phases for Qos1 and Qos2. It
* also doesn't notifyTopicPublished because using internally the owner should already know
* where it's publishing.
*
*
@param
msg
* the message to publish
*/
public
void
internalPublish
(
MqttPublishMessage
msg
) {
, handler);
}
private
void
initializeWebSocketTransport
(
final
NewNettyMQTTHandler
handler
,
IConfig
props
) {
LOG
.
debug(
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets "[]"
replaced with your own identifying information. (Don't include
import
io.moquette.BrokerConstants
;
import
io.moquette.BrokerConstants
;
import
org.h2.mvstore.MVStore
;
import
org.h2.mvstore.MVStore
;
2
distribution/build.gradle
Show comments
View file
QoS == 0 && retain => clean old retained
retainedRepository
.
cleanRetained(topic);
}
interceptor
.
notifyTopicPublished(msg, clientID, username);
}
void
receivedPublishQos1
(
MQTTConnection
connection
,
Topic
,
FAKE_CLIENT_ID
, payload,
false
,
MqttMessageBuilders
.
publish()
.payload(payload
.
retainedDuplicate())
.qos(
MqttQoS
.
AT_MOST_ONCE
...java/io/moquette/spi/impl/DebugUtils.java → ...n/java/io/moquette/broker/DebugUtils.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
spi.impl
;
package
io.moquette.
broker
;
import
ISubscriptionsRepository
subscriptionsRepository;
final
IQueueRepository
queueRepository;
final
IRetainedRepository
retainedRepository;
if
(persistencePath
!=
null
&&
!
persistencePath
.
isEmpty()) {
LOG
Action
.
REPEAT
;
}
}
private
Action
createNodeAndInsertSubscription
(
Topic
topic
,
INode
inode
,
Subscription
newSubscription
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelInboundHandlerAdapter
;
import
io.netty.channel.ChannelInboundHandlerAdapter
;
2
...java/io/moquette/spi/impl/DebugUtils.java → ...n/java/io/moquette/broker/DebugUtils.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
pipeline
,
MoquetteIdleTimeoutHandler
timeoutHandler
,
NewNettyMQTTHandler
handler
) {
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
ByteBuf payload = origPayload.retainedDuplicate();
targetSession
.
sendRetainedPublishOnSessionAtQos(subscription
.
getTopicFilter(), qos, payloadBuf);
}
}
}
}
}
24
broker/src/main/java/io/moquette/broker/RetainedMessage.java
Show comments
View file
Edit file
Delete file
Client didn't supply any credentials and MQTT anonymous mode is disabled. CId={}
"
, clientId);
return
false
;
}
return
true
;
}
void
handleConnectionLost
() {
String
clientID
=
NettyUtils
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
h2Builder
=
new
H2Builder
(config, scheduler)
.
initStore();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
queueRepository
=
debug(
"
Initializing
server
. Protocol={}
"
, protocol);
LOG
.
debug(
"
Initializing
integration
. Protocol={}
"
, protocol);
ServerBootstrap
final
MqttQoS
qos
=
msg
.
fixedHeader()
.
qosLevel();
final
Topic
topic
=
new
Topic
(msg
.
variableHeader()
"
Configuring Websocket MQTT transport
"
);
String
webSocketPortProp
=
props
.
getProperty(
WEB_SOCKET_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
if
(
DISABLED_PORT_BIND
.
the brackets!) The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
file or class name and description of purpose be included on the
same "printed page" as the copyright notice for easier
identification within third-party archives.
</
span
>
</
p
>
<
p
>
<
span
style
="
Edit file
Delete file
@@ -8,8 +8,6 @@ mainClassName = "io.moquette.integration.Server"
dependencies
{
dependencies
{
compile project(
'
:moquette-broker
'
)
compile project(
'
:moquette-broker
'
)
compile project(
topic
,
String
username
,
ByteBuf
payload
,
int
messageID
,
boolean
retain
,
MqttPublishMessage
msg
) {
//
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify
ConnectionTestUtils
.
verifyReceivePublish(channel1,
NEWS_TOPIC
,
"
io.netty.buffer.ByteBuf
;
15
...ver/DefaultMoquetteSslContextCreator.java → ...ker/DefaultMoquetteSslContextCreator.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
server
;
package
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
h2Builder
=
new
H2Builder
(config, scheduler)
.
initStore();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
) {
INode
newInode
=
createPathRec(topic, newSubscription);
CNode
cnode
=
inode
.
mainNode();
CNode
updatedCnode
=
cnode
.
copy();
updatedCnode
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.
spi.impl
;
package
io.moquette.
broker
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.ByteBuf
;
,
0
));
pipeline
.
addAfter(
"
idleStateHandler
"
,
"
idleEventHandler
"
, timeoutHandler);
//
pipeline.addLast("logger", new LoggingHandler("Netty", LogLevel.ERROR));
if
(errorsCather
.
@@ -0,0 +1,24 @@
package
io.moquette.broker
;
import
io.netty.handler.codec.mqtt.MqttQoS
;
import
java.io.Serializable
;
public
class
RetainedMessage
implements
Serializable
{
private
.
clientID(channel);
if
(clientID
==
null
||
clientID
.
isEmpty()) {
return
;
}
LOG
.
info(
"
"
, clientID, channel);
h2Builder
.
queueRepository();
retainedRepository
=
h2Builder
.
retainedRepository();
}
else
{
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
b
=
new
ServerBootstrap
();
b
.
group(bossGroup, workerGroup)
.
channel(channelClass)
.childHandler(
new
ChannelInitializer<
SocketChannel
>
() {
@@ -187,13 +183,13 @@ public void initChannel(SocketChannel ch) throws Exception {
.childOption(
.
topicName());
final
ByteBuf
payload
=
msg
.
payload();
LOG
.
info(
"
"
, topic, qos);
publish2Subscribers(payload, topic, qos);
if
(
!
msg
equals(webSocketPortProp)) {
//
Do nothing no WebSocket configured
LOG
.
info(
"
"
,
BrokerConstants
.
WEB_SOCKET_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
}
int
font-size: 10pt;
"
>
Copyright [yyyy] [name of copyright owner]
</
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
'
:moquette-h2-storage
'
)
//
compile project(':moquette-mapdb-storage')
compile
group
:
'
org.slf4j
'
,
name
:
'
slf4j-log4j12
verify if topic can be write
topic
.
getTokens();
if
(
!
topic
.
isValid()) {
LOG
.
warn(
"
Invalid topic format, force close the connection
"
);
connection
.
Hello world!
"
);
ConnectionTestUtils
.
verifyReceivePublish(channel2,
NEWS_TOPIC
,
"
Hello world!
"
);
}
@Test
public
void
testPublishWithEmptyPayloadClearRetainedStore
io.moquette.
broker
;
import
java.io.File
;
import
java.io.FileInputStream
;
@@ -34,8 +34,7 @@
import
java.util.Objects
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
queueRepository
=
h2Builder
.
queueRepository();
retainedRepository
=
h2Builder
.
retainedRepository();
}
else
{
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
.
add(newInode);
return
inode
.
compareAndSet(cnode, updatedCnode)
?
Action
.
OK
:
Action
.
REPEAT
;
}
private
15
...ver/DefaultMoquetteSslContextCreator.java → ...ker/DefaultMoquetteSslContextCreator.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.
server
;
package
io.moquette.
isPresent()) {
pipeline
.
addLast(
"
bugsnagCatcher
"
, errorsCather
.
get());
}
pipeline
.
addFirst(
"
bytemetrics
"
final
MqttQoS
qos;
private
final
byte
[] payload;
public
RetainedMessage
(
MqttQoS
qos
,
byte
[]
payload
) {
this
Session
session
=
sessionRegistry
.
retrieve(clientID);
if
(session
.
hasWill()) {
postOffice
.
fireWill(session
.
getWill());
}
if
(session
.
);
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
queueRepository
=
new
MemoryQueueRepository
();
retainedRepository
=
new
MemoryRetainedRepository
();
}
ISubscriptionsDirectory
ChannelOption
.
TCP_NODELAY
, nettyTcpNodelay)
.childOption(
ChannelOption
.
SO_KEEPALIVE
, nettySoKeepalive);
try
{
LOG
.
debug(
"
Binding
server
.
fixedHeader()
.
isRetain()) {
return
;
}
if
(qos
==
AT_MOST_ONCE
||
msg
.
payload()
.
readableBytes()
==
port
=
Integer
.
parseInt(webSocketPortProp);
final
MoquetteIdleTimeoutHandler
timeoutHandler
=
new
MoquetteIdleTimeoutHandler
();
String
host
=
props
.
getProperty(
BrokerConstants
>
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
</
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
'
,
version
:
'
1.7.5
'
compile
group
:
'
org.slf4j
'
,
name
:
'
slf4j-log4j12
'
dropConnection();
return
;
}
final
String
clientId
=
connection
.
getClientId();
if
(
!
authorizator
.
canWrite(topic, username, clientId)) {
LOG
.
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
this
.
retainedRepository
.
retain(
new
Topic
(
NEWS_TOPIC
),
MqttMessageBuilders
.
publish()
;
import
io.moquette.spi.security.ISslContextCreator
;
import
io.moquette.broker.config.IConfig
;
import
io.netty.handler.ssl.ClientAuth
;
import
io.netty.handler.ssl.SslContext
;
import
io.netty.handler.ssl.SslContextBuilder
;
@@ -46,16 +45,16 @@
import
);
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
queueRepository
=
new
MemoryQueueRepository
();
retainedRepository
=
new
MemoryRetainedRepository
();
}
ISubscriptionsDirectory
subscriptions
INode
createPathRec
(
Topic
topic
,
Subscription
newSubscription
) {
Topic
remainingTopic
=
topic
.
exceptHeadToken();
if
(
!
remainingTopic
broker
;
import
java.io.File
;
import
java.io.File
;
import
java.io.FileInputStream
;
import
java.io.FileInputStream
;
@@ -34,8 +34,7 @@
import
java.util.Objects
;
import
,
new
BytesMetricsHandler
(bytesMetricsCollector));
pipeline
.
addLast(
"
autoflush
"
,
new
AutoFlushHandler
(
1
,
TimeUnit
.
qos
=
qos;
this
.
payload
=
payload;
}
public
MqttQoS
qosLevel
() {
return
qos;
}
isClean()) {
sessionRegistry
.
remove(clientID);
}
else
{
sessionRegistry
.
disconnect(clientID);
}
connected
=
false
;
}
void
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
.
init(subscriptionsRepository);
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions, queueRepository);
dispatcher
=
new
"
, host, port);
LOG
.
debug(
"
Binding
integration
"
, host, port);
//
Bind and start to accept incoming connections.
ChannelFuture
f
=
b
.
bind(host, port);
0
) {
//
QoS == 0 && retain => clean old retained
retainedRepository
.
cleanRetained(topic);
return
;
}
retainedRepository
.
retain(topic, msg);
}
}
Copy lines
Copy permalink
View git blame
.
HOST_PROPERTY_NAME
);
initFactory(host, port,
"
Websocket MQTT
"
,
new
PipelineInitializer
() {
@Override
void
init
(
SocketChannel
channel
>
http://www.apache.org/licenses/LICENSE-2.0
</
span
>
</
p
>
<
p
>
<
span
style
="
font-size: 10pt;
"
>
Unless required by applicable law or agreed to in writing, software
,
version
:
'
1.7.5
'
}
}
9
h2_storage/build.gradle
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
error(
"
"
, clientId, topic);
return
;
}
publish2Subscribers(payload, topic,
AT_LEAST_ONCE
);
connection
.
sendPubAck(messageID);
if
(retain) {
if
(
!
payload
.payload(
ByteBufUtil
.
writeAscii(
UnpooledByteBufAllocator
.
DEFAULT
,
"
Hello world!
"
))
.qos(
AT_LEAST_ONCE
)
.build());
//
Exercise
org.slf4j.LoggerFactory
;
/**
* Moquette
server
implementation to load SSL certificate from local filesystem path configured in
* Moquette
integration
implementation to load SSL certificate from local filesystem path configured in
* config file.
*/
public
class
DefaultMoquetteSslContextCreator
implements
ISslContextCreator
{
class
=
new
CTrieSubscriptionDirectory
();
subscriptions
.
init(subscriptionsRepository);
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions, queueRepository);
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
.
isEmpty()) {
INode
inode
=
createPathRec(remainingTopic, newSubscription);
CNode
cnode
=
new
CNode
();
cnode
.
token
=
topic
java.util.Objects
;
import
io.moquette.BrokerConstants
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.broker.config.IConfig
;
import
io.moquette.spi.security.ISslContextCreator
;
.
SECONDS
));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
public
byte
[]
getPayload
() {
return
payload;
}
}
5
broker/src/main/java/io/moquette/broker/Server.java
Show comments
View file
Edit file
Delete file
@@ -162,21 +162,24 @@ public void startServer(IConfig config, List<? extends InterceptHandler> handler
final
sendConnAck
(
boolean
isSessionAlreadyPresent
) {
connected
=
true
;
final
MqttConnAckMessage
ackMessage
=
connAck(
CONNECTION_ACCEPTED
, isSessionAlreadyPresent);
channel
.
writeAndFlush(ackMessage)
PostOffice
(subscriptions, authorizatorPolicy, retainedRepository, sessions,
interceptor);
final
BrokerConfiguration
brokerConfig
=
new
BrokerConfiguration
(config);
MQTTConnectionFactory
connectionFactory
=
new
MQTTConnectionFactory
(brokerConfig, authenticator, sessions,
dispatcher);
LOG
.
info(
"
"
, host, port, protocol);
f
.
sync()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
catch
(
InterruptedException
ex) {
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
) {
ChannelPipeline
pipeline
=
channel
.
pipeline();
pipeline
.
addLast(
new
HttpServerCodec
());
pipeline
.
addLast(
"
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</
span
>
</
p
>
</
div
>
</
body
>
</
html
Retry
58
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
Show comments
View file
Edit file
Delete file
Load diff
This file was deleted.
Oops, something went wrong.
Retry
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
c4d928b
Please
sign in
.
isReadable()) {
retainedRepository
.
cleanRetained(topic);
}
else
{
//
before wasn't stored
retainedRepository
.
retain(topic, msg);
}
}
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
.
DefaultMoquetteSslContextCreator
implements
ISslContextCreator
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
new
MemoryRetainedRepository
()
, sessions,
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
retainedRepository
, sessions,
interceptor);
final
BrokerConfiguration
brokerConfig
=
.
headToken();
cnode
.
add(inode);
return
new
INode
(cnode);
}
import
io.netty.handler.ssl.ClientAuth
;
import
io.netty.handler.ssl.ClientAuth
;
import
io.netty.handler.ssl.SslContext
;
import
"
,
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(metricsCollector));
pipeline
ISubscriptionsRepository
subscriptionsRepository;
final
ISubscriptionsRepository
subscriptionsRepository;
final
IQueueRepository
queueRepository;
final
IQueueRepository
queueRepository;
final
IRetainedRepository
retainedRepository;
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
boolean
isConnected
() {
return
connected;
}
void
dropConnection
() {
channel
final
NewNettyMQTTHandler
mqttHandler
=
new
NewNettyMQTTHandler
(connectionFactory);
acceptor
=
new
NewNettyAcceptor
();
acceptor
.
initialize(mqttHandler, config, sslCtxCreator);
final
long
LOG
.
error(
"
An interruptedException was caught while initializing
server
. Protocol={}
"
, protocol, ex);
LOG
.
error(
"
An interruptedException was caught while initializing
integration
. Protocol={}
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
aggregator
"
,
new
HttpObjectAggregator
(
65536
));
pipeline
.
addLast(
"
webSocketHandler
"
,
new
WebSocketServerProtocolHandler
(
>
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
interceptor
.
notifyTopicPublished(msg, clientId, username);
}
private
void
publish2Subscribers
(
ByteBuf
origPayload
,
Topic
topic
,
MqttQoS
publishingQos
) {
Set<
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
TEST_USER
,
FAKE_CLIENT_ID
, anyPayload,
true
,
MqttMessageBuilders
.
publish()
.payload(anyPayload)
.qos(
MqttQoS
final
IConfig
props;
public
DefaultMoquetteSslContextCreator
(
IConfig
props
) {
DefaultMoquetteSslContextCreator
(
IConfig
props
) {
this
.
props
=
new
BrokerConfiguration
(config);
MQTTConnectionFactory
connectionFactory
=
new
MQTTConnectionFactory
(brokerConfig, authenticator, sessions,
5
broker/src/main/java/io/moquette/persistence/H2Builder.java
Show comments
View file
Edit file
Delete file
@@ -2,6 +2,7 @@
import
io.moquette.BrokerConstants
else
{
return
createLeafNodes(topic
.
headToken(), newSubscription);
}
}
private
INode
createLeafNodes
(
Token
token
,
Subscription
newSubscription
) {
io.netty.handler.ssl.SslContext
;
import
io.netty.handler.ssl.SslContextBuilder
;
import
io.netty.handler.ssl.SslContextBuilder
;
@@ -46,16 +45,16 @@
import
org.slf4j.LoggerFactory
;
import
org.slf4j.LoggerFactory
;
/**
/**
.
addLast(
"
messageLogger
"
,
new
MQTTMessageLogger
());
if
(metrics
.
isPresent()) {
pipeline
.
addLast(
"
wizardMetrics
if
(persistencePath
!=
null
&&
!
persistencePath
.
isEmpty()) {
if
(persistencePath
!=
null
&&
!
persistencePath
.
isEmpty()) {
LOG
.
close()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
void
processDisconnect
(
MqttMessage
msg
) {
final
String
clientID
=
NettyUtils
startTime
=
System
.
currentTimeMillis()
-
start;
LOG
.
info(
"
Moquette integration has been started successfully in {} ms
"
, startTime);
initialized
=
true
;
"
, protocol, ex);
}
}
1
broker/src/main/java/io/moquette/broker/NewNettyMQTTHandler.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
/mqtt
"
,
MQTT_SUBPROTOCOL_CSV_LIST
));
pipeline
.
addLast(
"
ws2bytebufDecoder
"
,
new
WebSocketFrameToByteBufDecoder
());
pipeline
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Subscription
>
topicMatchingSubscriptions
=
subscriptions
.
matchQosSharpening(topic);
for
(
final
Subscription
sub
:
topicMatchingSubscriptions) {
MqttQoS
qos
=
lowerQosToTheSubscriptionDesired(sub, publishingQos);
.
AT_MOST_ONCE
)
.retained(
false
)
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify
assertTrue(
"
Objects
.
requireNonNull(props);
}
@@ -131,7 +130,7 @@ private static SslContextBuilder builderWithJdkProvider(KeyStore ks, String keyP
}
/**
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the
server
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the
integration
* certificate and key in order to provide it to OpenSSL.
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.IRetainedRepository
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.config.IConfig
;
import
org.h2.mvstore.MVStore
;
@@ -57,4 +58,8 @@ public void closeStore() {
CNode
newLeafCnode
=
new
CNode
();
newLeafCnode
.
token
=
token;
newLeafCnode
.
addSubscription(newSubscription);
* Moquette
server
implementation to load SSL certificate from local filesystem path configured in
* Moquette
integration
implementation to load SSL certificate from local filesystem path configured in
* config file.
* config file.
*/
*/
public
class
DefaultMoquetteSslContextCreator
implements
ISslContextCreator
{
"
, metrics
.
get());
}
pipeline
.
addLast(
"
handler
"
, handler);
}
private
void
initializeWebSocketTransport
(
final
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
LOG
.
trace(
"
Configuring H2 subscriptions store to {}
"
, persistencePath);
h2Builder
=
new
H2Builder
(config, scheduler)
.
.
clientID(channel);
LOG
.
trace(
"
"
, clientID, channel);
if
(
!
connected) {
LOG
.
info(
"
"
, clientID, channel);
return
}
private
IAuthorizatorPolicy
initializeAuthorizatorPolicy
(
IAuthorizatorPolicy
authorizatorPolicy
,
IConfig
props
) {
//
if (authorizatorPolicy == null) {
//
authorizatorPolicy = new PermitAllAuthorizatorPolicy();
//
}
//
return authorizatorPolicy;
import
io.netty.channel.*
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.handler.codec.mqtt.MqttMessage
;
13
broker/src/main/java/io/moquette/broker/PostOffice.java
Show comments
View file
.
addLast(
"
bytebuf2wsEncoder
"
,
new
ByteBufToWebSocketFrameEncoder
());
configureMQTTPipeline(pipeline, timeoutHandler, handler);
}
});
}
private
void
initializeSSLTCPTransport
(
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Session
targetSession
=
this
.
sessionRegistry
.
retrieve(sub
.
getClientId());
boolean
isSessionPresent
=
targetSession
!=
null
;
if
(isSessionPresent) {
QoS0 MUST clean retained message for topic
"
, retainedRepository
.
isEmpty());
}
@Test
public
void
testPublishWithQoS1
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
* <
p
>
* TODO: SNI is currently not supported, we use only the first found private key.
@@ -153,7 +152,7 @@ private static SslContextBuilder builderWithOpenSSLProvider(KeyStore ks, String
private
static
void
addClientAuthentication
(
KeyStore
ks
,
SslContextBuilder
contextBuilder
)
throws
NoSuchAlgorithmException
,
public
IQueueRepository
queueRepository
() {
return
new
H2QueueRepository
(mvStore);
}
public
IRetainedRepository
retainedRepository
() {
return
new
H2RetainedRepository
(mvStore);
}
return
new
INode
(newLeafCnode);
}
public
void
removeFromTree
(
Topic
topic
,
String
clientID
) {
Action
res;
do
class
DefaultMoquetteSslContextCreator
implements
ISslContextCreator
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
NewNettyMQTTHandler
handler
,
IConfig
props
) {
LOG
.
debug(
"
Configuring Websocket MQTT transport
"
);
String
webSocketPortProp
=
props
initStore();
h2Builder
=
new
H2Builder
(config, scheduler)
.
initStore();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
subscriptionsRepository
=
h2Builder
.
subscriptionsRepository();
;
}
sessionRegistry
.
disconnect(clientID);
connected
=
false
;
channel
.
close()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
LOG
.
LOG
.
debug(
"
Configuring MQTT authorizator policy
"
);
String
authorizatorClassName
=
props
.
getProperty(
BrokerConstants
.
AUTHORIZATOR_CLASS_NAME
,
"
Edit file
Delete file
@@ -15,12 +15,11 @@
*/
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
import
io.moquette.spi.impl.BrokerInterceptor
;
import
io.moquette.spi.impl.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.spi.impl.subscriptions.Subscription
NewNettyMQTTHandler
handler
,
IConfig
props
,
SslContext
sslContext
) {
LOG
.
debug(
"
Configuring SSL MQTT transport
"
);
String
LOG
.
debug(
"
"
,
sub
.
getClientId(), sub
.
getTopicFilter(), qos);
//
TODO determine the user bounded to targetSession
if
(
!
authorizator
.
canRead(topic,
subscribe(connection,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
//
Exercise
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
KeyStoreException
{
LOG
.
warn(
"
Client authentication is enabled. The keystore will be used as a truststore.
"
);
//
use keystore as truststore, as
server
needs to trust certificates signed by the
server
certificates
//
use keystore as truststore, as
}
55
broker/src/main/java/io/moquette/persistence/H2RetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,55 @@
package
io.moquette.persistence
;
import
io.moquette.broker.IRetainedRepository
;
import
io.moquette.broker.RetainedMessage
;
import
{
res
=
remove(clientID, topic,
this
.
root,
NO_PARENT
);
}
while
(res
==
Action
.
REPEAT
);
}
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
DefaultMoquetteSslContextCreator
.
class);
private
final
IConfig
props;
private
final
IConfig
props;
.
getProperty(
WEB_SOCKET_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
if
(
DISABLED_PORT_BIND
.
equals(webSocketPortProp)) {
//
Do nothing no WebSocket configured
LOG
.
info(
"
"
,
queueRepository
=
h2Builder
.
queueRepository();
queueRepository
=
h2Builder
.
queueRepository();
retainedRepository
=
h2Builder
.
trace(
"
"
, clientID, channel);
}
void
processSubscribe
(
MqttSubscribeMessage
msg
) {
final
String
clientID
"
);
if
(authorizatorPolicy
==
null
&&
!
authorizatorClassName
.
isEmpty()) {
authorizatorPolicy
=
;
import
io.moquette.spi.impl.subscriptions.Topic
;
import
io.moquette.spi.security.IAuthorizatorPolicy
;
import
io.moquette.interception.BrokerInterceptor
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
sslPortProp
=
props
.
getProperty(
SSL_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
if
(
DISABLED_PORT_BIND
.
equals(sslPortProp)) {
//
Do nothing no SSL configured
LOG
.
info(
"
"
TODO
"
, sub
.
getClientId())) {
LOG
.
debug(
"
"
, sub
.
getClientId(), topic);
return
;
}
//
we need to retain because duplicate only copy r/w indexes and don't retain() causing refCnt = 0
Charset
.
defaultCharset());
sut
.
receivedPublishQos1(connection,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
,
MqttMessageBuilders
integration
needs to trust certificates signed by the
integration
certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.
init(ks);
contextBuilder
.
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
org.h2.mvstore.MVMap
;
import
org.h2.mvstore.MVStore
;
import
java.util.ArrayList
;
private
Action
remove
(
String
clientId
,
Topic
topic
,
INode
inode
,
INode
iParent
) {
Token
token
public
DefaultMoquetteSslContextCreator
(
IConfig
props
) {
DefaultMoquetteSslContextCreator
(
IConfig
props
) {
this
.
props
=
Objects
.
BrokerConstants
.
WEB_SOCKET_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
BrokerConstants
.
WEB_SOCKET_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
}
retainedRepository();
}
else
{
}
else
{
LOG
.
trace(
"
=
NettyUtils
.
clientID(channel);
if
(
!
connected) {
LOG
.
warn(
loadClass(authorizatorClassName,
IAuthorizatorPolicy
.
class,
IConfig
.
class, props);
}
if
(authorizatorPolicy
==
null
) {
String
aclFilePath
=
props
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.*
;
import
org.slf4j.Logger
;
@@ -31,7 +30,7 @@
"
,
BrokerConstants
.
SSL_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
}
int
sslPort
=
Integer
.
parseInt(sslPortProp);
LOG
ByteBuf
payload
=
origPayload
.
retainedDuplicate();
targetSession
.
sendPublishOnSessionAtQos(topic, qos, payload);
}
else
{
//
If we are, the subscriber disconnected after the subscriptions tree selected that session as a
//
destination.
LOG
.
.
publish()
.payload(
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset()))
.qos(
MqttQoS
.
AT_LEAST_ONCE
)
clientAuth(
ClientAuth
.
REQUIRE
);
2
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
package
io.moquette.broker
;
import
io.moquette.
import
java.util.List
;
import
java.util.Map
;
public
class
H2RetainedRepository
implements
IRetainedRepository
{
private
final
MVMap<
Topic
,
RetainedMessage
>
=
topic
.
headToken();
if
(
!
topic
.
isEmpty()
&&
(inode
.
mainNode()
.
anyChildrenMatch(token))) {
Topic
remainingTopic
=
requireNonNull(props);
this
.
props
=
Objects
.
requireNonNull(props);
}
}
@@ -131,7 +130,7 @@ private static SslContextBuilder builderWithJdkProvider(KeyStore ks, String keyP
}
}
/**
/**
* The OpenSSL provider does not support the {
int
port
=
Integer
.
parseInt(webSocketPortProp);
@@ -254,15 +263,7 @@ void init(SocketChannel channel) {
new
WebSocketServerProtocolHandler
(
"
/mqtt
"
,
MQTT_SUBPROTOCOL_CSV_LIST
));
pipeline
.
addLast(
Configuring in-memory subscriptions store
"
);
LOG
.
trace(
"
Configuring in-memory subscriptions store
"
);
subscriptionsRepository
=
new
MemorySubscriptionsRepository
();
subscriptionsRepository
=
new
MemorySubscriptionsRepository
"
"
, clientID, channel);
dropConnection();
return
;
}
postOffice
.
subscribeClientToTopics(msg, clientID,
NettyUtils
.
userName(channel),
this
);
}
void
sendSubAckMessage
(
int
.
getProperty(
BrokerConstants
.
ACL_FILE_PROPERTY_NAME
,
"
"
);
if
(aclFilePath
!=
null
&&
!
aclFilePath
.
isEmpty()) {
import
java.util.Set
;
import
java.util.stream.Collectors
;
import static
io.moquette.
spi.impl
.Utils.messageId
;
import static
io.moquette.
broker
.Utils.messageId
;
.
debug(
"
Starting SSL on port {}
"
, sslPort);
final
MoquetteIdleTimeoutHandler
timeoutHandler
=
new
MoquetteIdleTimeoutHandler
();
String
host
=
props
.
getProperty(
debug(
"
"
, sub
.
getClientId(),
sub
.
getTopicFilter(), qos);
}
}
}
/**
* First phase of a publish QoS2 protocol, sent by publisher to the broker. Publish to all interested
* subscribers.
*/
void
receivedPublishQos2
.retained(
true
)
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
"
Any payload
"
spi.impl
.subscriptions.Topic
;
import
io.moquette.
broker
.subscriptions.Topic
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
public
interface
IRetainedRepository
{
2
...ette/spi/security/ISslContextCreator.java → ...o/moquette/broker/ISslContextCreator.java
queueMap;
public
H2RetainedRepository
(
MVStore
mvStore
) {
this
.
queueMap
=
mvStore
.
openMap(
"
retained_store
"
topic
.
exceptHeadToken();
INode
nextInode
=
inode
.
mainNode()
.
childOf(token);
return
remove(clientId, remainingTopic, nextInode, inode);
}
else
{
final
CNode
@link
KeyManagerFactory}, so we have to lookup the
server
* The OpenSSL provider does not support the {
@link
KeyManagerFactory}, so we have to lookup the
integration
* certificate and key in order to provide it to OpenSSL.
* certificate and key in order to provide it to OpenSSL.
* <
p
>
* <
p
>
* TODO: SNI is currently not supported, we use only the first found private key.
* TODO: SNI is currently not supported, we use only the first found private key.
"
ws2bytebufDecoder
"
,
new
WebSocketFrameToByteBufDecoder
());
pipeline
.
addLast(
"
bytebuf2wsEncoder
"
,
new
ByteBufToWebSocketFrameEncoder
());
pipeline
.
();
queueRepository
=
new
MemoryQueueRepository
();
queueRepository
=
new
MemoryQueueRepository
();
retainedRepository
=
new
MemoryRetainedRepository
();
}
messageID
,
MqttSubAckMessage
ackMessage
) {
final
String
clientId
=
NettyUtils
.
clientID(channel);
LOG
.
trace(
"
"
authorizatorPolicy
=
new
DenyAllAuthorizatorPolicy
();
try
{
LOG
.
info(
"
Parsing ACL file. Path = {}
"
, aclFilePath);
IResourceLoader
resourceLoader
=
import static
io.netty.handler.codec.mqtt.MqttMessageIdVariableHeader.from
;
import static
io.netty.handler.codec.mqtt.MqttQoS.*
;
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
1ba9eb3
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
BrokerConstants
.
HOST_PROPERTY_NAME
);
String
sNeedsClientAuth
=
props
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
final
(
MQTTConnection
connection
,
MqttPublishMessage
mqttPublishMessage
,
String
username
) {
LOG
.
trace(
"
Processing PUBREL message on connection: {}
"
, connection);
final
);
}
@Test
public
void
testPublishWithQoS2
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
NEWS_TOPIC
,
EXACTLY_ONCE
);
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
spi.security
;
package
io.moquette.
broker
;
import
io.netty.handler.ssl.SslContext
;
2
);
}
@Override
public
void
cleanRetained
(
Topic
topic
) {
queueMap
.
remove(topic);
}
@Override
public
void
retain
cnode
=
inode
.
mainNode();
if
(cnode
instanceof
TNode
) {
//
this inode is a tomb, has no clients and should be cleaned up
//
Because we implemented cleanTomb below, this should be rare, but possible
//
Consider calling cleanTomb here too
return
Action
.
@@ -153,7 +152,7 @@ private static SslContextBuilder builderWithOpenSSLProvider(KeyStore ks, String
private
static
void
addClientAuthentication
(
KeyStore
ks
,
SslContextBuilder
contextBuilder
)
private
static
void
addClientAuthentication
(
KeyStore
ks
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
));
pipeline
.
addAfter(
"
idleStateHandler
"
,
"
}
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
ISubscriptionsDirectory
subscriptions
=
new
CTrieSubscriptionDirectory
();
subscriptions
.
init(subscriptionsRepository);
subscriptions
.
init(subscriptionsRepository);
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
, clientId, messageID);
channel
.
writeAndFlush(ackMessage)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
private
void
processUnsubscribe
(
MqttUnsubscribeMessage
msg
) {
List<
props
.
getResourceLoader();
authorizatorPolicy
=
ACLFileParser
.
parse(resourceLoader
.
loadResource(aclFilePath));
}
catch
(
ParseException
pex) {
LOG
.
error(
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
boolean
needsClientAuth
=
Boolean
.
valueOf(sNeedsClientAuth);
initFactory(host, sslPort,
"
SSL MQTT
"
,
new
PipelineInitializer
() {
@Override
void
init
(
Topic
topic
=
new
Topic
(mqttPublishMessage
.
variableHeader()
.
topicName());
final
ByteBuf
payload
=
mqttPublishMessage
.
payload();
final
//
Exercise
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
.
broker/src/main/java/io/moquette/broker/ISubscriptionsRepository.java
Show comments
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Subscription
;
import
io.moquette.
broker
(
Topic
topic
,
MqttPublishMessage
msg
) {
final
ByteBuf
payload
=
msg
.
content();
byte
[] rawPayload
=
new
byte
OK
;
}
if
(cnode
.
containsOnly(clientId)
&&
topic
.
isEmpty()
&&
cnode
.
allChildren()
.
isEmpty()) {
//
last client to leave this node, AND there are no downstream children, remove via TNode tomb
,
SslContextBuilder
contextBuilder
)
throws
NoSuchAlgorithmException
,
KeyStoreException
{
throws
NoSuchAlgorithmException
,
KeyStoreException
{
LOG
.
warn(
"
idleEventHandler
"
, timeoutHandler);
pipeline
.
addFirst(
"
bytemetrics
"
,
new
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
autoflush
"
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions, queueRepository);
SessionRegistry
sessions
=
new
SessionRegistry
(subscriptions, queueRepository);
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
String
>
topics
=
msg
.
payload()
.
topics();
String
clientID
=
NettyUtils
.
clientID(channel);
LOG
.
trace(
"
"
Unable to parse ACL file. path=
"
+
aclFilePath, pex);
}
}
else
{
authorizatorPolicy
=
new
PermitAllAuthorizatorPolicy
();
}
LOG
.
info(
"
Authorizator policy {} instance will be used
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
SocketChannel
channel
)
throws
Exception
{
ChannelPipeline
pipeline
=
channel
.
pipeline();
pipeline
.
addLast(
"
ssl
String
clientId
=
connection
.
getClientId();
if
(
!
authorizator
.
canWrite(topic, username, clientId)) {
LOG
.
error(
"
"
, clientId, topic);
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub · GitHub
receivedPublishQos2(connection,
MqttMessageBuilders
.
publish()
.payload(anyPayload)
.qos(
MqttQoS
.
EXACTLY_ONCE
)
.retained(
true
)
.topicName(
NEWS_TOPIC
)
.
.subscriptions.Subscription
;
import
java.util.List
;
1
broker/src/main/java/io/moquette/broker/InflightResender.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
remove unnecessary quotes (#478) · moquette-io/moquette@d2cce3f · GitHub
[payload
.
readableBytes()];
payload
.
getBytes(
0
, rawPayload);
final
RetainedMessage
toStore
=
new
RetainedMessage
(msg
.
fixedHeader()
.
if
(inode
==
this
.
root) {
return
inode
.
compareAndSet(cnode, inode
.
mainNode()
.
copy())
?
Action
.
OK
Client authentication is enabled. The keystore will be used as a truststore.
"
);
LOG
.
warn(
"
Client authentication is enabled. The keystore will be used as a truststore.
"
);
//
use keystore as truststore, as
server
needs to trust certificates signed by the
server
certificates
//
use keystore as truststore, as
integration
,
new
AutoFlushHandler
(
1
,
TimeUnit
.
SECONDS
));
pipeline
.
addLast(
"
decoder
"
,
new
Update Freedomotic references (#475) · moquette-io/moquette@78ac8b4 · GitHub
new
MemoryRetainedRepository
()
, sessions,
dispatcher
=
new
PostOffice
(subscriptions, authorizatorPolicy,
retainedRepository
, sessions,
interceptor);
interceptor);
final
BrokerConfiguration
brokerConfig
=
new
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
"
, clientID, topics);
postOffice
.
unsubscribe(topics,
this
, msg
.
variableHeader()
.
messageId());
}
void
sendUnsubAckMessage
(
List<
String
>
topics
Added GitHub Issue template · moquette-io/moquette@a49792a · GitHub
"
, authorizatorPolicy
.
getClass()
.
getName());
}
return
authorizatorPolicy;
}
private
IAuthenticator
initializeAuthenticator
(
IAuthenticator
authenticator
,
IConfig
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
"
, createSslHandler(channel, sslContext, needsClientAuth));
configureMQTTPipeline(pipeline, timeoutHandler, handler);
}
});
}
private
void
initializeWSSTransport
(
NewNettyMQTTHandler
handler
,
IConfig
props
,
SslContext
sslContext
return
;
}
publish2Subscribers(payload, topic,
EXACTLY_ONCE
);
final
boolean
retained
=
mqttPublishMessage
.
fixedHeader()
.
isRetain();
if
(retained) {
if
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
build(),
"
username
"
);
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
EXACTLY_ONCE
,
"
Any payload
"
);
}
//
aka testPublishWithQoS1_notCleanSession
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.util.concurrent.EventExecutor
;
8
broker/src/main/java/io/moquette/broker/MQTTConnection.java
Show comments
View file
Edit file
Delete file
@@ -15,10 +15,8 @@
*/
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Added GitHub Issue template · moquette-io/moquette@a49792a · GitHub
qosLevel(), rawPayload);
queueMap
.
put(topic, toStore);
}
@Override
public
boolean
isEmpty
() {
return
queueMap
.
isEmpty();
}
@Override
public
List<
:
Action
.
REPEAT
;
}
TNode
tnode
=
new
TNode
();
return
inode
.
compareAndSet(cnode, tnode)
?
cleanTomb(inode, iParent)
needs to trust certificates signed by the
integration
certificates
TrustManagerFactory
tmf
=
TrustManagerFactory
.
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
TrustManagerFactory
tmf
=
TrustManagerFactory
.
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
"
,
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
"
remove unnecessary quotes (#478) · moquette-io/moquette@d2cce3f · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
BrokerConfiguration
(config);
final
BrokerConfiguration
brokerConfig
=
new
BrokerConfiguration
(config);
MQTTConnectionFactory
connectionFactory
=
new
MQTTConnectionFactory
(brokerConfig, authenticator, sessions,
MQTTConnectionFactory
connectionFactory
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
,
String
clientID
,
int
messageID
) {
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
UNSUBACK
,
false
Big refactory on session management: · moquette-io/moquette@1b272e5 · GitHub
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
props
) {
//
if (authenticator == null) {
//
authenticator = new AcceptAllAuthenticator();
//
}
//
return authenticator;
LOG
.
debug(
"
Configuring MQTT authenticator
"
);
String
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
) {
LOG
.
debug(
"
Configuring secure websocket MQTT transport
"
);
String
sslPortProp
=
props
.
getProperty(
(
!
payload
.
isReadable()) {
retainedRepository
.
cleanRetained(topic);
}
else
{
//
before wasn't stored
retainedRepository
.
retain(topic, mqttPublishMessage);
}
}
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
@Test
public
void
forwardQoS1PublishesWhenNotCleanSessionReconnects
() {
connection
.
processConnect(
ConnectionTestUtils
.
buildConnectNotClean(
FAKE_CLIENT_ID
));
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
import
io.moquette.spi.impl.DebugUtils
;
import
io.moquette.spi.impl.subscriptions.Topic
;
import
io.moquette.spi.security.IAuthenticator
;
import
io.moquette.broker.subscriptions.Topic
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
RetainedMessage
>
retainedOnTopic
(
String
topic
) {
final
Topic
searchTopic
=
new
Topic
(topic);
final
List<
RetainedMessage
>
:
Action
.
REPEAT
;
}
else
if
(cnode
.
contains(clientId)
&&
topic
.
isEmpty()) {
CNode
getInstance(
TrustManagerFactory
.
getDefaultAlgorithm());
tmf
.
init(ks);
tmf
.
init(ks);
contextBuilder
.
clientAuth(
ClientAuth
.
REQUIRE
);
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
"
,
new
MQTTMessageLogger
());
pipeline
.
addLast(
"
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Sign in to GitHub · GitHub
Skip to content
GitHub no longer supports this web browser.
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
=
new
MQTTConnectionFactory
(brokerConfig, authenticator, sessions,
5
broker/src/main/java/io/moquette/persistence/H2Builder.java
Show comments
View file
Edit file
Delete file
@@ -2,6 +2,7 @@
import
io.moquette.BrokerConstants
;
import
io.moquette.BrokerConstants
,
AT_MOST_ONCE
,
false
,
0
);
MqttUnsubAckMessage
ackMessage
=
new
MqttUnsubAckMessage
(fixedHeader, from(messageID));
LOG
.
trace(
"
"
, clientID, messageID, topics);
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
authenticatorClassName
=
props
.
getProperty(
BrokerConstants
.
AUTHENTICATOR_CLASS_NAME
,
"
"
);
if
(authenticator
==
null
&&
!
WSS_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
if
(
DISABLED_PORT_BIND
.
equals(sslPortProp)) {
//
Do nothing no SSL configured
LOG
.
info(
"
"
,
BrokerConstants
String
clientID
=
connection
.
getClientId();
interceptor
.
notifyTopicPublished(mqttPublishMessage, clientID, username);
}
static
MqttQoS
lowerQosToTheSubscriptionDesired
(
Subscription
sub
,
MqttQoS
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
NEWS_TOPIC
,
AT_LEAST_ONCE
);
connection
.
processDisconnect(
null
);
//
publish a QoS 1 message from another client publish a message on the topic
EmbeddedChannel
pubChannel
=
new
EmbeddedChannel
();
;
import
io.moquette.broker.security.IAuthenticator
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelPipeline
;
@@ -154,7 +152,7 @@ void processConnect(MqttConnectMessage msg) {
//
Generating client id.
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
matchingMessages
=
new
ArrayList<>
();
for
(
Map
.
Entry<
Topic
,
RetainedMessage
>
entry
:
queueMap
.
updatedCnode
=
cnode
.
copy();
updatedCnode
.
removeSubscriptionsFor(clientId);
return
inode
.
compareAndSet(cnode, updatedCnode)
?
Action
.
OK
:
Action
contextBuilder
.
clientAuth(
ClientAuth
.
REQUIRE
);
2
broker/src/main/java/io/moquette/broker/IRetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
*/
package
handler
"
, handler);
configureMQTTPipeline(pipeline, timeoutHandler, handler);
}
});
}
@@ -273,7 +274,7 @@ private void initializeSSLTCPTransport(NewNettyMQTTHandler handler, IConfig prop
if
(
DISABLED_PORT_BIND
.
equals(sslPortProp)) {
//
Do nothing no SSL configured
LOG
.
info(
Sign in to GitHub · GitHub
Skip to content
moquette/README.md at 7b9db6eafd6b2beaf59184b91493360b16c5e97f · moquette-io/moquette · GitHub
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.IQueueRepository
;
import
io.moquette.broker.IRetainedRepository
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.ISubscriptionsRepository
;
import
io.moquette.broker.config.IConfig
channel
.
writeAndFlush(ackMessage)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
LOG
.
trace(
"
"
, clientID, topics);
}
void
processPublish
(
MqttPublishMessage
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
authenticatorClassName
.
isEmpty()) {
authenticator
=
loadClass(authenticatorClassName,
IAuthenticator
.
class,
IConfig
.
class, props);
}
IResourceLoader
resourceLoader
=
props
.
.
WSS_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
}
int
sslPort
=
Integer
.
parseInt(sslPortProp);
final
MoquetteIdleTimeoutHandler
timeoutHandler
=
qos
) {
if
(qos
.
value()
>
sub
.
getRequestedQos()
.
value()) {
qos
=
sub
.
getRequestedQos();
}
Reject
Save preferences
MQTTConnection
pubConn
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, pubChannel);
pubConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
PUBLISHER_ID
));
ConnectionTestUtils
.
assertConnectAccepted(pubChannel);
final
clientId
=
UUID
.
randomUUID()
.
toString()
.
replace(
"
-
"
,
"
"
);
LOG
.
debug(
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
entrySet()) {
final
Topic
scanTopic
=
entry
.
getKey();
if
(searchTopic
.
match(scanTopic)) {
matchingMessages
.
add(entry
.
getValue());
}
.
REPEAT
;
}
else
{
//
someone else already removed
return
Action
.
OK
;
}
}
}
/**
*
* Cleans Disposes of TNode in separate Atomic CAS operation per
io.moquette.broker
;
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Topic
;
import
io.moquette.
broker
.subscriptions.Topic
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
"
"
,
BrokerConstants
.
SSL_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
BrokerConstants
.
SSL_PORT_PROPERTY_NAME
,
DISABLED_PORT_BIND
);
return
;
}
Minor, changed header (#536) · moquette-io/moquette@8ba0b4d · GitHub
Minor, changed header (#536) · moquette-io/moquette@8ba0b4d · GitHub
GitHub no longer supports this web browser.
Learn more about the browsers we support.
Sign in to GitHub
Username or email address
Password
Forgot password?
New to GitHub?
Create an account
.
Terms
Privacy
Security
Contact GitHub
You can’t perform that action at this time.
You signed in with another tab or window.
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Team
moquette/README.md at 8ba0b4dfe52dce28a4eb5e362f18afaf850e71d4 · moquette-io/moquette · GitHub
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
;
import
io.moquette.broker.config.IConfig
;
import
org.h2.mvstore.MVStore
;
import
org.h2.mvstore.MVStore
;
@@ -57,4 +58,8 @@ public void closeStore() {
public
IQueueRepository
queueRepository
() {
public
IQueueRepository
queueRepository
msg
) {
final
MqttQoS
qos
=
msg
.
fixedHeader()
.
qosLevel();
final
String
username
=
NettyUtils
.
userName(channel);
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
getResourceLoader();
if
(authenticator
==
null
) {
String
passwdPath
=
props
.
getProperty(
BrokerConstants
.
PASSWORD_FILE_PROPERTY_NAME
,
"
"
);
new
MoquetteIdleTimeoutHandler
();
String
host
=
props
.
getProperty(
BrokerConstants
.
HOST_PROPERTY_NAME
);
String
sNeedsClientAuth
=
props
return
qos;
}
/**
* Intended usage is only for embedded versions of the broker, where the hosting application
* want to use the broker to send a publish message. Like normal external publish message but
* with some changes to avoid security check, and the handshake phases for Qos1 and Qos2. It
* also doesn't notifyTopicPublished because using internally the owner should already know
* where it's publishing.
*
*
@param
msg
* the message to publish
*/
public
void
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos1(pubConn,
new
"
Client has connected with
server
"
, clientId,
LOG
.
debug(
"
Client has connected with
integration
"
, clientId,
username, channel);
}
2
broker/src/main/java/io/moquette/broker/MQTTConnectionFactory.java
Show comments
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
}
return
matchingMessages;
}
}
10
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
Show comments
View file
Edit file
Delete file
@@ -390,7 +390,7 @@ public void cleanRetainedMessageStoreWhenPublishWithRetainedQos0IsReceived() {
sut
* http://bravenewgeek.com/breaking-and-entering-lose-the-lock-while-embracing-concurrency/
*
* We roughly follow this theory above, but we allow CNode with no Subscriptions to linger (for now).
*
*
*
@param
inode inode that handle to the tomb node.
*
@param
iParent inode parent.
*
@return
REPEAT if the this methods wasn't successful or OK.
*/
private
Action
cleanTomb
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
public
interface
IRetainedRepository
{
public
interface
IRetainedRepository
{
2
...ette/spi/security/ISslContextCreator.java → ...o/moquette/broker/ISslContextCreator.java
Show comments
View file
Edit file
Delete file
@@ -290,16 +291,7 @@ private void initializeSSLTCPTransport(NewNettyMQTTHandler handler, IConfig prop
void
init
(
SocketChannel
channel
)
throws
Exception
{
ChannelPipeline
pipeline
=
channel
.
pipeline();
pipeline
.
addLast(
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Avoid slow responses due to missed queue drain after a client sent ou… · moquette-io/moquette@6ee0137 · GitHub
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
→
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
() {
return
new
H2QueueRepository
(mvStore);
return
new
H2QueueRepository
(mvStore);
}
}
public
IRetainedRepository
retainedRepository
() {
final
String
topicName
=
msg
.
variableHeader()
.
topicName();
final
String
clientId
=
getClientId();
LOG
.
trace(
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
if
(passwdPath
.
isEmpty()) {
authenticator
=
new
AcceptAllAuthenticator
();
}
.
getProperty(
BrokerConstants
.
NEED_CLIENT_AUTH
,
"
false
"
);
final
internalPublish
(
MqttPublishMessage
msg
) {
final
MqttQoS
qos
=
msg
.
fixedHeader()
.
qosLevel();
final
Topic
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
,
MqttMessageBuilders
.
publish()
.payload(anyPayload
.
retainedDuplicate())
.qos(
MqttQoS
.
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
package
io.moquette.broker
;
import
io.moquette.
spi
.security.IAuthenticator
;
import
io.moquette.
broker
.security.IAuthenticator
;
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
remove unnecessary quotes (
#478
)
Loading branch information
joestr
authored and
andsel
committed
May 21, 2019
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
.
receivedPublishQos1(connection,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
,
publishMsg);
assertMessageIsRetained(
NEWS_TOPIC
);
assertMessageIsRetained(
(
INode
inode
,
INode
iParent
) {
CNode
updatedCnode
=
iParent
.
mainNode()
.
copy();
updatedCnode
.
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.
spi.security
;
package
io.moquette.
broker
;
import
io.netty.handler.ssl.SslContext
;
"
ssl
"
, createSslHandler(channel, sslContext, needsClientAuth));
pipeline
.
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
));
→
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
Security
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
Skip to content
Sign up
Why GitHub?
Features
→
Code review
Project management
Integrations
Actions
Packages
Security
Team management
Hosting
Mobile
Customer stories
→
Security
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
Pricing
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Update Freedomotic references (
#475
)
Loading branch information
mcicolella
authored and
andsel
return
new
H2RetainedRepository
(mvStore);
}
}
}
55
broker/src/main/java/io/moquette/persistence/H2RetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,55 @@
package
io.moquette.persistence
;
"
"
, clientId, topicName,
msg
.
variableHeader()
.
packetId(), qos);
ByteBuf
payload
=
msg
.
payload();
final
boolean
retain
=
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Added GitHub Issue template
Loading branch information
andsel
committed
Oct 20, 2017
1 parent
1b272e5
else
{
authenticator
=
new
ResourceAuthenticator
(resourceLoader, passwdPath);
}
LOG
.
info(
"
An {} authenticator instance will be used
"
, authenticator
.
getClass()
.
boolean
needsClientAuth
=
Boolean
.
valueOf(sNeedsClientAuth);
initFactory(host, sslPort,
"
Secure websocket
"
,
new
topic
=
new
Topic
(msg
.
variableHeader()
.
topicName());
final
ByteBuf
payload
=
msg
.
payload();
LOG
.
AT_LEAST_ONCE
)
.topicName(
NEWS_TOPIC
)
.
build());
//
simulate a reconnection from the other client
connection
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
);
connectMessage
=
ConnectionTestUtils
import
io.netty.channel.Channel
;
class
MQTTConnectionFactory
{
2
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
package
io.moquette.broker
;
1 parent
78ac8b4
commit
d2cce3fef45b1a2b44220c03cf65f6c0446140aa
Unified
Split
Showing
1 changed file
with
2 additions
and
2 deletions
.
+2
−2
distribution/src/main/scripts/moquette.bat
4
distribution/src/main/scripts/moquette.bat
Security
Insights
Permalink
Browse files
Loading status checks…
Added GitHub Issue template
Loading branch information
andsel
committed
Oct 20, 2017
1 parent
1b272e5
commit
a49792adf5d6bcf636737478e972207f516dc4df
Unified
Split
NEWS_TOPIC
, anyPayload
);
//
publish a QoS0 retained message
//
Exercise
@@ -406,8 +406,10 @@ public void cleanRetainedMessageStoreWhenPublishWithRetainedQos0IsReceived() {
assertTrue(
"
Retained message for topic /news must be cleared
"
, retainedRepository
.
isEmpty());
}
private
remove(inode);
return
iParent
.
compareAndSet(iParent
.
mainNode(), updatedCnode)
?
Action
.
OK
:
Action
.
REPEAT
;
}
import
io.netty.handler.ssl.SslContext
;
2
broker/src/main/java/io/moquette/broker/ISubscriptionsRepository.java
Show comments
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
*/
package
io.moquette.broker
;
package
io.moquette.broker
pipeline
.
addAfter(
"
idleStateHandler
"
,
"
idleEventHandler
"
, timeoutHandler);
//
pipeline.addLast("logger", new LoggingHandler("Netty", LogLevel.ERROR));
pipeline
.
addFirst(
"
bytemetrics
GitHub Education
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
GitHub Stars program
Marketplace
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
→
Team
Enterprise
Explore
Explore GitHub
→
Learn & contribute
Topics
Collections
Trending
Learning Lab
Open source guides
Connect with others
Events
Community forum
GitHub Education
GitHub Stars program
Marketplace
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
remove unnecessary quotes (
#478
)
Loading branch information
joestr
authored and
andsel
committed
May 21, 2019
committed
May 2, 2019
1 parent
1ee744f
commit
78ac8b4c9860934856abf56b0f33e203b001effd
Unified
Split
Showing
1 changed file
with
2 additions
and
2 deletions
.
+2
−2
README.md
import
io.moquette.broker.IRetainedRepository
;
import
io.moquette.broker.RetainedMessage
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
msg
.
fixedHeader()
.
isRetain();
final
Topic
topic
=
new
Topic
(topicName);
if
(
!
topic
.
isValid()) {
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Big refactory on session management:
Loading branch information
andsel
committed
Oct 14, 2017
1 parent
6bacce6
commit
1b272e584933fc0b78919bad767d7e73dbcc01b6
Unified
commit
a49792adf5d6bcf636737478e972207f516dc4df
Unified
Split
Showing
1 changed file
with
13 additions
and
0 deletions
.
+13
−0
.github/ISSUE_TEMPLATE.md
13
.github/ISSUE_TEMPLATE.md
Show comments
View file
getName());
}
return
authenticator;
}
private
void
initInterceptors
(
IConfig
props
,
List<? extends
InterceptHandler
>
embeddedObservers
) {
PipelineInitializer
() {
@Override
void
init
(
SocketChannel
channel
)
throws
Exception
{
ChannelPipeline
pipeline
=
channel
.
pipeline();
info(
"
"
, topic, qos);
publish2Subscribers(payload, topic, qos);
if
(
!
msg
.
fixedHeader()
.
isRetain()) {
return
;
}
if
(qos
.
buildConnectNotClean(
FAKE_CLIENT_ID
);
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
//
Verify
ConnectionTestUtils
.
verifyPublishIsReceived(channel,
AT_LEAST_ONCE
,
"
import
io.moquette.
spi.impl
.subscriptions.Topic
;
import
io.moquette.
broker
.subscriptions.Topic
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
java.util.concurrent.ConcurrentHashMap
;
3
broker/src/main/java/io/moquette/broker/MemorySubscriptionsRepository.java
Show comments
View file
Edit file
Delete file
@@ -31,7 +31,7 @@ goto end
rem
Set JavaHome if it exists
rem
Set JavaHome if it exists
if
exist
{
"
%JAVA_HOME%
\bin\java
"
} (
Showing
1 changed file
with
13 additions
and
0 deletions
.
+13
−0
.github/ISSUE_TEMPLATE.md
13
.github/ISSUE_TEMPLATE.md
Show comments
View file
Edit file
Delete file
@@ -0,0 +1,13 @@
void
assertMessageIsRetained
(
String
expectedTopicName
) {
MqttPublishMessage
msg
=
retainedRepository
.
retainedOnTopic(expectedTopicName);
assertEquals(expectedTopicName, msg
.
variableHeader()
.
topicName());
private
void
public
int
size
() {
SubscriptionCounterVisitor
visitor
=
new
SubscriptionCounterVisitor
();
dfsVisit(
this
.
root, visitor,
0
);
return
;
import
io.moquette.
spi.impl
.subscriptions.Subscription
;
import
io.moquette.
broker
.subscriptions.Subscription
;
import
java.util.List
;
import
java.util.List
;
1
"
,
new
BytesMetricsHandler
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
autoflush
"
,
new
AutoFlushHandler
(
1
,
TimeUnit
.
↵
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
No suggested jump to results
In this repository
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
Pricing
Plans
→
Compare plans
Contact Sales
Nonprofit
→
Education
→
In this repository
All GitHub
↵
Jump to
↵
No suggested jump to results
In this repository
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Fork
666
1 parent
78ac8b4
commit
d2cce3fef45b1a2b44220c03cf65f6c0446140aa
Unified
Split
Showing
1 changed file
with
2 additions
and
2 deletions
.
+2
−2
distribution/src/main/scripts/moquette.bat
4
4
README.md
Show comments
View file
Edit file
Delete file
@@ -12,7 +12,7 @@ Its designed to be evented, uses Netty for the protocol encoding and decoding pa
##
Embeddable
[
Freedomotic
](
http
://www.freedomotic.com/)
Is
an home automation framework
org.h2.mvstore.MVMap
;
import
org.h2.mvstore.MVStore
;
import
java.util.ArrayList
;
import
java.util.List
;
import
java.util.Map
;
public
class
H2RetainedRepository
LOG
.
debug(
"
Drop connection because of invalid topic format
"
);
dropConnection();
}
switch
(qos) {
case
AT_MOST_ONCE
:
postOffice
.
receivedPublishQos0(topic, username, clientId, payload, retain, msg);
break
;
Split
Showing
43 changed files
with
1,101 additions
and
1,704 deletions
.
+0
−8
broker/src/main/java/io/moquette/connections/IConnectionsManager.java
+46
−93
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
+3
−1
broker/src/main/java/io/moquette/persistence/PersistentSession.java
Edit file
Delete file
@@ -0,0 +1,13 @@
###
Expected behavior
###
Actual behavior
###
Steps to reproduce
###
Minimal yet complete reproducer code (or URL to code) or complete log file
###
Moquette MQTT version
###
JVM version (e.g.
`java -version`
)
LOG
.
info(
"
Configuring message interceptors...
"
);
List<
InterceptHandler
>
observers
=
new
ArrayList<>
(embeddedObservers);
String
interceptorClassName
=
pipeline
.
addLast(
"
ssl
"
, createSslHandler(channel, sslContext, needsClientAuth));
pipeline
.
addLast(
"
httpEncoder
"
,
==
AT_MOST_ONCE
||
msg
.
payload()
.
readableBytes()
==
0
) {
//
QoS == 0 && retain => clean old retained
retainedRepository
.
cleanRetained(topic);
return
;
}
Any payload
"
);
}
@Test
public
void
checkReceivePublishedMessage_after_a_reconnect_with_notCleanSession
() {
//
first connect - subscribe -disconnect
connection
.
processConnect(
ConnectionTestUtils
.
buildConnectNotClean(
Show comments
View file
Edit file
Delete file
@@ -15,11 +15,10 @@
*/
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Subscription
;
import
io.moquette.
broker
if
exist
{
"
%JAVA_HOME%
\bin\java
"
} (
set
"
JAVA
=
"
%JAVA_HOME%
\bin\java
"
set
JAVA
###
Expected behavior
###
Actual behavior
###
Steps to reproduce
###
Minimal yet complete reproducer code (or URL to code) or complete log file
###
Moquette MQTT version
###
JVM version (e.g.
`java -version`
)
###
OS version (e.g.
`uname -a`
assertMessageIsRetained
(
String
expectedTopicName
,
ByteBuf
expectedPayload
) {
List<
RetainedMessage
>
msgs
=
retainedRepository
.
retainedOnTopic(expectedTopicName);
assertEquals(
1
, msgs
visitor
.
getResult();
}
public
String
dumpTree
() {
DumpTreeVisitor
visitor
=
new
DumpTreeVisitor
();
dfsVisit(
this
.
root, visitor,
broker/src/main/java/io/moquette/broker/InflightResender.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
package
io.moquette.broker
;
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
import
SECONDS
));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
"
,
/
moquette
Watch
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
157
Star
1.7k
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
All GitHub
↵
Jump to
↵
In this repository
All GitHub
↵
Jump to
↵
Sign in
Sign up
moquette-io
/
moquette
Watch
157
Star
1.7k
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
7b9db6eafd
moquette
/
README.md
Go to file
Go to file
T
Go to line
L
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
distribution/src/main/scripts/moquette.bat
Show comments
View file
Edit file
Delete file
@@ -31,7 +31,7 @@ goto end
rem
Set JavaHome if it exists
if
exist
{
"
%JAVA_HOME%
\bin\java
"
} (
set
"
,
uses Moquette embedded to interface with MQTT
world.
[
Freedomotic
](
https
://www.freedomotic
-iot
.com/)
is
an home automation framework
and
uses Moquette embedded to interface with MQTT
by a specific [
plugin
](https://freedomotic-user-manual.readthedocs.io/en/latest/plugins/mqtt-broker.html).
Moquette is also used into [
implements
IRetainedRepository
{
private
final
MVMap<
Topic
,
RetainedMessage
>
queueMap;
public
H2RetainedRepository
(
MVStore
mvStore
) {
this
case
AT_LEAST_ONCE
:
{
final
int
messageID
=
msg
.
variableHeader()
.
packetId();
postOffice
.
receivedPublishQos1(
this
, topic, username, payload, messageID, retain, msg);
break
+1
−1
broker/src/main/java/io/moquette/server/ConnectionDescriptor.java
+7
−17
broker/src/main/java/io/moquette/server/ConnectionDescriptorStore.java
+1
−1
broker/src/main/java/io/moquette/server/Constants.java
+40
−163
broker/src/main/java/io/moquette/spi/ClientSession.java
+229
−0
broker/src/main/java/io/moquette/spi/DurableSession.java
+28
###
OS version (e.g.
`uname -a`
)
Toggle all file notes
0 comments on commit
a49792a
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
props
.
getProperty(
BrokerConstants
.
INTERCEPT_HANDLER_PROPERTY_NAME
);
if
(interceptorClassName
!=
null
&&
!
interceptorClassName
.
isEmpty()) {
InterceptHandler
handler
new
HttpResponseEncoder
());
pipeline
.
addLast(
"
httpDecoder
"
,
new
HttpRequestDecoder
());
pipeline
.
addLast(
"
aggregator
retainedRepository
.
retain(topic, msg);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
FAKE_CLIENT_ID
));
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
connection
.
processDisconnect(
null
);
//
connect - subscribe from another connection but with same ClientID
EmbeddedChannel
secondChannel
.subscriptions.Subscription
;
import
java.util.ArrayList
;
import
java.util.Collections
;
import
java.util.LinkedList
;
import
java.util.List
;
public
class
MemorySubscriptionsRepository
implements
=
"
%JAVA_HOME%
\bin\java
"
)
)
echo
Using JAVA_HOME:
"
%JAVA_HOME%
"
echo
Using JAVA_HOME:
"
%JAVA_HOME%
"
@@ -83,6 +83,6 @@ rem set JAVA_OPTS=%JAVA_OPTS% -XX:PrintFLSStatistics=1
)
Toggle all file notes
0 comments on commit
a49792a
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
.
size());
RetainedMessage
msg
=
msgs
.
get(
0
);
assertEquals(
ByteBufUtil
.
hexDump(expectedPayload),
ByteBufUtil
.
hexDump(msg
.
0
);
return
visitor
.
getResult();
}
private
void
dfsVisit
(
INode
node
,
IVisitor<?>
visitor
,
int
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelDuplexHandler
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelHandlerContext
;
import
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
"
,
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Minor, changed header (
#536
)
Loading branch information
andsel
committed
Fork
666
Code
Issues
63
Pull requests
11
Actions
Projects
0
Wiki
Security
Insights
More
Code
Issues
Pull requests
Actions
Copy path
Cannot retrieve contributors at this time
89 lines (59 sloc)
2.84 KB
Raw
Blame
Moquette Project
Documentation reference guide
Guide on how to use and configure Moquette
Google Group
Google Group to participate in development discussions.
Moquette aims to be a MQTT compliant broker. The broker supports QoS 0, QoS 1 and QoS 2.
Its designed to be evented, uses Netty for the protocol encoding and decoding part.
Embeddable
Freedomotic
is an home automation framework and uses Moquette embedded to interface with MQTT by a specific
plugin
.
Moquette is also used into
Projects
Wiki
Security
Insights
Permalink
Dismiss
Join GitHub today
GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
Sign up
8ba0b4dfe5
moquette
/
README.md
Go to file
Go to file
T
Go to line
L
JAVA
=
"
%JAVA_HOME%
\bin\java
"
set
JAVA
=
"
%JAVA_HOME%
\bin\java
"
)
echo
Using JAVA_HOME:
"
%JAVA_HOME%
Atomize Spin
](http://atomizesoftware.com/spin) a software solution for the logistic field.
@@ -86,4 +86,4 @@ If you like Moquette you can support us by donating.
<a href="https://paypal.me/andsel">
<img src="https://cloud.githubusercontent.com/assets/743833/23549988/02d66ccc-000f-11e7-8764-a257b21377bd.gif">
</a>
</a>
Toggle all file notes
0 comments on commit
78ac8b4
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
.
queueMap
=
mvStore
.
openMap(
"
retained_store
"
);
}
@Override
public
void
cleanRetained
(
Topic
;
}
case
EXACTLY_ONCE
:
{
final
int
messageID
=
msg
.
variableHeader()
.
packetId();
final
Session
session
−0
broker/src/main/java/io/moquette/spi/EnqueuedMessage.java
+0
−1
broker/src/main/java/io/moquette/spi/IMessagesStore.java
+12
−29
broker/src/main/java/io/moquette/spi/ISessionsStore.java
+12
−49
broker/src/main/java/io/moquette/spi/ISubscriptionsStore.java
+185
−0
broker/src/main/java/io/moquette/spi/TransientSession.java
+13
−8
broker/src/main/java/io/moquette/spi/impl/InternalRepublisher.java
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
=
loadClass(interceptorClassName,
InterceptHandler
.
class,
io.moquette.broker
.
Server
.
class,
this
);
if
(handler
!=
null
"
,
new
HttpObjectAggregator
(
65536
));
pipeline
.
addLast(
"
webSocketHandler
"
,
new
WebSocketServerProtocolHandler
(
"
/mqtt
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
=
new
EmbeddedChannel
();
MQTTConnection
secondConn
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, secondChannel);
secondConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
FAKE_CLIENT_ID
));
ISubscriptionsRepository
{
2
...ver/netty/MoquetteIdleTimeoutHandler.java → ...te/broker/MoquetteIdleTimeoutHandler.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
server.netty
;
rem
set JAVA_OPTS=%JAVA_OPTS% -Xloggc:/var/log/moquette/gc.log
rem
set JAVA_OPTS=%JAVA_OPTS% -Xloggc:/var/log/moquette/gc.log
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+UseGCLogFileRotation
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+UseGCLogFileRotation
set
JAVA_OPTS
=
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
getPayload()));
}
}
Toggle all file notes
0 comments on commit
2138513
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
deep
) {
if
(node
==
null
) {
return
;
}
visitor
.
visit(node
.
mainNode(), deep);
++
deep;
io.netty.util.concurrent.EventExecutor
;
import
io.netty.util.concurrent.EventExecutor
;
8
broker/src/main/java/io/moquette/broker/MQTTConnection.java
Show comments
View file
Edit file
Delete file
@@ -15,10 +15,8 @@
*/
*/
package
io.moquette.broker
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
messageLogger
"
,
new
MQTTMessageLogger
());
pipeline
.
addLast(
"
handler
"
Insights
Permalink
Browse files
Loading status checks…
Minor, changed header (
#536
)
Loading branch information
andsel
committed
Oct 1, 2020
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
Oct 1, 2020
Verified
This commit was created on GitHub.com and signed with a
verified signature
using GitHub’s key.
GPG key ID:
4AEE18F83AFDEB23
Learn about signing commits
1 parent
6ee0137
commit
8ba0b4dfe52dce28a4eb5e362f18afaf850e71d4
Unified
Split
Showing
1 changed file
Projects
Wiki
Security
Insights
Permalink
Browse files
Loading status checks…
Avoid slow responses due to missed queue drain after a client sent ou…
Loading branch information
andsel
committed
Oct 1, 2019
1 parent
fc1b603
commit
6ee013747f6bddf4ecf3050e6349b611cfcbbd93
Atomize Spin
a software solution for the logistic field.
Part of moquette are used into the
Vertx MQTT module
, into
MQTT spy
and into
WSO2 Messge broker
.
Try the demo instance
Point your browser to
cloud instance
, request an account then use it from your MQTT clients.
1 minute set up
Start play with it, download the self distribution tar from
BinTray
, the un untar and start the broker listening on
1883
Copy path
Cannot retrieve contributors at this time
89 lines (59 sloc)
2.84 KB
Raw
Blame
Moquette Project
Documentation reference guide
Guide on how to use and configure Moquette
Google Group
Google Group to participate in development discussions.
Moquette aims to be a MQTT compliant broker. The broker supports QoS 0, QoS 1 and QoS 2.
Its designed to be evented, uses Netty for the protocol encoding and decoding part.
Embeddable
Freedomotic
is an home automation framework and uses Moquette embedded to interface with MQTT by a specific
plugin
.
"
@@ -83,6 +83,6 @@ rem set JAVA_OPTS=%JAVA_OPTS% -XX:PrintFLSStatistics=1
rem
set JAVA_OPTS=%JAVA_OPTS% -Xloggc:/var/log/moquette/gc.log
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:+UseGCLogFileRotation
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:NumberOfGCLogFiles=
10
set
JAVA_OPTS
=
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
topic
) {
queueMap
.
remove(topic);
}
@Override
public
void
retain
(
Topic
topic
,
MqttPublishMessage
msg
) {
final
=
sessionRegistry
.
retrieve(clientId);
session
.
receivedPublishQos2(messageID, msg);
postOffice
.
receivedPublishQos2(
this
, msg, username);
//
msg.release();
break
;
}
default
+8
−6
broker/src/main/java/io/moquette/spi/impl/MessagesPublisher.java
+2
−2
broker/src/main/java/io/moquette/spi/impl/PersistentQueueMessageSender.java
+63
−104
broker/src/main/java/io/moquette/spi/impl/ProtocolProcessor.java
+6
−7
broker/src/main/java/io/moquette/spi/impl/ProtocolProcessorBootstrapper.java
+1
−1
broker/src/main/java/io/moquette/spi/impl/Qos1PublishHandler.java
+6
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
) {
observers
.
add(handler);
}
}
interceptor
=
new
BrokerInterceptor
(props, observers);
}
@SuppressWarnings
(
"
unchecked
"
)
"
,
MQTT_SUBPROTOCOL_CSV_LIST
));
pipeline
.
addLast(
"
ws2bytebufDecoder
"
,
new
WebSocketFrameToByteBufDecoder
());
pipeline
.
addLast(
"
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
ConnectionTestUtils
.
assertConnectAccepted(secondChannel);
subscribe(secondConn,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
//
publish a QoS 1 message another client publish a message on the topic
EmbeddedChannel
pubChannel
=
new
EmbeddedChannel
();
MQTTConnection
pubConn
package
io.moquette.
broker
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
14
.../io/moquette/server/netty/NettyUtils.java → ...n/java/io/moquette/broker/NettyUtils.java
Show comments
View file
Edit file
Delete file
%JAVA_OPTS%
-XX:NumberOfGCLogFiles=
10
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:NumberOfGCLogFiles=
10
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
"
set
JAVA_OPTS
=
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
for
(
INode
child
:
node
.
mainNode()
.
allChildren()) {
dfsVisit(child, visitor, deep);
}
}
}
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
;
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.spi.impl.DebugUtils
;
import
io.moquette.broker.security.IAuthenticator
;
import
, handler);
configureMQTTPipeline(pipeline, timeoutHandler, handler);
}
});
}
@@ -331,28 +323,21 @@ void init(SocketChannel channel) throws Exception {
new
WebSocketServerProtocolHandler
(
"
/mqtt
"
,
MQTT_SUBPROTOCOL_CSV_LIST
));
pipeline
.
addLast(
6ee0137
commit
8ba0b4dfe52dce28a4eb5e362f18afaf850e71d4
Unified
Split
Showing
1 changed file
with
1 addition
and
1 deletion
.
+1
−1
README.md
2
README.md
with
1 addition
and
1 deletion
.
+1
−1
README.md
2
README.md
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
##
What is
Unified
Split
Showing
4 changed files
with
21 additions
and
2 deletions
.
+6
−2
broker/src/main/java/io/moquette/broker/MQTTConnection.java
+6
−0
broker/src/main/java/io/moquette/broker/NewNettyMQTTHandler.java
+5
−0
port and enjoy!
Or if you are on Windows shell
Embedding in other projects
To embed Moquette in another maven project is sufficient to include a repository and declare the dependency:
Include dependency in your project:
Build from sources
After a git clone of the repository, cd into the cloned sources and:
./gradlew clean moquette-distribution:distMoquetteTar
or
./gradlew clean moquette-distribution:distMoquetteZip
.
In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
If you like Moquette you can support us by donating.
Go
© 2020 GitHub, Inc.
Terms
Privacy
Moquette is also used into
Atomize Spin
a software solution for the logistic field.
Part of moquette are used into the
Vertx MQTT module
, into
MQTT spy
and into
WSO2 Messge broker
.
Try the demo instance
Point your browser to
cloud instance
, request an account then use it from your MQTT clients.
1 minute set up
Start play with it, download the self distribution tar from
BinTray
, the un untar and start the broker listening on
%JAVA_OPTS%
-XX:GCLogFileSize=10M
"
set
JAVA_OPTS
=
%JAVA_OPTS%
-XX:GCLogFileSize=10M
%JAVA%
-server
%JAVA_OPTS%
%JAVA_OPTS_SCRIPT%
-Dlog4j.configuration=file:
%LOG_FILE%
-Dmoquette.path=
%MOQUETTE_PATH%
-cp
%MOQUETTE_HOME%
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
ByteBuf
payload
=
msg
.
content();
byte
[] rawPayload
=
new
byte
[payload
.
readableBytes()];
payload
.
getBytes(
0
:
LOG
.
error(
"
Unknown QoS-Type:{}
"
, qos);
break
;
}
}
void
sendPublishReceived
(
int
messageID
) {
−7
broker/src/main/java/io/moquette/spi/impl/Qos2PublishHandler.java
+126
−0
broker/src/main/java/io/moquette/spi/impl/SessionsRepository.java
+15
−28
broker/src/main/java/io/moquette/spi/impl/subscriptions/CNode.java
+34
−27
broker/src/main/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectory.java
+3
−4
broker/src/main/java/io/moquette/spi/impl/subscriptions/ISubscriptionsDirectory.java
+17
−7
broker/src/main/java/io/moquette/spi/impl/subscriptions/Subscription.java
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
private
<
T
,
U
>
T
loadClass
(
String
className
,
Class<
T
>
intrface
bytebuf2wsEncoder
"
,
new
ByteBufToWebSocketFrameEncoder
());
configureMQTTPipeline(pipeline, timeoutHandler, handler);
}
});
}
@SuppressWarnings
(
"
FutureReturnValueIgnored
"
)
public
Save preferences
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, pubChannel);
pubConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
PUBLISHER_ID
));
ConnectionTestUtils
.
assertConnectAccepted(pubChannel);
final
ByteBuf
@@ -14,9 +14,8 @@
* You may elect to redistribute this code under either of these licenses.
*/
package
io.moquette.
server.netty
;
package
io.moquette.
broker
;
import
io.moquette.server.Constants
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelHandlerContext
%JAVA_OPTS%
-XX:GCLogFileSize=10M
%JAVA%
-server
%JAVA_OPTS%
%JAVA_OPTS_SCRIPT%
-Dlog4j.configuration=file:
%LOG_FILE%
-Dmoquette.path=
%MOQUETTE_PATH%
-cp
%MOQUETTE_HOME%
\lib\* io.moquette.broker.Server
%JAVA%
-server
%JAVA_OPTS%
%JAVA_OPTS_SCRIPT%
-Dlog4j.configuration=file:
Save preferences
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
80daadf
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
io.moquette.spi.impl.subscriptions.Topic
;
import
io.moquette.spi.security.IAuthenticator
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.channel.Channel
;
import
io.netty.channel.Channel
;
import
"
ws2bytebufDecoder
"
,
new
WebSocketFrameToByteBufDecoder
());
pipeline
.
addLast(
"
bytebuf2wsEncoder
"
,
new
ByteBufToWebSocketFrameEncoder
());
pipeline
.
Show comments
View file
Edit file
Delete file
@@ -1,5 +1,5 @@
##
What is
Moquette
?
##
Moquette
Project
[![
Build Status
](https://api.travis-ci.org/moquette-io/moquette.svg?branch=master)](https://travis-ci.org/moquette-io/moquette)
Toggle all file notes
0 comments on commit
Moquette
?
##
Moquette
Project
[![
Build Status
](https://api.travis-ci.org/moquette-io/moquette.svg?branch=master)](https://travis-ci.org/moquette-io/moquette)
[![
Build Status
](https://api.travis-ci.org/moquette-io/moquette.svg?branch=master)](https://travis-ci.org/moquette-io/moquette)
Toggle all file notes
0 comments on commit
8ba0b4d
Please
sign in
to comment.
broker/src/main/java/io/moquette/broker/PostOffice.java
+4
−0
broker/src/main/java/io/moquette/broker/Session.java
8
broker/src/main/java/io/moquette/broker/MQTTConnection.java
Show comments
View file
Edit file
Delete file
@@ -406,8 +406,7 @@ void sendIfWritableElseDrop(MqttMessage msg) {
ChannelFuture
channelFuture;
if
(brokerConfig
.
isImmediateBufferFlush()) {
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
1883
port and enjoy!
Or if you are on Windows shell
Embedding in other projects
To embed Moquette in another maven project is sufficient to include a repository and declare the dependency:
Include dependency in your project:
Build from sources
After a git clone of the repository, cd into the cloned sources and:
./gradlew clean moquette-distribution:distMoquetteTar
or
./gradlew clean moquette-distribution:distMoquetteZip
.
In distribution/build directory will be produced the selfcontained file for the broker with all dependencies and a running script.
If you like Moquette you can support us by donating.
Go
© 2020 GitHub, Inc.
Terms
Privacy
\lib\* io.moquette.broker.Server
Toggle all file notes
0 comments on commit
d2cce3f
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
, rawPayload);
final
RetainedMessage
toStore
=
new
RetainedMessage
(msg
.
fixedHeader()
.
qosLevel(), rawPayload);
queueMap
.
put(topic, toStore);
}
@Override
public
LOG
.
trace(
"
sendPubRec invoked on channel: {}
"
, channel);
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBREC
,
+0
−243
broker/src/main/java/io/moquette/spi/impl/subscriptions/SubscriptionsDirectory.java
+0
−180
broker/src/main/java/io/moquette/spi/impl/subscriptions/TreeNode.java
+6
−5
broker/src/test/java/io/moquette/persistence/MessageStoreTCK.java
+32
−20
broker/src/test/java/io/moquette/spi/ClientSessionTest.java
+8
−6
broker/src/test/java/io/moquette/spi/impl/AbstractProtocolProcessorCommonUtils.java
+25
−20
,
Class<
U
>
constructorArgClass
,
U
props
) {
T
instance
=
null
;
try
{
//
void
close
() {
LOG
.
debug(
"
Closing Netty acceptor...
"
);
if
(workerGroup
==
null
||
bossGroup
==
null
) {
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos1(pubConn,
new
Topic
(
;
import
io.netty.util.Attribute
;
@@ -28,12 +27,13 @@
public
final
class
NettyUtils
{
public
static
final
String
ATTR_USERNAME
=
"
username
%LOG_FILE%
-Dmoquette.path=
%MOQUETTE_PATH%
-cp
%MOQUETTE_HOME%
\lib\* io.moquette.broker.Server
Toggle all file notes
0 comments on commit
d2cce3f
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Accept
Reject
Save preferences
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
io.netty.channel.ChannelPipeline
;
import
io.netty.channel.ChannelPipeline
;
@@ -154,7 +152,7 @@ void processConnect(MqttConnectMessage msg) {
//
Generating client id.
//
Generating client id.
clientId
=
UUID
.
randomUUID()
.
toString()
.
replace(
addFirst(
"
idleStateHandler
"
,
new
IdleStateHandler
(nettyChannelTimeoutSeconds,
0
,
0
));
pipeline
.
addAfter(
"
idleStateHandler
8ba0b4d
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
channelFuture
=
channel
.
writeAndFlush(msg);
}
else
{
}
else
{
channelFuture
=
channel
.
write(msg);
}
channelFuture
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
boolean
isEmpty
() {
return
queueMap
.
isEmpty();
}
@Override
public
List<
RetainedMessage
>
retainedOnTopic
(
String
topic
false
,
AT_MOST_ONCE
,
false
,
0
);
MqttPubAckMessage
pubRecMessage
=
new
MqttPubAckMessage
(fixedHeader, from(messageID));
sendIfWritableElseDrop(pubRecMessage);
}
private
void
processPubRel
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessorTest.java
+10
−6
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_CONNECT_Test.java
+2
−2
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_InternalPublish_Test.java
+0
−6
broker/src/test/java/io/moquette/spi/impl/ProtocolProcessor_VariousUseCases_Test.java
+53
−51
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryMatchingTest.java
+15
−13
broker/src/test/java/io/moquette/spi/impl/subscriptions/CTrieSubscriptionDirectoryTest.java
check if constructor with constructor arg class parameter
//
exists
LOG
.
info(
"
"
,
constructorArgClass
.
getName(), className, intrface
.
getName());
instance
=
this
.
LOG
.
error(
"
Netty acceptor is not initialized
"
);
throw
new
IllegalStateException
(
"
Invoked close on an Acceptor that wasn't initialized
"
);
}
Future<?>
workerWaiter
=
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
,
MqttMessageBuilders
.
publish()
.payload(anyPayload
.
retainedDuplicate())
.qos(
MqttQoS
.
"
;
public
static
final
String
ATTR_SESSION_STOLEN
=
"
sessionStolen
"
;
public
static
final
String
ATTR_CHANNEL_STATUS
=
"
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
"
-
"
,
"
"
);
clientId
=
UUID
.
"
,
"
idleEventHandler
"
, timeoutHandler);
pipeline
.
addFirst(
"
bytemetrics
"
,
new
BytesMetricsHandler
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
@@ -501,4 +500,9 @@ public String toString() {
InetSocketAddress
remoteAddress
() {
return
(
InetSocketAddress
) channel
.
remoteAddress();
}
public
void
readCompleted
() {
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
) {
final
Topic
searchTopic
=
new
Topic
(topic);
final
List<
RetainedMessage
>
matchingMessages
=
new
ArrayList<>
();
(
MqttMessage
msg
) {
final
Session
session
=
sessionRegistry
.
retrieve(getClientId());
final
int
messageID
=
((
MqttMessageIdVariableHeader
+0
−332
broker/src/test/java/io/moquette/spi/impl/subscriptions/SubscriptionsDirectoryTest.java
+0
−76
broker/src/test/java/io/moquette/spi/impl/subscriptions/TreeNodeTest.java
+43
−89
h2_storage/src/main/java/io/moquette/persistence/h2/H2SessionsStore.java
+2
−0
h2_storage/src/test/java/io/moquette/persistence/h2/H2MessagesStoreTest.java
+40
−88
mapdb_storage/src/main/java/io/moquette/persistence/mapdb/MapDBSessionsStore.java
+2
−0
getClass()
.
getClassLoader()
.loadClass(className)
.asSubclass(intrface)
.getConstructor(constructorArgClass)
.newInstance(props);
}
catch
(
InstantiationException
|
IllegalAccessException
|
workerGroup
.
shutdownGracefully();
Future<?>
bossWaiter
=
bossGroup
.
shutdownGracefully();
/*
* We shouldn't raise an IllegalStateException if we are interrupted. If we did so, the
* broker is not shut down properly.
AT_LEAST_ONCE
)
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify that after a reconnection the client receive the message
ConnectionTestUtils
.
verifyPublishIsReceived(secondChannel,
AT_LEAST_ONCE
,
"
Any payload
"
channelStatus
"
;
private
static
final
AttributeKey<
Object
>
ATTR_KEY_KEEPALIVE
=
AttributeKey
.
valueOf(
Constants
.
KEEP_ALIVE
);
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
randomUUID()
.
toString()
.
replace(
"
-
"
,
"
"
);
LOG
.
debug(
"
Client has connected with
server
(m_bytesMetricsCollector));
pipeline
.
addLast(
"
autoflush
"
,
new
AutoFlushHandler
(
1
,
TimeUnit
.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
//
TODO drain all messages in target's session in-flight message queue
postOffice
.
flushInFlight(
this
);
}
}
6
broker/src/main/java/io/moquette/broker/NewNettyMQTTHandler.java
Show comments
View file
Edit file
Delete file
@@ -70,6 +70,12 @@ public void operationComplete(ChannelFuture future) {
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
for
(
Map
.
Entry<
Topic
,
RetainedMessage
>
entry
:
queueMap
.
entrySet()) {
final
Topic
scanTopic
) msg
.
variableHeader())
.
messageId();
session
.
receivedPubRelQos2(messageID);
sendPubCompMessage(messageID);
}
void
sendPublish
(
MqttPublishMessage
publishMsg
) {
final
int
mapdb_storage/src/test/java/io/moquette/persistence/mapdb/MapDBPersistentStoreTest.java
+5
−3
perf/src/main/java/io/moquette/spi/impl/subscriptions/PerformanceTest.java
8
broker/src/main/java/io/moquette/connections/IConnectionsManager.java
Show comments
View file
Edit file
Delete file
@@ -55,14 +55,6 @@
*/
boolean
closeConnection
(
String
ClassNotFoundException
ex) {
LOG
.
warn(
"
"
+
"
errorMessage={}
"
, constructorArgClass
.
getName(), className, intrface
.
getName(), ex
.
*/
LOG
.
info(
"
Waiting for worker and boss event loop groups to terminate...
"
);
try
{
workerWaiter
.
await(
10
,
TimeUnit
.
SECONDS
);
}
@Test
public
void
noPublishToInactiveSession
() {
//
create an inactive session for Subscriber
connection
.
processConnect(
ConnectionTestUtils
.
buildConnectNotClean(
SUBSCRIBER_ID
));
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLEANSESSION
=
AttributeKey
.
valueOf(
Constants
.
CLEAN_SESSION
);
private
static
Reject
Save preferences
"
, clientId,
LOG
.
debug(
"
Client has connected with
integration
"
, clientId,
username, channel);
username, channel);
}
}
2
broker/src/main/java/io/moquette/broker/MQTTConnectionFactory.java
Show comments
SECONDS
));
pipeline
.
addLast(
"
decoder
"
,
new
MqttDecoder
(maxBytesInMessage));
pipeline
.
addLast(
"
encoder
"
,
Learn more
Accept
Reject
Save preferences
}
}
@Override
public
void
channelReadComplete
(
ChannelHandlerContext
ctx
)
throws
Exception
{
final
MQTTConnection
mqttConnection
=
=
entry
.
getKey();
if
(searchTopic
.
match(scanTopic)) {
matchingMessages
.
add(entry
.
getValue());
}
}
return
matchingMessages;
packetId
=
publishMsg
.
variableHeader()
.
packetId();
final
String
topicName
=
publishMsg
.
variableHeader()
.
topicName();
final
clientID
,
boolean
closeImmediately
);
/**
* Returns the state of the session of a given client.
*
*
@param
clientID
*
@return
*/
MqttSession
getSessionStatus
(
String
getCause(),
ex
.
getMessage());
return
null
;
}
catch
(
NoSuchMethodException
|
InvocationTargetException
e) {
try
{
LOG
.
);
bossWaiter
.
await(
10
,
TimeUnit
.
SECONDS
);
}
catch
(
InterruptedException
iex) {
LOG
.
ConnectionTestUtils
.
assertConnectAccepted(channel);
subscribe(connection,
NEWS_TOPIC
,
AT_LEAST_ONCE
);
connection
.
processDisconnect(
null
);
//
Exercise
EmbeddedChannel
pubChannel
final
AttributeKey<
Object
>
ATTR_KEY_CLIENTID
=
AttributeKey
.
valueOf(
Constants
.
ATTR_CLIENTID
);
private
static
final
String
ATTR_CLIENTID
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
*/
package
io.moquette.broker
;
package
io.moquette.broker
;
import
io.moquette.
spi
.security.IAuthenticator
MqttEncoder
.
INSTANCE
);
pipeline
.
addLast(
"
metrics
"
,
new
MessageMetricsHandler
(m_metricsCollector));
pipeline
.
addLast(
"
mqttConnection(ctx
.
channel());
mqttConnection
.
readCompleted();
}
@Override
public
void
channelActive
(
ChannelHandlerContext
ctx
) {
MQTTConnection
connection
=
}
}
10
broker/src/test/java/io/moquette/broker/PostOfficePublishTest.java
Show comments
View file
Edit file
Delete file
@@ -390,7 +390,7 @@ public void cleanRetainedMessageStoreWhenPublishWithRetainedQos0IsReceived() {
sut
.
receivedPublishQos1(connection,
new
Topic
(
NEWS_TOPIC
String
clientId
=
getClientId();
MqttQoS
qos
=
publishMsg
.
fixedHeader()
.
qosLevel();
if
(
LOG
.
isTraceEnabled()) {
LOG
clientID
);
/**
* Returns the state of all the sessions
*
139
broker/src/main/java/io/moquette/persistence/MemorySessionStore.java
Show comments
View file
Edit file
Delete file
@@ -17,7 +17,6 @@
package
info(
"
"
, className, intrface
.
getName());
//
fallback to default constructor
instance
=
this
.
getClass()
.
getClassLoader()
.loadClass(className)
.asSubclass(intrface)
warn(
"
An InterruptedException was caught while waiting for event loops to terminate...
"
);
}
if
(
!
workerGroup
.
isTerminated()) {
LOG
.
warn(
"
Forcing shutdown of worker event loop...
"
=
new
EmbeddedChannel
();
MQTTConnection
pubConn
=
createMQTTConnection(
ALLOW_ANONYMOUS_AND_ZERO_BYTES_CLID
, pubChannel);
pubConn
.
processConnect(
ConnectionTestUtils
.
buildConnect(
PUBLISHER_ID
));
=
"
ClientID
"
;
private
static
final
String
CLEAN_SESSION
=
"
removeTemporaryQoS2
"
;
private
static
final
;
import
io.moquette.
broker
.security.IAuthenticator
;
import
io.netty.channel.Channel
;
import
io.netty.channel.Channel
;
class
MQTTConnectionFactory
{
class
messageLogger
"
,
new
MQTTMessageLogger
());
pipeline
.
addLast(
"
handler
"
, handler);
configureMQTTPipeline(pipeline, timeoutHandler, handler);
}
});
}
@SuppressWarnings
connectionFactory
.
create(ctx
.
channel());
5
broker/src/main/java/io/moquette/broker/PostOffice.java
Show comments
View file
Edit file
Delete file
@@ -308,4 +308,9 @@ void dispatchDisconnection(String clientId,String userName){
void
dispatchConnectionLost
(
String
),
TEST_USER
, anyPayload,
1
,
true
,
sut
.
receivedPublishQos1(connection,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
.
trace(
"
"
, qos, packetId,
clientId, topicName,
DebugUtils
.
payload2Str(publishMsg
.
payload()));
}
else
{
LOG
.
io.moquette.persistence
;
import
io.moquette.server.Constants
;
import
io.moquette.spi.ClientSession
;
import
io.moquette.spi.IMessagesStore.StoredMessage
;
import
io.moquette.spi.ISessionsStore
;
import
io.moquette.spi.ISubscriptionsStore
;
@@ -30,32 +29,30 @@
.getDeclaredConstructor()
.
newInstance();
}
catch
(
InstantiationException
|
IllegalAccessException
|
ClassNotFoundException
|
NoSuchMethodException
|
InvocationTargetException
ex) {
LOG
);
workerGroup
.
shutdownGracefully(
0L
,
0L
,
TimeUnit
.
MILLISECONDS
);
}
if
(
!
bossGroup
ConnectionTestUtils
.
assertConnectAccepted(pubChannel);
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
sut
String
KEEP_ALIVE
=
"
keepAlive
"
;
private
static
final
AttributeKey<
Object
>
ATTR_KEY_KEEPALIVE
=
AttributeKey
.
MQTTConnectionFactory
{
2
broker/src/main/java/io/moquette/broker/MemoryRetainedRepository.java
Show comments
View file
Edit file
Delete file
@@ -15,7 +15,7 @@
*/
*/
package
io.moquette.broker
;
package
io.moquette.broker
(
"
FutureReturnValueIgnored
"
)
public
void
close
() {
LOG
.
debug(
"
Closing Netty acceptor...
"
);
if
(
clientId
,
String
userName
){
interceptor
.
notifyClientConnectionLost(clientId,userName);
}
void
flushInFlight
(
MQTTConnection
mqttConnection
) {
Session
targetSession
=
,
true
,
publishMsg);
publishMsg);
assertMessageIsRetained(
NEWS_TOPIC
);
assertMessageIsRetained(
NEWS_TOPIC
, anyPayload
);
//
publish a QoS0 retained message
//
publish a QoS0 retained message
//
debug(
"
"
, qos, packetId, clientId,
topicName);
}
sendIfWritableElseDrop(publishMsg);
}
void
sendIfWritableElseDrop
(
MqttMessage
msg
) {
if
(
LOG
import
java.util.concurrent.ArrayBlockingQueue
;
import
java.util.concurrent.BlockingQueue
;
import
java.util.concurrent.ConcurrentHashMap
;
import
java.util.concurrent.atomic.AtomicReference
;
public
class
MemorySessionStore
implements
.
error(
"
"
+
"
errorMessage={}
"
, className, intrface
.
getName(), ex
.
getCause(), ex
.
getMessage());
return
null
;
}
.
isTerminated()) {
LOG
.
warn(
"
Forcing shutdown of boss event loop...
"
);
bossGroup
.
shutdownGracefully(
0L
,
0L
,
TimeUnit
.
.
receivedPublishQos1(pubConn,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
, anyPayload,
1
,
true
,
MqttMessageBuilders
.
publish()
.payload(anyPayload)
.qos(
valueOf(
KEEP_ALIVE
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLEANSESSION
=
AttributeKey
.
valueOf(
CLEAN_SESSION
);
private
static
;
import
io.moquette.
spi.impl
.subscriptions.Topic
;
import
io.moquette.
broker
.subscriptions.Topic
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
import
io.netty.handler.codec.mqtt.MqttPublishMessage
;
m_workerGroup
==
null
||
m_bossGroup
==
null
) {
if
(
workerGroup
==
null
||
bossGroup
==
null
) {
LOG
sessionRegistry
.
retrieve(mqttConnection
.
getClientId());
targetSession
.
flushAllQueuedMessages();
}
}
4
broker/src/main/java/io/moquette/broker/Session.java
Show comments
View file
Edit file
Delete file
@@ -281,6 +281,10 @@ void pubAckReceived(int ackPacketId) {
Exercise
//
Exercise
@@ -406,8 +406,10 @@ public void cleanRetainedMessageStoreWhenPublishWithRetainedQos0IsReceived() {
assertTrue(
"
Retained message for topic /news must be cleared
"
, retainedRepository
.
isEmpty());
assertTrue(
"
Retained message for topic /news must be cleared
"
, retainedRepository
.
isEmpty());
.
isDebugEnabled()) {
LOG
.
debug(
"
"
, msg
.
fixedHeader()
.
messageType(), channel);
}
if
(channel
.
isWritable()) {
ISessionsStore
,
ISubscriptionsStore
{
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
MemorySessionStore
.
class);
class
Session
}
return
instance;
}
/**
* Use the broker to publish a message. It's intended for embedding applications. It can be used
* only after the integration is correctly started with startServer.
*
*
@param
msg the message to forward.
*
@param
clientId the id of the sending integration.
*
@throws
IllegalStateException if the integration is not yet started
*/
MILLISECONDS
);
}
MessageMetrics
metrics
=
metricsCollector
.
computeMetrics();
BytesMetrics
bytesMetrics
=
bytesMetricsCollector
.
computeMetrics();
LOG
.
info(
"
MqttQoS
.
AT_LEAST_ONCE
)
.retained(
true
)
.topicName(
NEWS_TOPIC
)
.
build());
verifyNoPublishIsReceived(channel);
}
private
void
verifyNoPublishIsReceived
final
AttributeKey<
Object
>
ATTR_KEY_CLIENTID
=
AttributeKey
.
valueOf(
ATTR_CLIENTID
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_USERNAME
=
import
java.util.concurrent.ConcurrentHashMap
;
import
java.util.concurrent.ConcurrentHashMap
;
3
broker/src/main/java/io/moquette/broker/MemorySubscriptionsRepository.java
Show comments
View file
Edit file
Delete file
@@ -15,11 +15,10 @@
*/
*/
package
.
error(
"
Netty acceptor is not initialized
"
);
throw
new
IllegalStateException
(
"
Invoked close on an Acceptor that wasn't initialized
"
);
}
Future<?>
workerWaiter
drainQueueToConnection();
}
public
void
flushAllQueuedMessages
() {
drainQueueToConnection();
}
public
void
resendInflightNotAcked
() {
Collection<
InFlightPacket
>
expired
=
new
}
}
private
void
assertMessageIsRetained
(
String
expectedTopicName
) {
private
void
assertMessageIsRetained
(
String
expectedTopicName
,
ByteBuf
channel
.
write(msg)
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
}
public
void
writabilityChanged
() {
if
(channel
.
isWritable()) {
LOG
.
{
final
String
clientID;
final
ClientSession
clientSession;
final
Map<
Topic
,
Subscription
>
subscriptions
=
new
ConcurrentHashMap<>
();
public
void
internalPublish
(
MqttPublishMessage
msg
,
final
String
clientId
) {
final
int
messageID
=
msg
.
variableHeader()
"
, metrics
.
messagesRead(),
metrics
.
messagesWrote(), bytesMetrics
.
readBytes(), bytesMetrics
.
wroteBytes());
}
private
ChannelHandler
createSslHandler
(
SocketChannel
channel
(
EmbeddedChannel
channel
) {
final
Object
messageReceived
=
channel
.
readOutbound();
assertNull(
"
Received an out message from processor while not expected
"
, messageReceived);
}
@Test
AttributeKey
.
valueOf(
ATTR_USERNAME
);
public
static
Object
getAttribute
(
ChannelHandlerContext
ctx
,
AttributeKey<
Object
>
key
) {
io.moquette.broker
;
package
io.moquette.broker
;
import
io.moquette.
spi.impl
.subscriptions.Subscription
;
import
io.moquette.
broker
.subscriptions.Subscription
;
import
java.util.ArrayList
=
m_workerGroup
.
shutdownGracefully();
Future<?>
bossWaiter
=
m_bossGroup
.
shutdownGracefully();
Future<?>
workerWaiter
=
workerGroup
.
shutdownGracefully();
Future<?>
bossWaiter
ArrayList<>
(
INFLIGHT_WINDOW_SIZE
);
inflightTimeouts
.
drainTo(expired);
Toggle all file notes
0 comments on commit
6ee0137
Please
sign in
to comment.
© 2020 GitHub, Inc.
expectedPayload
) {
MqttPublishMessage
msg
=
retainedRepository
.
retainedOnTopic(expectedTopicName);
List<
RetainedMessage
>
msgs
=
retainedRepository
.
retainedOnTopic(expectedTopicName);
assertEquals(expectedTopicName, msg
debug(
"
Channel {} is again writable
"
, channel);
final
Session
session
=
sessionRegistry
.
retrieve(getClientId());
session
.
writabilityChanged();
}
}
void
final
AtomicReference<
PersistentSession
>
persistentSession
=
new
AtomicReference<>
(
null
)
;
boolean
cleanSession
;
final
BlockingQueue<
StoredMessage
.
packetId();
if
(
!
initialized) {
LOG
.
error(
"
"
, clientId,
messageID);
throw
new
IllegalStateException
(
"
,
SslContext
sslContext
,
boolean
needsClientAuth
) {
SSLEngine
sslEngine
=
sslContext
.
newEngine(
channel
.
alloc(),
public
void
cleanRetainedMessageStoreWhenPublishWithRetainedQos0IsReceived
() {
connection
.
processConnect(connectMessage);
ConnectionTestUtils
.
assertConnectAccepted(channel);
14
broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java
Show comments
View file
Edit file
Delete file
@@ -17,12 +17,8 @@
package
io.moquette.broker
;
import
io.moquette.BrokerConstants
;
import
java.util.ArrayList
;
import
java.util.Collections
;
import
java.util.Collections
;
import
java.util.LinkedList
=
bossGroup
.
shutdownGracefully();
/*
* We shouldn't raise an IllegalStateException if we are interrupted. If we did so, the
@@ -366,20 +351,20 @@ public void close() {
LOG
.
warn(
"
An InterruptedException was caught while waiting for event loops to terminate...
"
);
}
if
(
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
.
variableHeader()
.
topicName());
assertEquals(
1
, msgs
.
size());
RetainedMessage
msg
=
msgs
.
get(
0
);
sendPubAck
(
int
messageID
) {
LOG
.
trace(
"
sendPubAck invoked
"
);
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
>
queue
=
new
ArrayBlockingQueue<>
(
Constants
.
MAX_MESSAGE_QUEUE
);
final
Map<
Integer
,
StoredMessage
>
secondPhaseStore
=
Can't publish on a integration is not yet started
"
);
}
LOG
.
trace(
"
"
, clientId, messageID);
dispatcher
.
internalPublish(msg);
}
public
void
stopServer
channel
.
remoteAddress()
.
getHostString(),
channel
.
remoteAddress()
.
getPort());
sslEngine
.
setUseClientMode(
false
);
if
(needsClientAuth) {
sslEngine
//
publish a QoS1 retained message
final
ByteBuf
anyPayload
=
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset());
final
MqttPublishMessage
;
import
io.moquette.server.config.IConfig
;
import
io.moquette.server.netty.AutoFlushHandler
;
import
io.moquette.server.netty.BugSnagErrorsHandler
;
import
io.moquette.server.netty.MoquetteIdleTimeoutHandler
;
import
io.moquette.server.netty.metrics.*
;
import
io.moquette.spi.security.ISslContextCreator
;
import
java.util.List
;
import
java.util.List
;
public
class
MemorySubscriptionsRepository
implements
ISubscriptionsRepository
{
public
class
MemorySubscriptionsRepository
implements
ISubscriptionsRepository
!
m_workerGroup
.
isTerminated()) {
if
(
!
workerGroup
.
isTerminated()) {
LOG
.
warn(
"
Forcing shutdown of worker event loop...
"
);
m_workerGroup
.
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
assertEquals(
ByteBufUtil
.
hexDump(expectedPayload),
ByteBufUtil
.
hexDump(msg
.
getPayload()));
}
}
}
}
Toggle all file notes
0 comments on commit
2138513
Please
(
MqttMessageType
.
PUBACK
,
false
,
AT_MOST_ONCE
,
false
,
0
);
MqttPubAckMessage
pubAckMessage
=
new
new
ConcurrentHashMap<>
();
final
Map<
Integer
,
StoredMessage
>
outboundFlightMessages
=
Collections
.
synchronizedMap(
new
HashMap<
Integer
,
() {
LOG
.
info(
"
Unbinding integration from the configured ports
"
);
acceptor
.
close();
LOG
.
trace(
"
Stopping MQTT protocol processor
"
);
.
setNeedClientAuth(
true
);
}
return
new
SslHandler
(sslEngine);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
publishMsg
=
MqttMessageBuilders
.
publish()
.payload(
Unpooled
.
copiedBuffer(
"
Any payload
"
,
Charset
.
defaultCharset()))
.qos(
MqttQoS
.
;
import
io.moquette.broker.config.IConfig
;
import
io.moquette.broker.metrics.*
;
import
io.netty.bootstrap.ServerBootstrap
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.channel.*
;
@@ -172,7 +168,7 @@ private boolean securityPortsConfigured(IConfig props) {
{
2
...ver/netty/MoquetteIdleTimeoutHandler.java → ...te/broker/MoquetteIdleTimeoutHandler.java
Show comments
View file
Edit file
Delete file
@@ -14,7 +14,7 @@
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.
server.netty
;
package
shutdownGracefully(
0L
,
0L
,
TimeUnit
.
MILLISECONDS
);
workerGroup
.
shutdownGracefully(
0L
,
0L
,
TimeUnit
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
MqttPubAckMessage
(fixedHeader, from(messageID));
sendIfWritableElseDrop(pubAckMessage);
}
private
void
sendPubCompMessage
(
int
messageID
) {
LOG
.
trace(
"
"
, channel, messageID);
MqttFixedHeader
StoredMessage
>
());
final
Map<
Integer
,
StoredMessage
>
inboundFlightMessages
=
new
ConcurrentHashMap<>
();
Session
(
String
initialized
=
false
;
//
calling shutdown() does not actually stop tasks that are not cancelled,
//
and SessionsRepository does not stop its tasks. Thus shutdownNow().
scheduler
.
shutdownNow();
if
(h2Builder
!=
null
) {
LOG
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
AT_LEAST_ONCE
)
.retained(
true
)
.topicName(
NEWS_TOPIC
)
.build();
sut
.
receivedPublishQos1(connection,
new
Topic
(
NEWS_TOPIC
),
TEST_USER
}
private
void
initFactory
(
String
host
,
int
port
,
String
protocol
,
final
PipelineInitializer
pipelieInitializer
) {
LOG
io.moquette.
broker
;
import
org.slf4j.Logger
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
org.slf4j.LoggerFactory
;
14
.../io/moquette/server/netty/NettyUtils.java → ...n/java/io/moquette/broker/NettyUtils.java
Show comments
.
MILLISECONDS
);
}
if
(
!
m_bossGroup
.
isTerminated()) {
if
(
!
bossGroup
.
isTerminated()) {
LOG
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBCOMP
,
false
,
AT_MOST_ONCE
,
false
,
0
);
MqttMessage
clientID
,
ClientSession
clientSession
) {
Session
(
String
clientID
,
boolean
cleanSession
) {
this
.
clientID
=
clientID;
.
trace(
"
Shutting down H2 persistence {}
"
);
h2Builder
.
closeStore();
}
LOG
.
info(
"
Moquette integration has been stopped.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
, anyPayload,
1
,
true
,
publishMsg);
assertMessageIsRetained(
NEWS_TOPIC
, anyPayload);
//
publish a QoS0 retained message
//
Exercise
final
ByteBuf
qos0Payload
=
.
debug(
"
Initializing
server
. Protocol={}
"
, protocol);
LOG
.
debug(
"
Initializing
integration
. Protocol={}
"
, protocol);
View file
Edit file
Delete file
@@ -14,9 +14,8 @@
* You may elect to redistribute this code under either of these licenses.
* You may elect to redistribute this code under either of these licenses.
*/
*/
package
io.moquette.
server.netty
;
package
io.moquette.
broker
;
import
.
warn(
"
Forcing shutdown of boss event loop...
"
);
m_bossGroup
.
shutdownGracefully(
0L
,
0L
,
TimeUnit
.
MILLISECONDS
);
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
pubCompMessage
=
new
MqttMessage
(fixedHeader, from(messageID));
sendIfWritableElseDrop(pubCompMessage);
}
String
getClientId
() {
return
NettyUtils
.
clientID(channel);
}
public
void
this
.
clientSession
=
clientSession
;
this
.
cleanSession
=
cleanSession
;
}
}
private
final
"
);
}
/**
* SPI method used by Broker embedded applications to get list of subscribers. Returns null if
* the broker is not started.
*
*
@return
list of subscriptions.
*/
//
TODO reimplement this
//
public List<Subscription> getSubscriptions() {
//
if (m_processorBootstrapper == null) {
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
Unpooled
.
copiedBuffer(
"
QoS0 payload
"
,
Charset
.
defaultCharset());
sut
.
receivedPublishQos0(
new
Topic
(
NEWS_TOPIC
),
ServerBootstrap
b
=
new
ServerBootstrap
();
b
.
group(bossGroup, workerGroup)
.
channel(channelClass)
.childHandler(
new
ChannelInitializer<
SocketChannel
>
() {
@@ -187,13 +183,13 @@ public void initChannel(SocketChannel ch) throws Exception {
io.moquette.server.Constants
;
import
io.netty.channel.Channel
;
import
io.netty.channel.Channel
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.channel.ChannelHandlerContext
;
import
io.netty.util.Attribute
;
bossGroup
.
shutdownGracefully(
0L
,
0L
,
TimeUnit
.
MILLISECONDS
);
}
MessageMetrics
metrics
=
m_metricsCollector
.
sendPublishRetainedQos0
(
Topic
topic
,
MqttQoS
qos
,
ByteBuf
payload
) {
MqttPublishMessage
publishMsg
=
retainedPublish(topic
.
toString(), qos, payload);
sendPublish(publishMsg);
Map<
String
,
Session
>
sessions
=
new
ConcurrentHashMap<>
();
public
MemorySessionStore
() {
MemorySessionStore
() {
}
private
Session
//
return null;
//
}
//
return this.subscriptionsStore.listAllSubscriptions();
//
}
/**
* SPI method used by Broker embedded applications to add intercept handlers.
*
*
@param
interceptHandler the handler to add.
*/
public
void
addInterceptHandler
TEST_USER
, connection
.
getClientId(), qos0Payload,
true
,
MqttMessageBuilders
.
publish()
.payload(qos0Payload)
.qos(
MqttQoS
.
AT_MOST_ONCE
)
.retained(
.childOption(
ChannelOption
.
TCP_NODELAY
, nettyTcpNodelay)
.childOption(
ChannelOption
.
SO_KEEPALIVE
, nettySoKeepalive);
try
{
LOG
.
debug(
"
Binding
import
io.netty.util.Attribute
;
@@ -28,12 +27,13 @@
public
final
class
NettyUtils
{
public
final
class
NettyUtils
{
public
static
computeMetrics();
BytesMetrics
bytesMetrics
=
m_bytesMetricsCollector
.
computeMetrics();
MessageMetrics
metrics
=
metricsCollector
.
computeMetrics();
BytesMetrics
bytesMetrics
=
bytesMetricsCollector
.
}
public
void
sendPublishRetainedWithPacketId
(
Topic
topic
,
MqttQoS
qos
,
ByteBuf
payload
) {
final
int
packetId
=
getSession
(
String
clientID
) {
@@ -110,64 +107,57 @@ public boolean contains(String clientID) {
}
@Override
public
ClientSession
createNewSession
(
String
clientID
,
boolean
cleanSession
) {
LOG
(
InterceptHandler
interceptHandler
) {
if
(
!
initialized) {
LOG
.
error(
"
Moquette is not started, MQTT message interceptor cannot be added. InterceptorId={}
"
,
interceptHandler
.
getID());
false
)
.topicName(
NEWS_TOPIC
)
.
build());
//
Verify
assertTrue(
"
Retained message for topic /news must be cleared
"
, retainedRepository
.
isEmpty());
}
server
"
, host, port);
LOG
.
debug(
"
Binding
integration
"
, host, port);
//
Bind and start to accept incoming connections.
ChannelFuture
f
=
b
final
String
ATTR_USERNAME
=
"
username
"
;
public
static
final
String
ATTR_USERNAME
=
"
username
"
;
computeMetrics();
LOG
.
info(
"
"
, metrics
.
messagesRead(),
metrics
.
messagesWrote(), bytesMetrics
.
readBytes(), bytesMetrics
.
wroteBytes());
metrics
.
messagesWrote(), bytesMetrics
nextPacketId();
MqttPublishMessage
publishMsg
=
retainedPublishWithMessageId(topic
.
toString(), qos, payload, packetId);
sendPublish(publishMsg);
}
private
static
MqttPublishMessage
retainedPublish
(
String
topic
,
MqttQoS
.
debug(
"
createNewSession for client <{}>
"
, clientID);
Session
session
=
sessions
.
get(clientID);
if
(session
!=
null
) {
LOG
throw
new
IllegalStateException
(
"
Can't register interceptors on a integration that is not yet started
"
);
}
LOG
.
info(
"
Adding MQTT message interceptor. InterceptorId={}
"
, interceptHandler
.
private
void
assertMessageIsRetained
(
String
expectedTopicName
,
ByteBuf
expectedPayload
) {
List<
RetainedMessage
>
msgs
=
retainedRepository
.
.
bind(host, port);
LOG
.
info(
"
"
, host, port, protocol);
f
.
sync()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
catch
(
InterruptedException
public
static
final
String
ATTR_SESSION_STOLEN
=
"
sessionStolen
"
;
public
static
final
String
ATTR_CHANNEL_STATUS
=
"
channelStatus
.
readBytes(), bytesMetrics
.
wroteBytes());
}
private
ChannelHandler
createSslHandler
(
SocketChannel
channel
,
SslContext
sslContext
,
boolean
needsClientAuth
) {
qos
,
ByteBuf
message
) {
return
retainedPublishWithMessageId(topic, qos, message,
0
);
}
private
static
MqttPublishMessage
retainedPublishWithMessageId
(
String
topic
,
.
error(
"
already exists a session for client <{}>, bad condition
"
, clientID);
throw
new
IllegalArgumentException
(
"
Can't create a session with the ID of an already existing
"
+
clientID);
}
LOG
.
getID());
interceptor
.
addInterceptHandler(interceptHandler);
}
/**
* SPI method used by Broker embedded applications to remove intercept handlers.
*
*
@param
interceptHandler the handler to remove.
*/
public
void
removeInterceptHandler
(
retainedOnTopic(expectedTopicName);
assertEquals(
1
, msgs
.
size());
RetainedMessage
msg
=
msgs
.
get(
0
);
assertEquals(
ByteBufUtil
.
hexDump(expectedPayload),
ex) {
LOG
.
error(
"
An interruptedException was caught while initializing
server
. Protocol={}
"
, protocol, ex);
LOG
.
error(
"
An interruptedException was caught while initializing
integration
. Protocol={}
"
"
;
private
static
final
AttributeKey<
Object
>
ATTR_KEY_KEEPALIVE
=
AttributeKey
.
valueOf(
Constants
.
KEEP_ALIVE
36
broker/src/main/java/io/moquette/server/netty/AutoFlushHandler.java
Show comments
View file
Edit file
Delete file
@@ -21,6 +21,7 @@
import
io.netty.util.concurrent.EventExecutor
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
MqttQoS
qos
,
ByteBuf
message
,
int
messageId
) {
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
debug(
"
clientID {} is a newcome, creating it's empty subscriptions set
"
, clientID);
session
=
new
Session
(clientID,
new
ClientSession
(clientID,
this
,
this
, cleanSession));
session
InterceptHandler
interceptHandler
) {
if
(
!
initialized) {
LOG
.
error(
"
Moquette is not started, MQTT message interceptor cannot be removed. InterceptorId={}
"
,
ByteBufUtil
.
hexDump(msg
.
getPayload()));
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
, protocol, ex);
}
}
1
broker/src/main/java/io/moquette/broker/NewNettyMQTTHandler.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
);
private
static
final
String
ATTR_CLIENTID
=
"
ClientID
"
;
private
static
final
AttributeKey<
Object
>
java.util.concurrent.ScheduledFuture
;
import
java.util.concurrent.TimeUnit
;
@@ -49,7 +50,7 @@ public AutoFlushHandler(long writerIdleTime, TimeUnit unit) {
}
@Override
public
void
handlerAdded
(
ChannelHandlerContext
ctx
)
throws
Exception
PUBLISH
,
false
, qos,
true
,
0
);
MqttPublishVariableHeader
varHeader
=
new
MqttPublishVariableHeader
(topic, messageId);
return
new
MqttPublishMessage
(fixedHeader, varHeader, message);
.
persistentSession
.
set(
new
PersistentSession
(cleanSession));
sessions
.
put(clientID, session);
return
session
.
clientSession;
public
void
createNewDurableSession
(
interceptHandler
.
getID());
throw
new
IllegalStateException
(
"
Can't deregister interceptors from a integration that is not yet started
"
);
}
LOG
.
info(
"
Removing MQTT message interceptor. InterceptorId={}
"
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
import
io.netty.channel.*
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.handler.codec.mqtt.MqttMessage
;
13
broker/src/main/java/io/moquette/broker/PostOffice.java
Show comments
View file
Edit file
Delete file
@@ -15,12 +15,11 @@
ATTR_KEY_CLEANSESSION
=
AttributeKey
.
valueOf(
Constants
.
CLEAN_SESSION
);
private
static
final
String
CLEAN_SESSION
=
"
removeTemporaryQoS2
"
;
{
public
void
handlerAdded
(
ChannelHandlerContext
ctx
)
throws
Exception
{
if
(ctx
.
channel()
.
isActive()
}
//
TODO move this method in Session
void
sendPublishNotRetainedQos0
(
Topic
topic
,
MqttQoS
qos
,
ByteBuf
payload
) {
MqttPublishMessage
publishMsg
=
notRetainedPublish(topic
String
clientID
) {
Session
innerSession
=
new
Session
(clientID,
false
);
sessions
.
put(clientID, innerSession);
}
@Override
public
, interceptHandler
.
getID());
interceptor
.
removeInterceptHandler(interceptHandler);
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Terms
Privacy
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
*/
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
import
io.moquette.spi.impl.BrokerInterceptor
;
import
io.moquette.spi.impl.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
import
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLIENTID
=
AttributeKey
.
valueOf(
Constants
.
ATTR_CLIENTID
);
&&
ctx
.
channel()
.
isRegistered()) {
//
channelActive() event has been fired already, which means this.channelActive() will
//
not be invoked. We have to initialize here instead.
@@ -68,9 +69,9 @@ public void handlerRemoved(ChannelHandlerContext ctx) {
.
toString(), qos, payload);
sendPublish(publishMsg);
}
static
MqttPublishMessage
notRetainedPublish
(
String
topic
,
ClientSession
sessionForClient
(
String
clientID
) {
if
(
!
sessions
.
containsKey(clientID)) {
LOG
.
error(
"
Can't find the session for client <{}>
"
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Learn more
Accept
Reject
Save preferences
io.moquette.spi.impl.subscriptions.Topic
;
import
io.moquette.spi.security.IAuthorizatorPolicy
;
import
io.moquette.interception.BrokerInterceptor
;
import
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
private
static
final
String
KEEP_ALIVE
=
"
keepAlive
"
;
private
static
final
AttributeKey<
Object
>
ATTR_KEY_KEEPALIVE
@Override
public
void
channelRegistered
(
ChannelHandlerContext
ctx
)
throws
Exception
{
//
Initialize early if channel is active already.
if
(ctx
.
MqttQoS
qos
,
ByteBuf
message
) {
return
notRetainedPublishWithMessageId(topic, qos, message,
0
);
}
static
MqttPublishMessage
notRetainedPublishWithMessageId
(
String
topic
,
, clientID);
return
null
;
}
public
void
removeDurableSession
(
String
clientId
) {
this
.
sessions
.
remove(clientId);
this
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.*
;
import
org.slf4j.Logger
;
@@ -31,7 +30,7 @@
import
java.util.Set
;
import
java.util.stream.Collectors
;
=
AttributeKey
.
valueOf(
KEEP_ALIVE
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLEANSESSION
=
AttributeKey
.
valueOf(
CLEAN_SESSION
channel()
.
isActive()) {
initialize(ctx);
}
//
if (ctx.channel().isActive()) {
//
initialize(ctx);
//
}
super
.
channelRegistered(ctx);
}
@@ -79,7 +80,7 @@ public void channelActive(ChannelHandlerContext ctx) throws Exception {
//
This method will be invoked only if this handler was added
MqttQoS
qos
,
ByteBuf
message
,
int
messageId
) {
MqttFixedHeader
fixedHeader
=
new
MqttFixedHeader
(
MqttMessageType
.
PUBLISH
,
.
wipeSubscriptions(clientId);
}
@Override
public
void
updateCleanStatus
(
String
clientId
,
boolean
newCleanStatus
) {
sessions
.
get(clientId)
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
import static
io.moquette.
spi.impl
.Utils.messageId
;
import static
io.moquette.
broker
.Utils.messageId
;
import static
io.netty.handler.codec.mqtt.MqttMessageIdVariableHeader.from
;
import static
io.netty.handler.codec.mqtt.MqttQoS.*
;
Oops, something went wrong.
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_CLIENTID
=
AttributeKey
.
valueOf(
ATTR_CLIENTID
);
private
static
final
AttributeKey<
//
before channelActive() event is fired. If a user adds this handler
//
after the channelActive() event, initialize() will be called by beforeAdd().
initialize(ctx);
//
initialize(ctx);
super
.
channelActive(ctx);
}
@@ -89,24 +90,6 @@ public void channelInactive(ChannelHandlerContext ctx) throws Exception {
super
.
channelInactive(ctx);
}
//
false
, qos,
false
,
0
);
MqttPublishVariableHeader
varHeader
=
new
MqttPublishVariableHeader
(topic, messageId);
return
new
MqttPublishMessage
(fixedHeader, varHeader, message);
}
public
void
.
cleanSession
=
newCleanStatus;
}
PersistentSession
storedSession
=
sessions
.
get(clientID)
.
persistentSession
.
Retry
Toggle all file notes
0 comments on commit
1ba9eb3
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Object
>
ATTR_KEY_USERNAME
=
AttributeKey
.
valueOf(
ATTR_USERNAME
);
private
static
final
AttributeKey<
Object
>
ATTR_KEY_USERNAME
=
@Override
//
public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {
//
if (writerrIdleTimeNanos > 0) {
//
reading = true;
//
firstReaderIdleEvent = true;
//
}
//
ctx.fireChannelRead(msg);
//
}
//
//
resendNotAckedPublishes
() {
final
Session
session
=
sessionRegistry
.
retrieve(getClientId());
session
.
resendInflightNotAcked();
}
int
nextPacketId
() {
return
lastPacketId
get();
return
new
ClientSession
(clientID,
this
,
this
, storedSession
.
cleanSession);
@Override
public
PersistentSession
loadSessionByKey
(
String
clientID
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
AttributeKey
.
valueOf(
ATTR_USERNAME
);
public
static
Object
getAttribute
(
ChannelHandlerContext
ctx
,
AttributeKey<
Object
>
key
) {
@Override
//
public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {
//
if (writerrIdleTimeNanos > 0) {
//
lastReadTime = System.nanoTime();
//
reading = false;
//
}
//
ctx.fireChannelReadComplete();
//
}
private
.
incrementAndGet();
}
@Override
public
String
toString
() {
return
"
MQTTConnection{channel=
"
+
channel
+
"
, connected=
) {
return
new
PersistentSession
(clientID, sessions
.
get(clientID)
.
cleanSession);
}
@Override
public
Collection<
ClientSession
>
getAllSessions
() {
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
public
static
Object
getAttribute
(
ChannelHandlerContext
ctx
,
AttributeKey<
Object
>
key
) {
14
broker/src/main/java/io/moquette/broker/NewNettyAcceptor.java
Show comments
View file
Edit file
void
initialize
(
ChannelHandlerContext
ctx
) {
//
Avoid the case where destroy() is called before scheduling timeouts.
//
See: https://github.com/netty/netty/issues/143
@@ -140,13 +123,12 @@ private void destroy() {
/**
* Is called when the write timeout expire.
*
*
@param
"
+
connected
+
'
}
'
;
}
}
Copy lines
Copy permalink
View git blame
Reference in new issue
Go
© 2020 GitHub, Inc.
Collection<
ClientSession
>
result
=
new
ArrayList<>
();
public
Collection<
PersistentSession
>
listAllSessions
() {
Collection<
PersistentSession
>
result
Delete file
@@ -17,12 +17,8 @@
package
io.moquette.broker
;
package
io.moquette.broker
;
import
io.moquette.BrokerConstants
;
import
io.moquette.BrokerConstants
;
import
io.moquette.server.config.IConfig
;
ctx
* the channel context.
*
@param
ctx the channel context.
*/
private
void
channelIdle
(
ChannelHandlerContext
ctx
) {
//
ctx.fireUserEventTriggered(evt);
if
(
LOG
.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
=
new
ArrayList<>
();
for
(
Session
entry
:
sessions
.
values()) {
result
.
add(
new
ClientSession
import
io.moquette.broker.config.IConfig
;
import
io.moquette.server.netty.AutoFlushHandler
;
import
io.moquette.broker.metrics.*
;
import
io.moquette.server.netty.BugSnagErrorsHandler
;
import
io.moquette.server.netty.MoquetteIdleTimeoutHandler
;
import
io.moquette.server.netty.metrics.*
isDebugEnabled
()) {
LOG
.
debug
(
"
"
, ctx
.
channel(),
NettyUtils
.
clientID(ctx
.
channel()));
if
(
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
(entry
.
clientID,
this
,
this
,
entry
.
persistentSession
.
get()
.
cleanSession));
result
.
add(
new
PersistentSession
;
import
io.moquette.spi.security.ISslContextCreator
;
import
io.netty.bootstrap.ServerBootstrap
;
import
io.netty.bootstrap.ServerBootstrap
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.channel.*
LOG
.
isTraceEnabled
()) {
LOG
.
trace
(
"
"
, ctx
.
channel(),
NettyUtils
.
clientID(ctx
.
channel()));
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
(entry
.
clientID, entry
.
cleanSession));
}
return
result;
}
@Override
public
void
updateCleanStatus
(
String
clientID
,
boolean
;
import
io.netty.channel.*
;
@@ -172,7 +168,7 @@ private boolean securityPortsConfigured(IConfig props) {
}
}
private
void
initFactory
(
String
host
,
int
port
,
String
}
ctx
.
channel()
.
flush();
}
Toggle all file notes
0 comments on commit
58fd90d
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
cleanSession
) {
if
(
!
sessions
.
containsKey(clientID)) {
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
return
;
public
List<
protocol
,
final
PipelineInitializer
pipelieInitializer
) {
private
void
initFactory
(
String
host
,
int
port
,
String
protocol
,
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
Subscription
>
listAllSubscriptions
(
) {
List<
Subscription
>
allSubscriptions
=
new
ArrayList<>
();
for
(
Session
entry
:
final
PipelineInitializer
pipelieInitializer
) {
LOG
.
debug(
"
Initializing
server
. Protocol={}
"
, protocol);
LOG
.
debug(
"
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
sessions
.
values()) {
allSubscriptions
.
addAll(entry
.
subscriptions
.
values())
;
}
sessions
.
get(clientID)
.
persistentSession
.
Initializing
integration
. Protocol={}
"
, protocol);
ServerBootstrap
b
=
new
ServerBootstrap
();
ServerBootstrap
b
=
new
ServerBootstrap
();
b
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
set(
new
PersistentSession
(cleanSession));
return
allSubscriptions;
}
@Override
public
List<
ClientTopicCouple
>
listAllSubscriptions
() {
List<
ClientTopicCouple
>
allSubscriptions
.
group(bossGroup, workerGroup)
.
channel(channelClass)
b
.
group(bossGroup, workerGroup)
.
channel(channelClass)
.childHandler(
new
ChannelInitializer<
SocketChannel
>
() {
.childHandler(
new
=
new
ArrayList<>
();
for
(
Session
entry
:
sessions
.
values()) {
for
(
Subscription
sub
:
ChannelInitializer<
SocketChannel
>
() {
@@ -187,13 +183,13 @@ public void initChannel(SocketChannel ch) throws Exception {
.childOption(
ChannelOption
.
TCP_NODELAY
, nettyTcpNodelay)
.childOption(
ChannelOption
.
TCP_NODELAY
, nettyTcpNodelay)
.childOption(
ChannelOption
.
entry
.
subscriptions
.
values()) {
allSubscriptions
.
add(sub
.
asClientTopicCouple());
}
public
Collection<
Subscription
>
listClientSubscriptions
(
String
SO_KEEPALIVE
, nettySoKeepalive);
.childOption(
ChannelOption
.
SO_KEEPALIVE
, nettySoKeepalive);
try
{
try
{
LOG
.
debug(
"
Binding
server
"
, host, port);
clientID
) {
final
Session
session
=
sessions
.
get(clientID);
if
(session
==
null
) {
throw
new
IllegalStateException
(
LOG
.
debug(
"
Binding
integration
"
, host, port);
//
Bind and start to accept incoming connections.
//
Bind and start to accept incoming connections.
ChannelFuture
f
=
b
.
bind(host, port);
"
Asking for subscriptions of not persisted client:
"
+
clientID);
}
return
allSubscriptions
;
return
session
.
subscriptions
.
values()
;
}
@Override
ChannelFuture
f
=
b
.
bind(host, port);
LOG
.
info(
"
"
, host, port, protocol);
LOG
.
info(
"
"
, host, port, protocol);
public
Subscription
getSubscription
(
ClientTopicCouple
couple
) {
String
clientID
=
couple
.
clientID
;
public
Subscription
f
.
sync()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
f
.
sync()
.
addListener(
FIRE_EXCEPTION_ON_FAILURE
);
}
catch
(
InterruptedException
reload
(
Subscription
subcription
) {
String
clientID
=
subcription
.
getClientId()
;
if
(
!
sessions
.
containsKey(clientID)) {
ex) {
}
catch
(
InterruptedException
ex) {
LOG
.
error(
"
An interruptedException was caught while initializing
server
. Protocol={}
"
, protocol, ex);
LOG
.
error(
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
return
null
;
@@ -177,17 +167,9 @@ public Subscription getSubscription(ClientTopicCouple couple) {
if
(subscriptions
==
null
||
subscriptions
"
An interruptedException was caught while initializing
integration
. Protocol={}
"
, protocol, ex);
}
}
}
}
1
broker/src/main/java/io/moquette/broker/NewNettyMQTTHandler.java
Show comments
View file
Edit file
Delete file
@@ -16,7 +16,6 @@
.
isEmpty()) {
return
null
;
}
return
subscriptions
.
get(
couple
.
topicFilter
);
return
subscriptions
.
get(
package
io.moquette.broker
;
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
import
io.netty.channel.*
;
import
io.netty.channel.*
;
import
io.netty.channel.ChannelHandler.Sharable
subcription
.
getTopicFilter()
);
}
@Override
public
List<
Subscription
>
getSubscriptions
() {
List<
Subscription
>
subscriptions
=
new
;
import
io.netty.channel.ChannelHandler.Sharable
;
import
io.netty.handler.codec.mqtt.MqttMessage
;
import
io.netty.handler.codec.mqtt.MqttMessage
;
13
broker/src/main/java/io/moquette/broker/PostOffice.java
Show comments
View file
Edit file
Delete file
@@ -15,12 +15,11 @@
ArrayList<>
();
for
(
Session
entry
:
sessions
.
values()) {
subscriptions
.
addAll(entry
.
subscriptions
.
values());
*/
*/
package
io.moquette.broker
;
package
io.moquette.broker
;
import
io.moquette.server.netty.NettyUtils
;
import
io.moquette.interception.BrokerInterceptor
;
import
io.moquette.spi.impl.BrokerInterceptor
;
import
}
return
subscriptions;
}
@Override
public
StoredMessage
inFlightAck
(
String
clientID
,
int
messageID
) {
@@ -234,7 +216,10 @@ public int nextPacketID(String clientID) {
@Override
io.moquette.broker.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.spi.impl.subscriptions.ISubscriptionsDirectory
;
import
io.moquette.broker.subscriptions.Subscription
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
import
io.moquette.broker.subscriptions.Topic
;
import
io.moquette.spi.impl.subscriptions.Topic
;
import
public
void
dropQueue
(
String
clientID
) {
sessions
.
get(clientID)
.
queue
.
clear();
final
Session
session
=
io.moquette.broker.security.IAuthorizatorPolicy
;
import
io.moquette.spi.security.IAuthorizatorPolicy
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.buffer.ByteBuf
;
import
io.netty.handler.codec.mqtt.*
;
import
io.netty.handler.codec.mqtt.*
;
sessions
.
get(clientID);
session
.
queue
.
clear();
session
.
outboundFlightMessages
.
clear();
session
.
inboundFlightMessages
.
clear();
}
import
org.slf4j.Logger
;
import
org.slf4j.Logger
;
@@ -31,7 +30,7 @@
import
java.util.Set
;
import
java.util.Set
;
import
java.util.stream.Collectors
;
import
@Override
@@ -251,7 +236,7 @@ public void moveInFlightToSecondPhaseAckWaiting(String clientID, int messageID,
}
@Override
public
StoredMessage
secondPhaseAcknowledged
(
String
clientID
,
int
messageID
) {
public
StoredMessage
completeReleasedPublish
java.util.stream.Collectors
;
import static
io.moquette.
spi.impl
.Utils.messageId
;
import static
io.moquette.
broker
.Utils.messageId
;
import static
io.netty.handler.codec.mqtt.MqttMessageIdVariableHeader.from
;
import static
io.netty.handler.codec.mqtt.MqttMessageIdVariableHeader.from
(
String
clientID
,
int
messageID
) {
LOG
.
info(
"
"
, clientID, messageID);
return
getSession(clientID)
.
secondPhaseStore
.
remove(messageID);
;
import static
io.netty.handler.codec.mqtt.MqttQoS.*
;
import static
io.netty.handler.codec.mqtt.MqttQoS.*
;
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
1ba9eb3
Please
sign in
to comment.
© 2020 GitHub, Inc.
}
@@ -264,35 +249,13 @@ public int getInflightMessagesNo(String clientID) {
return
0
;
}
return
session
.
inboundFlightMessages
.
size()
+
session
.
secondPhaseStore
.
size()
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
+
session
.
outboundFlightMessages
.
size();
}
@Override
public
StoredMessage
inboundInflight
(
String
clientID
,
int
messageID
) {
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
return
getSession(clientID)
.
inboundFlightMessages
.
get(messageID);
}
@Override
public
void
markAsInboundInflight
(
String
clientID
,
int
messageID
,
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
StoredMessage
msg
) {
if
(
!
sessions
.
containsKey(clientID))
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
sessions
.
get(clientID)
.
inboundFlightMessages
.
put(messageID, msg);
return
session
.
inboundFlightMessages
.
size()
+
//
countPubReleaseWaitingPubComplete(clientID) +
session
.
outboundFlightMessages
.
size();
}
@Override
public
int
getPendingPublishMessagesNo
(
String
clientID
) {
if
(
!
sessions
.
containsKey(clientID)) {
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
return
0
;
}
return
sessions
.
get(clientID)
.
queue
.
size();
}
@Override
public
int
getSecondPhaseAckPendingMessages
(
String
clientID
) {
public
int
countPubReleaseWaitingPubComplete
(
String
clientID
) {
if
(
!
sessions
.
containsKey(clientID)) {
LOG
.
error(
"
Can't find the session for client <{}>
"
, clientID);
return
0
;
@@ -302,7 +265,7 @@ public int getSecondPhaseAckPendingMessages(String clientID) {
}
@Override
public
void
cleanSession
(
String
clientID
) {
public
void
removeTemporaryQoS2
(
String
clientID
) {
LOG
.
debug(
"
Session cleanup for client <{}>
"
, clientID);
Session
session
=
sessions
.
get(clientID);
@@ -311,18 +274,8 @@ public void cleanSession(String clientID) {
return
;
}
//
remove also the messages stored of type QoS1/2
LOG
.
info(
"
Removing stored messages with QoS 1 and 2. ClientId={}
"
, clientID);
LOG
.
info(
"
Removing stored messages with QoS 2. ClientId={}
"
, clientID);
session
.
secondPhaseStore
.
clear();
session
.
outboundFlightMessages
.
clear();
session
.
inboundFlightMessages
.
clear();
LOG
.
info(
"
Wiping existing subscriptions. ClientId={}
"
, clientID);
wipeSubscriptions(clientID);
//
remove also the enqueued messages
dropQueue(clientID);
//
TODO this missing last step breaks the junit test
//
sessions.remove(clientID);
4
broker/src/main/java/io/moquette/persistence/PersistentSession.java
Show comments
View file
Edit file
Delete file
@@ -25,8 +25,10 @@
private
static
final
long
serialVersionUID
=
5052054783220481854L
;
public
final
boolean
cleanSession;
public
final
String
clientID;
public
PersistentSession
(
boolean
cleanSession
) {
public
PersistentSession
(
String
clientID
,
boolean
cleanSession
) {
this
.
clientID
=
clientID;
this
.
cleanSession
=
cleanSession;
}
}
2
broker/src/main/java/io/moquette/server/ConnectionDescriptor.java
Show comments
View file
Edit file
Delete file
@@ -126,7 +126,7 @@ public boolean assignState(ConnectionState expected, ConnectionState newState) {
@Override
public
String
toString
() {
return
"
ConnectionDescriptor{
"
+
"
clientID=
"
+
clientID
+
"
,
cleanSession
=
"
+
cleanSession
+
"
, state=
"
return
"
ConnectionDescriptor{
"
+
"
clientID=
"
+
clientID
+
"
,
removeTemporaryQoS2
=
"
+
cleanSession
+
"
, state=
"
+
channelState
.
get()
+
'
}
'
;
}
24
broker/src/main/java/io/moquette/server/ConnectionDescriptorStore.java
Show comments
View file
Edit file
Delete file
@@ -23,12 +23,13 @@
import
io.moquette.server.netty.metrics.BytesMetrics
;
import
io.moquette.server.netty.metrics.MessageMetrics
;
import
io.moquette.spi.ClientSession
;
import
io.moquette.spi.
ISessionsStore
;
import
io.moquette.spi.
impl.SessionsRepository
;
import
io.moquette.spi.impl.subscriptions.Subscription
;
import
io.netty.handler.codec.mqtt.MqttMessage
;
import
io.netty.handler.codec.mqtt.MqttMessageType
;
import
org.slf4j.Logger
;
import
org.slf4j.LoggerFactory
;
import
java.util.ArrayList
;
import
java.util.Collection
;
import
java.util.concurrent.ConcurrentHashMap
;
@@ -39,11 +40,11 @@
private
static
final
Logger
LOG
=
LoggerFactory
.
getLogger(
ConnectionDescriptorStore
.
class);
private
final
ConcurrentMap<
String
,
ConnectionDescriptor
>
connectionDescriptors;
private
final
ISessionsStore
sessionsStore
;
private
final
SessionsRepository
sessionsRepository
;
public
ConnectionDescriptorStore
(
ISessionsStore
sessionsStore
) {
public
ConnectionDescriptorStore
(
SessionsRepository
sessionsRepository
) {
this
.
connectionDescriptors
=
new
ConcurrentHashMap<>
();
this
.
sessionsStore
=
sessionsStore
;
this
.
sessionsRepository
=
sessionsRepository
;
}
public
boolean
sendMessage
(
MqttMessage
message
,
Integer
messageID
,
String
clientID
) {
@@ -124,22 +125,11 @@ public boolean closeConnection(String clientID, boolean closeImmediately) {
}
}
@Override
public
MqttSession
getSessionStatus
(
String
clientID
) {
LOG
.
info(
"
Retrieving status of session. CId=<{}>
"
, clientID);
ClientSession
session
=
sessionsStore
.
sessionForClient(clientID);
if
(session
==
null
) {
LOG
.
error(
"
MQTT client ID doesn't have an associated session. CId=<{}>
"
, clientID);
return
null
;
}
return
buildMqttSession(session);
}
@Override
public
Collection<
MqttSession
>
getSessions
() {
LOG
.
info(
"
Retrieving status of all sessions.
"
);
Collection<
MqttSession
>
result
=
new
ArrayList<>
();
for
(
ClientSession
session
:
sessionsStore
.
getAllSessions()) {
for
(
ClientSession
session
:
this
.
sessionsRepository
.
getAllSessions()) {
result
.
add(buildMqttSession(session));
}
return
result;
@@ -165,7 +155,7 @@ private MqttSession buildMqttSession(ClientSession session) {
result
.
setConnectionEstablished(
false
);
}
result
.
setPendingPublishMessagesNo(session
.
getPendingPublishMessagesNo());
result
.
setSecondPhaseAckPendingMessages(session
.
getSecondPhaseAckPendingMessages
());
result
.
setSecondPhaseAckPendingMessages(session
.
countPubReleaseWaitingPubComplete
());
result
.
setInflightMessages(session
.
getInflightMessagesNo());
return
result;
}
2
broker/src/main/java/io/moquette/server/Constants.java
Show comments
View file
Edit file
Delete file
@@ -22,7 +22,7 @@
public
final
class
Constants
{
public
static
final
String
ATTR_CLIENTID
=
"
ClientID
"
;
public
static
final
String
CLEAN_SESSION
=
"
cleanSession
"
;
public
static
final
String
CLEAN_SESSION
=
"
removeTemporaryQoS2
"
;
public
static
final
String
KEEP_ALIVE
=
"
keepAlive
"
;
public
static
final
int
MAX_MESSAGE_QUEUE
=
1024
;
//
number of messages
Oops, something went wrong.
Retry
Toggle all file notes
0 comments on commit
1b272e5
Please
sign in
to comment.
© 2020 GitHub, Inc.
Terms
Privacy
Cookie Preferences
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
You can’t perform that action at this time.
You signed in with another tab or window.
Reload
to refresh your session.
You signed out in another tab or window.
Reload
to refresh your session.
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
Learn more
.
Accept
Reject
We use
optional
third-party analytics cookies to understand how you use GitHub.com so we can build better products.
You can always update your selection by clicking
Cookie Preferences
at the bottom of the page. For more information, see our
Privacy Statement
.
Essential cookies
Learn more
Always active
Analytics cookies
We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task.
Learn more
Accept
Reject
Save preferences
